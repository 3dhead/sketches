<!doctype html><html lang=en><meta charset=UTF-8><meta name=viewport content="width=device-width,shrink-to-fit=0,user-scalable=no,minimum-scale=1,maximum-scale=1"><title>2019.01.31-21.35.35.js</title><style>html{width:100%;height:100%;display:flex;justify-content:center;align-items:center;flex-direction:column}body{width:100%;height:100%;display:flex;justify-content:center;align-items:center;flex-direction:row;margin:0}canvas{margin:auto;display:block;box-shadow:0 2px 12px -2px rgba(0,0,0,.15)}</style><body><script>!function(){return function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){return i(t[a][1][e]||e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}}()({1:[function(e,t,n){"use strict";t.exports=function(e,t){e=e||document.body,t=t||{};var n=[.01,Infinity];"distanceLimits"in t&&(n[0]=t.distanceLimits[0],n[1]=t.distanceLimits[1]);"zoomMin"in t&&(n[0]=t.zoomMin);"zoomMax"in t&&(n[1]=t.zoomMax);var c=i({center:t.center||[0,0,0],up:t.up||[0,1,0],eye:t.eye||[0,0,10],mode:t.mode||"orbit",distanceLimits:n}),l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f=0,h=e.clientWidth,d=e.clientHeight,p={view:c,element:e,delay:t.delay||16,rotateSpeed:t.rotateSpeed||1,zoomSpeed:t.zoomSpeed||1,translateSpeed:t.translateSpeed||1,flipX:!!t.flipX,flipY:!!t.flipY,modes:c.modes,tick:function(){var t=r(),n=this.delay;c.idle(t-n),c.flush(t-(100+2*n));var i=t-2*n;c.recalcMatrix(i);for(var o=!0,a=c.computedMatrix,s=0;s<16;++s)o=o&&l[s]===a[s],l[s]=a[s];var u=e.clientWidth===h&&e.clientHeight===d;return h=e.clientWidth,d=e.clientHeight,o?!u:(f=Math.exp(c.computedRadius[0]),!0)},lookAt:function(e,t,n){c.lookAt(c.lastT(),e,t,n)},rotate:function(e,t,n){c.rotate(c.lastT(),e,t,n)},pan:function(e,t,n){c.pan(c.lastT(),e,t,n)},translate:function(e,t,n){c.translate(c.lastT(),e,t,n)}};Object.defineProperties(p,{matrix:{get:function(){return c.computedMatrix},set:function(e){return c.setMatrix(c.lastT(),e),c.computedMatrix},enumerable:!0},mode:{get:function(){return c.getMode()},set:function(e){return c.setMode(e),c.getMode()},enumerable:!0},center:{get:function(){return c.computedCenter},set:function(e){return c.lookAt(c.lastT(),e),c.computedCenter},enumerable:!0},eye:{get:function(){return c.computedEye},set:function(e){return c.lookAt(c.lastT(),null,e),c.computedEye},enumerable:!0},up:{get:function(){return c.computedUp},set:function(e){return c.lookAt(c.lastT(),null,null,e),c.computedUp},enumerable:!0},distance:{get:function(){return f},set:function(e){return c.setDistance(c.lastT(),e),e},enumerable:!0},distanceLimits:{get:function(){return c.getDistanceLimits(n)},set:function(e){return c.setDistanceLimits(e),e},enumerable:!0}}),e.addEventListener("contextmenu",function(e){return e.preventDefault(),!1});var m=0,g=0,v={shift:!1,control:!1,alt:!1,meta:!1};function b(t,n,i,o){var a=1/e.clientHeight,s=a*(n-m),u=a*(i-g),l=p.flipX?1:-1,h=p.flipY?1:-1,d=Math.PI*p.rotateSpeed,b=r();if(1&t)o.shift?c.rotate(b,0,0,-s*d):c.rotate(b,l*d*s,-h*d*u,0);else if(2&t)c.pan(b,-p.translateSpeed*s*f,p.translateSpeed*u*f,0);else if(4&t){var y=p.zoomSpeed*u/window.innerHeight*(b-c.lastT())*50;c.pan(b,0,0,f*(Math.exp(y)-1))}m=n,g=i,v=o}return o(e,b),e.addEventListener("touchstart",function(t){var n=s(t.changedTouches[0],e);b(0,n[0],n[1],v),b(1,n[0],n[1],v),t.preventDefault()},!!u&&{passive:!1}),e.addEventListener("touchmove",function(t){var n=s(t.changedTouches[0],e);b(1,n[0],n[1],v),t.preventDefault()},!!u&&{passive:!1}),e.addEventListener("touchend",function(t){s(t.changedTouches[0],e),b(0,m,g,v),t.preventDefault()},!!u&&{passive:!1}),a(e,function(e,t,n){var i=p.flipX?1:-1,o=p.flipY?1:-1,a=r();if(Math.abs(e)>Math.abs(t))c.rotate(a,0,0,-e*i*Math.PI*p.rotateSpeed/window.innerWidth);else{var s=p.zoomSpeed*o*t/window.innerHeight*(a-c.lastT())/100;c.pan(a,0,0,f*(Math.exp(s)-1))}},!0),p};var r=e("right-now"),i=e("3d-view"),o=e("mouse-change"),a=e("mouse-wheel"),s=e("mouse-event-offset"),u=e("has-passive-events")},{"3d-view":2,"has-passive-events":109,"mouse-change":117,"mouse-event-offset":118,"mouse-wheel":120,"right-now":130}],2:[function(e,t,n){"use strict";t.exports=function(e){var t=(e=e||{}).eye||[0,0,1],n=e.center||[0,0,0],s=e.up||[0,1,0],u=e.distanceLimits||[0,Infinity],c=e.mode||"turntable",l=r(),f=i(),h=o();return l.setDistanceLimits(u[0],u[1]),l.lookAt(0,t,n,s),f.setDistanceLimits(u[0],u[1]),f.lookAt(0,t,n,s),h.setDistanceLimits(u[0],u[1]),h.lookAt(0,t,n,s),new a({turntable:l,orbit:f,matrix:h},c)};var r=e("turntable-camera-controller"),i=e("orbit-camera-controller"),o=e("matrix-camera-controller");function a(e,t){this._controllerNames=Object.keys(e),this._controllerList=this._controllerNames.map(function(t){return e[t]}),this._mode=t,this._active=e[t],this._active||(this._mode="turntable",this._active=e.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var s=a.prototype;[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]].forEach(function(e){for(var t=e[0],n=[],r=0;r<e[1];++r)n.push("a"+r);var i="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+e[0]+"("+n.join()+")}";s[t]=Function.apply(null,n.concat(i))}),s.recalcMatrix=function(e){this._active.recalcMatrix(e)},s.getDistance=function(e){return this._active.getDistance(e)},s.getDistanceLimits=function(e){return this._active.getDistanceLimits(e)},s.lastT=function(){return this._active.lastT()},s.setMode=function(e){if(e!==this._mode){var t=this._controllerNames.indexOf(e);if(!(t<0)){var n=this._active,r=this._controllerList[t],i=Math.max(n.lastT(),r.lastT());n.recalcMatrix(i),r.setMatrix(i,n.computedMatrix),this._active=r,this._mode=e,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},s.getMode=function(){return this._mode}},{"matrix-camera-controller":116,"orbit-camera-controller":122,"turntable-camera-controller":135}],3:[function(e,t,n){"use strict";var r=Math.abs,i=Math.min;function o(e,t,n,a){var s=r(e-t);return null==n&&(n=o.DBL_EPSILON),null==a&&(a=n),s<=n||(s<=a*i(r(e),r(t))||e===t)}o.FLT_EPSILON=1.1920929e-7,o.DBL_EPSILON=2.220446049250313e-16,t.exports=o},{}],4:[function(e,t,n){"use strict";function r(e,t,n,r,i,o){var a=["function ",e,"(a,l,h,",r.join(","),"){",o?"":"var i=",n?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",i?".get(m)":"[m]"];return o?t.indexOf("c")<0?a.push(";if(x===y){return m}else if(x<=y){"):a.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):a.push(";if(",t,"){i=m;"),a.push(n?"l=m+1}else{h=m-1}":"h=m-1}else{l=m+1}"),a.push("}"),a.push(o?"return -1};":"return i};"),a.join("")}function i(e,t,n,i){return new Function([r("A","x"+e+"y",t,["y"],!1,i),r("B","x"+e+"y",t,["y"],!0,i),r("P","c(x,y)"+e+"0",t,["y","c"],!1,i),r("Q","c(x,y)"+e+"0",t,["y","c"],!0,i),"function dispatchBsearch",n,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",n].join(""))()}t.exports={ge:i(">=",!1,"GE"),gt:i(">",!1,"GT"),lt:i("<",!0,"LT"),le:i("<=",!0,"LE"),eq:i("-",!0,"EQ",!0)}},{}],5:[function(e,t,n){var r=e("./lib/css-color"),i=e("./lib/css-color-names.json"),o=e("./lib/relative-luminance"),a=e("./lib/hsl"),s=e("./lib/hex-to-rgba"),u=e("./lib/rgba-to-hex");t.exports.parse=r.parse,t.exports.style=r.style,t.exports.names=i,t.exports.relativeLuminance=function(e){var n=t.exports.parse(e);return n?o(n.rgb):null},t.exports.contrastRatio=function(e,n){var r=t.exports.relativeLuminance(e),i=t.exports.relativeLuminance(n);return null==r||null==i?null:(Math.max(r,i)+.05)/(Math.min(r,i)+.05)},t.exports.offsetHSL=function(e,n,r,i){var o=t.exports.parse(e);return o?(o.hsla[0]+=n||0,o.hsla[1]=Math.max(0,Math.min(100,o.hsla[1]+(r||0))),o.hsla[2]=Math.max(0,Math.min(100,o.hsla[2]+(i||0))),t.exports.parse({hsla:o.hsla})):null},t.exports.blend=function(e,n,r){var i=t.exports.parse(e),o=t.exports.parse(n);if(null==i||null==o)return null;var a=i.rgba,s=o.rgba,u=(r="number"==typeof r&&isFinite(r)?r:1)*s[3];if(u>=1)return o;for(var c=0;c<3;c++)s[c]=s[c]*u+a[c]*(a[3]*(1-u));return s[3]=Math.max(0,Math.min(1,u+a[3]*(1-u))),t.exports.parse(s)},t.exports.hexToRGBA=s,t.exports.RGBAToHex=u,t.exports.RGBAToHSLA=a.RGBAToHSLA,t.exports.HSLAToRGBA=a.HSLAToRGBA},{"./lib/css-color":11,"./lib/css-color-names.json":10,"./lib/hex-to-rgba":12,"./lib/hsl":13,"./lib/relative-luminance":14,"./lib/rgba-to-hex":15}],6:[function(e,t,n){var r=e("lineclip");t.exports.clipSegmentToCircle=e("./lib/clip/clip-segment-to-circle"),t.exports.clipLineToCircle=e("./lib/clip/clip-line-to-circle"),t.exports.clipPolylinesToBox=function(e,t,n,i){if(!Array.isArray(t)||2!==t.length&&4!==t.length)throw new Error("Expected box to either be format [ minPoint, maxPoint ] or [ minX, minY, maxX, maxY ]");if(2===t.length){var o=t[0],a=t[1];t=[o[0],o[1],a[0],a[1]]}return i=!1!==i,(n=Boolean(n))?e.map(function(e){var n=r.polygon(e,t);return i&&n.length>2&&n.push(n[0]),n}).filter(function(e){return e.length>0}):e.map(function(e){return r.polyline(e,t)}).reduce(function(e,t){return e.concat(t)},[])},t.exports.createHatchLines=function(e,t,n,r){if(!Array.isArray(e)||2!==e.length&&4!==e.length)throw new Error("Expected box to either be format [ minPoint, maxPoint ] or [ minX, minY, maxX, maxY ]");if(2===e.length){var i=e[0],o=e[1];e=[i[0],i[1],o[0],o[1]]}null==t&&(t=-Math.PI/4);null==n&&(n=.5);null==r&&(r=[]);if(0===(n=Math.abs(n)))throw new Error("cannot use a spacing of zero as it will run an infinite loop!");var a=e[0],s=e[1],u=e[2],c=e[3],l=u-a,f=c-s;if(0===l||0===f)return r;var h=Math.sqrt(l*l+f*f)/2,d=Math.PI/2-t,p=Math.cos(d),m=Math.sin(d),g=a+l/2,v=s+f/2,b=-h;for(;b<=h;){var y=g+b*p+h*m,x=v+b*m-h*p,_=g+b*p-h*m,w=v+b*m+h*p;b+=n,y<a&&_<a||y>u&&_>u||(x<s&&w<s||x>c&&w>c||r.push([[y,x],[_,w]]))}return r}},{"./lib/clip/clip-line-to-circle":8,"./lib/clip/clip-segment-to-circle":9,lineclip:111}],7:[function(e,t,n){t.exports={random:e("./random"),math:e("./math"),penplot:e("./penplot.js"),geometry:e("./geometry.js"),shader:e("./shader.js"),color:e("./color.js")}},{"./color.js":5,"./geometry.js":6,"./math":17,"./penplot.js":18,"./random":19,"./shader.js":20}],8:[function(e,t,n){var r=e("almost-equal");function i(e){return e*e}t.exports=function(e,t,n,o,a){null==a&&(a=[]);var s,u=i(t[0]-e[0])+i(t[1]-e[1]),c=2*((t[0]-e[0])*(e[0]-n[0])+(t[1]-e[1])*(e[1]-n[1])),l=i(n[0])+i(n[1])+i(e[0])+i(e[1])-2*(n[0]*e[0]+n[1]*e[1])-i(o),f=c*c-4*u*l;if(f<0)return!1;if(r(f,0))return a.push([e[0]+(s=-c/(2*u))*(t[0]-e[0]),e[1]+s*(t[1]-e[1])]),!0;if(f>0){var h=Math.sqrt(f);return a.push([e[0]+(s=(-c+h)/(2*u))*(t[0]-e[0]),e[1]+s*(t[1]-e[1])]),a.push([e[0]+(s=(-c-h)/(2*u))*(t[0]-e[0]),e[1]+s*(t[1]-e[1])]),!0}return null}},{"almost-equal":3}],9:[function(e,t,n){var r=e("almost-equal");function i(e,t,n,r,i){return(o=n-e)*o+(a=r-t)*a<=i*i;var o,a}function o(e,t,n,r){var i=e-n,o=t-r;return Math.sqrt(i*i+o*o)}function a(e,t,n,r,i){var a=i/o(e,t,n,r);return[e+a*(n-e),t+a*(r-t)]}t.exports=function(e,t,n,s,u){return function(e,t,n,s,u,c,l,f){null==f&&(f=[]);var h,d,p,m,g,v=i(e,t,u,c,l),b=i(n,s,u,c,l);if(v&&b)return f.push([e,t]),f.push([n,s]),!0;if(v||b){p=function(e,t,n,r,i,o){var a=n-e,s=r-t,u=(a*(i-e)+s*(o-t))/(a*a+s*s);return[e+u*a,t+u*s]}(e,t,n,s,u,c),h=o(m=p[0],g=p[1],u,c),d=Math.sqrt(l*l-h*h);var y=v?[e,t]:[n,s],x=v?a(m,g,n,s,d):a(m,g,e,t,d);return r(y[0],x[0])&&r(y[1],x[1])?(f.push(y),!0):(f.push(y),f.push(x),!0)}return p=function(e,t,n,r,i,o){var a=n-e,s=r-t,u=a*(i-e)+s*(o-t);if(u<=0)return[e,t];var c=a*a+s*s;if(c<=u)return[n,r];var l=u/c;return[e+l*a,t+l*s]}(e,t,n,s,u,c),g=p[1],!(r(e,m=p[0])&&r(t,g)||r(n,m)&&r(s,g))&&(!((h=o(m,g,u,c))>l)&&(r(h,l)?(f.push([m,g]),!0):r(h,0)?(f.push(a(u,c,e,t,l)),f.push(a(u,c,n,s,l)),!0):(d=Math.sqrt(l*l-h*h),f.push(a(m,g,e,t,d)),f.push(a(m,g,n,s,d)),!0)))}(e[0],e[1],t[0],t[1],n[0],n[1],s,u)}},{"almost-equal":3}],10:[function(e,t,n){t.exports={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},{}],11:[function(e,t,n){var r=e("./css-color-names.json"),i=e("./hsl"),o=e("./hex-to-rgba"),a=e("./rgba-to-hex"),s=e("./wrap");function u(e){if("string"!=typeof e)throw new TypeError("Color parsing must be performed on a string parameter");var t,n,u;if((e=e.toLowerCase())in r?e=r[e]:"transparent"===e&&(e="#00000000"),/^#[a-f0-9]+$/.test(e))t=o(e),u=a(t),n=i.RGBAToHSLA(t);else{var c=/^((?:rgb|hsl)a?)\s*\(([^)]*)\)/.exec(e);if(!c)return null;var l=c[1].replace(/a$/,""),f=c[2].replace(/^\s+|\s+$/g,"").split(/\s*,\s*/).map(function(e,t){return t<=2?Math.round(parseFloat(e)||0):("number"==typeof(e=parseFloat(e))&&isFinite(e)||(e=1),e)});void 0!==f[3]&&isFinite(f[3])||(f[3]=1),"rgb"===l?(n=i.RGBAToHSLA(f),t=f):"hsl"===l&&(t=i.HSLAToRGBA(f),f[0]=s(f[0],0,360),n=f),u=a(t)}return t||u||n?{hex:u,alpha:t[3],rgb:t.slice(0,3),rgba:t,hsl:n.slice(0,3),hsla:n}:null}function c(e,t,n,r){return e=Math.max(0,Math.min(255,Math.round(e))),t=Math.max(0,Math.min(255,Math.round(t))),n=Math.max(0,Math.min(255,Math.round(n))),1!==r&&isFinite(r)&&void 0!==r?"rgba("+[e,t,n,r=Math.max(0,Math.min(1,r))].join(", ")+")":"rgb("+[e,t,n].join(", ")+")"}function l(e,t,n,r){return e=s(e,0,360),e=Math.max(0,Math.min(360,Math.round(e))),t=Math.max(0,Math.min(100,Math.round(t))),n=Math.max(0,Math.min(100,Math.round(n))),1!==r&&isFinite(r)&&void 0!==r?"hsla("+[e,t,n,r=Math.max(0,Math.min(1,r))].join(", ")+")":"hsl("+[e,t,n].join(", ")+")"}t.exports.parse=function(e){if("string"==typeof e)return u(e);if(Array.isArray(e)&&e.length>=3){var t=c(e[0],e[1],e[2],e[3]);return u(t)}var n;if(e&&"object"==typeof e&&(e.hex?n=e.hex:e.rgba?n=c(e.rgba[0],e.rgba[1],e.rgba[2],e.rgba[3]):e.hsla?n=l(e.hsla[0],e.hsla[1],e.hsla[2],e.hsla[3]):e.rgb?n=c(e.rgb[0],e.rgb[1],e.rgb[2]):e.hsl&&(n=l(e.hsl[0],e.hsl[1],e.hsl[2])),n))return u(n);return null},t.exports.style=function(e){var n=t.exports.parse(e);if(n){var r=n.rgba;return c(r[0],r[1],r[2],r[3])}return null}},{"./css-color-names.json":10,"./hex-to-rgba":12,"./hsl":13,"./rgba-to-hex":15,"./wrap":16}],12:[function(e,t,n){t.exports=function(e){if("string"!=typeof e)throw new TypeError("Hex code parsing must be performed on a string parameter");if(e=e.toLowerCase(),!/^#[a-f0-9]+$/.test(e))return null;var t=e.replace(/^#/,""),n=1;8===t.length&&(n=parseInt(t.slice(6,8),16)/255,t=t.slice(0,6));4===t.length&&(n=parseInt(t.slice(3,4).repeat(2),16)/255,t=t.slice(0,3));3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var r=parseInt(t,16);return[r>>16,r>>8&255,255&r,n]}},{}],13:[function(e,t,n){var r=e("float-hsl2rgb"),i=e("float-rgb2hsl"),o=e("./wrap");t.exports.RGBAToHSLA=function(e){var t=i([e[0]/255,e[1]/255,e[2]/255]);return[Math.max(0,Math.min(360,Math.round(360*t[0]))),Math.max(0,Math.min(100,Math.round(100*t[1]))),Math.max(0,Math.min(100,Math.round(100*t[2]))),e[3]]},t.exports.HSLAToRGBA=function(e){var t=o(e[0],0,360),n=r([t/360,e[1]/100,e[2]/100]);return[Math.max(0,Math.min(255,Math.round(255*n[0]))),Math.max(0,Math.min(255,Math.round(255*n[1]))),Math.max(0,Math.min(255,Math.round(255*n[2]))),e[3]]}},{"./wrap":16,"float-hsl2rgb":30,"float-rgb2hsl":31}],14:[function(e,t,n){var r=.2126,i=.7152,o=.0722,a=1/12.92;function s(e){return Math.pow((e+.055)/1.055,2.4)}t.exports=function(e){var t=e[0]/255,n=e[1]/255,u=e[2]/255,c=t<=.03928?t*a:s(t),l=n<=.03928?n*a:s(n),f=u<=.03928?u*a:s(u);return c*r+l*i+f*o}},{}],15:[function(e,t,n){t.exports=function(e){if(!e||!Array.isArray(e))throw new TypeError("Must specify an array to convert into a hex code");var t=Math.max(0,Math.min(255,Math.round(e[0]||0))),n=Math.max(0,Math.min(255,Math.round(e[1]||0))),r=Math.max(0,Math.min(255,Math.round(e[2]||0))),i=e[3];void 0!==i&&isFinite(i)||(i=1);var o=Math.max(0,Math.min(255,Math.round(255*i))),a=255===o?"":(256|o).toString(16).slice(1);return"#"+((r|n<<8|t<<16|1<<24).toString(16).slice(1)+a)}},{}],16:[function(e,t,n){t.exports=function(e,t,n){if("number"!=typeof t||"number"!=typeof n)throw new TypeError('Must specify "to" and "from" arguments as numbers');if(t>n){var r=t;t=n,n=r}var i=n-t;if(0===i)return n;return e-i*Math.floor((e-t)/i)}},{}],17:[function(e,t,n){var r=e("defined"),i=e("./lib/wrap"),o=Number.EPSILON;function a(e,t,n){return t<n?e<t?t:e>n?n:e:e<n?n:e>t?t:e}function s(e,t,n){return e*(1-n)+t*n}function u(e,t,n){return Math.abs(e-t)<o?0:(n-e)/(t-e)}function c(e,t){return t=r(t,0),"number"==typeof e&&isFinite(e)?e:t}function l(e){if("number"!=typeof e)throw new TypeError("Expected dims argument");return function(t,n){var i;n=r(n,0),null==t?i=n:"number"==typeof t&&isFinite(t)&&(i=t);var o,a=[];if(null==i)for(o=0;o<e;o++)a[o]=c(t[o],n);else for(o=0;o<e;o++)a[o]=i;return a}}function f(e,t,n,r){if(r=r||[],e.length!==t.length)throw new TypeError("min and max array are expected to have the same length");for(var i=0;i<e.length;i++)r[i]=s(e[i],t[i],n);return r}function h(e,t){if("number"!=typeof(e=r(e,0)))throw new TypeError("Expected n argument to be a number");for(var n=[],i=0;i<e;i++)n.push(t);return n}function d(e,t){return(e%t+t)%t}function p(e,t,n,r){return s(e,t,1-Math.exp(-n*r))}t.exports={mod:d,fract:function(e){return e-Math.floor(e)},sign:function(e){return e>0?1:e<0?-1:0},degToRad:function(e){return e*Math.PI/180},radToDeg:function(e){return 180*e/Math.PI},wrap:i,pingPong:function(e,t){return e=d(e,2*t),t-Math.abs(e-t)},linspace:function(e,t){if("number"!=typeof(e=r(e,0)))throw new TypeError("Expected n argument to be a number");"boolean"==typeof(t=t||{})&&(t={endpoint:!0});var n=r(t.offset,0);return t.endpoint?h(e).map(function(t,r){return e<=1?0:(r+n)/(e-1)}):h(e).map(function(t,r){return(r+n)/e})},lerp:s,lerpArray:f,inverseLerp:u,lerpFrames:function(e,t,n){t=a(t,0,1);var r=e.length-1,i=t*r,o=Math.floor(i),u=i-o,c=Math.min(o+1,r),l=e[o%e.length],h=e[c%e.length];if("number"==typeof l&&"number"==typeof h)return s(l,h,u);if(Array.isArray(l)&&Array.isArray(h))return f(l,h,u,n);throw new TypeError("Mismatch in value type of two array elements: "+o+" and "+c)},clamp:a,clamp01:function(e){return a(e,0,1)},smoothstep:function(e,t,n){var r=a(u(e,t,n),0,1);return r*r*(3-2*r)},damp:p,dampArray:function(e,t,n,r,i){i=i||[];for(var o=0;o<e.length;o++)i[o]=p(e[o],t[o],n,r);return i},mapRange:function(e,t,n,r,i,a){if(Math.abs(t-n)<o)return r;var s=(e-t)/(n-t)*(i-r)+r;return a&&(i<r?s<i?s=i:s>r&&(s=r):s>i?s=i:s<r&&(s=r)),s},expand2D:l(2),expand3D:l(3),expand4D:l(4)}},{"./lib/wrap":16,defined:28}],18:[function(e,t,n){var r=e("defined"),i=e("convert-length");t.exports.polylinesToSVG=function(e,t){var n=(t=t||{}).width,o=t.height;if(void 0===n||void 0===o)throw new Error('Must specify "width" and "height" options');var a=t.units||"px",s=[],u={roundPixel:!1,precision:r(t.precision,5),pixelsPerInch:90};e.forEach(function(e){e.forEach(function(e,t){var n=0===t?"M":"L",r=i(e[0],a,"px",u).toString(),o=i(e[1],a,"px",u).toString();s.push(n+r+" "+o)})});var c=s.join(" "),l=i(n,a,"px",u).toString(),f=i(o,a,"px",u).toString(),h=t.fillStyle||"none",d=t.strokeStyle||"black",p=t.lineWidth;return void 0===p&&(p=i(.03,"cm",a,u).toString()),['<?xml version="1.0" standalone="no"?>','  <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','      "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">','  <svg width="'+n+a+'" height="'+o+a+'"','      xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 '+l+" "+f+'">',"    <g>",'      <path d="'+c+'" fill="'+h+'" stroke="'+d+'" stroke-width="'+p+a+'" />',"    </g>","</svg>"].join("\n")},t.exports.renderPolylines=function(e,n){var r=(n=n||{}).context;if(!r)throw new Error('Must specify "context" options');var o=n.units||"px",a=n.width,s=n.height;if(void 0===a||void 0===s)throw new Error('Must specify "width" and "height" options');var u=n.lineWidth;return void 0===u&&(u=i(.03,"cm",o,{roundPixel:!1,pixelsPerInch:90})),r.clearRect(0,0,a,s),r.fillStyle=n.background||"white",r.fillRect(0,0,a,s),e.forEach(function(e){r.beginPath(),e.forEach(function(e){r.lineTo(e[0],e[1])}),r.strokeStyle=n.foreground||n.strokeStyle||"black",r.lineWidth=u,r.lineJoin=n.lineJoin||"round",r.lineCap=n.lineCap||"round",r.stroke()}),[r.canvas,{data:t.exports.polylinesToSVG(e,n),extension:".svg"}]}},{"convert-length":22,defined:28}],19:[function(e,t,n){var r=e("seed-random"),i=e("simplex-noise"),o=e("defined");t.exports=function e(t){t=o(t,null);var n,a,s,u=Math.random,c=null,l=!1;return f(t),{value:h,createRandom:function(t){return e(t)},setSeed:f,getSeed:function(){return n},getRandomSeed:function(){return String(Math.floor(1e6*Math.random()))},valueNonZero:function(){for(var e=0;0===e;)e=h();return e},permuteNoise:function(){s=d()},noise1D:function(e,t,n){if(!isFinite(e))throw new TypeError("x component for noise() must be finite");return t=o(t,1),(n=o(n,1))*s.noise2D(e*t,0)},noise2D:function(e,t,n,r){if(!isFinite(e))throw new TypeError("x component for noise() must be finite");if(!isFinite(t))throw new TypeError("y component for noise() must be finite");return n=o(n,1),(r=o(r,1))*s.noise2D(e*n,t*n)},noise3D:function(e,t,n,r,i){if(!isFinite(e))throw new TypeError("x component for noise() must be finite");if(!isFinite(t))throw new TypeError("y component for noise() must be finite");if(!isFinite(n))throw new TypeError("z component for noise() must be finite");return r=o(r,1),(i=o(i,1))*s.noise3D(e*r,t*r,n*r)},noise4D:function(e,t,n,r,i,a){if(!isFinite(e))throw new TypeError("x component for noise() must be finite");if(!isFinite(t))throw new TypeError("y component for noise() must be finite");if(!isFinite(n))throw new TypeError("z component for noise() must be finite");if(!isFinite(r))throw new TypeError("w component for noise() must be finite");return i=o(i,1),(a=o(a,1))*s.noise4D(e*i,t*i,n*i,r*i)},sign:function(){return p()?1:-1},boolean:p,chance:function(e){if("number"!=typeof(e=o(e,.5)))throw new TypeError("expected n to be a number");return h()<e},range:m,rangeFloor:g,pick:function(e){return 0===e.length?void 0:e[g(0,e.length)]},shuffle:function(e){if(!Array.isArray(e))throw new TypeError("Expected Array, got "+typeof e);for(var t,n,r=e.length,i=e.slice();r;)t=Math.floor(h()*r--),n=i[r],i[r]=i[t],i[t]=n;return i},onCircle:v,insideCircle:function(e,t){e=o(e,1),v(1,t=t||[]);var n=e*Math.sqrt(h());return t[0]*=n,t[1]*=n,t},onSphere:function(e,t){e=o(e,1),t=t||[];var n=h()*Math.PI*2,r=2*h()-1,i=n,a=Math.acos(r);return t[0]=e*Math.sin(a)*Math.cos(i),t[1]=e*Math.sin(a)*Math.sin(i),t[2]=e*Math.cos(a),t},insideSphere:function(e,t){e=o(e,1),t=t||[];var n=h()*Math.PI*2,r=2*h()-1,i=h(),a=n,s=Math.acos(r),u=e*Math.cbrt(i);return t[0]=u*Math.sin(s)*Math.cos(a),t[1]=u*Math.sin(s)*Math.sin(a),t[2]=u*Math.cos(s),t},quaternion:function(e){e=e||[];var t=h(),n=h(),r=h(),i=Math.sqrt(1-t),o=Math.sqrt(t),a=2*Math.PI*n,s=2*Math.PI*r,u=Math.sin(a)*i,c=Math.cos(a)*i,l=Math.sin(s)*o,f=Math.cos(s)*o;return e[0]=u,e[1]=c,e[2]=l,e[3]=f,e},weighted:y,weightedSet:function(e){return 0===(e=e||[]).length?null:e[b(e)].value},weightedSetIndex:b,gaussian:function(e,t){if(e=o(e,0),t=o(t,1),l){l=!1;var n=c;return c=null,e+t*n}var r=0,i=0,a=0;do{r=2*h()-1,i=2*h()-1,a=r*r+i*i}while(a>=1||0===a);var s=Math.sqrt(-2*Math.log(a)/a);return c=i*s,l=!0,e+t*(r*s)}};function f(e,t){"number"==typeof e||"string"==typeof e?a=r(n=e,t):(n=void 0,a=u),s=d(),c=null,l=!1}function h(){return a()}function d(){return new i(a)}function p(){return h()>.5}function m(e,t){if(void 0===t&&(t=e,e=0),"number"!=typeof e||"number"!=typeof t)throw new TypeError("Expected all arguments to be numbers");return h()*(t-e)+e}function g(e,t){if(void 0===t&&(t=e,e=0),"number"!=typeof e||"number"!=typeof t)throw new TypeError("Expected all arguments to be numbers");return Math.floor(m(e,t))}function v(e,t){e=o(e,1),t=t||[];var n=2*h()*Math.PI;return t[0]=e*Math.cos(n),t[1]=e*Math.sin(n),t}function b(e){return 0===(e=e||[]).length?-1:y(e.map(function(e){return e.weight}))}function y(e){if(0===(e=e||[]).length)return-1;var t,n=0;for(t=0;t<e.length;t++)n+=e[t];if(n<=0)throw new Error("Weights must sum to > 0");var r=h()*n;for(t=0;t<e.length;t++){if(r<e[t])return t;r-=e[t]}return 0}}()},{defined:28,"seed-random":131,"simplex-noise":132}],20:[function(e,t,n){var r=e("regl"),i=e("primitive-quad"),o=e("parse-color"),a=e("defined");function s(e){return e&&!Array.isArray(e)&&"object"==typeof e}t.exports=function(e){if(!(e=e||{}).gl)throw new Error('Must specify { context: "webgl" } in sketch settings, or a WebGL-enabled canvas');var t=e.gl,n={gl:t};void 0!==e.extensions&&(n.extensions=e.extensions);void 0!==e.optionalExtensions&&(n.optionalExtensions=e.optionalExtensions);void 0!==e.profile&&(n.profile=e.profile);void 0!==e.onDone&&(n.onDone=e.onDone);var u,c=r(n),l=i(),f=new Map,h=e.uniforms||{},d=Object.assign({},h);Object.keys(h).forEach(function(e){var t=h[e];d[e]="function"==typeof t?function(e,n,r){var i=t.call(h,n,r);if(s(i))if(f.has(t)){var o=f.get(t);o(i),i=o}else{var a=c.texture(i);f.set(t,a),i=a}return i}:s(t)?c.texture(t):t});try{u=c({scissor:!!e.scissor&&{enable:!0,box:{x:c.prop("scissorX"),y:c.prop("scissorY"),width:c.prop("scissorWidth"),height:c.prop("scissorHeight")}},uniforms:d,frag:e.frag||["precision highp float;","","void main () {","  gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","}"].join("\n"),vert:e.vert||["precision highp float;","attribute vec3 position;","varying vec2 vUv;","","void main () {","  gl_Position = vec4(position.xyz, 1.0);","  vUv = gl_Position.xy * 0.5 + 0.5;","}"].join("\n"),blend:!1!==e.blend?{enable:!0,func:{srcRGB:"src alpha",srcAlpha:1,dstRGB:"one minus src alpha",dstAlpha:1}}:void 0,attributes:{position:l.positions},elements:l.cells})}catch(e){y(e)}var p=a(e.clearColor,"black");if("string"==typeof p){var m=o(p);if(!m.rgb)throw new Error('Error parsing { clearColor } color string "'+p+'"');p=m.rgb.slice(0,3).map(function(e){return e/255})}else if(p&&(!Array.isArray(p)||p.length<3))throw new Error("Error with { clearColor } option, must be a string or [ r, g, b ] float array");var g=a(e.clearAlpha,1),v=!!p&&p.concat([g||0]);return{render:function(e){c.poll(),v&&c.clear({color:v,depth:1,stencil:0}),b(e),t.flush()},regl:c,drawQuad:b,unload:function(){f.clear(),c.destroy()}};function b(e){if(e=e||{},u)try{u(e)}catch(t){y(t)&&null==e&&console.warn('Warning: shader.render() is not called with any "props" parameter')}}function y(e){if(/^\(regl\)/.test(e.message))return!0;throw e}}},{defined:28,"parse-color":123,"primitive-quad":127,regl:129}],21:[function(e,t,n){(function(r){!function(r,i){"object"==typeof n&&void 0!==t?t.exports=i(e("convert-length")):"function"==typeof define&&define.amd?define(["convert-length"],i):r.canvasSketch=i(null)}(this,function(e){e=e&&e.hasOwnProperty("default")?e.default:e;var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;var o=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,r){for(var o,a,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),u=1;u<arguments.length;u++){for(var c in o=Object(arguments[u]))n.call(o,c)&&(s[c]=o[c]);if(t){a=t(o);for(var l=0;l<a.length;l++)i.call(o,a[l])&&(s[a[l]]=o[a[l]])}}return s},a="undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:{};function s(e,t){return e(t={exports:{}},t.exports),t.exports}var u=a.performance&&a.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date},c=function(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then};var l=function(e){return!(!e||"object"!=typeof e)&&("object"==typeof window&&"object"==typeof window.Node?e instanceof window.Node:"number"==typeof e.nodeType&&"string"==typeof e.nodeName)};function f(){return"undefined"!=typeof window&&window["canvas-sketch-cli"]}function h(){for(var e=arguments,t=0;t<arguments.length;t++)if(null!=e[t])return e[t]}function d(){return"undefined"!=typeof document}var p,m=s(function(e,t){function n(e){var t=[];for(var n in e)t.push(n);return t}(e.exports="function"==typeof Object.keys?Object.keys:n).shim=n}),g=s(function(e,t){var n="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function r(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function i(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}(t=e.exports=n?r:i).supported=r,t.unsupported=i}),v=s(function(e){var t=Array.prototype.slice,n=e.exports=function(e,o,a){return a||(a={}),e===o||(e instanceof Date&&o instanceof Date?e.getTime()===o.getTime():!e||!o||"object"!=typeof e&&"object"!=typeof o?a.strict?e===o:e==o:function(e,o,a){var s,u;if(r(e)||r(o))return!1;if(e.prototype!==o.prototype)return!1;if(g(e))return!!g(o)&&(e=t.call(e),o=t.call(o),n(e,o,a));if(i(e)){if(!i(o))return!1;if(e.length!==o.length)return!1;for(s=0;s<e.length;s++)if(e[s]!==o[s])return!1;return!0}try{var c=m(e),l=m(o)}catch(e){return!1}if(c.length!=l.length)return!1;for(c.sort(),l.sort(),s=c.length-1;s>=0;s--)if(c[s]!=l[s])return!1;for(s=c.length-1;s>=0;s--)if(!n(e[u=c[s]],o[u],a))return!1;return typeof e==typeof o}(e,o,a))};function r(e){return null==e}function i(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length)&&("function"==typeof e.copy&&"function"==typeof e.slice&&!(e.length>0&&"number"!=typeof e[0]))}}),b=s(function(e,t){!function(t){var n,r,i,o=(n=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|"[^"]*"|'[^']*'/g,r=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,i=/[^-+\dA-Z]/g,function(e,t,s,u){if(1!==arguments.length||"string"!==(null===(c=e)?"null":void 0===c?"undefined":"object"!=typeof c?typeof c:Array.isArray(c)?"array":{}.toString.call(c).slice(8,-1).toLowerCase())||/\d/.test(e)||(t=e,e=void 0),(e=e||new Date)instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");var c,l=(t=String(o.masks[t]||t||o.masks.default)).slice(0,4);"UTC:"!==l&&"GMT:"!==l||(t=t.slice(4),s=!0,"GMT:"===l&&(u=!0));var f=s?"getUTC":"get",h=e[f+"Date"](),d=e[f+"Day"](),p=e[f+"Month"](),m=e[f+"FullYear"](),g=e[f+"Hours"](),v=e[f+"Minutes"](),b=e[f+"Seconds"](),y=e[f+"Milliseconds"](),x=s?0:e.getTimezoneOffset(),_=function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var n=new Date(t.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);var r=t.getTimezoneOffset()-n.getTimezoneOffset();return t.setHours(t.getHours()-r),1+Math.floor((t-n)/6048e5)}(e),w=function(e){var t=e.getDay();return 0===t&&(t=7),t}(e),M={d:h,dd:a(h),ddd:o.i18n.dayNames[d],dddd:o.i18n.dayNames[d+7],m:p+1,mm:a(p+1),mmm:o.i18n.monthNames[p],mmmm:o.i18n.monthNames[p+12],yy:String(m).slice(2),yyyy:m,h:g%12||12,hh:a(g%12||12),H:g,HH:a(g),M:v,MM:a(v),s:b,ss:a(b),l:a(y,3),L:a(Math.round(y/10)),t:g<12?o.i18n.timeNames[0]:o.i18n.timeNames[1],tt:g<12?o.i18n.timeNames[2]:o.i18n.timeNames[3],T:g<12?o.i18n.timeNames[4]:o.i18n.timeNames[5],TT:g<12?o.i18n.timeNames[6]:o.i18n.timeNames[7],Z:u?"GMT":s?"UTC":(String(e).match(r)||[""]).pop().replace(i,""),o:(x>0?"-":"+")+a(100*Math.floor(Math.abs(x)/60)+Math.abs(x)%60,4),S:["th","st","nd","rd"][h%10>3?0:(h%100-h%10!=10)*h%10],W:_,N:w};return t.replace(n,function(e){return e in M?M[e]:e.slice(1,e.length-1)})});function a(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}o.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},o.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},e.exports=o}()}),y="",x=function(e,t){if("string"!=typeof e)throw new TypeError("expected a string");if(1===t)return e;if(2===t)return e+e;var n=e.length*t;if(p!==e||void 0===p)p=e,y="";else if(y.length>=n)return y.substr(0,n);for(;n>y.length&&t>1;)1&t&&(y+=e),t>>=1,e+=e;return y=(y+=e).substr(0,n)};var _,w=function(e,t,n){return e=e.toString(),void 0===t?e:(n=0===n?"0":n?n.toString():" ",x(n,t-e.length)+e)},M=function(){},k={extension:"",prefix:"",suffix:""},E=["image/png","image/jpeg","image/webp"];function A(e,t){return void 0===t&&(t={}),new Promise(function(n,r){t=o({},k,t);var i=T(Object.assign({},t,{frame:void 0})),a=e?"streamStart":"streamEnd",s=f();return s&&s.output&&"function"==typeof s[a]?s[a](o({},t,{filename:i})).then(function(e){return n(e)}):n({filename:i,client:!1})})}function C(e,t){return void 0===t&&(t={}),function(e){return new Promise(function(t){var n=e.indexOf(",");if(-1!==n){for(var r=e.slice(n+1),i=window.atob(r),o=e.slice(0,n),a=/data:([^;]+)/.exec(o),s=(a?a[1]:"")||void 0,u=new ArrayBuffer(i.length),c=new Uint8Array(u),l=0;l<i.length;l++)c[l]=i.charCodeAt(l);t(new window.Blob([u],{type:s}))}else t(new window.Blob)})}(e).then(function(e){return S(e,t)})}function S(e,t){return void 0===t&&(t={}),new Promise(function(n){var r=(t=o({},k,t)).filename,i=f();if(i&&"function"==typeof i.saveBlob&&i.output)return i.saveBlob(e,o({},t,{filename:r})).then(function(e){return n(e)});_||((_=document.createElement("a")).style.visibility="hidden",_.target="_blank"),_.download=r,_.href=window.URL.createObjectURL(e),document.body.appendChild(_),_.onclick=function(){_.onclick=M,setTimeout(function(){window.URL.revokeObjectURL(e),_.parentElement&&_.parentElement.removeChild(_),_.removeAttribute("href"),n({filename:r,client:!1})})},_.click()})}function T(e){if(void 0===e&&(e={}),"function"==typeof(e=o({},e)).file)return e.file(e);if(e.file)return e.file;var t,n=null,r="";("string"==typeof e.extension&&(r=e.extension),"number"==typeof e.frame)&&(t="number"==typeof e.totalFrames?e.totalFrames:Math.max(1e3,e.frame),n=w(String(e.frame),String(t).length,"0"));var i=isFinite(e.totalLayers)&&isFinite(e.layer)&&e.totalLayers>1?""+e.layer:"";return null!=n?[i,n].filter(Boolean).join("-")+r:[e.prefix,e.name||e.timeStamp,i,e.hash,e.suffix].filter(Boolean).join("-")+r}var D={dimension:"dimensions",animated:"animate",animating:"animate",unit:"units",P5:"p5",pixellated:"pixelated",looping:"loop",pixelPerInch:"pixels"},R=["dimensions","units","pixelsPerInch","orientation","scaleToFit","scaleToView","bleed","pixelRatio","exportPixelRatio","maxPixelRatio","scaleContext","resizeCanvas","styleCanvas","canvas","context","attributes","parent","file","name","prefix","suffix","animate","playing","loop","duration","totalFrames","fps","playbackRate","timeScale","frame","time","flush","pixelated","hotkeys","p5","id","scaleToFitPadding","data","params","encoding","encodingQuality"],O=function(e){Object.keys(e).forEach(function(e){e in D?console.warn('[canvas-sketch] Could not recognize the setting "'+e+'", did you mean "'+D[e]+'"?'):R.includes(e)||console.warn('[canvas-sketch] Could not recognize the setting "'+e+'"')})};var F=[["postcard",101.6,152.4],["poster-small",280,430],["poster",460,610],["poster-large",610,910],["business-card",50.8,88.9],["2r",64,89],["3r",89,127],["4r",102,152],["5r",127,178],["6r",152,203],["8r",203,254],["10r",254,305],["11r",279,356],["12r",305,381],["a0",841,1189],["a1",594,841],["a2",420,594],["a3",297,420],["a4",210,297],["a5",148,210],["a6",105,148],["a7",74,105],["a8",52,74],["a9",37,52],["a10",26,37],["2a0",1189,1682],["4a0",1682,2378],["b0",1e3,1414],["b1",707,1e3],["b1+",720,1020],["b2",500,707],["b2+",520,720],["b3",353,500],["b4",250,353],["b5",176,250],["b6",125,176],["b7",88,125],["b8",62,88],["b9",44,62],["b10",31,44],["b11",22,32],["b12",16,22],["c0",917,1297],["c1",648,917],["c2",458,648],["c3",324,458],["c4",229,324],["c5",162,229],["c6",114,162],["c7",81,114],["c8",57,81],["c9",40,57],["c10",28,40],["c11",22,32],["c12",16,22],["half-letter",5.5,8.5,"in"],["letter",8.5,11,"in"],["legal",8.5,14,"in"],["junior-legal",5,8,"in"],["ledger",11,17,"in"],["tabloid",11,17,"in"],["ansi-a",8.5,11,"in"],["ansi-b",11,17,"in"],["ansi-c",17,22,"in"],["ansi-d",22,34,"in"],["ansi-e",34,44,"in"],["arch-a",9,12,"in"],["arch-b",12,18,"in"],["arch-c",18,24,"in"],["arch-d",24,36,"in"],["arch-e",36,48,"in"],["arch-e1",30,42,"in"],["arch-e2",26,38,"in"],["arch-e3",27,39,"in"]].reduce(function(e,t){var n={units:t[3]||"mm",dimensions:[t[1],t[2]]};return e[t[0]]=n,e[t[0].replace(/-/g," ")]=n,e},{});function j(t,n,r,i){return void 0===n&&(n="px"),void 0===r&&(r="px"),void 0===i&&(i=72),e(t,n,r,{pixelsPerInch:i,precision:4,roundPixel:!0})}function L(e,t){var n,r,i,o,a,s,u=d(),c=t.dimensions,l=function(e){return!(!e.dimensions||"string"!=typeof e.dimensions&&!(Array.isArray(e.dimensions)&&e.dimensions.length>=2))}(t),f=e.exporting,p=!!l&&!1!==t.scaleToFit,m=!(!f&&l)||t.scaleToView;u||(p=m=!1);var g,v,b=t.units,y="number"==typeof t.pixelsPerInch&&isFinite(t.pixelsPerInch)?t.pixelsPerInch:72,x=h(t.bleed,0),_=u?window.devicePixelRatio:1,w=m?_:1;"number"==typeof t.pixelRatio&&isFinite(t.pixelRatio)?v=h(t.exportPixelRatio,g=t.pixelRatio):l?(g=w,v=h(t.exportPixelRatio,1)):v=h(t.exportPixelRatio,g=_),"number"==typeof t.maxPixelRatio&&isFinite(t.maxPixelRatio)&&(g=Math.min(t.maxPixelRatio,g)),f&&(g=v);var M,k,E=function(e,t){if(!d())return[300,150];var n=t.parent||window;if(n===window||n===document||n===document.body)return[window.innerWidth,window.innerHeight];var r=n.getBoundingClientRect();return[r.width,r.height]}(0,t),A=E[0],C=E[1];if(l){var S=function(e,t,n){if(void 0===t&&(t="px"),void 0===n&&(n=72),"string"==typeof e){var r=e.toLowerCase();if(!(r in F))throw new Error('The dimension preset "'+e+'" is not supported or could not be found; try using a4, a3, postcard, letter, etc.');var i=F[r];return i.dimensions.map(function(e){return j(e,i.units,t,n)})}return e}(c,b,y),T=Math.max(S[0],S[1]),D=Math.min(S[0],S[1]);if(t.orientation){var R="landscape"===t.orientation;n=R?T:D,r=R?D:T}else n=S[0],r=S[1];M=n,k=r,n+=2*x,r+=2*x}else M=n=A,k=r=C;var O=n,L=r;if(l&&b&&(O=j(n,b,"px",y),L=j(r,b,"px",y)),i=Math.round(O),o=Math.round(L),p&&!f&&l){var N=n/r,P=A/C,B=h(t.scaleToFitPadding,40),z=Math.round(A-2*B),I=Math.round(C-2*B);(i>z||o>I)&&(P>N?(o=I,i=Math.round(o*N)):(i=z,o=Math.round(i/N)))}return{bleed:x,pixelRatio:g,width:n,height:r,dimensions:[n,r],units:b||"px",scaleX:(a=m?Math.round(g*i):Math.round(g*O))/n,scaleY:(s=m?Math.round(g*o):Math.round(g*L))/r,viewportWidth:m?Math.round(i):Math.round(O),viewportHeight:m?Math.round(o):Math.round(L),canvasWidth:a,canvasHeight:s,trimWidth:M,trimHeight:k,styleWidth:i,styleHeight:o}}var N=function(e,t){if("string"!=typeof e)throw new TypeError("must specify type string");if(t=t||{},"undefined"==typeof document&&!t.canvas)return null;var n=t.canvas||document.createElement("canvas");"number"==typeof t.width&&(n.width=t.width);"number"==typeof t.height&&(n.height=t.height);var r,i=t;try{var o=[e];0===e.indexOf("webgl")&&o.push("experimental-"+e);for(var a=0;a<o.length;a++)if(r=n.getContext(o[a],i))return r}catch(e){r=null}return r||null};function P(e){var t,n;void 0===e&&(e={});var r=!1;if(!1!==e.canvas){if(!(t=e.context)||"string"==typeof t){var i=e.canvas;i||(i=function(){if(!d())throw new Error("It appears you are runing from Node.js or a non-browser environment. Try passing in an existing { canvas } interface instead.");return document.createElement("canvas")}(),r=!0);var a=t||"2d";if("function"!=typeof i.getContext)throw new Error("The specified { canvas } element does not have a getContext() function, maybe it is not a <canvas> tag?");if(!(t=N(a,o({},e.attributes,{canvas:i}))))throw new Error("Failed at canvas.getContext('"+a+"') - the browser may not support this context, or a different context may already be in use with this canvas.")}if(n=t.canvas,e.canvas&&n!==e.canvas)throw new Error("The { canvas } and { context } settings must point to the same underlying canvas element");e.pixelated&&(t.imageSmoothingEnabled=!1,t.mozImageSmoothingEnabled=!1,t.oImageSmoothingEnabled=!1,t.webkitImageSmoothingEnabled=!1,t.msImageSmoothingEnabled=!1,n.style["image-rendering"]="pixelated")}return{canvas:n,context:t,ownsCanvas:r}}var B=function(){var e=this;this._settings={},this._props={},this._sketch=void 0,this._raf=null,this._lastRedrawResult=void 0,this._isP5Resizing=!1,this._keyboardShortcuts=function(e){void 0===e&&(e={});var t=function(t){if(e.enabled()){var n=f();83!==t.keyCode||t.altKey||!t.metaKey&&!t.ctrlKey?32===t.keyCode?e.togglePlay(t):n&&!t.altKey&&75===t.keyCode&&(t.metaKey||t.ctrlKey)&&(t.preventDefault(),e.commit(t)):(t.preventDefault(),e.save(t))}};return{attach:function(){window.addEventListener("keydown",t)},detach:function(){window.removeEventListener("keydown",t)}}}({enabled:function(){return!1!==e.settings.hotkeys},save:function(t){t.shiftKey?e.props.recording?(e.endRecord(),e.run()):e.record():e.props.recording||e.exportFrame()},togglePlay:function(){e.props.playing?e.pause():e.play()},commit:function(t){e.exportFrame({commit:!0})}}),this._animateHandler=function(){return e.animate()},this._resizeHandler=function(){e.resize()&&e.render()}},z={sketch:{configurable:!0},settings:{configurable:!0},props:{configurable:!0}};z.sketch.get=function(){return this._sketch},z.settings.get=function(){return this._settings},z.props.get=function(){return this._props},B.prototype._computePlayhead=function(e,t){return"number"==typeof t&&isFinite(t)?e/t:0},B.prototype._computeFrame=function(e,t,n,r){return isFinite(n)&&n>1?Math.floor(e*(n-1)):Math.floor(r*t)},B.prototype._computeCurrentFrame=function(){return this._computeFrame(this.props.playhead,this.props.time,this.props.totalFrames,this.props.fps)},B.prototype._getSizeProps=function(){var e=this.props;return{width:e.width,height:e.height,pixelRatio:e.pixelRatio,canvasWidth:e.canvasWidth,canvasHeight:e.canvasHeight,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight}},B.prototype.run=function(){if(!this.sketch)throw new Error("should wait until sketch is loaded before trying to play()");return!1!==this.settings.playing&&this.play(),"function"==typeof this.sketch.dispose&&console.warn("In canvas-sketch@0.0.23 the dispose() event has been renamed to unload()"),this.props.started||(this._signalBegin(),this.props.started=!0),this.tick(),this.render(),this},B.prototype.play=function(){var e=this.settings.animate;"animation"in this.settings&&(e=!0,console.warn("[canvas-sketch] { animation } has been renamed to { animate }")),e&&(d()?this.props.playing||(this.props.started||(this._signalBegin(),this.props.started=!0),this.props.playing=!0,null!=this._raf&&window.cancelAnimationFrame(this._raf),this._lastTime=u(),this._raf=window.requestAnimationFrame(this._animateHandler)):console.error("[canvas-sketch] WARN: Using { animate } in Node.js is not yet supported"))},B.prototype.pause=function(){this.props.recording&&this.endRecord(),this.props.playing=!1,null!=this._raf&&d()&&window.cancelAnimationFrame(this._raf)},B.prototype.togglePlay=function(){this.props.playing?this.pause():this.play()},B.prototype.stop=function(){this.pause(),this.props.frame=0,this.props.playhead=0,this.props.time=0,this.props.deltaTime=0,this.props.started=!1,this.render()},B.prototype.record=function(){var e=this;if(!this.props.recording)if(d()){this.stop(),this.props.playing=!0,this.props.recording=!0;var t=this._createExportOptions({sequence:!0}),n=1/this.props.fps;null!=this._raf&&window.cancelAnimationFrame(this._raf);var r,i=function(){return e.props.recording?(e.props.deltaTime=n,e.tick(),e.exportFrame(t).then(function(){e.props.recording&&(e.props.deltaTime=0,e.props.frame++,e.props.frame<e.props.totalFrames?(e.props.time+=n,e.props.playhead=e._computePlayhead(e.props.time,e.props.duration),e._raf=window.requestAnimationFrame(i)):(console.log("Finished recording"),e._signalEnd(),e.endRecord(),e.stop(),e.run()))})):Promise.resolve()};this.props.started||(this._signalBegin(),this.props.started=!0),(r=t,void 0===r&&(r={}),A(!0,r)).catch(function(e){console.error(e)}).then(function(t){e._raf=window.requestAnimationFrame(i)})}else console.error("[canvas-sketch] WARN: Recording from Node.js is not yet supported")},B.prototype._signalBegin=function(){var e=this;this.sketch&&"function"==typeof this.sketch.begin&&this._wrapContextScale(function(t){return e.sketch.begin(t)})},B.prototype._signalEnd=function(){var e=this;this.sketch&&"function"==typeof this.sketch.end&&this._wrapContextScale(function(t){return e.sketch.end(t)})},B.prototype.endRecord=function(){var e;null!=this._raf&&d()&&window.cancelAnimationFrame(this._raf),this.props.recording=!1,this.props.deltaTime=0,this.props.playing=!1,(void 0===e&&(e={}),A(!1,e)).catch(function(e){console.error(e)})},B.prototype._createExportOptions=function(e){return void 0===e&&(e={}),{sequence:e.sequence,save:e.save,fps:this.props.fps,frame:e.sequence?this.props.frame:void 0,file:this.settings.file,name:this.settings.name,prefix:this.settings.prefix,suffix:this.settings.suffix,encoding:this.settings.encoding,encodingQuality:this.settings.encodingQuality,timeStamp:e.timeStamp||b(new Date,"yyyy.mm.dd-HH.MM.ss"),totalFrames:isFinite(this.props.totalFrames)?Math.max(100,this.props.totalFrames):1e3}},B.prototype.exportFrame=function(e){var t=this;if(void 0===e&&(e={}),!this.sketch)return Promise.all([]);"function"==typeof this.sketch.preExport&&this.sketch.preExport();var n=this._createExportOptions(e),r=f(),i=Promise.resolve();if(r&&e.commit&&"function"==typeof r.commit){var a=o({},n),s=r.commit(a);i=c(s)?s:Promise.resolve(s)}return i.then(function(e){return t._doExportFrame(o({},n,{hash:e||""}))}).then(function(e){return 1===e.length?e[0]:e})},B.prototype._doExportFrame=function(e){var t=this;void 0===e&&(e={}),this._props.exporting=!0,this.resize();var n=this.render();return void 0===n&&(n=[this.props.canvas]),n=(n=[].concat(n).filter(Boolean)).map(function(t){var n,r="object"==typeof t&&t&&("data"in t||"dataURL"in t),i=r?t.data:t,a=r?o({},t,{data:i}):{data:i};if(l(n=i)&&/canvas/i.test(n.nodeName)&&"function"==typeof n.getContext){var s=function(e,t){void 0===t&&(t={});var n=t.encoding||"image/png";if(!E.includes(n))throw new Error("Invalid canvas encoding "+n);var r=(n.split("/")[1]||"").replace(/jpeg/i,"jpg");return r&&(r=("."+r).toLowerCase()),{extension:r,type:n,dataURL:e.toDataURL(n,t.encodingQuality)}}(i,{encoding:a.encoding||e.encoding,encodingQuality:h(a.encodingQuality,e.encodingQuality,.95)});return Object.assign(a,{dataURL:s.dataURL,extension:s.extension,type:s.type})}return a}),this._props.exporting=!1,this.resize(),this.render(),Promise.all(n.map(function(t,n,r){var i=o({extension:"",prefix:"",suffix:""},e,t,{layer:n,totalLayers:r.length}),a=!1!==e.save&&t.save;for(var s in i.save=!1!==a,i.filename=T(i),delete i.encoding,delete i.encodingQuality,i)void 0===i[s]&&delete i[s];var u=Promise.resolve({});if(i.save){var c=i.data;if(i.dataURL)u=C(i.dataURL,i);else u=function(e,t){void 0===t&&(t={});var n=Array.isArray(e)?e:[e];return S(new window.Blob(n,{type:t.type||""}),t)}(c,i)}return u.then(function(e){return Object.assign({},i,e)})})).then(function(n){var r=n.filter(function(e){return e.save});if(r.length>0){var i,o=r.find(function(e){return e.outputName}),a=r.some(function(e){return e.client}),s=r.some(function(e){return e.stream});i=r.length>1?r.length:o?o.outputName+"/"+r[0].filename:""+r[0].filename;var u="";if(e.sequence)u=isFinite(t.props.totalFrames)?" (frame "+(e.frame+1)+" / "+t.props.totalFrames+")":" (frame "+e.frame+")";else r.length>1&&(u=" files");console.log("%c["+(a?"canvas-sketch-cli":"canvas-sketch")+"]%c "+(s?"Streaming into":"Exported")+" %c"+i+"%c"+u,"color: #8e8e8e;","color: initial;","font-weight: bold;","font-weight: initial;")}return"function"==typeof t.sketch.postExport&&t.sketch.postExport(),n})},B.prototype._wrapContextScale=function(e){this._preRender(),e(this.props),this._postRender()},B.prototype._preRender=function(){var e=this.props;this.props.gl||!e.context||e.p5?e.p5&&e.p5.scale(e.scaleX/e.pixelRatio,e.scaleY/e.pixelRatio):(e.context.save(),!1!==this.settings.scaleContext&&e.context.scale(e.scaleX,e.scaleY))},B.prototype._postRender=function(){var e=this.props;this.props.gl||!e.context||e.p5||e.context.restore(),e.gl&&!1!==this.settings.flush&&!e.p5&&e.gl.flush()},B.prototype.tick=function(){this.sketch&&"function"==typeof this.sketch.tick&&(this._preRender(),this.sketch.tick(this.props),this._postRender())},B.prototype.render=function(){return this.props.p5?(this._lastRedrawResult=void 0,this.props.p5.redraw(),this._lastRedrawResult):this.submitDrawCall()},B.prototype.submitDrawCall=function(){if(this.sketch){var e,t=this.props;return this._preRender(),"function"==typeof this.sketch?e=this.sketch(t):"function"==typeof this.sketch.render&&(e=this.sketch.render(t)),this._postRender(),e}},B.prototype.update=function(e){var t=this;void 0===e&&(e={});var n=["animate"];Object.keys(e).forEach(function(e){if(n.indexOf(e)>=0)throw new Error("Sorry, the { "+e+" } option is not yet supported with update().")});var r=this._settings.canvas,i=this._settings.context;for(var o in e){var a=e[o];void 0!==a&&(t._settings[o]=a)}var s=Object.assign({},this._settings,e);if("time"in e&&"frame"in e)throw new Error("You should specify { time } or { frame } but not both");if("time"in e?delete s.frame:"frame"in e&&delete s.time,"duration"in e&&"totalFrames"in e)throw new Error("You should specify { duration } or { totalFrames } but not both");"duration"in e?delete s.totalFrames:"totalFrames"in e&&delete s.duration,"data"in e&&(this._props.data=e.data);var u=this.getTimeProps(s);if(Object.assign(this._props,u),r!==this._settings.canvas||i!==this._settings.context){var c=P(this._settings),l=c.context;this.props.canvas=c.canvas,this.props.context=l,this._setupGLKey(),this._appendCanvasIfNeeded()}return e.p5&&"function"!=typeof e.p5&&(this.props.p5=e.p5,this.props.p5.draw=function(){t._isP5Resizing||(t._lastRedrawResult=t.submitDrawCall())}),"playing"in e&&(e.playing?this.play():this.pause()),O(this._settings),this.resize(),this.render(),this.props},B.prototype.resize=function(){var e=this._getSizeProps(),t=this.settings,n=this.props,r=L(n,t);Object.assign(this._props,r);var i=this.props,o=i.pixelRatio,a=i.canvasWidth,s=i.canvasHeight,u=i.styleWidth,c=i.styleHeight,l=this.props.canvas;l&&!1!==t.resizeCanvas&&(n.p5?l.width===a&&l.height===s||(this._isP5Resizing=!0,n.p5.pixelDensity(o),n.p5.resizeCanvas(a/o,s/o,!1),this._isP5Resizing=!1):(l.width!==a&&(l.width=a),l.height!==s&&(l.height=s)),d()&&!1!==t.styleCanvas&&(l.style.width=u+"px",l.style.height=c+"px"));var f=this._getSizeProps(),h=!v(e,f);return h&&this._sizeChanged(),h},B.prototype._sizeChanged=function(){this.sketch&&"function"==typeof this.sketch.resize&&this.sketch.resize(this.props)},B.prototype.animate=function(){if(this.props.playing)if(d()){this._raf=window.requestAnimationFrame(this._animateHandler);var e=u(),t=1e3/this.props.fps,n=e-this._lastTime,r=this.props.duration,i="number"==typeof r&&isFinite(r),o=!0,a=this.settings.playbackRate;"fixed"===a?n=t:"throttle"===a?n>t?this._lastTime=e-=n%t:o=!1:this._lastTime=e;var s=n/1e3,c=this.props.time+s*this.props.timeScale;c<0&&i&&(c=r+c);var l=!1,f=!1;if(i&&c>=r&&(!1!==this.settings.loop?(o=!0,c%=r,f=!0):(o=!1,c=r,l=!0),this._signalEnd()),o){this.props.deltaTime=s,this.props.time=c,this.props.playhead=this._computePlayhead(c,r);var h=this.props.frame;this.props.frame=this._computeCurrentFrame(),f&&this._signalBegin(),h!==this.props.frame&&this.tick(),this.render(),this.props.deltaTime=0}l&&this.pause()}else console.error("[canvas-sketch] WARN: Animation in Node.js is not yet supported")},B.prototype.dispatch=function(e){if("function"!=typeof e)throw new Error("must pass function into dispatch()");e(this.props),this.render()},B.prototype.mount=function(){this._appendCanvasIfNeeded()},B.prototype.unmount=function(){d()&&(window.removeEventListener("resize",this._resizeHandler),this._keyboardShortcuts.detach()),this.props.canvas.parentElement&&this.props.canvas.parentElement.removeChild(this.props.canvas)},B.prototype._appendCanvasIfNeeded=function(){d()&&(!1!==this.settings.parent&&this.props.canvas&&!this.props.canvas.parentElement&&(this.settings.parent||document.body).appendChild(this.props.canvas))},B.prototype._setupGLKey=function(){var e;this.props.context&&("function"==typeof(e=this.props.context).clear&&"function"==typeof e.clearColor&&"function"==typeof e.bufferData?this._props.gl=this.props.context:delete this._props.gl)},B.prototype.getTimeProps=function(e){void 0===e&&(e={});var t=e.duration,n=e.totalFrames,r=h(e.timeScale,1),i=h(e.fps,24),o="number"==typeof t&&isFinite(t),a="number"==typeof n&&isFinite(n),s=o?Math.floor(i*t):void 0,u=a?n/i:void 0;if(o&&a&&s!==n)throw new Error("You should specify either duration or totalFrames, but not both. Or, they must match exactly.");void 0===e.dimensions&&void 0!==e.units&&console.warn("You've specified a { units } setting but no { dimension }, so the units will be ignored."),n=h(n,s,Infinity),t=h(t,u,Infinity);var c=e.time,l=e.frame,f="number"==typeof c&&isFinite(c),d="number"==typeof l&&isFinite(l),p=0,m=0,g=0;if(f&&d)throw new Error("You should specify either start frame or time, but not both.");return f?(g=this._computePlayhead(p=c,t),m=this._computeFrame(g,p,n,i)):d&&(g=this._computePlayhead(p=(m=l)/i,t)),{playhead:g,time:p,frame:m,duration:t,totalFrames:n,fps:i,timeScale:r}},B.prototype.setup=function(e){var t=this;if(void 0===e&&(e={}),this.sketch)throw new Error("Multiple setup() calls not yet supported.");this._settings=Object.assign({},e,this._settings),O(this._settings);var n=P(this._settings),r=n.context,i=n.canvas,o=this.getTimeProps(this._settings);this._props=Object.assign({},o,{canvas:i,context:r,deltaTime:0,started:!1,exporting:!1,playing:!1,recording:!1,settings:this.settings,data:this.settings.data,render:function(){return t.render()},togglePlay:function(){return t.togglePlay()},dispatch:function(e){return t.dispatch(e)},tick:function(){return t.tick()},resize:function(){return t.resize()},update:function(e){return t.update(e)},exportFrame:function(e){return t.exportFrame(e)},record:function(){return t.record()},play:function(){return t.play()},pause:function(){return t.pause()},stop:function(){return t.stop()}}),this._setupGLKey(),this.resize()},B.prototype.loadAndRun=function(e,t){var n=this;return this.load(e,t).then(function(){return n.run(),n})},B.prototype.unload=function(){var e=this;this.pause(),this.sketch&&("function"==typeof this.sketch.unload&&this._wrapContextScale(function(t){return e.sketch.unload(t)}),this._sketch=null)},B.prototype.destroy=function(){this.unload(),this.unmount()},B.prototype.load=function(e,t){var n=this;if("function"!=typeof e)throw new Error("The function must take in a function as the first parameter. Example:\n  canvasSketcher(() => { ... }, settings)");this.sketch&&this.unload(),void 0!==t&&this.update(t),this._preRender();var r=Promise.resolve();if(this.settings.p5){if(!d())throw new Error("[canvas-sketch] ERROR: Using p5.js in Node.js is not supported");r=new Promise(function(e){var t,r=n.settings.p5;r.p5&&(t=r.preload,r=r.p5);var i=function(r){t&&(r.preload=function(){return t(r)}),r.setup=function(){var t=n.props,i="webgl"===n.settings.context,o=i?r.WEBGL:r.P2D;r.noLoop(),r.pixelDensity(t.pixelRatio),r.createCanvas(t.viewportWidth,t.viewportHeight,o),i&&n.settings.attributes&&r.setAttributes(n.settings.attributes),n.update({p5:r,canvas:r.canvas,context:r._renderer.drawingContext}),e()}};if("function"==typeof r)new r(i);else{if("function"!=typeof window.createCanvas)throw new Error("{ p5 } setting is passed but can't find p5.js in global (window) scope. Maybe you did not create it globally?\nnew p5(); // <-- attaches to global scope");i(window)}})}return r.then(function(){var t=e(n.props);return c(t)||(t=Promise.resolve(t)),t}).then(function(e){return e||(e={}),n._sketch=e,d()&&(n._keyboardShortcuts.attach(),window.addEventListener("resize",n._resizeHandler)),n._postRender(),n._sizeChanged(),n}).catch(function(e){throw console.warn("Could not start sketch, the async loading function rejected with an error:\n    Error: "+e.message),e})},Object.defineProperties(B.prototype,z);var I="hot-id-cache",H=[];function q(e,t){if(void 0===t&&(t={}),t.p5){if(t.canvas||t.context&&"string"!=typeof t.context)throw new Error('In { p5 } mode, you can\'t pass your own canvas or context, unless the context is a "webgl" or "2d" string');t=Object.assign({},t,{canvas:!1,context:"string"==typeof t.context&&t.context})}var n,r,i=(n=f())&&n.hot;i&&(r=h(t.id,"$__DEFAULT_CANVAS_SKETCH_ID__$"));var o=i&&"string"==typeof r;o&&H.includes(r)&&(console.warn("Warning: You have multiple calls to canvasSketch() in --hot mode. You must pass unique { id } strings in settings to enable hot reload across multiple sketches. ",r),o=!1);var a=Promise.resolve();if(o){H.push(r);var s=function(e){var t=f();if(t)return t[I]=t[I]||{},t[I][e]}(r);if(s){var u=function(){var e,n=(e=s.manager,t.animate?{time:e.props.time}:void 0);return s.manager.destroy(),n};a=s.load.then(u).catch(u)}}return a.then(function(n){var i,a,s,u,c=new B;return e?(t=Object.assign({},t,n),c.setup(t),c.mount(),i=c.loadAndRun(e)):i=Promise.resolve(c),o&&(a=r,s={load:i,manager:c},(u=f())&&(u[I]=u[I]||{},u[I][a]=s)),i})}return q.canvasSketch=q,q.PaperSizes=F,q})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"convert-length":22}],22:[function(e,t,n){var r=e("defined"),i=["mm","cm","m","pc","pt","in","ft","px"],o={m:{system:"metric",factor:1},cm:{system:"metric",factor:.01},mm:{system:"metric",factor:.001},pt:{system:"imperial",factor:1/72},pc:{system:"imperial",factor:1/6},in:{system:"imperial",factor:1},ft:{system:"imperial",factor:12}};const a={metric:{unit:"m",ratio:1/.0254},imperial:{unit:"in",ratio:.0254}};t.exports=function(e,t,n,s){if("number"!=typeof e||!isFinite(e))throw new Error("Value must be a finite number");if(!t||!n)throw new Error("Must specify from and to units");var u=r((s=s||{}).pixelsPerInch,96),c=s.precision,l=!1!==s.roundPixel;if(t=t.toLowerCase(),n=n.toLowerCase(),-1===i.indexOf(t))throw new Error('Invalid from unit "'+t+'", must be one of: '+i.join(", "));if(-1===i.indexOf(n))throw new Error('Invalid from unit "'+n+'", must be one of: '+i.join(", "));if(t===n)return e;var f=1,h=1,d=!1;"px"===t&&(h=1/u,t="in"),"px"===n&&(d=!0,f=u,n="in");var p=o[t],m=o[n],g=e*p.factor*h;p.system!==m.system&&(g*=a[p.system].ratio);var v=g/m.factor*f;return d&&l?v=Math.round(v):"number"==typeof c&&isFinite(c)&&(v=function(e,t){return Number(Math.round(e+"e"+t)+"e-"+t)}(v,c)),v},t.exports.units=i},{defined:28}],23:[function(e,t,n){"use strict";t.exports=function(e,t,n,r,i,o){var a=i-1,s=i*i,u=a*a,c=(1+2*i)*u,l=i*u,f=s*(3-2*i),h=s*a;if(e.length){o||(o=new Array(e.length));for(var d=e.length-1;d>=0;--d)o[d]=c*e[d]+l*t[d]+f*n[d]+h*r[d];return o}return c*e+l*t+f*n+h*r},t.exports.derivative=function(e,t,n,r,i,o){var a=6*i*i-6*i,s=3*i*i-4*i+1,u=-6*i*i+6*i,c=3*i*i-2*i;if(e.length){o||(o=new Array(e.length));for(var l=e.length-1;l>=0;--l)o[l]=a*e[l]+s*t[l]+u*n[l]+c*r[l];return o}return a*e+s*t+u*n[l]+c*r}},{}],24:[function(e,t,n){var r,i;r=this,i=function(e){"use strict";function t(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function n(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function r(){}var i="\\s*([+-]?\\d+)\\s*",o="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",a="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",s=/^#([0-9a-f]{3})$/,u=/^#([0-9a-f]{6})$/,c=new RegExp("^rgb\\("+[i,i,i]+"\\)$"),l=new RegExp("^rgb\\("+[a,a,a]+"\\)$"),f=new RegExp("^rgba\\("+[i,i,i,o]+"\\)$"),h=new RegExp("^rgba\\("+[a,a,a,o]+"\\)$"),d=new RegExp("^hsl\\("+[o,a,a]+"\\)$"),p=new RegExp("^hsla\\("+[o,a,a,o]+"\\)$"),m={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function g(e){var t;return e=(e+"").trim().toLowerCase(),(t=s.exec(e))?new _((t=parseInt(t[1],16))>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):(t=u.exec(e))?v(parseInt(t[1],16)):(t=c.exec(e))?new _(t[1],t[2],t[3],1):(t=l.exec(e))?new _(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=f.exec(e))?b(t[1],t[2],t[3],t[4]):(t=h.exec(e))?b(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=d.exec(e))?M(t[1],t[2]/100,t[3]/100,1):(t=p.exec(e))?M(t[1],t[2]/100,t[3]/100,t[4]):m.hasOwnProperty(e)?v(m[e]):"transparent"===e?new _(NaN,NaN,NaN,0):null}function v(e){return new _(e>>16&255,e>>8&255,255&e,1)}function b(e,t,n,r){return r<=0&&(e=t=n=NaN),new _(e,t,n,r)}function y(e){return e instanceof r||(e=g(e)),e?new _((e=e.rgb()).r,e.g,e.b,e.opacity):new _}function x(e,t,n,r){return 1===arguments.length?y(e):new _(e,t,n,null==r?1:r)}function _(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function w(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function M(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new E(e,t,n,r)}function k(e,t,n,i){return 1===arguments.length?function(e){if(e instanceof E)return new E(e.h,e.s,e.l,e.opacity);if(e instanceof r||(e=g(e)),!e)return new E;if(e instanceof E)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,o=Math.min(t,n,i),a=Math.max(t,n,i),s=NaN,u=a-o,c=(a+o)/2;return u?(s=t===a?(n-i)/u+6*(n<i):n===a?(i-t)/u+2:(t-n)/u+4,u/=c<.5?a+o:2-a-o,s*=60):u=c>0&&c<1?0:s,new E(s,u,c,e.opacity)}(e):new E(e,t,n,null==i?1:i)}function E(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function A(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}t(r,g,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),t(_,x,n(r,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new _(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new _(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+w(this.r)+w(this.g)+w(this.b)},toString:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}})),t(E,k,n(r,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new E(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new E(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new _(A(e>=240?e-240:e+120,i,r),A(e,i,r),A(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var C=Math.PI/180,S=180/Math.PI,T=.96422,D=1,R=.82521,O=4/29,F=6/29,j=3*F*F,L=F*F*F;function N(e){if(e instanceof B)return new B(e.l,e.a,e.b,e.opacity);if(e instanceof G)return W(e);e instanceof _||(e=y(e));var t,n,r=q(e.r),i=q(e.g),o=q(e.b),a=z((.2225045*r+.7168786*i+.0606169*o)/D);return r===i&&i===o?t=n=a:(t=z((.4360747*r+.3850649*i+.1430804*o)/T),n=z((.0139322*r+.0971045*i+.7141733*o)/R)),new B(116*a-16,500*(t-a),200*(a-n),e.opacity)}function P(e,t,n,r){return 1===arguments.length?N(e):new B(e,t,n,null==r?1:r)}function B(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function z(e){return e>L?Math.pow(e,1/3):e/j+O}function I(e){return e>F?e*e*e:j*(e-O)}function H(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function q(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function U(e){if(e instanceof G)return new G(e.h,e.c,e.l,e.opacity);if(e instanceof B||(e=N(e)),0===e.a&&0===e.b)return new G(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*S;return new G(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function V(e,t,n,r){return 1===arguments.length?U(e):new G(e,t,n,null==r?1:r)}function G(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function W(e){if(isNaN(e.h))return new B(e.l,0,0,e.opacity);var t=e.h*C;return new B(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t(B,P,n(r,{brighter:function(e){return new B(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new B(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new _(H(3.1338561*(t=T*I(t))-1.6168667*(e=D*I(e))-.4906146*(n=R*I(n))),H(-.9787684*t+1.9161415*e+.033454*n),H(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),t(G,V,n(r,{brighter:function(e){return new G(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new G(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return W(this).rgb()}}));var X=-.14861,Y=1.78277,Q=-.29227,K=-.90649,J=1.97294,$=J*K,Z=J*Y,ee=Y*Q-K*X;function te(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof ne)return new ne(e.h,e.s,e.l,e.opacity);e instanceof _||(e=y(e));var t=e.g/255,n=e.b/255,r=(ee*n+$*(e.r/255)-Z*t)/(ee+$-Z),i=n-r,o=(J*(t-r)-Q*i)/K,a=Math.sqrt(o*o+i*i)/(J*r*(1-r)),s=a?Math.atan2(o,i)*S-120:NaN;return new ne(s<0?s+360:s,a,r,e.opacity)}(e):new ne(e,t,n,null==r?1:r)}function ne(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}t(ne,te,n(r,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new ne(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new ne(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*C,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new _(255*(t+n*(X*r+Y*i)),255*(t+n*(Q*r+K*i)),255*(t+n*(J*r)),this.opacity)}})),e.color=g,e.rgb=x,e.hsl=k,e.lab=P,e.hcl=V,e.lch=function(e,t,n,r){return 1===arguments.length?U(e):new G(n,t,e,null==r?1:r)},e.gray=function(e,t){return new B(e,0,0,null==t?1:t)},e.cubehelix=te,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof n&&void 0!==t?i(n):"function"==typeof define&&define.amd?define(["exports"],i):i(r.d3=r.d3||{})},{}],25:[function(e,t,n){t.exports=e("./vendor/dat.gui"),t.exports.color=e("./vendor/dat.color")},{"./vendor/dat.color":26,"./vendor/dat.gui":27}],26:[function(e,t,n){var r,i,o,a,s=t.exports=s||{};s.color=s.color||{},s.utils=s.utils||{},s.utils.common=(r=Array.prototype.forEach,i=Array.prototype.slice,{BREAK:{},extend:function(e){return this.each(i.call(arguments,1),function(t){for(var n in t)this.isUndefined(t[n])||(e[n]=t[n])},this),e},defaults:function(e){return this.each(i.call(arguments,1),function(t){for(var n in t)this.isUndefined(e[n])&&(e[n]=t[n])},this),e},compose:function(){var e=i.call(arguments);return function(){for(var t=i.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,t,n){if(r&&e.forEach===r)e.forEach(t,n);else if(e.length===e.length+0){for(var i=0,o=e.length;i<o;i++)if(i in e&&t.call(n,e[i],i)===this.BREAK)return}else for(var i in e)if(t.call(n,e[i],i)===this.BREAK)return},defer:function(e){setTimeout(e,0)},toArray:function(e){return e.toArray?e.toArray():i.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){return e!=e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}}),s.color.toString=(o=s.utils.common,function(e){if(1==e.a||o.isUndefined(e.a)){for(var t=e.hex.toString(16);t.length<6;)t="0"+t;return"#"+t}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}),s.Color=s.color.Color=function(e,t,n,r){var i=function(){if(this.__state=e.apply(this,arguments),!1===this.__state)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};function o(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(s(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(s(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function a(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(u(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(u(this),this.__state.space="HSV"),this.__state[t]=e}})}function s(e,n,i){if("HEX"===e.__state.space)e.__state[n]=t.component_from_hex(e.__state.hex,i);else{if("HSV"!==e.__state.space)throw"Corrupted color state";r.extend(e.__state,t.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}}function u(e){var n=t.rgb_to_hsv(e.r,e.g,e.b);r.extend(e.__state,{s:n.s,v:n.v}),r.isNaN(n.h)?r.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=n.h}return i.COMPONENTS=["r","g","b","h","s","v","hex","a"],r.extend(i.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),o(i.prototype,"r",2),o(i.prototype,"g",1),o(i.prototype,"b",0),a(i.prototype,"h"),a(i.prototype,"s"),a(i.prototype,"v"),Object.defineProperty(i.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(i.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=t.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}}),i}(s.color.interpret=function(e,t){var n,r,i=[{litmus:t.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString())}},write:e},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString())}},write:e},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:e},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:e}}},{litmus:t.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:t.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:t.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)&&t.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)&&t.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}];return function(){r=!1;var e=arguments.length>1?t.toArray(arguments):arguments[0];return t.each(i,function(i){if(i.litmus(e))return t.each(i.conversions,function(i,o){if(n=i.read(e),!1===r&&!1!==n)return r=n,n.conversionName=o,n.conversion=i,t.BREAK}),t.BREAK}),r}}(s.color.toString,s.utils.common),s.color.math={hsv_to_rgb:function(e,t,n){var r=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),o=n*(1-t),a=n*(1-i*t),s=n*(1-(1-i)*t),u=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(e,t,n){var r,i=Math.min(e,t,n),o=Math.max(e,t,n),a=o-i;return 0==o?{h:NaN,s:0,v:0}:(r=e==o?(t-n)/a:t==o?2+(n-e)/a:4+(e-t)/a,(r/=6)<0&&(r+=1),{h:360*r,s:a/o,v:o/255})},rgb_to_hex:function(e,t,n){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),r=this.hex_with_component(r,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(a=8*t)|e&~(255<<a)}},s.color.toString,s.utils.common)},{}],27:[function(e,t,n){var r,i,o,a,s,u=t.exports=u||{};u.gui=u.gui||{},u.utils=u.utils||{},u.controllers=u.controllers||{},u.dom=u.dom||{},u.color=u.color||{},u.utils.css={load:function(e,t){var n=(t=t||document).createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)},inject:function(e,t){t=t||document;var n=document.createElement("style");n.type="text/css",n.innerHTML=e,t.getElementsByTagName("head")[0].appendChild(n)}},u.utils.common=(r=Array.prototype.forEach,i=Array.prototype.slice,{BREAK:{},extend:function(e){return this.each(i.call(arguments,1),function(t){for(var n in t)this.isUndefined(t[n])||(e[n]=t[n])},this),e},defaults:function(e){return this.each(i.call(arguments,1),function(t){for(var n in t)this.isUndefined(e[n])&&(e[n]=t[n])},this),e},compose:function(){var e=i.call(arguments);return function(){for(var t=i.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,t,n){if(r&&e.forEach===r)e.forEach(t,n);else if(e.length===e.length+0){for(var i=0,o=e.length;i<o;i++)if(i in e&&t.call(n,e[i],i)===this.BREAK)return}else for(var i in e)if(t.call(n,e[i],i)===this.BREAK)return},defer:function(e){setTimeout(e,0)},toArray:function(e){return e.toArray?e.toArray():i.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){return e!=e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}}),u.controllers.Controller=(u.utils.common.extend((o=function(e,t){this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}).prototype,{onChange:function(e){return this.__onChange=e,this},onFinishChange:function(e){return this.__onFinishChange=e,this},setValue:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),o),u.dom.dom=function(e){var t={};e.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(n,r){e.each(n,function(e){t[e]=r})});var n=/(\d+(\.\d+)?)px/;function r(t){if("0"===t||e.isUndefined(t))return 0;var r=t.match(n);return e.isNull(r)?0:parseFloat(r[1])}var i={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(t,n,r){e.isUndefined(n)&&(n=!0),e.isUndefined(r)&&(r=!0),t.style.position="absolute",n&&(t.style.left=0,t.style.right=0),r&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(n,r,i,o){i=i||{};var a=t[r];if(!a)throw new Error("Event type "+r+" not supported.");var s=document.createEvent(a);switch(a){case"MouseEvents":s.initMouseEvent(r,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,i.x||i.clientX||0,i.y||i.clientY||0,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var u=s.initKeyboardEvent||s.initKeyEvent;e.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),u(r,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:s.initEvent(r,i.bubbles||!1,i.cancelable||!0)}e.defaults(s,o),n.dispatchEvent(s)},bind:function(e,t,n,r){return r=r||!1,e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on"+t,n),i},unbind:function(e,t,n,r){return r=r||!1,e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on"+t,n),i},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);-1==n.indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return i},removeClass:function(e,t){if(t)if(void 0===e.className);else if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),r=n.indexOf(t);-1!=r&&(n.splice(r,1),e.className=n.join(" "))}else e.className=void 0;return i},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return r(t["border-left-width"])+r(t["border-right-width"])+r(t["padding-left"])+r(t["padding-right"])+r(t.width)},getHeight:function(e){var t=getComputedStyle(e);return r(t["border-top-width"])+r(t["border-bottom-width"])+r(t["padding-top"])+r(t["padding-bottom"])+r(t.height)},getOffset:function(e){var t={left:0,top:0};if(e.offsetParent)do{t.left+=e.offsetLeft,t.top+=e.offsetTop}while(e=e.offsetParent);return t},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}};return i}(u.utils.common),u.controllers.OptionController=function(e,t,n){var r=function(e,i,o){r.superclass.call(this,e,i);var a=this;if(this.__select=document.createElement("select"),n.isArray(o)){var s={};n.each(o,function(e){s[e]=e}),o=s}n.each(o,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),a.__select.appendChild(n)}),this.updateDisplay(),t.bind(this.__select,"change",function(){a.setValue(this.options[this.selectedIndex].value)}),this.domElement.appendChild(this.__select)};return r.superclass=e,n.extend(r.prototype,e.prototype,{setValue:function(e){var t=r.superclass.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),t},updateDisplay:function(){return this.__select.value=this.getValue(),r.superclass.prototype.updateDisplay.call(this)}}),r}(u.controllers.Controller,u.dom.dom,u.utils.common),u.controllers.NumberController=function(e,t){var n=function(e,r,i){var o;n.superclass.call(this,e,r),this.__min=(i=i||{}).min,this.__max=i.max,this.__step=i.step,this.__impliedStep=t.isUndefined(this.__step)?0==this.initialValue?1:Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__step,this.__precision=(o=(o=this.__impliedStep).toString()).indexOf(".")>-1?o.length-o.indexOf(".")-1:0};return n.superclass=e,t.extend(n.prototype,e.prototype,{setValue:function(e){return void 0!==this.__min&&e<this.__min?e=this.__min:void 0!==this.__max&&e>this.__max&&(e=this.__max),void 0!==this.__step&&e%this.__step!=0&&(e=Math.round(e/this.__step)*this.__step),n.superclass.prototype.setValue.call(this,e)},min:function(e){return this.__min=e,this},max:function(e){return this.__max=e,this},step:function(e){return this.__step=e,this}}),n}(u.controllers.Controller,u.utils.common),u.controllers.NumberControllerBox=function(e,t,n){var r=function(e,i,o){this.__truncationSuspended=!1,r.superclass.call(this,e,i,o);var a,s=this;function u(){var e=parseFloat(s.__input.value);n.isNaN(e)||s.setValue(e)}function c(e){var t=a-e.clientY;s.setValue(s.getValue()+t*s.__impliedStep),a=e.clientY}function l(){t.unbind(window,"mousemove",c),t.unbind(window,"mouseup",l)}this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),t.bind(this.__input,"change",u),t.bind(this.__input,"blur",function(){u(),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}),t.bind(this.__input,"mousedown",function(e){t.bind(window,"mousemove",c),t.bind(window,"mouseup",l),a=e.clientY}),t.bind(this.__input,"keydown",function(e){13===e.keyCode&&(s.__truncationSuspended=!0,this.blur(),s.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return r.superclass=e,n.extend(r.prototype,e.prototype,{updateDisplay:function(){var e,t;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),t=Math.pow(10,this.__precision),Math.round(e*t)/t),r.superclass.prototype.updateDisplay.call(this)}}),r}(u.controllers.NumberController,u.dom.dom,u.utils.common),u.controllers.NumberControllerSlider=function(e,t,n,r,i){var o=function(e,n,r,i,a){o.superclass.call(this,e,n,{min:r,max:i,step:a});var s=this;function u(e){e.preventDefault();var n,r,i=t.getOffset(s.__background),o=t.getWidth(s.__background);return s.setValue((r=s.__min)+(e.clientX-(n=i.left))/(i.left+o-n)*(s.__max-r)),!1}function c(){t.unbind(window,"mousemove",u),t.unbind(window,"mouseup",c),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),t.bind(this.__background,"mousedown",function(e){t.bind(window,"mousemove",u),t.bind(window,"mouseup",c),u(e)}),t.addClass(this.__background,"slider"),t.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return o.superclass=e,o.useDefaultStyles=function(){n.inject(".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}")},r.extend(o.prototype,e.prototype,{updateDisplay:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",o.superclass.prototype.updateDisplay.call(this)}}),o}(u.controllers.NumberController,u.dom.dom,u.utils.css,u.utils.common),u.controllers.FunctionController=function(e,t,n){var r=function(e,n,i){r.superclass.call(this,e,n);var o=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===i?"Fire":i,t.bind(this.__button,"click",function(e){return e.preventDefault(),o.fire(),!1}),t.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return r.superclass=e,n.extend(r.prototype,e.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),r}(u.controllers.Controller,u.dom.dom,u.utils.common),u.controllers.BooleanController=function(e,t,n){var r=function(e,n){r.superclass.call(this,e,n);var i=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),t.bind(this.__checkbox,"change",function(){i.setValue(!i.__prev)},!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return r.superclass=e,n.extend(r.prototype,e.prototype,{setValue:function(e){var t=r.superclass.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),t},updateDisplay:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,r.superclass.prototype.updateDisplay.call(this)}}),r}(u.controllers.Controller,u.dom.dom,u.utils.common),u.color.toString=(a=u.utils.common,function(e){if(1==e.a||a.isUndefined(e.a)){for(var t=e.hex.toString(16);t.length<6;)t="0"+t;return"#"+t}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}),u.color.interpret=function(e,t){var n,r,i=[{litmus:t.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString())}},write:e},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString())}},write:e},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:e},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:e}}},{litmus:t.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:t.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:t.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)&&t.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)&&t.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}];return function(){r=!1;var e=arguments.length>1?t.toArray(arguments):arguments[0];return t.each(i,function(i){if(i.litmus(e))return t.each(i.conversions,function(i,o){if(n=i.read(e),!1===r&&!1!==n)return r=n,n.conversionName=o,n.conversion=i,t.BREAK}),t.BREAK}),r}}(u.color.toString,u.utils.common),u.GUI=u.gui.GUI=function(e,t,n,r,i,o,a,s,u,c,l,f,h,d,p){e.inject(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");var m,g,v="Default",b=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}(),y=!0,x=!1,_=[],w=function(e){var t=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),d.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],e=p.defaults(e=e||{},{autoPlace:!0,width:w.DEFAULT_WIDTH}),e=p.defaults(e,{resizable:e.autoPlace,hideable:e.autoPlace}),p.isUndefined(e.load)?e.load={preset:v}:e.preset&&(e.load.preset=e.preset),p.isUndefined(e.parent)&&e.hideable&&_.push(this),e.resizable=p.isUndefined(e.parent)&&e.resizable,e.autoPlace&&p.isUndefined(e.scrollable)&&(e.scrollable=!0);var n=b&&"true"===localStorage.getItem(A(this,"isLocal"));if(Object.defineProperties(this,{parent:{get:function(){return e.parent}},scrollable:{get:function(){return e.scrollable}},autoPlace:{get:function(){return e.autoPlace}},preset:{get:function(){return t.parent?t.getRoot().preset:e.load.preset},set:function(n){t.parent?t.getRoot().preset=n:e.load.preset=n,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value==e.preset&&(e.__preset_select.selectedIndex=t)}(this),t.revert()}},width:{get:function(){return e.width},set:function(n){e.width=n,C(t,n)}},name:{get:function(){return e.name},set:function(t){e.name=t,i&&(i.innerHTML=e.name)}},closed:{get:function(){return e.closed},set:function(n){e.closed=n,e.closed?d.addClass(t.__ul,w.CLASS_CLOSED):d.removeClass(t.__ul,w.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=n?w.TEXT_OPEN:w.TEXT_CLOSED)}},load:{get:function(){return e.load}},useLocalStorage:{get:function(){return n},set:function(e){b&&(n=e,e?d.bind(window,"unload",a):d.unbind(window,"unload",a),localStorage.setItem(A(t,"isLocal"),e))}}}),p.isUndefined(e.parent)){if(e.closed=!1,d.addClass(this.domElement,w.CLASS_MAIN),d.makeSelectable(this.domElement,!1),b&&n){t.useLocalStorage=!0;var r=localStorage.getItem(A(this,"gui"));r&&(e.load=JSON.parse(r))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=w.TEXT_CLOSED,d.addClass(this.__closeButton,w.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),d.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{void 0===e.closed&&(e.closed=!0);var i=document.createTextNode(e.name);d.addClass(i,"controller-name");var o=k(t,i);d.addClass(this.__ul,w.CLASS_CLOSED),d.addClass(o,"title"),d.bind(o,"click",function(e){return e.preventDefault(),t.closed=!t.closed,!1}),e.closed||(this.closed=!1)}function a(){localStorage.setItem(A(t,"gui"),JSON.stringify(t.getSaveObject()))}e.autoPlace&&(p.isUndefined(e.parent)&&(y&&(g=document.createElement("div"),d.addClass(g,"dg"),d.addClass(g,w.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(g),y=!1),g.appendChild(this.domElement),d.addClass(this.domElement,w.CLASS_AUTO_PLACE)),this.parent||C(t,e.width)),d.bind(window,"resize",function(){t.onResize()}),d.bind(this.__ul,"webkitTransitionEnd",function(){t.onResize()}),d.bind(this.__ul,"transitionend",function(){t.onResize()}),d.bind(this.__ul,"oTransitionEnd",function(){t.onResize()}),this.onResize(),e.resizable&&function(e){var t;function n(n){return n.preventDefault(),t=n.clientX,d.addClass(e.__closeButton,w.CLASS_DRAG),d.bind(window,"mousemove",r),d.bind(window,"mouseup",i),!1}function r(n){return n.preventDefault(),e.width+=t-n.clientX,e.onResize(),t=n.clientX,!1}function i(){d.removeClass(e.__closeButton,w.CLASS_DRAG),d.unbind(window,"mousemove",r),d.unbind(window,"mouseup",i)}e.__resize_handle=document.createElement("div"),p.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),d.bind(e.__resize_handle,"mousedown",n),d.bind(e.__closeButton,"mousedown",n),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}(this);t.getRoot();e.parent||function(){var e=t.getRoot();e.width+=1,p.defer(function(){e.width-=1})}()};function M(e,t,n,c){if(void 0===t[n])throw new Error("Object "+t+' has no property "'+n+'"');var f;if(c.color)f=new l(t,n);else{var h=[t,n].concat(c.factoryArgs);f=r.apply(e,h)}c.before instanceof i&&(c.before=c.before.__li),E(e,f),d.addClass(f.domElement,"c");var m=document.createElement("span");d.addClass(m,"property-name"),m.innerHTML=f.property;var g=document.createElement("div");g.appendChild(m),g.appendChild(f.domElement);var v=k(e,g,c.before);return d.addClass(v,w.CLASS_CONTROLLER_ROW),d.addClass(v,typeof f.getValue()),function(e,t,n){if(n.__li=t,n.__gui=e,p.extend(n,{options:function(t){return arguments.length>1?(n.remove(),M(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[p.toArray(arguments)]})):p.isArray(t)||p.isObject(t)?(n.remove(),M(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[t]})):void 0},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof u){var r=new s(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});p.each(["updateDisplay","onChange","onFinishChange"],function(e){var t=n[e],i=r[e];n[e]=r[e]=function(){var e=Array.prototype.slice.call(arguments);return t.apply(n,e),i.apply(r,e)}}),d.addClass(t,"has-slider"),n.domElement.insertBefore(r.domElement,n.domElement.firstElementChild)}else if(n instanceof s){var i=function(t){return p.isNumber(n.__min)&&p.isNumber(n.__max)?(n.remove(),M(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]})):t};n.min=p.compose(i,n.min),n.max=p.compose(i,n.max)}else n instanceof o?(d.bind(t,"click",function(){d.fakeEvent(n.__checkbox,"click")}),d.bind(n.__checkbox,"click",function(e){e.stopPropagation()})):n instanceof a?(d.bind(t,"click",function(){d.fakeEvent(n.__button,"click")}),d.bind(t,"mouseover",function(){d.addClass(n.__button,"hover")}),d.bind(t,"mouseout",function(){d.removeClass(n.__button,"hover")})):n instanceof l&&(d.addClass(t,"color"),n.updateDisplay=p.compose(function(e){return t.style.borderLeftColor=n.__color.toString(),e},n.updateDisplay),n.updateDisplay());n.setValue=p.compose(function(t){return e.getRoot().__preset_select&&n.isModified()&&D(e.getRoot(),!0),t},n.setValue)}(e,v,f),e.__controllers.push(f),f}function k(e,t,n){var r=document.createElement("li");return t&&r.appendChild(t),n?e.__ul.insertBefore(r,params.before):e.__ul.appendChild(r),e.onResize(),r}function E(e,t){var n=e.getRoot(),r=n.__rememberedObjects.indexOf(t.object);if(-1!=r){var i=n.__rememberedObjectIndecesToControllers[r];if(void 0===i&&(n.__rememberedObjectIndecesToControllers[r]=i={}),i[t.property]=t,n.load&&n.load.remembered){var o,a=n.load.remembered;if(a[e.preset])o=a[e.preset];else{if(!a[v])return;o=a[v]}if(o[r]&&void 0!==o[r][t.property]){var s=o[r][t.property];t.initialValue=s,t.setValue(s)}}}}function A(e,t){return document.location.href+"."+t}function C(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function S(e,t){var n={};return p.each(e.__rememberedObjects,function(r,i){var o={};p.each(e.__rememberedObjectIndecesToControllers[i],function(e,n){o[n]=t?e.initialValue:e.getValue()}),n[i]=o}),n}function T(e,t,n){var r=document.createElement("option");r.innerHTML=t,r.value=t,e.__preset_select.appendChild(r),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function D(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}return w.toggleHide=function(){x=!x,p.each(_,function(e){e.domElement.style.zIndex=x?-999:999,e.domElement.style.opacity=x?0:1})},w.CLASS_AUTO_PLACE="a",w.CLASS_AUTO_PLACE_CONTAINER="ac",w.CLASS_MAIN="main",w.CLASS_CONTROLLER_ROW="cr",w.CLASS_TOO_TALL="taller-than-window",w.CLASS_CLOSED="closed",w.CLASS_CLOSE_BUTTON="close-button",w.CLASS_DRAG="drag",w.DEFAULT_WIDTH=245,w.TEXT_CLOSED="Close Controls",w.TEXT_OPEN="Open Controls",d.bind(window,"keydown",function(e){"text"===document.activeElement.type||72!==e.which&&72!=e.keyCode||w.toggleHide()},!1),p.extend(w.prototype,{add:function(e,t){return M(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return M(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.slice(this.__controllers.indexOf(e),1);var t=this;p.defer(function(){t.onResize()})},destroy:function(){this.autoPlace&&g.removeChild(this.domElement)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new w(t);this.__folders[e]=n;var r=k(this,n.domElement);return d.addClass(r,"folder"),n},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=d.getOffset(e.__ul).top,n=0;p.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(n+=d.getHeight(t))}),window.innerHeight-t-20<n?(d.addClass(e.domElement,w.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(d.removeClass(e.domElement,w.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&p.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},remember:function(){if(p.isUndefined(m)&&((m=new h).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;p.each(Array.prototype.slice.call(arguments),function(t){0==e.__rememberedObjects.length&&function(e){var t=e.__save_row=document.createElement("li");d.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),d.addClass(t,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",d.addClass(n,"button gears");var r=document.createElement("span");r.innerHTML="Save",d.addClass(r,"button"),d.addClass(r,"save");var i=document.createElement("span");i.innerHTML="New",d.addClass(i,"button"),d.addClass(i,"save-as");var o=document.createElement("span");o.innerHTML="Revert",d.addClass(o,"button"),d.addClass(o,"revert");var a=e.__preset_select=document.createElement("select");e.load&&e.load.remembered?p.each(e.load.remembered,function(t,n){T(e,n,n==e.preset)}):T(e,v,!1);if(d.bind(a,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),t.appendChild(a),t.appendChild(n),t.appendChild(r),t.appendChild(i),t.appendChild(o),b){var s=document.getElementById("dg-save-locally"),u=document.getElementById("dg-local-explain");s.style.display="block";var c=document.getElementById("dg-local-storage");function l(){u.style.display=e.useLocalStorage?"block":"none"}"true"===localStorage.getItem(A(e,"isLocal"))&&c.setAttribute("checked","checked"),l(),d.bind(c,"change",function(){e.useLocalStorage=!e.useLocalStorage,l()})}var f=document.getElementById("dg-new-constructor");d.bind(f,"keydown",function(e){!e.metaKey||67!==e.which&&67!=e.keyCode||m.hide()}),d.bind(n,"click",function(){f.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),m.show(),f.focus(),f.select()}),d.bind(r,"click",function(){e.save()}),d.bind(i,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),d.bind(o,"click",function(){e.revert()})}(e),-1==e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&C(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=S(this)),e.folders={},p.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=S(this),D(this,!1)},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[v]=S(this,!0)),this.load.remembered[e]=S(this),this.preset=e,T(this,e,!0)},revert:function(e){p.each(this.__controllers,function(t){this.getRoot().load.remembered?E(e||this.getRoot(),t):t.setValue(t.initialValue)},this),p.each(this.__folders,function(e){e.revert(e)}),e||D(this.getRoot(),!1)},listen:function(e){var t=0==this.__listening.length;this.__listening.push(e),t&&function e(t){0!=t.length&&f(function(){e(t)});p.each(t,function(e){e.updateDisplay()})}(this.__listening)}}),w}(u.utils.css,0,0,u.controllers.factory=function(e,t,n,r,i,o,a){return function(s,u){var c=s[u];return a.isArray(arguments[2])||a.isObject(arguments[2])?new e(s,u,arguments[2]):a.isNumber(c)?a.isNumber(arguments[2])&&a.isNumber(arguments[3])?new n(s,u,arguments[2],arguments[3]):new t(s,u,{min:arguments[2],max:arguments[3]}):a.isString(c)?new r(s,u):a.isFunction(c)?new i(s,u,""):a.isBoolean(c)?new o(s,u):void 0}}(u.controllers.OptionController,u.controllers.NumberControllerBox,u.controllers.NumberControllerSlider,u.controllers.StringController=function(e,t,n){var r=function(e,n){r.superclass.call(this,e,n);var i=this;function o(){i.setValue(i.__input.value)}this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),t.bind(this.__input,"keyup",o),t.bind(this.__input,"change",o),t.bind(this.__input,"blur",function(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}),t.bind(this.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return r.superclass=e,n.extend(r.prototype,e.prototype,{updateDisplay:function(){return t.isActive(this.__input)||(this.__input.value=this.getValue()),r.superclass.prototype.updateDisplay.call(this)}}),r}(u.controllers.Controller,u.dom.dom,u.utils.common),u.controllers.FunctionController,u.controllers.BooleanController,u.utils.common),u.controllers.Controller,u.controllers.BooleanController,u.controllers.FunctionController,u.controllers.NumberControllerBox,u.controllers.NumberControllerSlider,0,u.controllers.ColorController=function(e,t,n,r,i){var o=function(e,a){o.superclass.call(this,e,a),this.__color=new n(this.getValue()),this.__temp=new n(0);var u=this;this.domElement=document.createElement("div"),t.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",t.bind(this.__input,"keydown",function(e){13===e.keyCode&&d.call(this)}),t.bind(this.__input,"blur",d),t.bind(this.__selector,"mousedown",function(e){t.addClass(this,"drag").bind(window,"mouseup",function(e){t.removeClass(u.__selector,"drag")})});var c,l=document.createElement("div");function f(e){m(e),t.bind(window,"mousemove",m),t.bind(window,"mouseup",h)}function h(){t.unbind(window,"mousemove",m),t.unbind(window,"mouseup",h)}function d(){var e=r(this.value);!1!==e?(u.__color.__state=e,u.setValue(u.__color.toOriginal())):this.value=u.__color.toString()}function p(){t.unbind(window,"mousemove",g),t.unbind(window,"mouseup",p)}function m(e){e.preventDefault();var n=t.getWidth(u.__saturation_field),r=t.getOffset(u.__saturation_field),i=(e.clientX-r.left+document.body.scrollLeft)/n,o=1-(e.clientY-r.top+document.body.scrollTop)/n;return o>1?o=1:o<0&&(o=0),i>1?i=1:i<0&&(i=0),u.__color.v=o,u.__color.s=i,u.setValue(u.__color.toOriginal()),!1}function g(e){e.preventDefault();var n=t.getHeight(u.__hue_field),r=t.getOffset(u.__hue_field),i=1-(e.clientY-r.top+document.body.scrollTop)/n;return i>1?i=1:i<0&&(i=0),u.__color.h=360*i,u.setValue(u.__color.toOriginal()),!1}i.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),i.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),i.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),i.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),i.extend(l.style,{width:"100%",height:"100%",background:"none"}),s(l,"top","rgba(0,0,0,0)","#000"),i.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),(c=this.__hue_field).style.background="",c.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",c.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",c.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",c.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",c.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),t.bind(this.__saturation_field,"mousedown",f),t.bind(this.__field_knob,"mousedown",f),t.bind(this.__hue_field,"mousedown",function(e){g(e),t.bind(window,"mousemove",g),t.bind(window,"mouseup",p)}),this.__saturation_field.appendChild(l),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};o.superclass=e,i.extend(o.prototype,e.prototype,{updateDisplay:function(){var e=r(this.getValue());if(!1!==e){var t=!1;i.each(n.COMPONENTS,function(n){if(!i.isUndefined(e[n])&&!i.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}},this),t&&i.extend(this.__color.__state,e)}i.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var o=this.__color.v<.5||this.__color.s>.5?255:0,a=255-o;i.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+o+","+o+","+o+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,s(this.__saturation_field,"left","#fff",this.__temp.toString()),i.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+o+","+o+","+o+")",textShadow:this.__input_textShadow+"rgba("+a+","+a+","+a+",.7)"})}});var a=["-moz-","-o-","-webkit-","-ms-",""];function s(e,t,n,r){e.style.background="",i.each(a,function(i){e.style.cssText+="background: "+i+"linear-gradient("+t+", "+n+" 0%, "+r+" 100%); "})}return o}(u.controllers.Controller,u.dom.dom,u.color.Color=function(e,t,n,r){var i=function(){if(this.__state=e.apply(this,arguments),!1===this.__state)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};function o(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(s(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(s(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function a(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(u(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(u(this),this.__state.space="HSV"),this.__state[t]=e}})}function s(e,n,i){if("HEX"===e.__state.space)e.__state[n]=t.component_from_hex(e.__state.hex,i);else{if("HSV"!==e.__state.space)throw"Corrupted color state";r.extend(e.__state,t.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}}function u(e){var n=t.rgb_to_hsv(e.r,e.g,e.b);r.extend(e.__state,{s:n.s,v:n.v}),r.isNaN(n.h)?r.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=n.h}return i.COMPONENTS=["r","g","b","h","s","v","hex","a"],r.extend(i.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),o(i.prototype,"r",2),o(i.prototype,"g",1),o(i.prototype,"b",0),a(i.prototype,"h"),a(i.prototype,"s"),a(i.prototype,"v"),Object.defineProperty(i.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(i.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=t.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}}),i}(u.color.interpret,u.color.math={hsv_to_rgb:function(e,t,n){var r=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),o=n*(1-t),a=n*(1-i*t),s=n*(1-(1-i)*t),u=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(e,t,n){var r,i=Math.min(e,t,n),o=Math.max(e,t,n),a=o-i;return 0==o?{h:NaN,s:0,v:0}:(r=e==o?(t-n)/a:t==o?2+(n-e)/a:4+(e-t)/a,(r/=6)<0&&(r+=1),{h:360*r,s:a/o,v:o/255})},rgb_to_hex:function(e,t,n){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),r=this.hex_with_component(r,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(s=8*t)|e&~(255<<s)}},u.color.toString,u.utils.common),u.color.interpret,u.utils.common),u.utils.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)},u.dom.CenteredDiv=function(e,t){var n=function(){this.backgroundElement=document.createElement("div"),t.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),e.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),t.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var n=this;e.bind(this.backgroundElement,"click",function(){n.hide()})};return n.prototype.show=function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),t.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})},n.prototype.hide=function(){var t=this,n=function(){t.domElement.style.display="none",t.backgroundElement.style.display="none",e.unbind(t.domElement,"webkitTransitionEnd",n),e.unbind(t.domElement,"transitionend",n),e.unbind(t.domElement,"oTransitionEnd",n)};e.bind(this.domElement,"webkitTransitionEnd",n),e.bind(this.domElement,"transitionend",n),e.bind(this.domElement,"oTransitionEnd",n),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},n.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-e.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-e.getHeight(this.domElement)/2+"px"},n}(u.dom.dom,u.utils.common),u.dom.dom,u.utils.common)},{}],28:[function(e,t,n){t.exports=function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]}},{}],29:[function(e,t,n){"use strict";t.exports=function(e,t,n){switch(arguments.length){case 0:return new a([0],[0],0);case 1:if("number"==typeof e){var r=u(e);return new a(r,r,0)}return new a(e,u(e.length),0);case 2:if("number"==typeof t){var r=u(e.length);return new a(e,r,+t)}n=0;case 3:if(e.length!==t.length)throw new Error("state and velocity lengths must match");return new a(e,t,n)}};var r=e("cubic-hermite"),i=e("binary-search-bounds");function o(e,t,n){return Math.min(t,Math.max(e,n))}function a(e,t,n){this.dimension=e.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var r=0;r<this.dimension;++r)this.bounds[0][r]=-Infinity,this.bounds[1][r]=Infinity;this._state=e.slice().reverse(),this._velocity=t.slice().reverse(),this._time=[n],this._scratch=[e.slice(),e.slice(),e.slice(),e.slice(),e.slice()]}var s=a.prototype;function u(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}s.flush=function(e){var t=i.gt(this._time,e)-1;t<=0||(this._time.splice(0,t),this._state.splice(0,t*this.dimension),this._velocity.splice(0,t*this.dimension))},s.curve=function(e){var t=this._time,n=t.length,a=i.le(t,e),s=this._scratch[0],u=this._state,c=this._velocity,l=this.dimension,f=this.bounds;if(a<0)for(var h=l-1,d=0;d<l;++d,--h)s[d]=u[h];else if(a>=n-1){h=u.length-1;var p=e-t[n-1];for(d=0;d<l;++d,--h)s[d]=u[h]+p*c[h]}else{h=l*(a+1)-1;var m=t[a],g=t[a+1]-m||1,v=this._scratch[1],b=this._scratch[2],y=this._scratch[3],x=this._scratch[4],_=!0;for(d=0;d<l;++d,--h)v[d]=u[h],y[d]=c[h]*g,b[d]=u[h+l],x[d]=c[h+l]*g,_=_&&v[d]===b[d]&&y[d]===x[d]&&0===y[d];if(_)for(d=0;d<l;++d)s[d]=v[d];else r(v,y,b,x,(e-m)/g,s)}var w=f[0],M=f[1];for(d=0;d<l;++d)s[d]=o(w[d],M[d],s[d]);return s},s.dcurve=function(e){var t=this._time,n=t.length,o=i.le(t,e),a=this._scratch[0],s=this._state,u=this._velocity,c=this.dimension;if(o>=n-1)for(var l=s.length-1,f=0;f<c;++f,--l)a[f]=u[l];else{l=c*(o+1)-1;var h=t[o],d=t[o+1]-h||1,p=this._scratch[1],m=this._scratch[2],g=this._scratch[3],v=this._scratch[4],b=!0;for(f=0;f<c;++f,--l)p[f]=s[l],g[f]=u[l]*d,m[f]=s[l+c],v[f]=u[l+c]*d,b=b&&p[f]===m[f]&&g[f]===v[f]&&0===g[f];if(b)for(f=0;f<c;++f)a[f]=0;else{r.derivative(p,g,m,v,(e-h)/d,a);for(f=0;f<c;++f)a[f]/=d}}return a},s.lastT=function(){var e=this._time;return e[e.length-1]},s.stable=function(){for(var e=this._velocity,t=e.length,n=this.dimension-1;n>=0;--n)if(e[--t])return!1;return!0},s.jump=function(e){var t=this.lastT(),n=this.dimension;if(!(e<t||arguments.length!==n+1)){var r=this._state,i=this._velocity,a=r.length-this.dimension,s=this.bounds,u=s[0],c=s[1];this._time.push(t,e);for(var l=0;l<2;++l)for(var f=0;f<n;++f)r.push(r[a++]),i.push(0);this._time.push(e);for(f=n;f>0;--f)r.push(o(u[f-1],c[f-1],arguments[f])),i.push(0)}},s.push=function(e){var t=this.lastT(),n=this.dimension;if(!(e<t||arguments.length!==n+1)){var r=this._state,i=this._velocity,a=r.length-this.dimension,s=e-t,u=this.bounds,c=u[0],l=u[1],f=s>1e-6?1/s:0;this._time.push(e);for(var h=n;h>0;--h){var d=o(c[h-1],l[h-1],arguments[h]);r.push(d),i.push((d-r[a++])*f)}}},s.set=function(e){var t=this.dimension;if(!(e<this.lastT()||arguments.length!==t+1)){var n=this._state,r=this._velocity,i=this.bounds,a=i[0],s=i[1];this._time.push(e);for(var u=t;u>0;--u)n.push(o(a[u-1],s[u-1],arguments[u])),r.push(0)}},s.move=function(e){var t=this.lastT(),n=this.dimension;if(!(e<=t||arguments.length!==n+1)){var r=this._state,i=this._velocity,a=r.length-this.dimension,s=this.bounds,u=s[0],c=s[1],l=e-t,f=l>1e-6?1/l:0;this._time.push(e);for(var h=n;h>0;--h){var d=arguments[h];r.push(o(u[h-1],c[h-1],r[a++]+d)),i.push(d*f)}}},s.idle=function(e){var t=this.lastT();if(!(e<t)){var n=this.dimension,r=this._state,i=this._velocity,a=r.length-n,s=this.bounds,u=s[0],c=s[1],l=e-t;this._time.push(e);for(var f=n-1;f>=0;--f)r.push(o(u[f],c[f],r[a]+l*i[a])),i.push(0),a+=1}}},{"binary-search-bounds":4,"cubic-hermite":23}],30:[function(e,t,n){t.exports=function(e){var t,n,r,i,o,a=e[0],s=e[1],u=e[2];if(0===s)return[o=u,o,o];n=u<.5?u*(1+s):u+s-u*s;t=2*u-n,i=[0,0,0];for(var c=0;c<3;c++)(r=a+1/3*-(c-1))<0&&r++,r>1&&r--,i[c]=o=6*r<1?t+6*(n-t)*r:2*r<1?n:3*r<2?t+(n-t)*(2/3-r)*6:t;return i}},{}],31:[function(e,t,n){t.exports=function(e){var t,n,r,i=e[0],o=e[1],a=e[2],s=Math.min(i,o,a),u=Math.max(i,o,a),c=u-s;u===s?t=0:i===u?t=(o-a)/c:o===u?t=2+(a-i)/c:a===u&&(t=4+(i-o)/c);(t=Math.min(60*t,360))<0&&(t+=360);r=(s+u)/2,n=u===s?0:r<=.5?c/(u+s):c/(2-u-s);return[t/360,n,r]}},{}],32:[function(e,t,n){t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],d=t[11],p=t[12],m=t[13],g=t[14],v=t[15];return e[0]=s*(h*v-d*g)-f*(u*v-c*g)+m*(u*d-c*h),e[1]=-(r*(h*v-d*g)-f*(i*v-o*g)+m*(i*d-o*h)),e[2]=r*(u*v-c*g)-s*(i*v-o*g)+m*(i*c-o*u),e[3]=-(r*(u*d-c*h)-s*(i*d-o*h)+f*(i*c-o*u)),e[4]=-(a*(h*v-d*g)-l*(u*v-c*g)+p*(u*d-c*h)),e[5]=n*(h*v-d*g)-l*(i*v-o*g)+p*(i*d-o*h),e[6]=-(n*(u*v-c*g)-a*(i*v-o*g)+p*(i*c-o*u)),e[7]=n*(u*d-c*h)-a*(i*d-o*h)+l*(i*c-o*u),e[8]=a*(f*v-d*m)-l*(s*v-c*m)+p*(s*d-c*f),e[9]=-(n*(f*v-d*m)-l*(r*v-o*m)+p*(r*d-o*f)),e[10]=n*(s*v-c*m)-a*(r*v-o*m)+p*(r*c-o*s),e[11]=-(n*(s*d-c*f)-a*(r*d-o*f)+l*(r*c-o*s)),e[12]=-(a*(f*g-h*m)-l*(s*g-u*m)+p*(s*h-u*f)),e[13]=n*(f*g-h*m)-l*(r*g-i*m)+p*(r*h-i*f),e[14]=-(n*(s*g-u*m)-a*(r*g-i*m)+p*(r*u-i*s)),e[15]=n*(s*h-u*f)-a*(r*h-i*f)+l*(r*u-i*s),e}},{}],33:[function(e,t,n){t.exports=function(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},{}],34:[function(e,t,n){t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},{}],35:[function(e,t,n){t.exports=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],36:[function(e,t,n){t.exports=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11],d=e[12],p=e[13],m=e[14],g=e[15];return(t*a-n*o)*(f*g-h*m)-(t*s-r*o)*(l*g-h*p)+(t*u-i*o)*(l*m-f*p)+(n*s-r*a)*(c*g-h*d)-(n*u-i*a)*(c*m-f*d)+(r*u-i*s)*(c*p-l*d)}},{}],37:[function(e,t,n){t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,h=i*a,d=i*s,p=i*u,m=o*a,g=o*s,v=o*u;return e[0]=1-f-p,e[1]=l+v,e[2]=h-g,e[3]=0,e[4]=l-v,e[5]=1-c-p,e[6]=d+m,e[7]=0,e[8]=h+g,e[9]=d-m,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],38:[function(e,t,n){t.exports=function(e,t,n){var r,i,o,a=n[0],s=n[1],u=n[2],c=Math.sqrt(a*a+s*s+u*u);if(Math.abs(c)<1e-6)return null;return a*=c=1/c,s*=c,u*=c,r=Math.sin(t),i=Math.cos(t),e[0]=a*a*(o=1-i)+i,e[1]=s*a*o+u*r,e[2]=u*a*o-s*r,e[3]=0,e[4]=a*s*o-u*r,e[5]=s*s*o+i,e[6]=u*s*o+a*r,e[7]=0,e[8]=a*u*o+s*r,e[9]=s*u*o-a*r,e[10]=u*u*o+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],39:[function(e,t,n){t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,u=i+i,c=o+o,l=r*s,f=r*u,h=r*c,d=i*u,p=i*c,m=o*c,g=a*s,v=a*u,b=a*c;return e[0]=1-(d+m),e[1]=f+b,e[2]=h-v,e[3]=0,e[4]=f-b,e[5]=1-(l+m),e[6]=p+g,e[7]=0,e[8]=h+v,e[9]=p-g,e[10]=1-(l+d),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}},{}],40:[function(e,t,n){t.exports=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],41:[function(e,t,n){t.exports=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}},{}],42:[function(e,t,n){t.exports=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],43:[function(e,t,n){t.exports=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],44:[function(e,t,n){t.exports=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],45:[function(e,t,n){t.exports=function(e,t,n,r,i,o,a){var s=1/(n-t),u=1/(i-r),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*u,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e}},{}],46:[function(e,t,n){t.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],47:[function(e,t,n){t.exports={create:e("./create"),clone:e("./clone"),copy:e("./copy"),identity:e("./identity"),transpose:e("./transpose"),invert:e("./invert"),adjoint:e("./adjoint"),determinant:e("./determinant"),multiply:e("./multiply"),translate:e("./translate"),scale:e("./scale"),rotate:e("./rotate"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),fromRotation:e("./fromRotation"),fromRotationTranslation:e("./fromRotationTranslation"),fromScaling:e("./fromScaling"),fromTranslation:e("./fromTranslation"),fromXRotation:e("./fromXRotation"),fromYRotation:e("./fromYRotation"),fromZRotation:e("./fromZRotation"),fromQuat:e("./fromQuat"),frustum:e("./frustum"),perspective:e("./perspective"),perspectiveFromFieldOfView:e("./perspectiveFromFieldOfView"),ortho:e("./ortho"),lookAt:e("./lookAt"),str:e("./str")}},{"./adjoint":32,"./clone":33,"./copy":34,"./create":35,"./determinant":36,"./fromQuat":37,"./fromRotation":38,"./fromRotationTranslation":39,"./fromScaling":40,"./fromTranslation":41,"./fromXRotation":42,"./fromYRotation":43,"./fromZRotation":44,"./frustum":45,"./identity":46,"./invert":48,"./lookAt":49,"./multiply":50,"./ortho":51,"./perspective":52,"./perspectiveFromFieldOfView":53,"./rotate":54,"./rotateX":55,"./rotateY":56,"./rotateZ":57,"./scale":58,"./str":59,"./translate":60,"./transpose":61}],48:[function(e,t,n){t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],d=t[11],p=t[12],m=t[13],g=t[14],v=t[15],b=n*s-r*a,y=n*u-i*a,x=n*c-o*a,_=r*u-i*s,w=r*c-o*s,M=i*c-o*u,k=l*m-f*p,E=l*g-h*p,A=l*v-d*p,C=f*g-h*m,S=f*v-d*m,T=h*v-d*g,D=b*T-y*S+x*C+_*A-w*E+M*k;if(!D)return null;return e[0]=(s*T-u*S+c*C)*(D=1/D),e[1]=(i*S-r*T-o*C)*D,e[2]=(m*M-g*w+v*_)*D,e[3]=(h*w-f*M-d*_)*D,e[4]=(u*A-a*T-c*E)*D,e[5]=(n*T-i*A+o*E)*D,e[6]=(g*x-p*M-v*y)*D,e[7]=(l*M-h*x+d*y)*D,e[8]=(a*S-s*A+c*k)*D,e[9]=(r*A-n*S-o*k)*D,e[10]=(p*w-m*x+v*b)*D,e[11]=(f*x-l*w-d*b)*D,e[12]=(s*E-a*C-u*k)*D,e[13]=(n*C-r*E+i*k)*D,e[14]=(m*y-p*_-g*b)*D,e[15]=(l*_-f*y+h*b)*D,e}},{}],49:[function(e,t,n){var r=e("./identity");t.exports=function(e,t,n,i){var o,a,s,u,c,l,f,h,d,p,m=t[0],g=t[1],v=t[2],b=i[0],y=i[1],x=i[2],_=n[0],w=n[1],M=n[2];if(Math.abs(m-_)<1e-6&&Math.abs(g-w)<1e-6&&Math.abs(v-M)<1e-6)return r(e);f=m-_,h=g-w,d=v-M,p=1/Math.sqrt(f*f+h*h+d*d),o=y*(d*=p)-x*(h*=p),a=x*(f*=p)-b*d,s=b*h-y*f,(p=Math.sqrt(o*o+a*a+s*s))?(o*=p=1/p,a*=p,s*=p):(o=0,a=0,s=0);u=h*s-d*a,c=d*o-f*s,l=f*a-h*o,(p=Math.sqrt(u*u+c*c+l*l))?(u*=p=1/p,c*=p,l*=p):(u=0,c=0,l=0);return e[0]=o,e[1]=u,e[2]=f,e[3]=0,e[4]=a,e[5]=c,e[6]=h,e[7]=0,e[8]=s,e[9]=l,e[10]=d,e[11]=0,e[12]=-(o*m+a*g+s*v),e[13]=-(u*m+c*g+l*v),e[14]=-(f*m+h*g+d*v),e[15]=1,e}},{"./identity":46}],50:[function(e,t,n){t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],d=t[10],p=t[11],m=t[12],g=t[13],v=t[14],b=t[15],y=n[0],x=n[1],_=n[2],w=n[3];return e[0]=y*r+x*s+_*f+w*m,e[1]=y*i+x*u+_*h+w*g,e[2]=y*o+x*c+_*d+w*v,e[3]=y*a+x*l+_*p+w*b,e[4]=(y=n[4])*r+(x=n[5])*s+(_=n[6])*f+(w=n[7])*m,e[5]=y*i+x*u+_*h+w*g,e[6]=y*o+x*c+_*d+w*v,e[7]=y*a+x*l+_*p+w*b,e[8]=(y=n[8])*r+(x=n[9])*s+(_=n[10])*f+(w=n[11])*m,e[9]=y*i+x*u+_*h+w*g,e[10]=y*o+x*c+_*d+w*v,e[11]=y*a+x*l+_*p+w*b,e[12]=(y=n[12])*r+(x=n[13])*s+(_=n[14])*f+(w=n[15])*m,e[13]=y*i+x*u+_*h+w*g,e[14]=y*o+x*c+_*d+w*v,e[15]=y*a+x*l+_*p+w*b,e}},{}],51:[function(e,t,n){t.exports=function(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(a+o)*c,e[15]=1,e}},{}],52:[function(e,t,n){t.exports=function(e,t,n,r,i){var o=1/Math.tan(t/2),a=1/(r-i);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*a,e[15]=0,e}},{}],53:[function(e,t,n){t.exports=function(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-s)*u*.5,e[9]=(i-o)*c*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}},{}],54:[function(e,t,n){t.exports=function(e,t,n,r){var i,o,a,s,u,c,l,f,h,d,p,m,g,v,b,y,x,_,w,M,k,E,A,C,S=r[0],T=r[1],D=r[2],R=Math.sqrt(S*S+T*T+D*D);if(Math.abs(R)<1e-6)return null;S*=R=1/R,T*=R,D*=R,i=Math.sin(n),o=Math.cos(n),u=t[1],c=t[2],l=t[3],h=t[5],d=t[6],p=t[7],g=t[9],v=t[10],b=t[11],w=S*T*(a=1-o)-D*i,M=T*T*a+o,k=D*T*a+S*i,E=S*D*a+T*i,A=T*D*a-S*i,C=D*D*a+o,e[0]=(s=t[0])*(y=S*S*a+o)+(f=t[4])*(x=T*S*a+D*i)+(m=t[8])*(_=D*S*a-T*i),e[1]=u*y+h*x+g*_,e[2]=c*y+d*x+v*_,e[3]=l*y+p*x+b*_,e[4]=s*w+f*M+m*k,e[5]=u*w+h*M+g*k,e[6]=c*w+d*M+v*k,e[7]=l*w+p*M+b*k,e[8]=s*E+f*A+m*C,e[9]=u*E+h*A+g*C,e[10]=c*E+d*A+v*C,e[11]=l*E+p*A+b*C,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);return e}},{}],55:[function(e,t,n){t.exports=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);return e[4]=o*i+c*r,e[5]=a*i+l*r,e[6]=s*i+f*r,e[7]=u*i+h*r,e[8]=c*i-o*r,e[9]=l*i-a*r,e[10]=f*i-s*r,e[11]=h*i-u*r,e}},{}],56:[function(e,t,n){t.exports=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],l=t[9],f=t[10],h=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);return e[0]=o*i-c*r,e[1]=a*i-l*r,e[2]=s*i-f*r,e[3]=u*i-h*r,e[8]=o*r+c*i,e[9]=a*r+l*i,e[10]=s*r+f*i,e[11]=u*r+h*i,e}},{}],57:[function(e,t,n){t.exports=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[4],l=t[5],f=t[6],h=t[7];t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);return e[0]=o*i+c*r,e[1]=a*i+l*r,e[2]=s*i+f*r,e[3]=u*i+h*r,e[4]=c*i-o*r,e[5]=l*i-a*r,e[6]=f*i-s*r,e[7]=h*i-u*r,e}},{}],58:[function(e,t,n){t.exports=function(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},{}],59:[function(e,t,n){t.exports=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}},{}],60:[function(e,t,n){t.exports=function(e,t,n){var r,i,o,a,s,u,c,l,f,h,d,p,m=n[0],g=n[1],v=n[2];t===e?(e[12]=t[0]*m+t[4]*g+t[8]*v+t[12],e[13]=t[1]*m+t[5]*g+t[9]*v+t[13],e[14]=t[2]*m+t[6]*g+t[10]*v+t[14],e[15]=t[3]*m+t[7]*g+t[11]*v+t[15]):(i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],d=t[10],p=t[11],e[0]=r=t[0],e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=f,e[9]=h,e[10]=d,e[11]=p,e[12]=r*m+s*g+f*v+t[12],e[13]=i*m+u*g+h*v+t[13],e[14]=o*m+c*g+d*v+t[14],e[15]=a*m+l*g+p*v+t[15]);return e}},{}],61:[function(e,t,n){t.exports=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}},{}],62:[function(e,t,n){t.exports=function(e,t,n,r){var i,o,a,s,u,c=t[0],l=t[1],f=t[2],h=t[3],d=n[0],p=n[1],m=n[2],g=n[3];(o=c*d+l*p+f*m+h*g)<0&&(o=-o,d=-d,p=-p,m=-m,g=-g);1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r);return e[0]=s*c+u*d,e[1]=s*l+u*p,e[2]=s*f+u*m,e[3]=s*h+u*g,e}},{}],63:[function(e,t,n){t.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}},{}],64:[function(e,t,n){t.exports=function(e,t){var n=r(e[0],e[1],e[2]),a=r(t[0],t[1],t[2]);i(n,n),i(a,a);var s=o(n,a);return s>1?0:Math.acos(s)};var r=e("./fromValues"),i=e("./normalize"),o=e("./dot")},{"./dot":74,"./fromValues":80,"./normalize":91}],65:[function(e,t,n){t.exports=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}},{}],66:[function(e,t,n){t.exports=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},{}],67:[function(e,t,n){t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},{}],68:[function(e,t,n){t.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},{}],69:[function(e,t,n){t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2];return e[0]=i*u-o*s,e[1]=o*a-r*u,e[2]=r*s-i*a,e}},{}],70:[function(e,t,n){t.exports=e("./distance")},{"./distance":71}],71:[function(e,t,n){t.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}},{}],72:[function(e,t,n){t.exports=e("./divide")},{"./divide":73}],73:[function(e,t,n){t.exports=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}},{}],74:[function(e,t,n){t.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},{}],75:[function(e,t,n){t.exports=1e-6},{}],76:[function(e,t,n){t.exports=function(e,t){var n=e[0],i=e[1],o=e[2],a=t[0],s=t[1],u=t[2];return Math.abs(n-a)<=r*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=r*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-u)<=r*Math.max(1,Math.abs(o),Math.abs(u))};var r=e("./epsilon")},{"./epsilon":75}],77:[function(e,t,n){t.exports=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},{}],78:[function(e,t,n){t.exports=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}},{}],79:[function(e,t,n){t.exports=function(e,t,n,i,o,a){var s,u;t||(t=3);n||(n=0);u=i?Math.min(i*t+n,e.length):e.length;for(s=n;s<u;s+=t)r[0]=e[s],r[1]=e[s+1],r[2]=e[s+2],o(r,r,a),e[s]=r[0],e[s+1]=r[1],e[s+2]=r[2];return e};var r=e("./create")()},{"./create":68}],80:[function(e,t,n){t.exports=function(e,t,n){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=n,r}},{}],81:[function(e,t,n){t.exports={EPSILON:e("./epsilon"),create:e("./create"),clone:e("./clone"),angle:e("./angle"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),equals:e("./equals"),exactEquals:e("./exactEquals"),add:e("./add"),subtract:e("./subtract"),sub:e("./sub"),multiply:e("./multiply"),mul:e("./mul"),divide:e("./divide"),div:e("./div"),min:e("./min"),max:e("./max"),floor:e("./floor"),ceil:e("./ceil"),round:e("./round"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),dist:e("./dist"),squaredDistance:e("./squaredDistance"),sqrDist:e("./sqrDist"),length:e("./length"),len:e("./len"),squaredLength:e("./squaredLength"),sqrLen:e("./sqrLen"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),cross:e("./cross"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformMat3:e("./transformMat3"),transformQuat:e("./transformQuat"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),forEach:e("./forEach")}},{"./add":63,"./angle":64,"./ceil":65,"./clone":66,"./copy":67,"./create":68,"./cross":69,"./dist":70,"./distance":71,"./div":72,"./divide":73,"./dot":74,"./epsilon":75,"./equals":76,"./exactEquals":77,"./floor":78,"./forEach":79,"./fromValues":80,"./inverse":82,"./len":83,"./length":84,"./lerp":85,"./max":86,"./min":87,"./mul":88,"./multiply":89,"./negate":90,"./normalize":91,"./random":92,"./rotateX":93,"./rotateY":94,"./rotateZ":95,"./round":96,"./scale":97,"./scaleAndAdd":98,"./set":99,"./sqrDist":100,"./sqrLen":101,"./squaredDistance":102,"./squaredLength":103,"./sub":104,"./subtract":105,"./transformMat3":106,"./transformMat4":107,"./transformQuat":108}],82:[function(e,t,n){t.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}},{}],83:[function(e,t,n){t.exports=e("./length")},{"./length":84}],84:[function(e,t,n){t.exports=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}},{}],85:[function(e,t,n){t.exports=function(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e}},{}],86:[function(e,t,n){t.exports=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}},{}],87:[function(e,t,n){t.exports=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}},{}],88:[function(e,t,n){t.exports=e("./multiply")},{"./multiply":89}],89:[function(e,t,n){t.exports=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}},{}],90:[function(e,t,n){t.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}},{}],91:[function(e,t,n){t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o);return e}},{}],92:[function(e,t,n){t.exports=function(e,t){t=t||1;var n=2*Math.random()*Math.PI,r=2*Math.random()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}},{}],93:[function(e,t,n){t.exports=function(e,t,n,r){var i=n[1],o=n[2],a=t[1]-i,s=t[2]-o,u=Math.sin(r),c=Math.cos(r);return e[0]=t[0],e[1]=i+a*c-s*u,e[2]=o+a*u+s*c,e}},{}],94:[function(e,t,n){t.exports=function(e,t,n,r){var i=n[0],o=n[2],a=t[0]-i,s=t[2]-o,u=Math.sin(r),c=Math.cos(r);return e[0]=i+s*u+a*c,e[1]=t[1],e[2]=o+s*c-a*u,e}},{}],95:[function(e,t,n){t.exports=function(e,t,n,r){var i=n[0],o=n[1],a=t[0]-i,s=t[1]-o,u=Math.sin(r),c=Math.cos(r);return e[0]=i+a*c-s*u,e[1]=o+a*u+s*c,e[2]=t[2],e}},{}],96:[function(e,t,n){t.exports=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}},{}],97:[function(e,t,n){t.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}},{}],98:[function(e,t,n){t.exports=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}},{}],99:[function(e,t,n){t.exports=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}},{}],100:[function(e,t,n){t.exports=e("./squaredDistance")},{"./squaredDistance":102}],101:[function(e,t,n){t.exports=e("./squaredLength")},{"./squaredLength":103}],102:[function(e,t,n){t.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}},{}],103:[function(e,t,n){t.exports=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}},{}],104:[function(e,t,n){t.exports=e("./subtract")},{"./subtract":105}],105:[function(e,t,n){t.exports=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}},{}],106:[function(e,t,n){t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e}},{}],107:[function(e,t,n){t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/(a=a||1),e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,e}},{}],108:[function(e,t,n){t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,f=c*i+u*r-a*o,h=c*o+a*i-s*r,d=-a*r-s*i-u*o;return e[0]=l*c+d*-a+f*-u-h*-s,e[1]=f*c+d*-s+h*-a-l*-u,e[2]=h*c+d*-u+l*-s-f*-a,e}},{}],109:[function(e,t,n){"use strict";var r=e("is-browser");t.exports=r&&function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=!1}return e}()},{"is-browser":110}],110:[function(e,t,n){t.exports=!0},{}],111:[function(e,t,n){"use strict";function r(e,t,n){var r,a,s,u,c,l=e.length,f=o(e[0],t),h=[];for(n||(n=[]),r=1;r<l;r++){for(a=e[r-1],u=c=o(s=e[r],t);;){if(!(f|u)){h.push(a),u!==c?(h.push(s),r<l-1&&(n.push(h),h=[])):r===l-1&&h.push(s);break}if(f&u)break;f?f=o(a=i(a,s,f,t),t):u=o(s=i(a,s,u,t),t)}f=c}return h.length&&n.push(h),n}function i(e,t,n,r){return 8&n?[e[0]+(t[0]-e[0])*(r[3]-e[1])/(t[1]-e[1]),r[3]]:4&n?[e[0]+(t[0]-e[0])*(r[1]-e[1])/(t[1]-e[1]),r[1]]:2&n?[r[2],e[1]+(t[1]-e[1])*(r[2]-e[0])/(t[0]-e[0])]:1&n?[r[0],e[1]+(t[1]-e[1])*(r[0]-e[0])/(t[0]-e[0])]:null}function o(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}t.exports=r,r.polyline=r,r.polygon=function(e,t){var n,r,a,s,u,c,l;for(r=1;r<=8;r*=2){for(n=[],s=!(o(a=e[e.length-1],t)&r),u=0;u<e.length;u++)(l=!(o(c=e[u],t)&r))!==s&&n.push(i(a,c,r,t)),l&&n.push(c),a=c,s=l;if(!(e=n).length)break}return n}},{}],112:[function(e,t,n){var r=e("./normalize"),i=e("gl-mat4/create"),o=e("gl-mat4/clone"),a=e("gl-mat4/determinant"),s=e("gl-mat4/invert"),u=e("gl-mat4/transpose"),c={length:e("gl-vec3/length"),normalize:e("gl-vec3/normalize"),dot:e("gl-vec3/dot"),cross:e("gl-vec3/cross")},l=i(),f=i(),h=[0,0,0,0],d=[[0,0,0],[0,0,0],[0,0,0]],p=[0,0,0];function m(e,t,n,r,i){e[0]=t[0]*r+n[0]*i,e[1]=t[1]*r+n[1]*i,e[2]=t[2]*r+n[2]*i}t.exports=function(e,t,n,i,g,v){if(t||(t=[0,0,0]),n||(n=[0,0,0]),i||(i=[0,0,0]),g||(g=[0,0,0,1]),v||(v=[0,0,0,1]),!r(l,e))return!1;if(o(f,l),f[3]=0,f[7]=0,f[11]=0,f[15]=1,Math.abs(a(f)<1e-8))return!1;var b,y,x,_,w,M,k,E=l[3],A=l[7],C=l[11],S=l[12],T=l[13],D=l[14],R=l[15];if(0!==E||0!==A||0!==C){if(h[0]=E,h[1]=A,h[2]=C,h[3]=R,!s(f,f))return!1;u(f,f),(b=g)[0]=(x=f)[0]*(_=(y=h)[0])+x[4]*(w=y[1])+x[8]*(M=y[2])+x[12]*(k=y[3]),b[1]=x[1]*_+x[5]*w+x[9]*M+x[13]*k,b[2]=x[2]*_+x[6]*w+x[10]*M+x[14]*k,b[3]=x[3]*_+x[7]*w+x[11]*M+x[15]*k}else g[0]=g[1]=g[2]=0,g[3]=1;if(t[0]=S,t[1]=T,t[2]=D,function(e,t){e[0][0]=t[0],e[0][1]=t[1],e[0][2]=t[2],e[1][0]=t[4],e[1][1]=t[5],e[1][2]=t[6],e[2][0]=t[8],e[2][1]=t[9],e[2][2]=t[10]}(d,l),n[0]=c.length(d[0]),c.normalize(d[0],d[0]),i[0]=c.dot(d[0],d[1]),m(d[1],d[1],d[0],1,-i[0]),n[1]=c.length(d[1]),c.normalize(d[1],d[1]),i[0]/=n[1],i[1]=c.dot(d[0],d[2]),m(d[2],d[2],d[0],1,-i[1]),i[2]=c.dot(d[1],d[2]),m(d[2],d[2],d[1],1,-i[2]),n[2]=c.length(d[2]),c.normalize(d[2],d[2]),i[1]/=n[2],i[2]/=n[2],c.cross(p,d[1],d[2]),c.dot(d[0],p)<0)for(var O=0;O<3;O++)n[O]*=-1,d[O][0]*=-1,d[O][1]*=-1,d[O][2]*=-1;return v[0]=.5*Math.sqrt(Math.max(1+d[0][0]-d[1][1]-d[2][2],0)),v[1]=.5*Math.sqrt(Math.max(1-d[0][0]+d[1][1]-d[2][2],0)),v[2]=.5*Math.sqrt(Math.max(1-d[0][0]-d[1][1]+d[2][2],0)),v[3]=.5*Math.sqrt(Math.max(1+d[0][0]+d[1][1]+d[2][2],0)),d[2][1]>d[1][2]&&(v[0]=-v[0]),d[0][2]>d[2][0]&&(v[1]=-v[1]),d[1][0]>d[0][1]&&(v[2]=-v[2]),!0}},{"./normalize":113,"gl-mat4/clone":33,"gl-mat4/create":35,"gl-mat4/determinant":36,"gl-mat4/invert":48,"gl-mat4/transpose":61,"gl-vec3/cross":69,"gl-vec3/dot":74,"gl-vec3/length":84,"gl-vec3/normalize":91}],113:[function(e,t,n){t.exports=function(e,t){var n=t[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)e[i]=t[i]*r;return!0}},{}],114:[function(e,t,n){var r=e("gl-vec3/lerp"),i=e("mat4-recompose"),o=e("mat4-decompose"),a=e("gl-mat4/determinant"),s=e("quat-slerp"),u=f(),c=f(),l=f();function f(){return{translate:h(),scale:h(1),skew:h(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function h(e){return[e||0,e||0,e||0]}t.exports=function(e,t,n,f){if(0===a(t)||0===a(n))return!1;var h=o(t,u.translate,u.scale,u.skew,u.perspective,u.quaternion),d=o(n,c.translate,c.scale,c.skew,c.perspective,c.quaternion);return!(!h||!d||(r(l.translate,u.translate,c.translate,f),r(l.skew,u.skew,c.skew,f),r(l.scale,u.scale,c.scale,f),r(l.perspective,u.perspective,c.perspective,f),s(l.quaternion,u.quaternion,c.quaternion,f),i(e,l.translate,l.scale,l.skew,l.perspective,l.quaternion),0))}},{"gl-mat4/determinant":36,"gl-vec3/lerp":85,"mat4-decompose":112,"mat4-recompose":115,"quat-slerp":128}],115:[function(e,t,n){var r={identity:e("gl-mat4/identity"),translate:e("gl-mat4/translate"),multiply:e("gl-mat4/multiply"),create:e("gl-mat4/create"),scale:e("gl-mat4/scale"),fromRotationTranslation:e("gl-mat4/fromRotationTranslation")},i=(r.create(),r.create());t.exports=function(e,t,n,o,a,s){return r.identity(e),r.fromRotationTranslation(e,s,t),e[3]=a[0],e[7]=a[1],e[11]=a[2],e[15]=a[3],r.identity(i),0!==o[2]&&(i[9]=o[2],r.multiply(e,e,i)),0!==o[1]&&(i[9]=0,i[8]=o[1],r.multiply(e,e,i)),0!==o[0]&&(i[8]=0,i[4]=o[0],r.multiply(e,e,i)),r.scale(e,e,n),e}},{"gl-mat4/create":35,"gl-mat4/fromRotationTranslation":39,"gl-mat4/identity":46,"gl-mat4/multiply":50,"gl-mat4/scale":58,"gl-mat4/translate":60}],116:[function(e,t,n){"use strict";var r=e("binary-search-bounds"),i=e("mat4-interpolate"),o=e("gl-mat4/invert"),a=e("gl-mat4/rotateX"),s=e("gl-mat4/rotateY"),u=e("gl-mat4/rotateZ"),c=e("gl-mat4/lookAt"),l=e("gl-mat4/translate"),f=(e("gl-mat4/scale"),e("gl-vec3/normalize")),h=[0,0,0];function d(e){this._components=e.slice(),this._time=[0],this.prevMatrix=e.slice(),this.nextMatrix=e.slice(),this.computedMatrix=e.slice(),this.computedInverse=e.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-Infinity,Infinity]}t.exports=function(e){return new d((e=e||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};var p=d.prototype;p.recalcMatrix=function(e){var t=this._time,n=r.le(t,e),a=this.computedMatrix;if(!(n<0)){var s=this._components;if(n===t.length-1)for(var u=16*n,c=0;c<16;++c)a[c]=s[u++];else{var l=t[n+1]-t[n],h=(u=16*n,this.prevMatrix),d=!0;for(c=0;c<16;++c)h[c]=s[u++];var p=this.nextMatrix;for(c=0;c<16;++c)p[c]=s[u++],d=d&&h[c]===p[c];if(l<1e-6||d)for(c=0;c<16;++c)a[c]=h[c];else i(a,h,p,(e-t[n])/l)}var m=this.computedUp;m[0]=a[1],m[1]=a[5],m[2]=a[9],f(m,m);var g=this.computedInverse;o(g,a);var v=this.computedEye,b=g[15];v[0]=g[12]/b,v[1]=g[13]/b,v[2]=g[14]/b;var y=this.computedCenter,x=Math.exp(this.computedRadius[0]);for(c=0;c<3;++c)y[c]=v[c]-a[2+4*c]*x}},p.idle=function(e){if(!(e<this.lastT())){for(var t=this._components,n=t.length-16,r=0;r<16;++r)t.push(t[n++]);this._time.push(e)}},p.flush=function(e){var t=r.gt(this._time,e)-2;t<0||(this._time.splice(0,t),this._components.splice(0,16*t))},p.lastT=function(){return this._time[this._time.length-1]},p.lookAt=function(e,t,n,r){this.recalcMatrix(e),this.setMatrix(e,c(this.computedMatrix,t=t||this.computedEye,n=n||h,r=r||this.computedUp));for(var i=0,o=0;o<3;++o)i+=Math.pow(n[o]-t[o],2);i=Math.log(Math.sqrt(i)),this.computedRadius[0]=i},p.rotate=function(e,t,n,r){this.recalcMatrix(e);var i=this.computedInverse;t&&s(i,i,t),n&&a(i,i,n),r&&u(i,i,r),this.setMatrix(e,o(this.computedMatrix,i))};var m=[0,0,0];p.pan=function(e,t,n,r){m[0]=-(t||0),m[1]=-(n||0),m[2]=-(r||0),this.recalcMatrix(e);var i=this.computedInverse;l(i,i,m),this.setMatrix(e,o(i,i))},p.translate=function(e,t,n,r){m[0]=t||0,m[1]=n||0,m[2]=r||0,this.recalcMatrix(e);var i=this.computedMatrix;l(i,i,m),this.setMatrix(e,i)},p.setMatrix=function(e,t){if(!(e<this.lastT())){this._time.push(e);for(var n=0;n<16;++n)this._components.push(t[n])}},p.setDistance=function(e,t){this.computedRadius[0]=t},p.setDistanceLimits=function(e,t){var n=this._limits;n[0]=e,n[1]=t},p.getDistanceLimits=function(e){var t=this._limits;return e?(e[0]=t[0],e[1]=t[1],e):t}},{"binary-search-bounds":4,"gl-mat4/invert":48,"gl-mat4/lookAt":49,"gl-mat4/rotateX":55,"gl-mat4/rotateY":56,"gl-mat4/rotateZ":57,"gl-mat4/scale":58,"gl-mat4/translate":60,"gl-vec3/normalize":91,"mat4-interpolate":114}],117:[function(e,t,n){"use strict";t.exports=function(e,t){t||(t=e,e=window);var n=0,i=0,o=0,a={shift:!1,alt:!1,control:!1,meta:!1},s=!1;function u(e){var t=!1;return"altKey"in e&&(t=t||e.altKey!==a.alt,a.alt=!!e.altKey),"shiftKey"in e&&(t=t||e.shiftKey!==a.shift,a.shift=!!e.shiftKey),"ctrlKey"in e&&(t=t||e.ctrlKey!==a.control,a.control=!!e.ctrlKey),"metaKey"in e&&(t=t||e.metaKey!==a.meta,a.meta=!!e.metaKey),t}function c(e,s){var c=r.x(s),l=r.y(s);"buttons"in s&&(e=0|s.buttons),(e!==n||c!==i||l!==o||u(s))&&(n=0|e,i=c||0,o=l||0,t&&t(n,i,o,a))}function l(e){c(0,e)}function f(){(n||i||o||a.shift||a.alt||a.meta||a.control)&&(i=o=0,n=0,a.shift=a.alt=a.control=a.meta=!1,t&&t(0,0,0,a))}function h(e){u(e)&&t&&t(n,i,o,a)}function d(e){0===r.buttons(e)?c(0,e):c(n,e)}function p(e){c(n|r.buttons(e),e)}function m(e){c(n&~r.buttons(e),e)}function g(){s||(s=!0,e.addEventListener("mousemove",d),e.addEventListener("mousedown",p),e.addEventListener("mouseup",m),e.addEventListener("mouseleave",l),e.addEventListener("mouseenter",l),e.addEventListener("mouseout",l),e.addEventListener("mouseover",l),e.addEventListener("blur",f),e.addEventListener("keyup",h),e.addEventListener("keydown",h),e.addEventListener("keypress",h),e!==window&&(window.addEventListener("blur",f),window.addEventListener("keyup",h),window.addEventListener("keydown",h),window.addEventListener("keypress",h)))}g();var v={element:e};return Object.defineProperties(v,{enabled:{get:function(){return s},set:function(t){t?g():s&&(s=!1,e.removeEventListener("mousemove",d),e.removeEventListener("mousedown",p),e.removeEventListener("mouseup",m),e.removeEventListener("mouseleave",l),e.removeEventListener("mouseenter",l),e.removeEventListener("mouseout",l),e.removeEventListener("mouseover",l),e.removeEventListener("blur",f),e.removeEventListener("keyup",h),e.removeEventListener("keydown",h),e.removeEventListener("keypress",h),e!==window&&(window.removeEventListener("blur",f),window.removeEventListener("keyup",h),window.removeEventListener("keydown",h),window.removeEventListener("keypress",h)))},enumerable:!0},buttons:{get:function(){return n},enumerable:!0},x:{get:function(){return i},enumerable:!0},y:{get:function(){return o},enumerable:!0},mods:{get:function(){return a},enumerable:!0}}),v};var r=e("mouse-event")},{"mouse-event":119}],118:[function(e,t,n){var r={left:0,top:0};t.exports=function(e,t,n){t=t||e.currentTarget||e.srcElement,Array.isArray(n)||(n=[0,0]);var i=e.clientX||0,o=e.clientY||0,a=(s=t,s===window||s===document||s===document.body?r:s.getBoundingClientRect());var s;return n[0]=i-a.left,n[1]=o-a.top,n}},{}],119:[function(e,t,n){"use strict";function r(e){return e.target||e.srcElement||window}n.buttons=function(e){if("object"==typeof e){if("buttons"in e)return e.buttons;if("which"in e){if(2===(t=e.which))return 4;if(3===t)return 2;if(t>0)return 1<<t-1}else if("button"in e){var t;if(1===(t=e.button))return 4;if(2===t)return 2;if(t>=0)return 1<<t}}return 0},n.element=r,n.x=function(e){if("object"==typeof e){if("offsetX"in e)return e.offsetX;var t=r(e).getBoundingClientRect();return e.clientX-t.left}return 0},n.y=function(e){if("object"==typeof e){if("offsetY"in e)return e.offsetY;var t=r(e).getBoundingClientRect();return e.clientY-t.top}return 0}},{}],120:[function(e,t,n){"use strict";var r=e("to-px");t.exports=function(e,t,n){"function"==typeof e&&(n=!!t,t=e,e=window);var i=r("ex",e),o=function(e){n&&e.preventDefault();var r=e.deltaX||0,o=e.deltaY||0,a=e.deltaZ||0,s=e.deltaMode,u=1;switch(s){case 1:u=i;break;case 2:u=window.innerHeight}if(o*=u,a*=u,(r*=u)||o||a)return t(r,o,a,e)};return e.addEventListener("wheel",o),o}},{"to-px":134}],121:[function(e,t,n){"use strict";t.exports=function(e,t,n,r,i,o,a,s,u,c){var l=t+o+c;if(f>0){var f=Math.sqrt(l+1);e[0]=.5*(a-u)/f,e[1]=.5*(s-r)/f,e[2]=.5*(n-o)/f,e[3]=.5*f}else{var h=Math.max(t,o,c),f=Math.sqrt(2*h-l+1);t>=h?(e[0]=.5*f,e[1]=.5*(i+n)/f,e[2]=.5*(s+r)/f,e[3]=.5*(a-u)/f):o>=h?(e[0]=.5*(n+i)/f,e[1]=.5*f,e[2]=.5*(u+a)/f,e[3]=.5*(s-r)/f):(e[0]=.5*(r+s)/f,e[1]=.5*(a+u)/f,e[2]=.5*f,e[3]=.5*(n-i)/f)}return e}},{}],122:[function(e,t,n){"use strict";t.exports=function(e){var t=(e=e||{}).center||[0,0,0],n=e.rotation||[0,0,0,1],r=e.radius||1;t=[].slice.call(t,0,3),l(n=[].slice.call(n,0,4),n);var i=new f(n,t,Math.log(r));i.setDistanceLimits(e.zoomMin,e.zoomMax),("eye"in e||"up"in e)&&i.lookAt(0,e.eye,e.center,e.up);return i};var r=e("filtered-vector"),i=e("gl-mat4/lookAt"),o=e("gl-mat4/fromQuat"),a=e("gl-mat4/invert"),s=e("./lib/quatFromFrame");function u(e,t,n){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(n,2))}function c(e,t,n,r){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(n,2)+Math.pow(r,2))}function l(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=c(n,r,i,o);a>1e-6?(e[0]=n/a,e[1]=r/a,e[2]=i/a,e[3]=o/a):(e[0]=e[1]=e[2]=0,e[3]=1)}function f(e,t,n){this.radius=r([n]),this.center=r(t),this.rotation=r(e),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var h=f.prototype;h.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},h.recalcMatrix=function(e){this.radius.curve(e),this.center.curve(e),this.rotation.curve(e);var t=this.computedRotation;l(t,t);var n=this.computedMatrix;o(n,t);var r=this.computedCenter,i=this.computedEye,a=this.computedUp,s=Math.exp(this.computedRadius[0]);i[0]=r[0]+s*n[2],i[1]=r[1]+s*n[6],i[2]=r[2]+s*n[10],a[0]=n[1],a[1]=n[5],a[2]=n[9];for(var u=0;u<3;++u){for(var c=0,f=0;f<3;++f)c+=n[u+4*f]*i[f];n[12+u]=-c}},h.getMatrix=function(e,t){this.recalcMatrix(e);var n=this.computedMatrix;if(t){for(var r=0;r<16;++r)t[r]=n[r];return t}return n},h.idle=function(e){this.center.idle(e),this.radius.idle(e),this.rotation.idle(e)},h.flush=function(e){this.center.flush(e),this.radius.flush(e),this.rotation.flush(e)},h.pan=function(e,t,n,r){t=t||0,n=n||0,r=r||0,this.recalcMatrix(e);var i=this.computedMatrix,o=i[1],a=i[5],s=i[9],c=u(o,a,s),l=i[0],f=i[4],h=i[8],d=l*(o/=c)+f*(a/=c)+h*(s/=c),p=u(l-=o*d,f-=a*d,h-=s*d),m=i[2],g=i[6],v=i[10],b=m*o+g*a+v*s,y=m*(l/=p)+g*(f/=p)+v*(h/=p),x=u(m-=b*o+y*l,g-=b*a+y*f,v-=b*s+y*h);m/=x,g/=x,v/=x,this.center.move(e,l*t+o*n,f*t+a*n,h*t+s*n);var _=Math.exp(this.computedRadius[0]);_=Math.max(1e-4,_+r),this.radius.set(e,Math.log(_))},h.rotate=function(e,t,n,r){this.recalcMatrix(e);var i=this.computedMatrix,o=i[2],a=i[6],s=i[10],l=(t=t||0)*i[0]+(n=n||0)*i[1],f=t*i[4]+n*i[5],h=t*i[8]+n*i[9],d=-(a*h-s*f),p=-(s*l-o*h),m=-(o*f-a*l),g=Math.sqrt(Math.max(0,1-Math.pow(d,2)-Math.pow(p,2)-Math.pow(m,2))),v=c(d,p,m,g);v>1e-6?(d/=v,p/=v,m/=v,g/=v):(d=p=m=0,g=1);var b=this.computedRotation,y=b[0],x=b[1],_=b[2],w=b[3],M=y*g+w*d+x*m-_*p,k=x*g+w*p+_*d-y*m,E=_*g+w*m+y*p-x*d,A=w*g-y*d-x*p-_*m;if(r){d=o,p=a,m=s;var C=Math.sin(r)/u(d,p,m);d*=C,p*=C,m*=C,A=A*(g=Math.cos(t))-(M=M*g+A*d+k*m-E*p)*d-(k=k*g+A*p+E*d-M*m)*p-(E=E*g+A*m+M*p-k*d)*m}var S=c(M,k,E,A);S>1e-6?(M/=S,k/=S,E/=S,A/=S):(M=k=E=0,A=1),this.rotation.set(e,M,k,E,A)},h.lookAt=function(e,t,n,r){this.recalcMatrix(e);var o=this.computedMatrix;i(o,t=t||this.computedEye,n=n||this.computedCenter,r=r||this.computedUp);var a=this.computedRotation;s(a,o[0],o[1],o[2],o[4],o[5],o[6],o[8],o[9],o[10]),l(a,a),this.rotation.set(e,a[0],a[1],a[2],a[3]);for(var u=0,c=0;c<3;++c)u+=Math.pow(n[c]-t[c],2);this.radius.set(e,.5*Math.log(Math.max(u,1e-6))),this.center.set(e,n[0],n[1],n[2])},h.translate=function(e,t,n,r){this.center.move(e,t||0,n||0,r||0)},h.setMatrix=function(e,t){var n=this.computedRotation;s(n,t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]),l(n,n),this.rotation.set(e,n[0],n[1],n[2],n[3]);var r=this.computedMatrix;a(r,t);var i=r[15];if(Math.abs(i)>1e-6){var o=r[12]/i,u=r[13]/i,c=r[14]/i;this.recalcMatrix(e);var f=Math.exp(this.computedRadius[0]);this.center.set(e,o-r[2]*f,u-r[6]*f,c-r[10]*f),this.radius.idle(e)}else this.center.idle(e),this.radius.idle(e)},h.setDistance=function(e,t){t>0&&this.radius.set(e,Math.log(t))},h.setDistanceLimits=function(e,t){e=e>0?Math.log(e):-Infinity,t=t>0?Math.log(t):Infinity,t=Math.max(t,e),this.radius.bounds[0][0]=e,this.radius.bounds[1][0]=t},h.getDistanceLimits=function(e){var t=this.radius.bounds;return e?(e[0]=Math.exp(t[0][0]),e[1]=Math.exp(t[1][0]),e):[Math.exp(t[0][0]),Math.exp(t[1][0])]},h.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},h.fromJSON=function(e){var t=this.lastT(),n=e.center;n&&this.center.set(t,n[0],n[1],n[2]);var r=e.rotation;r&&this.rotation.set(t,r[0],r[1],r[2],r[3]);var i=e.distance;i&&i>0&&this.radius.set(t,Math.log(i)),this.setDistanceLimits(e.zoomMin,e.zoomMax)}},{"./lib/quatFromFrame":121,"filtered-vector":29,"gl-mat4/fromQuat":37,"gl-mat4/invert":48,"gl-mat4/lookAt":49}],123:[function(e,t,n){var r=e("color-convert");t.exports=function(e){var t,n,i,o;if(t=/^((?:rgb|hs[lv]|cmyk|xyz|lab)a?)\s*\(([^\)]*)\)/.exec(e)){var a=t[1],s="cmyk"===(u=a.replace(/a$/,""))?4:3;n=r[u],i=t[2].replace(/^\s+|\s+$/g,"").split(/\s*,\s*/).map(function(e,t){return/%$/.test(e)&&t===s?parseFloat(e)/100:(/%$/.test(e),parseFloat(e))}),a===u&&i.push(1),o=void 0===i[s]?1:i[s],i=i.slice(0,s),n[u]=function(){return i}}else if(/^#[A-Fa-f0-9]+$/.test(e)){var u=e.replace(/^#/,"");n=r.rgb,i=(i=u.split(3===(s=u.length)?/(.)/:/(..)/)).filter(Boolean).map(function(e){return 3===s?parseInt(e+e,16):parseInt(e,16)}),o=1,n.rgb=function(){return i},i[0]||(i[0]=0),i[1]||(i[1]=0),i[2]||(i[2]=0)}else(n=r.keyword).keyword=function(){return e},i=e,o=1;var c={rgb:void 0,hsl:void 0,hsv:void 0,cmyk:void 0,keyword:void 0,hex:void 0};try{c.rgb=n.rgb(i)}catch(e){}try{c.hsl=n.hsl(i)}catch(e){}try{c.hsv=n.hsv(i)}catch(e){}try{c.cmyk=n.cmyk(i)}catch(e){}try{c.keyword=n.keyword(i)}catch(e){}return c.rgb&&(c.hex="#"+c.rgb.map(function(e){var t=e.toString(16);return 1===t.length?"0"+t:t}).join("")),c.rgb&&(c.rgba=c.rgb.concat(o)),c.hsl&&(c.hsla=c.hsl.concat(o)),c.hsv&&(c.hsva=c.hsv.concat(o)),c.cmyk&&(c.cmyka=c.cmyk.concat(o)),c}},{"color-convert":125}],124:[function(e,t,n){function i(e){var t,n,r=e[0]/255,i=e[1]/255,o=e[2]/255,a=Math.min(r,i,o),s=Math.max(r,i,o),u=s-a;return s==a?t=0:r==s?t=(i-o)/u:i==s?t=2+(o-r)/u:o==s&&(t=4+(r-i)/u),(t=Math.min(60*t,360))<0&&(t+=360),n=(a+s)/2,[t,100*(s==a?0:n<=.5?u/(s+a):u/(2-s-a)),100*n]}function o(e){var t,n,r=e[0],i=e[1],o=e[2],a=Math.min(r,i,o),s=Math.max(r,i,o),u=s-a;return n=0==s?0:u/s*1e3/10,s==a?t=0:r==s?t=(i-o)/u:i==s?t=2+(o-r)/u:o==s&&(t=4+(r-i)/u),(t=Math.min(60*t,360))<0&&(t+=360),[t,n,s/255*1e3/10]}function a(e){var t=e[0],n=e[1],r=e[2];return[i(e)[0],100*(1/255*Math.min(t,Math.min(n,r))),100*(r=1-1/255*Math.max(t,Math.max(n,r)))]}function s(e){var t,n=e[0]/255,r=e[1]/255,i=e[2]/255;return[100*((1-n-(t=Math.min(1-n,1-r,1-i)))/(1-t)||0),100*((1-r-t)/(1-t)||0),100*((1-i-t)/(1-t)||0),100*t]}function u(e){return E[JSON.stringify(e)]}function c(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*t+.7152*n+.0722*r),100*(.0193*t+.1192*n+.9505*r)]}function l(e){var t=c(e),n=t[0],r=t[1],i=t[2];return r/=100,i/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(n-r),200*(r-(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116))]}function f(e){var t,n,r,i,o,a=e[0]/360,s=e[1]/100,u=e[2]/100;if(0==s)return[o=255*u,o,o];t=2*u-(n=u<.5?u*(1+s):u+s-u*s),i=[0,0,0];for(var c=0;c<3;c++)(r=a+1/3*-(c-1))<0&&r++,r>1&&r--,i[c]=255*(o=6*r<1?t+6*(n-t)*r:2*r<1?n:3*r<2?t+(n-t)*(2/3-r)*6:t);return i}function h(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,i=Math.floor(t)%6,o=t-Math.floor(t),a=255*r*(1-n),s=255*r*(1-n*o),u=255*r*(1-n*(1-o));r*=255;switch(i){case 0:return[r,u,a];case 1:return[s,r,a];case 2:return[a,r,u];case 3:return[a,s,r];case 4:return[u,a,r];case 5:return[r,a,s]}}function d(e){var t,n,i,o,a=e[0]/360,s=e[1]/100,u=e[2]/100,c=s+u;switch(c>1&&(s/=c,u/=c),i=6*a-(t=Math.floor(6*a)),0!=(1&t)&&(i=1-i),o=s+i*((n=1-u)-s),t){default:case 6:case 0:r=n,g=o,b=s;break;case 1:r=o,g=n,b=s;break;case 2:r=s,g=n,b=o;break;case 3:r=s,g=o,b=n;break;case 4:r=o,g=s,b=n;break;case 5:r=n,g=s,b=o}return[255*r,255*g,255*b]}function p(e){var t=e[1]/100,n=e[2]/100,r=e[3]/100;return[255*(1-Math.min(1,e[0]/100*(1-r)+r)),255*(1-Math.min(1,t*(1-r)+r)),255*(1-Math.min(1,n*(1-r)+r))]}function m(e){var t,n,r,i=e[0]/100,o=e[1]/100,a=e[2]/100;return n=-.9689*i+1.8758*o+.0415*a,r=.0557*i+-.204*o+1.057*a,t=(t=3.2406*i+-1.5372*o+-.4986*a)>.0031308?1.055*Math.pow(t,1/2.4)-.055:t*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,[255*(t=Math.min(Math.max(0,t),1)),255*(n=Math.min(Math.max(0,n),1)),255*(r=Math.min(Math.max(0,r),1))]}function v(e){var t=e[0],n=e[1],r=e[2];return n/=100,r/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(t-n),200*(n-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]}function y(e){var t,n,r,i,o=e[0],a=e[1],s=e[2];return o<=8?i=(n=100*o/903.3)/100*7.787+16/116:(n=100*Math.pow((o+16)/116,3),i=Math.pow(n/100,1/3)),[t=t/95.047<=.008856?t=95.047*(a/500+i-16/116)/7.787:95.047*Math.pow(a/500+i,3),n,r=r/108.883<=.008859?r=108.883*(i-s/200-16/116)/7.787:108.883*Math.pow(i-s/200,3)]}function x(e){var t,n=e[0],r=e[1],i=e[2];return(t=360*Math.atan2(i,r)/2/Math.PI)<0&&(t+=360),[n,Math.sqrt(r*r+i*i),t]}function _(e){return m(y(e))}function w(e){var t,n=e[1];return t=e[2]/360*2*Math.PI,[e[0],n*Math.cos(t),n*Math.sin(t)]}function M(e){return k[e]}t.exports={rgb2hsl:i,rgb2hsv:o,rgb2hwb:a,rgb2cmyk:s,rgb2keyword:u,rgb2xyz:c,rgb2lab:l,rgb2lch:function(e){return x(l(e))},hsl2rgb:f,hsl2hsv:function(e){var t=e[0],n=e[1]/100,r=e[2]/100;if(0===r)return[0,0,0];return[t,100*(2*(n*=(r*=2)<=1?r:2-r)/(r+n)),100*((r+n)/2)]},hsl2hwb:function(e){return a(f(e))},hsl2cmyk:function(e){return s(f(e))},hsl2keyword:function(e){return u(f(e))},hsv2rgb:h,hsv2hsl:function(e){var t,n,r=e[1]/100,i=e[2]/100;return t=r*i,[e[0],100*(t=(t/=(n=(2-r)*i)<=1?n:2-n)||0),100*(n/=2)]},hsv2hwb:function(e){return a(h(e))},hsv2cmyk:function(e){return s(h(e))},hsv2keyword:function(e){return u(h(e))},hwb2rgb:d,hwb2hsl:function(e){return i(d(e))},hwb2hsv:function(e){return o(d(e))},hwb2cmyk:function(e){return s(d(e))},hwb2keyword:function(e){return u(d(e))},cmyk2rgb:p,cmyk2hsl:function(e){return i(p(e))},cmyk2hsv:function(e){return o(p(e))},cmyk2hwb:function(e){return a(p(e))},cmyk2keyword:function(e){return u(p(e))},keyword2rgb:M,keyword2hsl:function(e){return i(M(e))},keyword2hsv:function(e){return o(M(e))},keyword2hwb:function(e){return a(M(e))},keyword2cmyk:function(e){return s(M(e))},keyword2lab:function(e){return l(M(e))},keyword2xyz:function(e){return c(M(e))},xyz2rgb:m,xyz2lab:v,xyz2lch:function(e){return x(v(e))},lab2xyz:y,lab2rgb:_,lab2lch:x,lch2lab:w,lch2xyz:function(e){return y(w(e))},lch2rgb:function(e){return _(w(e))}};var k={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},E={};for(var A in k)E[JSON.stringify(k[A])]=A},{}],125:[function(e,t,n){var r=e("./conversions"),i=function(){return new c};for(var o in r){i[o+"Raw"]=function(e){return function(t){return"number"==typeof t&&(t=Array.prototype.slice.call(arguments)),r[e](t)}}(o);var a=/(\w+)2(\w+)/.exec(o),s=a[1],u=a[2];(i[s]=i[s]||{})[u]=i[o]=function(e){return function(t){"number"==typeof t&&(t=Array.prototype.slice.call(arguments));var n=r[e](t);if("string"==typeof n||void 0===n)return n;for(var i=0;i<n.length;i++)n[i]=Math.round(n[i]);return n}}(o)}var c=function(){this.convs={}};c.prototype.routeSpace=function(e,t){var n=t[0];return void 0===n?this.getValues(e):("number"==typeof n&&(n=Array.prototype.slice.call(t)),this.setValues(e,n))},c.prototype.setValues=function(e,t){return this.space=e,this.convs={},this.convs[e]=t,this},c.prototype.getValues=function(e){var t=this.convs[e];if(!t){var n=this.space;t=i[n][e](this.convs[n]),this.convs[e]=t}return t},["rgb","hsl","hsv","cmyk","keyword"].forEach(function(e){c.prototype[e]=function(t){return this.routeSpace(e,arguments)}}),t.exports=i},{"./conversions":124}],126:[function(e,t,n){t.exports=function(e,t){t||(t=[0,""]),e=String(e);var n=parseFloat(e,10);return t[0]=n,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t}},{}],127:[function(e,t,n){t.exports=function(e){e=void 0!==e?e:1,Array.isArray(e)||(e=[e,e]);var t=[[-e[0],-e[1],0],[e[0],-e[1],0],[e[0],e[1],0],[-e[0],e[1],0]],n=[0,0,-1],r=[n.slice(),n.slice(),n.slice(),n.slice()];return{positions:t,cells:[[0,1,2],[2,3,0]],uvs:[[0,0],[1,0],[1,1],[0,1]],normals:r}}},{}],128:[function(e,t,n){t.exports=e("gl-quat/slerp")},{"gl-quat/slerp":62}],129:[function(e,t,n){var r,i;r=this,i=function(){function e(e,t){this.id=H++,this.type=e,this.data=t}function t(e){return"["+function e(t){if(0===t.length)return[];var n=t.charAt(0),r=t.charAt(t.length-1);if(1<t.length&&n===r&&('"'===n||"'"===n))return['"'+t.substr(1,t.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(n=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t))return e(t.substr(0,n.index)).concat(e(n[1])).concat(e(t.substr(n.index+n[0].length)));if(1===(n=t.split(".")).length)return['"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(t=[],r=0;r<n.length;++r)t=t.concat(e(n[r]));return t}(e).join("][")+"]"}function n(e){return"string"==typeof e?e.split():e}function r(e){return"string"==typeof e?document.querySelector(e):e}function i(e){var t,i,o,a,s=e||{};e={};var u=[],c=[],l="undefined"==typeof window?1:window.devicePixelRatio,f=!1,h=function(e){},d=function(){};if("string"==typeof s?t=document.querySelector(s):"object"==typeof s&&("string"==typeof s.nodeName&&"function"==typeof s.appendChild&&"function"==typeof s.getBoundingClientRect?t=s:"function"==typeof s.drawArrays||"function"==typeof s.drawElements?o=(a=s).canvas:("gl"in s?a=s.gl:"canvas"in s?o=r(s.canvas):"container"in s&&(i=r(s.container)),"attributes"in s&&(e=s.attributes),"extensions"in s&&(u=n(s.extensions)),"optionalExtensions"in s&&(c=n(s.optionalExtensions)),"onDone"in s&&(h=s.onDone),"profile"in s&&(f=!!s.profile),"pixelRatio"in s&&(l=+s.pixelRatio))),t&&("canvas"===t.nodeName.toLowerCase()?o=t:i=t),!a){if(!o){if(!(t=function(e,t,n){function r(){var t=window.innerWidth,r=window.innerHeight;e!==document.body&&(t=(r=e.getBoundingClientRect()).right-r.left,r=r.bottom-r.top),i.width=n*t,i.height=n*r,I(i.style,{width:t+"px",height:r+"px"})}var i=document.createElement("canvas");return I(i.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(i),e===document.body&&(i.style.position="absolute",I(e.style,{margin:0,padding:0})),window.addEventListener("resize",r,!1),r(),{canvas:i,onDestroy:function(){window.removeEventListener("resize",r),e.removeChild(i)}}}(i||document.body,0,l)))return null;o=t.canvas,d=t.onDestroy}a=function(e,t){function n(n){try{return e.getContext(n,t)}catch(e){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}(o,e)}return a?{gl:a,canvas:o,container:i,extensions:u,optionalExtensions:c,pixelRatio:l,profile:f,onDone:h,onDestroy:d}:(d(),h("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function o(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}function a(e){var t,n;return t=(65535<e)<<4,t|=n=(255<(e>>>=t))<<3,(t|=n=(15<(e>>>=n))<<2)|(n=(3<(e>>>=n))<<1)|e>>>n>>1}function s(){function e(e){e:{for(var t=16;268435456>=t;t*=16)if(e<=t){e=t;break e}e=0}return 0<(t=n[a(e)>>2]).length?t.pop():new ArrayBuffer(e)}function t(e){n[a(e.byteLength)>>2].push(e)}var n=o(8,function(){return[]});return{alloc:e,free:t,allocType:function(t,n){var r=null;switch(t){case 5120:r=new Int8Array(e(n),0,n);break;case 5121:r=new Uint8Array(e(n),0,n);break;case 5122:r=new Int16Array(e(2*n),0,n);break;case 5123:r=new Uint16Array(e(2*n),0,n);break;case 5124:r=new Int32Array(e(4*n),0,n);break;case 5125:r=new Uint32Array(e(4*n),0,n);break;case 5126:r=new Float32Array(e(4*n),0,n);break;default:return null}return r.length!==n?r.subarray(0,n):r},freeType:function(e){t(e.buffer)}}}function u(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||X(e.data))}function c(e,t,n,r,i,o){for(var a=0;a<t;++a)for(var s=e[a],u=0;u<n;++u)for(var c=s[u],l=0;l<r;++l)i[o++]=c[l]}function l(e){return 0|K[Object.prototype.toString.call(e)]}function f(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function h(e,t,n,r,i,o,a){for(var s=0,u=0;u<n;++u)for(var c=0;c<r;++c)e[s++]=t[i*u+o*c+a]}function d(e,t,n,r){function i(t){this.id=c++,this.buffer=e.createBuffer(),this.type=t,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,n.profile&&(this.stats={size:0})}function o(t,n,r){t.byteLength=n.byteLength,e.bufferData(t.type,n,r)}function a(e,t,n,r,i,a){if(e.usage=n,Array.isArray(t)){if(e.dtype=r||5126,0<t.length)if(Array.isArray(t[0])){i=ee(t);for(var s=r=1;s<i.length;++s)r*=i[s];e.dimension=r,o(e,t=Z(t,i,e.dtype),n),a?e.persistentData=t:G.freeType(t)}else"number"==typeof t[0]?(e.dimension=i,f(i=G.allocType(e.dtype,t.length),t),o(e,i,n),a?e.persistentData=i:G.freeType(i)):X(t[0])&&(e.dimension=t[0].length,e.dtype=r||l(t[0])||5126,o(e,t=Z(t,[t.length,t[0].length],e.dtype),n),a?e.persistentData=t:G.freeType(t))}else if(X(t))e.dtype=r||l(t),e.dimension=i,o(e,t,n),a&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(u(t)){var c=t.stride,d=(s=t.offset,0),p=0,m=0,g=0;1===(i=t.shape).length?(d=i[0],p=1,m=c[0],g=0):2===i.length&&(d=i[0],p=i[1],m=c[0],g=c[1]),e.dtype=r||l(t.data)||5126,e.dimension=p,h(i=G.allocType(e.dtype,d*p),t.data,d,p,m,g,s),o(e,i,n),a?e.persistentData=i:G.freeType(i)}}function s(n){t.bufferCount--;for(var i=0;i<r.state.length;++i){var o=r.state[i];o.buffer===n&&(e.disableVertexAttribArray(i),o.buffer=null)}e.deleteBuffer(n.buffer),n.buffer=null,delete d[n.id]}var c=0,d={};i.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},i.prototype.destroy=function(){s(this)};var p=[];return n.profile&&(t.getTotalBufferSize=function(){var e=0;return Object.keys(d).forEach(function(t){e+=d[t].stats.size}),e}),{create:function(r,o,c,p){function m(t){var r=35044,i=null,o=0,s=0,c=1;return Array.isArray(t)||X(t)||u(t)?i=t:"number"==typeof t?o=0|t:t&&("data"in t&&(i=t.data),"usage"in t&&(r=$[t.usage]),"type"in t&&(s=J[t.type]),"dimension"in t&&(c=0|t.dimension),"length"in t&&(o=0|t.length)),g.bind(),i?a(g,i,r,s,c,p):(o&&e.bufferData(g.type,o,r),g.dtype=s||5121,g.usage=r,g.dimension=c,g.byteLength=o),n.profile&&(g.stats.size=g.byteLength*te[g.dtype]),m}t.bufferCount++;var g=new i(o);return d[g.id]=g,c||m(r),m._reglType="buffer",m._buffer=g,m.subdata=function(t,n){var r,i=0|(n||0);if(g.bind(),X(t))e.bufferSubData(g.type,i,t);else if(Array.isArray(t)){if(0<t.length)if("number"==typeof t[0]){var o=G.allocType(g.dtype,t.length);f(o,t),e.bufferSubData(g.type,i,o),G.freeType(o)}else(Array.isArray(t[0])||X(t[0]))&&(r=ee(t),o=Z(t,r,g.dtype),e.bufferSubData(g.type,i,o),G.freeType(o))}else if(u(t)){var a=t.stride,s=o=0,c=0,d=0;1===(r=t.shape).length?(o=r[0],s=1,c=a[0],d=0):2===r.length&&(o=r[0],s=r[1],c=a[0],d=a[1]),r=Array.isArray(t.data)?g.dtype:l(t.data),h(r=G.allocType(r,o*s),t.data,o,s,c,d,t.offset),e.bufferSubData(g.type,i,r),G.freeType(r)}return m},n.profile&&(m.stats=g.stats),m.destroy=function(){s(g)},m},createStream:function(e,t){var n=p.pop();return n||(n=new i(e)),n.bind(),a(n,t,35040,0,1,!1),n},destroyStream:function(e){p.push(e)},clear:function(){Y(d).forEach(s),p.forEach(s)},getBuffer:function(e){return e&&e._buffer instanceof i?e._buffer:null},restore:function(){Y(d).forEach(function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)})},_initBuffer:a}}function p(e,t,n,r){function i(e){this.id=c++,s[this.id]=this,this.buffer=e,this.primType=4,this.type=this.vertCount=0}function o(r,i,o,a,s,c,l){if(r.buffer.bind(),i){var f=l;l||X(i)&&(!u(i)||X(i.data))||(f=t.oes_element_index_uint?5125:5123),n._initBuffer(r.buffer,i,o,f,3)}else e.bufferData(34963,c,o),r.buffer.dtype=f||5121,r.buffer.usage=o,r.buffer.dimension=3,r.buffer.byteLength=c;if(f=l,!l){switch(r.buffer.dtype){case 5121:case 5120:f=5121;break;case 5123:case 5122:f=5123;break;case 5125:case 5124:f=5125}r.buffer.dtype=f}r.type=f,0>(i=s)&&(i=r.buffer.byteLength,5123===f?i>>=1:5125===f&&(i>>=2)),r.vertCount=i,i=a,0>a&&(i=4,1===(a=r.buffer.dimension)&&(i=0),2===a&&(i=1),3===a&&(i=4)),r.primType=i}function a(e){r.elementsCount--,delete s[e.id],e.buffer.destroy(),e.buffer=null}var s={},c=0,l={uint8:5121,uint16:5123};t.oes_element_index_uint&&(l.uint32=5125),i.prototype.bind=function(){this.buffer.bind()};var f=[];return{create:function(e,t){function s(e){if(e)if("number"==typeof e)c(e),f.primType=4,f.vertCount=0|e,f.type=5121;else{var t=null,n=35044,r=-1,i=-1,a=0,h=0;Array.isArray(e)||X(e)||u(e)?t=e:("data"in e&&(t=e.data),"usage"in e&&(n=$[e.usage]),"primitive"in e&&(r=ne[e.primitive]),"count"in e&&(i=0|e.count),"type"in e&&(h=l[e.type]),"length"in e?a=0|e.length:(a=i,5123===h||5122===h?a*=2:5125!==h&&5124!==h||(a*=4))),o(f,t,n,r,i,a,h)}else c(),f.primType=4,f.vertCount=0,f.type=5121;return s}var c=n.create(null,34963,!0),f=new i(c._buffer);return r.elementsCount++,s(e),s._reglType="elements",s._elements=f,s.subdata=function(e,t){return c.subdata(e,t),s},s.destroy=function(){a(f)},s},createStream:function(e){var t=f.pop();return t||(t=new i(n.create(null,34963,!0,!1)._buffer)),o(t,e,35040,-1,-1,0,0),t},destroyStream:function(e){f.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof i?e._elements:null},clear:function(){Y(s).forEach(a)}}}function m(e){for(var t=G.allocType(5123,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(Infinity===e[n])t[n]=31744;else if(-Infinity===e[n])t[n]=64512;else{re[0]=e[n];var r=(o=ie[0])>>>31<<15,i=(o<<1>>>24)-127,o=o>>13&1023;t[n]=-24>i?r:-14>i?r+(o+1024>>-14-i):15<i?r+31744:r+(i+15<<10)+o}return t}function g(e){return Array.isArray(e)||X(e)}function v(e){return"[object "+e+"]"}function b(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function y(e){return!(!Array.isArray(e)||0===e.length||!g(e[0]))}function x(e){return Object.prototype.toString.call(e)}function _(e){if(!e)return!1;var t=x(e);return 0<=de.indexOf(t)||(b(e)||y(e)||u(e))}function w(e,t){36193===e.type?(e.data=m(t),G.freeType(t)):e.data=t}function M(e,t,n,r,i,o){if(e=void 0!==me[e]?me[e]:se[e]*pe[t],o&&(e*=6),i){for(r=0;1<=n;)r+=e*n*n,n/=2;return r}return e*n*r}function k(e,t,n,r,i,o,a){function s(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function c(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function l(e,t){if("object"==typeof t&&t){"premultiplyAlpha"in t&&(e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(e.flipY=t.flipY),"alignment"in t&&(e.unpackAlignment=t.alignment),"colorSpace"in t&&(e.colorSpace=U[t.colorSpace]),"type"in t&&(e.type=V[t.type]);var n=e.width,r=e.height,i=e.channels,o=!1;"shape"in t?(n=t.shape[0],r=t.shape[1],3===t.shape.length&&(i=t.shape[2],o=!0)):("radius"in t&&(n=r=t.radius),"width"in t&&(n=t.width),"height"in t&&(r=t.height),"channels"in t&&(i=t.channels,o=!0)),e.width=0|n,e.height=0|r,e.channels=0|i,n=!1,"format"in t&&(r=e.internalformat=W[n=t.format],e.format=de[r],n in V&&!("type"in t)&&(e.type=V[n]),n in J&&(e.compressed=!0),n=!0),!o&&n?e.channels=se[e.format]:o&&!n&&e.channels!==ae[e.format]&&(e.format=e.internalformat=ae[e.channels])}}function f(t){e.pixelStorei(37440,t.flipY),e.pixelStorei(37441,t.premultiplyAlpha),e.pixelStorei(37443,t.colorSpace),e.pixelStorei(3317,t.unpackAlignment)}function h(){s.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function d(e,t){var n=null;if(_(t)?n=t:t&&(l(e,t),"x"in t&&(e.xOffset=0|t.x),"y"in t&&(e.yOffset=0|t.y),_(t.data)&&(n=t.data)),t.copy){var r=i.viewportWidth,o=i.viewportHeight;e.width=e.width||r-e.xOffset,e.height=e.height||o-e.yOffset,e.needsCopy=!0}else if(n){if(X(n))e.channels=e.channels||4,e.data=n,"type"in t||5121!==e.type||(e.type=0|K[Object.prototype.toString.call(n)]);else if(b(n)){switch(e.channels=e.channels||4,o=(r=n).length,e.type){case 5121:case 5123:case 5125:case 5126:(o=G.allocType(e.type,o)).set(r),e.data=o;break;case 36193:e.data=m(r)}e.alignment=1,e.needsFree=!0}else if(u(n)){r=n.data,Array.isArray(r)||5121!==e.type||(e.type=0|K[Object.prototype.toString.call(r)]);var a,s,c,f,h=n.stride;3===(o=n.shape).length?(c=o[2],f=h[2]):f=c=1,a=o[0],s=o[1],o=h[0],h=h[1],e.alignment=1,e.width=a,e.height=s,e.channels=c,e.format=e.internalformat=ae[c],e.needsFree=!0,a=f,n=n.offset;for(var d=G.allocType(36193===e.type?5126:e.type,(c=e.width)*(f=e.height)*(s=e.channels)),p=0,v=0;v<f;++v)for(var M=0;M<c;++M)for(var k=0;k<s;++k)d[p++]=r[o*M+h*v+a*k+n];w(e,d)}else if(x(n)===ue||x(n)===ce)e.element=x(n)===ue?n:n.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(x(n)===le)e.element=n,e.width=n.width,e.height=n.height,e.channels=4;else if(x(n)===fe)e.element=n,e.width=n.naturalWidth,e.height=n.naturalHeight,e.channels=4;else if(x(n)===he)e.element=n,e.width=n.videoWidth,e.height=n.videoHeight,e.channels=4;else if(y(n)){for(r=e.width||n[0].length,o=e.height||n.length,h=e.channels,h=g(n[0][0])?h||n[0][0].length:h||1,a=Q.shape(n),c=1,f=0;f<a.length;++f)c*=a[f];c=G.allocType(36193===e.type?5126:e.type,c),Q.flatten(n,a,"",c),w(e,c),e.alignment=1,e.width=r,e.height=o,e.channels=h,e.format=e.internalformat=ae[h],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4}function p(t,n,i,o,a){var s=t.element,u=t.data,c=t.internalformat,l=t.format,h=t.type,d=t.width,p=t.height;f(t),s?e.texSubImage2D(n,a,i,o,l,h,s):t.compressed?e.compressedTexSubImage2D(n,a,i,o,c,d,p,u):t.needsCopy?(r(),e.copyTexSubImage2D(n,a,i,o,t.xOffset,t.yOffset,d,p)):e.texSubImage2D(n,a,i,o,d,p,l,h,u)}function v(){return pe.pop()||new h}function k(e){e.needsFree&&G.freeType(e.data),h.call(e),pe.push(e)}function E(){s.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function A(e,t,n){var r=e.images[0]=v();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function C(e,t){var n=null;if(_(t))c(n=e.images[0]=v(),e),d(n,t),e.mipmask=1;else if(l(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,i=0;i<r.length;++i)c(n=e.images[i]=v(),e),n.width>>=i,n.height>>=i,d(n,r[i]),e.mipmask|=1<<i;else c(n=e.images[0]=v(),e),d(n,t),e.mipmask=1;c(e,e.images[0])}function S(t,n){for(var i=t.images,o=0;o<i.length&&i[o];++o){var a=i[o],s=n,u=o,c=a.element,l=a.data,h=a.internalformat,d=a.format,p=a.type,m=a.width,g=a.height,v=a.channels;f(a),c?e.texImage2D(s,u,d,d,p,c):a.compressed?e.compressedTexImage2D(s,u,h,m,g,0,l):a.needsCopy?(r(),e.copyTexImage2D(s,u,d,a.xOffset,a.yOffset,m,g,0)):((a=!l)&&(l=G.zero.allocType(p,m*g*v)),e.texImage2D(s,u,d,m,g,0,d,p,l),a&&l&&G.zero.freeType(l))}}function T(){var e=me.pop()||new E;s.call(e);for(var t=e.mipmask=0;16>t;++t)e.images[t]=null;return e}function D(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&k(t[n]),t[n]=null;me.push(e)}function R(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function O(e,t){"min"in t&&(e.minFilter=q[t.min],0<=oe.indexOf(e.minFilter)&&!("faces"in t)&&(e.genMipmaps=!0)),"mag"in t&&(e.magFilter=H[t.mag]);var n=e.wrapS,r=e.wrapT;if("wrap"in t){var i=t.wrap;"string"==typeof i?n=r=z[i]:Array.isArray(i)&&(n=z[i[0]],r=z[i[1]])}else"wrapS"in t&&(n=z[t.wrapS]),"wrapT"in t&&(r=z[t.wrapT]);if(e.wrapS=n,e.wrapT=r,"anisotropic"in t&&(e.anisotropic=t.anisotropic),"mipmap"in t){switch(n=!1,typeof t.mipmap){case"string":e.mipmapHint=B[t.mipmap],n=e.genMipmaps=!0;break;case"boolean":n=e.genMipmaps=t.mipmap;break;case"object":e.genMipmaps=!1,n=!0}!n||"min"in t||(e.minFilter=9984)}}function F(n,r){e.texParameteri(r,10241,n.minFilter),e.texParameteri(r,10240,n.magFilter),e.texParameteri(r,10242,n.wrapS),e.texParameteri(r,10243,n.wrapT),t.ext_texture_filter_anisotropic&&e.texParameteri(r,34046,n.anisotropic),n.genMipmaps&&(e.hint(33170,n.mipmapHint),e.generateMipmap(r))}function j(t){s.call(this),this.mipmask=0,this.internalformat=6408,this.id=ge++,this.refCount=1,this.target=t,this.texture=e.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new R,a.profile&&(this.stats={size:0})}function L(t){e.activeTexture(33984),e.bindTexture(t.target,t.texture)}function N(){var t=ye[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(3553,null)}function P(t){var n=t.texture,r=t.unit,i=t.target;0<=r&&(e.activeTexture(33984+r),e.bindTexture(i,null),ye[r]=null),e.deleteTexture(n),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete ve[t.id],o.textureCount--}var B={"don't care":4352,"dont care":4352,nice:4354,fast:4353},z={repeat:10497,clamp:33071,mirror:33648},H={nearest:9728,linear:9729},q=I({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},H),U={none:0,browser:37444},V={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},W={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},J={};t.ext_srgb&&(W.srgb=35904,W.srgba=35906),t.oes_texture_float&&(V.float32=V.float=5126),t.oes_texture_half_float&&(V.float16=V["half float"]=36193),t.webgl_depth_texture&&(I(W,{depth:6402,"depth stencil":34041}),I(V,{uint16:5123,uint32:5125,"depth stencil":34042})),t.webgl_compressed_texture_s3tc&&I(J,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),t.webgl_compressed_texture_atc&&I(J,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),t.webgl_compressed_texture_pvrtc&&I(J,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),t.webgl_compressed_texture_etc1&&(J["rgb etc1"]=36196);var $=Array.prototype.slice.call(e.getParameter(34467));Object.keys(J).forEach(function(e){var t=J[e];0<=$.indexOf(t)&&(W[e]=t)});var Z=Object.keys(W);n.textureFormats=Z;var ee=[];Object.keys(W).forEach(function(e){ee[W[e]]=e});var te=[];Object.keys(V).forEach(function(e){te[V[e]]=e});var ne=[];Object.keys(H).forEach(function(e){ne[H[e]]=e});var re=[];Object.keys(q).forEach(function(e){re[q[e]]=e});var ie=[];Object.keys(z).forEach(function(e){ie[z[e]]=e});var de=Z.reduce(function(e,t){var n=W[t];return e[n]=6409===n||6406===n||6409===n||6410===n||6402===n||34041===n?n:32855===n||0<=t.indexOf("rgba")?6408:6407,e},{}),pe=[],me=[],ge=0,ve={},be=n.maxTextureUnits,ye=Array(be).map(function(){return null});return I(j.prototype,{bind:function(){this.bindCount+=1;var t=this.unit;if(0>t){for(var n=0;n<be;++n){var r=ye[n];if(r){if(0<r.bindCount)continue;r.unit=-1}ye[n]=this,t=n;break}a.profile&&o.maxTextureUnits<t+1&&(o.maxTextureUnits=t+1),this.unit=t,e.activeTexture(33984+t),e.bindTexture(this.target,this.texture)}return t},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&P(this)}}),a.profile&&(o.getTotalTextureSize=function(){var e=0;return Object.keys(ve).forEach(function(t){e+=ve[t].stats.size}),e}),{create2D:function(t,n){function r(e,t){var n=i.texInfo;R.call(n);var o=T();return"number"==typeof e?A(o,0|e,"number"==typeof t?0|t:0|e):e?(O(n,e),C(o,e)):A(o,1,1),n.genMipmaps&&(o.mipmask=(o.width<<1)-1),i.mipmask=o.mipmask,c(i,o),i.internalformat=o.internalformat,r.width=o.width,r.height=o.height,L(i),S(o,3553),F(n,3553),N(),D(o),a.profile&&(i.stats.size=M(i.internalformat,i.type,o.width,o.height,n.genMipmaps,!1)),r.format=ee[i.internalformat],r.type=te[i.type],r.mag=ne[n.magFilter],r.min=re[n.minFilter],r.wrapS=ie[n.wrapS],r.wrapT=ie[n.wrapT],r}var i=new j(3553);return ve[i.id]=i,o.textureCount++,r(t,n),r.subimage=function(e,t,n,o){t|=0,n|=0,o|=0;var a=v();return c(a,i),a.width=0,a.height=0,d(a,e),a.width=a.width||(i.width>>o)-t,a.height=a.height||(i.height>>o)-n,L(i),p(a,3553,t,n,o),N(),k(a),r},r.resize=function(t,n){var o=0|t,s=0|n||o;if(o===i.width&&s===i.height)return r;r.width=i.width=o,r.height=i.height=s,L(i);for(var u,c=i.channels,l=i.type,f=0;i.mipmask>>f;++f){var h=o>>f,d=s>>f;if(!h||!d)break;u=G.zero.allocType(l,h*d*c),e.texImage2D(3553,f,i.format,h,d,0,i.format,i.type,u),u&&G.zero.freeType(u)}return N(),a.profile&&(i.stats.size=M(i.internalformat,i.type,o,s,!1,!1)),r},r._reglType="texture2d",r._texture=i,a.profile&&(r.stats=i.stats),r.destroy=function(){i.decRef()},r},createCube:function(t,n,r,i,s,u){function f(e,t,n,r,i,o){var s,u=h.texInfo;for(R.call(u),s=0;6>s;++s)m[s]=T();if("number"!=typeof e&&e){if("object"==typeof e)if(t)C(m[0],e),C(m[1],t),C(m[2],n),C(m[3],r),C(m[4],i),C(m[5],o);else if(O(u,e),l(h,e),"faces"in e)for(e=e.faces,s=0;6>s;++s)c(m[s],h),C(m[s],e[s]);else for(s=0;6>s;++s)C(m[s],e)}else for(e=0|e||1,s=0;6>s;++s)A(m[s],e,e);for(c(h,m[0]),h.mipmask=u.genMipmaps?(m[0].width<<1)-1:m[0].mipmask,h.internalformat=m[0].internalformat,f.width=m[0].width,f.height=m[0].height,L(h),s=0;6>s;++s)S(m[s],34069+s);for(F(u,34067),N(),a.profile&&(h.stats.size=M(h.internalformat,h.type,f.width,f.height,u.genMipmaps,!0)),f.format=ee[h.internalformat],f.type=te[h.type],f.mag=ne[u.magFilter],f.min=re[u.minFilter],f.wrapS=ie[u.wrapS],f.wrapT=ie[u.wrapT],s=0;6>s;++s)D(m[s]);return f}var h=new j(34067);ve[h.id]=h,o.cubeCount++;var m=Array(6);return f(t,n,r,i,s,u),f.subimage=function(e,t,n,r,i){n|=0,r|=0,i|=0;var o=v();return c(o,h),o.width=0,o.height=0,d(o,t),o.width=o.width||(h.width>>i)-n,o.height=o.height||(h.height>>i)-r,L(h),p(o,34069+e,n,r,i),N(),k(o),f},f.resize=function(t){if((t|=0)!==h.width){f.width=h.width=t,f.height=h.height=t,L(h);for(var n=0;6>n;++n)for(var r=0;h.mipmask>>r;++r)e.texImage2D(34069+n,r,h.format,t>>r,t>>r,0,h.format,h.type,null);return N(),a.profile&&(h.stats.size=M(h.internalformat,h.type,f.width,f.height,!1,!0)),f}},f._reglType="textureCube",f._texture=h,a.profile&&(f.stats=h.stats),f.destroy=function(){h.decRef()},f},clear:function(){for(var t=0;t<be;++t)e.activeTexture(33984+t),e.bindTexture(3553,null),ye[t]=null;Y(ve).forEach(P),o.cubeCount=0,o.textureCount=0},getTexture:function(e){return null},restore:function(){for(var t=0;t<be;++t){var n=ye[t];n&&(n.bindCount=0,n.unit=-1,ye[t]=null)}Y(ve).forEach(function(t){t.texture=e.createTexture(),e.bindTexture(t.target,t.texture);for(var n=0;32>n;++n)if(0!=(t.mipmask&1<<n))if(3553===t.target)e.texImage2D(3553,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);else for(var r=0;6>r;++r)e.texImage2D(34069+r,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);F(t.texInfo,t.target)})}}}function E(e,t,n,r,i,o){function a(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=e=0;t?(e=t.width,r=t.height):n&&(e=n.width,r=n.height),this.width=e,this.height=r}function s(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function u(e,t,n){e&&(e.texture?e.texture._texture.refCount+=1:e.renderbuffer._renderbuffer.refCount+=1)}function c(t,n){n&&(n.texture?e.framebufferTexture2D(36160,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(36160,t,36161,n.renderbuffer._renderbuffer.renderbuffer))}function l(e){var t=3553,n=null,r=null,i=e;return"object"==typeof e&&(i=e.data,"target"in e&&(t=0|e.target)),"texture2d"===(e=i._reglType)?n=i:"textureCube"===e?n=i:"renderbuffer"===e&&(r=i,t=36161),new a(t,n,r)}function f(e,t,n,o,s){return n?((e=r.create2D({width:e,height:t,format:o,type:s}))._texture.refCount=0,new a(3553,e,null)):((e=i.create({width:e,height:t,format:o}))._renderbuffer.refCount=0,new a(36161,null,e))}function h(e){return e&&(e.texture||e.renderbuffer)}function d(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n),e.width=t,e.height=n)}function p(){this.id=M++,k[this.id]=this,this.framebuffer=e.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function m(e){e.colorAttachments.forEach(s),s(e.depthAttachment),s(e.stencilAttachment),s(e.depthStencilAttachment)}function g(t){e.deleteFramebuffer(t.framebuffer),t.framebuffer=null,o.framebufferCount--,delete k[t.id]}function v(t){var r;e.bindFramebuffer(36160,t.framebuffer);var i=t.colorAttachments;for(r=0;r<i.length;++r)c(36064+r,i[r]);for(r=i.length;r<n.maxColorAttachments;++r)e.framebufferTexture2D(36160,36064+r,3553,null,0);e.framebufferTexture2D(36160,33306,3553,null,0),e.framebufferTexture2D(36160,36096,3553,null,0),e.framebufferTexture2D(36160,36128,3553,null,0),c(36096,t.depthAttachment),c(36128,t.stencilAttachment),c(33306,t.depthStencilAttachment),e.checkFramebufferStatus(36160),e.isContextLost(),e.bindFramebuffer(36160,y.next?y.next.framebuffer:null),y.cur=y.next,e.getError()}function b(e,t){function n(e,t){var i,o=0,a=0,s=!0,c=!0;i=null;var d=!0,p="rgba",g="uint8",b=1,y=null,w=null,M=null,k=!1;"number"==typeof e?(o=0|e,a=0|t||o):e?("shape"in e?(o=(a=e.shape)[0],a=a[1]):("radius"in e&&(o=a=e.radius),"width"in e&&(o=e.width),"height"in e&&(a=e.height)),("color"in e||"colors"in e)&&(i=e.color||e.colors,Array.isArray(i)),i||("colorCount"in e&&(b=0|e.colorCount),"colorTexture"in e&&(d=!!e.colorTexture,p="rgba4"),"colorType"in e&&(g=e.colorType,!d)&&("half float"===g||"float16"===g?p="rgba16f":"float"!==g&&"float32"!==g||(p="rgba32f")),"colorFormat"in e&&(0<=x.indexOf(p=e.colorFormat)?d=!0:0<=_.indexOf(p)&&(d=!1))),("depthTexture"in e||"depthStencilTexture"in e)&&(k=!(!e.depthTexture&&!e.depthStencilTexture)),"depth"in e&&("boolean"==typeof e.depth?s=e.depth:(y=e.depth,c=!1)),"stencil"in e&&("boolean"==typeof e.stencil?c=e.stencil:(w=e.stencil,s=!1)),"depthStencil"in e&&("boolean"==typeof e.depthStencil?s=c=e.depthStencil:(M=e.depthStencil,c=s=!1))):o=a=1;var E=null,A=null,C=null,S=null;if(Array.isArray(i))E=i.map(l);else if(i)E=[l(i)];else for(E=Array(b),i=0;i<b;++i)E[i]=f(o,a,d,p,g);for(o=o||E[0].width,a=a||E[0].height,y?A=l(y):s&&!c&&(A=f(o,a,k,"depth","uint32")),w?C=l(w):c&&!s&&(C=f(o,a,!1,"stencil","uint8")),M?S=l(M):!y&&!w&&c&&s&&(S=f(o,a,k,"depth stencil","depth stencil")),s=null,i=0;i<E.length;++i)u(E[i]),E[i]&&E[i].texture&&(c=be[E[i].texture._texture.format]*ye[E[i].texture._texture.type],null===s&&(s=c));return u(A),u(C),u(S),m(r),r.width=o,r.height=a,r.colorAttachments=E,r.depthAttachment=A,r.stencilAttachment=C,r.depthStencilAttachment=S,n.color=E.map(h),n.depth=h(A),n.stencil=h(C),n.depthStencil=h(S),n.width=r.width,n.height=r.height,v(r),n}var r=new p;return o.framebufferCount++,n(e,t),I(n,{resize:function(e,t){var i=Math.max(0|e,1),o=Math.max(0|t||i,1);if(i===r.width&&o===r.height)return n;for(var a=r.colorAttachments,s=0;s<a.length;++s)d(a[s],i,o);return d(r.depthAttachment,i,o),d(r.stencilAttachment,i,o),d(r.depthStencilAttachment,i,o),r.width=n.width=i,r.height=n.height=o,v(r),n},_reglType:"framebuffer",_framebuffer:r,destroy:function(){g(r),m(r)},use:function(e){y.setFBO({framebuffer:n},e)}})}var y={cur:null,next:null,dirty:!1,setFBO:null},x=["rgba"],_=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&_.push("srgba"),t.ext_color_buffer_half_float&&_.push("rgba16f","rgb16f"),t.webgl_color_buffer_float&&_.push("rgba32f");var w=["uint8"];t.oes_texture_half_float&&w.push("half float","float16"),t.oes_texture_float&&w.push("float","float32");var M=0,k={};return I(y,{getFramebuffer:function(e){return"function"==typeof e&&"framebuffer"===e._reglType&&(e=e._framebuffer)instanceof p?e:null},create:b,createCube:function(e){function t(e){var i,o={color:null},a=0,s=null;i="rgba";var u="uint8",c=1;if("number"==typeof e?a=0|e:e?("shape"in e?a=e.shape[0]:("radius"in e&&(a=0|e.radius),"width"in e?a=0|e.width:"height"in e&&(a=0|e.height)),("color"in e||"colors"in e)&&(s=e.color||e.colors,Array.isArray(s)),s||("colorCount"in e&&(c=0|e.colorCount),"colorType"in e&&(u=e.colorType),"colorFormat"in e&&(i=e.colorFormat)),"depth"in e&&(o.depth=e.depth),"stencil"in e&&(o.stencil=e.stencil),"depthStencil"in e&&(o.depthStencil=e.depthStencil)):a=1,s)if(Array.isArray(s))for(e=[],i=0;i<s.length;++i)e[i]=s[i];else e=[s];else for(e=Array(c),s={radius:a,format:i,type:u},i=0;i<c;++i)e[i]=r.createCube(s);for(o.color=Array(e.length),i=0;i<e.length;++i)c=e[i],a=a||c.width,o.color[i]={target:34069,data:e[i]};for(i=0;6>i;++i){for(c=0;c<e.length;++c)o.color[c].target=34069+i;0<i&&(o.depth=n[0].depth,o.stencil=n[0].stencil,o.depthStencil=n[0].depthStencil),n[i]?n[i](o):n[i]=b(o)}return I(t,{width:a,height:a,color:e})}var n=Array(6);return t(e),I(t,{faces:n,resize:function(e){var r=0|e;if(r===t.width)return t;var i=t.color;for(e=0;e<i.length;++e)i[e].resize(r);for(e=0;6>e;++e)n[e].resize(r);return t.width=t.height=r,t},_reglType:"framebufferCube",destroy:function(){n.forEach(function(e){e.destroy()})}})},clear:function(){Y(k).forEach(g)},restore:function(){y.cur=null,y.next=null,y.dirty=!0,Y(k).forEach(function(t){t.framebuffer=e.createFramebuffer(),v(t)})}})}function A(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function C(e,t,n,r){function i(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function o(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function a(n,r,i){if(!(a=(i=35632===n?c:l)[r])){var o=t.str(r),a=e.createShader(n);e.shaderSource(a,o),e.compileShader(a),i[r]=a}return a}function s(e,t){this.id=d++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function u(n,s){var u,c;u=a(35632,n.fragId),c=a(35633,n.vertId);var l=n.program=e.createProgram();e.attachShader(l,u),e.attachShader(l,c),e.linkProgram(l);var f=e.getProgramParameter(l,35718);r.profile&&(n.stats.uniformsCount=f);var h=n.uniforms;for(u=0;u<f;++u)if(c=e.getActiveUniform(l,u))if(1<c.size)for(var d=0;d<c.size;++d){var p=c.name.replace("[0]","["+d+"]");o(h,new i(p,t.id(p),e.getUniformLocation(l,p),c))}else o(h,new i(c.name,t.id(c.name),e.getUniformLocation(l,c.name),c));for(f=e.getProgramParameter(l,35721),r.profile&&(n.stats.attributesCount=f),h=n.attributes,u=0;u<f;++u)(c=e.getActiveAttrib(l,u))&&o(h,new i(c.name,t.id(c.name),e.getAttribLocation(l,c.name),c))}var c={},l={},f={},h=[],d=0;return r.profile&&(n.getMaxUniformsCount=function(){var e=0;return h.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},n.getMaxAttributesCount=function(){var e=0;return h.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var t=e.deleteShader.bind(e);Y(c).forEach(t),c={},Y(l).forEach(t),l={},h.forEach(function(t){e.deleteProgram(t.program)}),h.length=0,f={},n.shaderCount=0},program:function(e,t,r){var i=f[t];i||(i=f[t]={});var o=i[e];return o||(o=new s(t,e),n.shaderCount++,u(o),i[e]=o,h.push(o)),o},restore:function(){c={},l={};for(var e=0;e<h.length;++e)u(h[e])},shader:a,frag:-1,vert:-1}}function S(e,t,n,r,i,o,a){function s(i){var o;o=null===t.next?5121:t.next.colorAttachments[0].texture._texture.type;var a=0,s=0,u=r.framebufferWidth,c=r.framebufferHeight,l=null;return X(i)?l=i:i&&(a=0|i.x,s=0|i.y,u=0|(i.width||r.framebufferWidth-a),c=0|(i.height||r.framebufferHeight-s),l=i.data||null),n(),i=u*c*4,l||(5121===o?l=new Uint8Array(i):5126===o&&(l=l||new Float32Array(i))),e.pixelStorei(3333,4),e.readPixels(a,s,u,c,6408,o,l),l}return function(e){return e&&"framebuffer"in e?function(e){var n;return t.setFBO({framebuffer:e.framebuffer},function(){n=s(e)}),n}(e):s(e)}}function T(e){return Array.prototype.slice.call(e)}function D(e){return T(e).join("")}function R(){function e(){var e=[],t=[];return I(function(){e.push.apply(e,T(arguments))},{def:function(){var r="v"+n++;return t.push(r),0<arguments.length&&(e.push(r,"="),e.push.apply(e,T(arguments)),e.push(";")),r},toString:function(){return D([0<t.length?"var "+t+";":"",D(e)])}})}function t(){function t(e,t){r(e,t,"=",n.def(e,t),";")}var n=e(),r=e(),i=n.toString,o=r.toString;return I(function(){n.apply(n,T(arguments))},{def:n.def,entry:n,exit:r,save:t,set:function(e,r,i){t(e,r),n(e,r,"=",i,";")},toString:function(){return i()+o()}})}var n=0,r=[],i=[],o=e(),a={};return{global:o,link:function(e){for(var t=0;t<i.length;++t)if(i[t]===e)return r[t];return t="g"+n++,r.push(t),i.push(e),t},block:e,proc:function(e,n){function r(){var e="a"+i.length;return i.push(e),e}var i=[];n=n||0;for(var o=0;o<n;++o)r();var s=(o=t()).toString;return a[e]=I(o,{arg:r,toString:function(){return D(["function(",i.join(),"){",s(),"}"])}})},scope:t,cond:function(){var e=D(arguments),n=t(),r=t(),i=n.toString,o=r.toString;return I(n,{then:function(){return n.apply(n,T(arguments)),this},else:function(){return r.apply(r,T(arguments)),this},toString:function(){var t=o();return t&&(t="else{"+t+"}"),D(["if(",e,"){",i(),"}",t])}})},compile:function(){var e=['"use strict";',o,"return {"];Object.keys(a).forEach(function(t){e.push('"',t,'":',a[t].toString(),",")}),e.push("}");var t=D(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,r.concat(t)).apply(null,i)}}}function O(e){return Array.isArray(e)||X(e)||u(e)}function F(e){return e.sort(function(e,t){return"viewport"===e?-1:"viewport"===t?1:e<t?-1:1})}function j(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function L(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function N(e){return new j(!1,!1,!1,e)}function P(e,t){var n=e.type;return 0===n?new j(!0,1<=(n=e.data.length),2<=n,t):4===n?new j((n=e.data).thisDep,n.contextDep,n.propDep,t):new j(3===n,2===n,1===n,t)}function B(e,t,n,r,i,a,s,u,c,l,f,h,d,p,m){function v(e){return e.replace(".","_")}function b(e,t,n){var r=v(e);re.push(e),te[r]=ee[r]=!!n,ie[r]=t}function y(e,t,n){var r=v(e);re.push(e),Array.isArray(n)?(ee[r]=n.slice(),te[r]=n.slice()):ee[r]=te[r]=n,oe[r]=t}function x(){var e=R(),n=e.link,r=e.global;e.id=ue++,e.batchId="0";var i=n(ae),o=e.shared={props:"a0"};Object.keys(ae).forEach(function(e){o[e]=r.def(i,".",e)});var a=e.next={},s=e.current={};Object.keys(oe).forEach(function(e){Array.isArray(ee[e])&&(a[e]=r.def(o.next,".",e),s[e]=r.def(o.current,".",e))});var u=e.constants={};Object.keys(se).forEach(function(e){u[e]=r.def(JSON.stringify(se[e]))}),e.invoke=function(t,r){switch(r.type){case 0:var i=["this",o.context,o.props,e.batchId];return t.def(n(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case 1:return t.def(o.props,r.data);case 2:return t.def(o.context,r.data);case 3:return t.def("this",r.data);case 4:return r.data.append(e,t),r.data.ref}},e.attribCache={};var c={};return e.scopeAttrib=function(e){if((e=t.id(e))in c)return c[e];var r=l.scope[e];return r||(r=l.scope[e]=new Q),c[e]=n(r)},e}function _(e,t){var n=e.static,r=e.dynamic;if("framebuffer"in n){var i=n.framebuffer;return i?(i=u.getFramebuffer(i),N(function(e,t){var n=e.link(i),r=e.shared;return t.set(r.framebuffer,".next",n),t.set(r=r.context,".framebufferWidth",n+".width"),t.set(r,".framebufferHeight",n+".height"),n})):N(function(e,t){var n=e.shared;return t.set(n.framebuffer,".next","null"),t.set(n=n.context,".framebufferWidth",n+".drawingBufferWidth"),t.set(n,".framebufferHeight",n+".drawingBufferHeight"),"null"})}if("framebuffer"in r){var o=r.framebuffer;return P(o,function(e,t){var n=e.invoke(t,o),r=e.shared,i=r.framebuffer;n=t.def(i,".getFramebuffer(",n,")");return t.set(i,".next",n),t.set(r=r.context,".framebufferWidth",n+"?"+n+".width:"+r+".drawingBufferWidth"),t.set(r,".framebufferHeight",n+"?"+n+".height:"+r+".drawingBufferHeight"),n})}return null}function w(e){function n(e){if(e in r){var n=t.id(r[e]);return(e=N(function(){return n})).id=n,e}if(e in i){var o=i[e];return P(o,function(e,t){var n=e.invoke(t,o);return t.def(e.shared.strings,".id(",n,")")})}return null}var r=e.static,i=e.dynamic,o=n("frag"),a=n("vert"),s=null;return L(o)&&L(a)?(s=f.program(a.id,o.id),e=N(function(e,t){return e.link(s)})):e=new j(o&&o.thisDep||a&&a.thisDep,o&&o.contextDep||a&&a.contextDep,o&&o.propDep||a&&a.propDep,function(e,t){var n,r,i=e.shared.shader;return n=o?o.append(e,t):t.def(i,".","frag"),r=a?a.append(e,t):t.def(i,".","vert"),t.def(i+".program("+r+","+n+")")}),{frag:o,vert:a,progVar:e,program:s}}function M(e,t){function n(e,t){if(e in r){var n=0|r[e];return N(function(e,r){return t&&(e.OFFSET=n),n})}if(e in i){var a=i[e];return P(a,function(e,n){var r=e.invoke(n,a);return t&&(e.OFFSET=r),r})}return t&&o?N(function(e,t){return e.OFFSET="0",0}):null}var r=e.static,i=e.dynamic,o=function(){if("elements"in r){var e=r.elements;O(e)?e=a.getElements(a.create(e,!0)):e&&(e=a.getElements(e));var t=N(function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r}return t.ELEMENTS=null});return t.value=e,t}if("elements"in i){var n=i.elements;return P(n,function(e,t){var r=(i=e.shared).isBufferArgs,i=i.elements,o=e.invoke(t,n),a=t.def("null");r=t.def(r,"(",o,")"),o=e.cond(r).then(a,"=",i,".createStream(",o,");").else(a,"=",i,".getElements(",o,");");return t.entry(o),t.exit(e.cond(r).then(i,".destroyStream(",a,");")),e.ELEMENTS=a})}return null}(),s=n("offset",!0);return{elements:o,primitive:function(){if("primitive"in r){var e=r.primitive;return N(function(t,n){return ne[e]})}if("primitive"in i){var t=i.primitive;return P(t,function(e,n){var r=e.constants.primTypes,i=e.invoke(n,t);return n.def(r,"[",i,"]")})}return o?L(o)?N(o.value?function(e,t){return t.def(e.ELEMENTS,".primType")}:function(){return 4}):new j(o.thisDep,o.contextDep,o.propDep,function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",4)}):null}(),count:function(){if("count"in r){var e=0|r.count;return N(function(){return e})}if("count"in i){var t=i.count;return P(t,function(e,n){return e.invoke(n,t)})}return o?L(o)?o?s?new j(s.thisDep,s.contextDep,s.propDep,function(e,t){return t.def(e.ELEMENTS,".vertCount-",e.OFFSET)}):N(function(e,t){return t.def(e.ELEMENTS,".vertCount")}):N(function(){return-1}):new j(o.thisDep||s.thisDep,o.contextDep||s.contextDep,o.propDep||s.propDep,function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")}):null}(),instances:n("instances",!1),offset:s}}function k(e,n){var r=e.static,o=e.dynamic,a={};return Object.keys(r).forEach(function(e){var n=r[e],o=t.id(e),s=new Q;if(O(n))s.state=1,s.buffer=i.getBuffer(i.create(n,34962,!1,!0)),s.type=0;else if(c=i.getBuffer(n))s.state=1,s.buffer=c,s.type=0;else if("constant"in n){var u=n.constant;s.buffer="null",s.state=2,"number"==typeof u?s.x=u:xe.forEach(function(e,t){t<u.length&&(s[e]=u[t])})}else{var c=O(n.buffer)?i.getBuffer(i.create(n.buffer,34962,!1,!0)):i.getBuffer(n.buffer),l=0|n.offset,f=0|n.stride,h=0|n.size,d=!!n.normalized,p=0;"type"in n&&(p=J[n.type]),n=0|n.divisor,s.buffer=c,s.state=1,s.size=h,s.normalized=d,s.type=p||c.dtype,s.offset=l,s.stride=f,s.divisor=n}a[e]=N(function(e,t){var n=e.attribCache;if(o in n)return n[o];var r={isStream:!1};return Object.keys(s).forEach(function(e){r[e]=s[e]}),s.buffer&&(r.buffer=e.link(s.buffer),r.type=r.type||r.buffer+".dtype"),n[o]=r})}),Object.keys(o).forEach(function(e){var t=o[e];a[e]=P(t,function(e,n){function r(e){n(u[e],"=",i,".",e,"|0;")}var i=e.invoke(n,t),o=e.shared,a=o.isBufferArgs,s=o.buffer,u={isStream:n.def(!1)},c=new Q;c.state=1,Object.keys(c).forEach(function(e){u[e]=n.def(""+c[e])});var l=u.buffer,f=u.type;return n("if(",a,"(",i,")){",u.isStream,"=true;",l,"=",s,".createStream(",34962,",",i,");",f,"=",l,".dtype;","}else{",l,"=",s,".getBuffer(",i,");","if(",l,"){",f,"=",l,".dtype;",'}else if("constant" in ',i,"){",u.state,"=",2,";","if(typeof "+i+'.constant === "number"){',u[xe[0]],"=",i,".constant;",xe.slice(1).map(function(e){return u[e]}).join("="),"=0;","}else{",xe.map(function(e,t){return u[e]+"="+i+".constant.length>"+t+"?"+i+".constant["+t+"]:0;"}).join(""),"}}else{","if(",a,"(",i,".buffer)){",l,"=",s,".createStream(",34962,",",i,".buffer);","}else{",l,"=",s,".getBuffer(",i,".buffer);","}",f,'="type" in ',i,"?",o.glTypes,"[",i,".type]:",l,".dtype;",u.normalized,"=!!",i,".normalized;"),r("size"),r("offset"),r("stride"),r("divisor"),n("}}"),n.exit("if(",u.isStream,"){",s,".destroyStream(",l,");","}"),u})}),a}function E(e,t,n,r,i){var a=_(e),s=function(e,t,n){function r(e){if(e in i){var n=i[e];e=!0;var r,a,s=0|n.x,u=0|n.y;return"width"in n?r=0|n.width:e=!1,"height"in n?a=0|n.height:e=!1,new j(!e&&t&&t.thisDep,!e&&t&&t.contextDep,!e&&t&&t.propDep,function(e,t){var i=e.shared.context,o=r;"width"in n||(o=t.def(i,".","framebufferWidth","-",s));var c=a;return"height"in n||(c=t.def(i,".","framebufferHeight","-",u)),[s,u,o,c]})}if(e in o){var c=o[e];return e=P(c,function(e,t){var n=e.invoke(t,c),r=e.shared.context,i=t.def(n,".x|0"),o=t.def(n,".y|0");return[i,o,t.def('"width" in ',n,"?",n,".width|0:","(",r,".","framebufferWidth","-",i,")"),n=t.def('"height" in ',n,"?",n,".height|0:","(",r,".","framebufferHeight","-",o,")")]}),t&&(e.thisDep=e.thisDep||t.thisDep,e.contextDep=e.contextDep||t.contextDep,e.propDep=e.propDep||t.propDep),e}return t?new j(t.thisDep,t.contextDep,t.propDep,function(e,t){var n=e.shared.context;return[0,0,t.def(n,".","framebufferWidth"),t.def(n,".","framebufferHeight")]}):null}var i=e.static,o=e.dynamic;if(e=r("viewport")){var a=e;e=new j(e.thisDep,e.contextDep,e.propDep,function(e,t){var n=a.append(e,t),r=e.shared.context;return t.set(r,".viewportWidth",n[2]),t.set(r,".viewportHeight",n[3]),n})}return{viewport:e,scissor_box:r("scissor.box")}}(e,a),u=M(e),c=function(e,t){var n=e.static,r=e.dynamic,i={};return re.forEach(function(e){function t(t,o){if(e in n){var s=t(n[e]);i[a]=N(function(){return s})}else if(e in r){var u=r[e];i[a]=P(u,function(e,t){return o(e,t,e.invoke(t,u))})}}var a=v(e);switch(e){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return t(function(e){return e},function(e,t,n){return n});case"depth.func":return t(function(e){return Me[e]},function(e,t,n){return t.def(e.constants.compareFuncs,"[",n,"]")});case"depth.range":return t(function(e){return e},function(e,t,n){return[t.def("+",n,"[0]"),t=t.def("+",n,"[1]")]});case"blend.func":return t(function(e){return[we["srcRGB"in e?e.srcRGB:e.src],we["dstRGB"in e?e.dstRGB:e.dst],we["srcAlpha"in e?e.srcAlpha:e.src],we["dstAlpha"in e?e.dstAlpha:e.dst]]},function(e,t,n){function r(e,r){return t.def('"',e,r,'" in ',n,"?",n,".",e,r,":",n,".",e)}e=e.constants.blendFuncs;var i=r("src","RGB"),o=r("dst","RGB"),a=(i=t.def(e,"[",i,"]"),t.def(e,"[",r("src","Alpha"),"]"));return[i,o=t.def(e,"[",o,"]"),a,e=t.def(e,"[",r("dst","Alpha"),"]")]});case"blend.equation":return t(function(e){return"string"==typeof e?[K[e],K[e]]:"object"==typeof e?[K[e.rgb],K[e.alpha]]:void 0},function(e,t,n){var r=e.constants.blendEquations,i=t.def(),o=t.def();return(e=e.cond("typeof ",n,'==="string"')).then(i,"=",o,"=",r,"[",n,"];"),e.else(i,"=",r,"[",n,".rgb];",o,"=",r,"[",n,".alpha];"),t(e),[i,o]});case"blend.color":return t(function(e){return o(4,function(t){return+e[t]})},function(e,t,n){return o(4,function(e){return t.def("+",n,"[",e,"]")})});case"stencil.mask":return t(function(e){return 0|e},function(e,t,n){return t.def(n,"|0")});case"stencil.func":return t(function(e){return[Me[e.cmp||"keep"],e.ref||0,"mask"in e?e.mask:-1]},function(e,t,n){return[e=t.def('"cmp" in ',n,"?",e.constants.compareFuncs,"[",n,".cmp]",":",7680),t.def(n,".ref|0"),t=t.def('"mask" in ',n,"?",n,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return t(function(t){return["stencil.opBack"===e?1029:1028,ke[t.fail||"keep"],ke[t.zfail||"keep"],ke[t.zpass||"keep"]]},function(t,n,r){function i(e){return n.def('"',e,'" in ',r,"?",o,"[",r,".",e,"]:",7680)}var o=t.constants.stencilOps;return["stencil.opBack"===e?1029:1028,i("fail"),i("zfail"),i("zpass")]});case"polygonOffset.offset":return t(function(e){return[0|e.factor,0|e.units]},function(e,t,n){return[t.def(n,".factor|0"),t=t.def(n,".units|0")]});case"cull.face":return t(function(e){var t=0;return"front"===e?t=1028:"back"===e&&(t=1029),t},function(e,t,n){return t.def(n,'==="front"?',1028,":",1029)});case"lineWidth":return t(function(e){return e},function(e,t,n){return n});case"frontFace":return t(function(e){return Ee[e]},function(e,t,n){return t.def(n+'==="cw"?2304:2305')});case"colorMask":return t(function(e){return e.map(function(e){return!!e})},function(e,t,n){return o(4,function(e){return"!!"+n+"["+e+"]"})});case"sample.coverage":return t(function(e){return["value"in e?e.value:1,!!e.invert]},function(e,t,n){return[t.def('"value" in ',n,"?+",n,".value:1"),t=t.def("!!",n,".invert")]})}}),i}(e),l=w(e),f=s.viewport;return f&&(c.viewport=f),(s=s[f=v("scissor.box")])&&(c[f]=s),(a={framebuffer:a,draw:u,shader:l,state:c,dirty:s=0<Object.keys(c).length}).profile=function(e){var t,n=e.static;if(e=e.dynamic,"profile"in n){var r=!!n.profile;(t=N(function(e,t){return r})).enable=r}else if("profile"in e){var i=e.profile;t=P(i,function(e,t){return e.invoke(t,i)})}return t}(e),a.uniforms=function(e,t){var n=e.static,r=e.dynamic,i={};return Object.keys(n).forEach(function(e){var t,r=n[e];if("number"==typeof r||"boolean"==typeof r)t=N(function(){return r});else if("function"==typeof r){var a=r._reglType;"texture2d"===a||"textureCube"===a?t=N(function(e){return e.link(r)}):"framebuffer"!==a&&"framebufferCube"!==a||(t=N(function(e){return e.link(r.color[0])}))}else g(r)&&(t=N(function(e){return e.global.def("[",o(r.length,function(e){return r[e]}),"]")}));t.value=r,i[e]=t}),Object.keys(r).forEach(function(e){var t=r[e];i[e]=P(t,function(e,n){return e.invoke(n,t)})}),i}(n),a.attributes=k(t),a.context=function(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach(function(e){var n=t[e];r[e]=N(function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)})}),Object.keys(n).forEach(function(e){var t=n[e];r[e]=P(t,function(e,n){return e.invoke(n,t)})}),r}(r),a}function A(e,t,n){var r=e.shared.context,i=e.scope();Object.keys(n).forEach(function(o){t.save(r,"."+o),i(r,".",o,"=",n[o].append(e,t),";")}),t(i)}function C(e,t,n,r){var i,o=(s=e.shared).gl,a=s.framebuffer;Z&&(i=t.def(s.extensions,".webgl_draw_buffers"));var s=(u=e.constants).drawBuffer,u=u.backBuffer;e=n?n.append(e,t):t.def(a,".next"),r||t("if(",e,"!==",a,".cur){"),t("if(",e,"){",o,".bindFramebuffer(",36160,",",e,".framebuffer);"),Z&&t(i,".drawBuffersWEBGL(",s,"[",e,".colorAttachments.length]);"),t("}else{",o,".bindFramebuffer(",36160,",null);"),Z&&t(i,".drawBuffersWEBGL(",u,");"),t("}",a,".cur=",e,";"),r||t("}")}function S(e,t,n){var r=e.shared,i=r.gl,a=e.current,s=e.next,u=r.current,c=r.next,l=e.cond(u,".dirty");re.forEach(function(t){var r,f;if(!((t=v(t))in n.state))if(t in s){r=s[t],f=a[t];var h=o(ee[t].length,function(e){return l.def(r,"[",e,"]")});l(e.cond(h.map(function(e,t){return e+"!=="+f+"["+t+"]"}).join("||")).then(i,".",oe[t],"(",h,");",h.map(function(e,t){return f+"["+t+"]="+e}).join(";"),";"))}else r=l.def(c,".",t),h=e.cond(r,"!==",u,".",t),l(h),t in ie?h(e.cond(r).then(i,".enable(",ie[t],");").else(i,".disable(",ie[t],");"),u,".",t,"=",r,";"):h(i,".",oe[t],"(",r,");",u,".",t,"=",r,";")}),0===Object.keys(n.state).length&&l(u,".dirty=false;"),t(l)}function T(e,t,n,r){var i=e.shared,o=e.current,a=i.current,s=i.gl;F(Object.keys(n)).forEach(function(i){var u=n[i];if(!r||r(u)){var c=u.append(e,t);if(ie[i]){var l=ie[i];L(u)?t(s,c?".enable(":".disable(",l,");"):t(e.cond(c).then(s,".enable(",l,");").else(s,".disable(",l,");")),t(a,".",i,"=",c,";")}else if(g(c)){var f=o[i];t(s,".",oe[i],"(",c,");",c.map(function(e,t){return f+"["+t+"]="+e}).join(";"),";")}else t(s,".",oe[i],"(",c,");",a,".",i,"=",c,";")}})}function D(e,t){$&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function B(e,t,n,r,i){function o(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function a(e){e(c=t.def(),"=",o(),";"),"string"==typeof i?e(h,".count+=",i,";"):e(h,".count++;"),p&&(r?e(l=t.def(),"=",m,".getNumPendingQueries();"):e(m,".beginQuery(",h,");"))}function s(e){e(h,".cpuTime+=",o(),"-",c,";"),p&&(r?e(m,".pushScopeStats(",l,",",m,".getNumPendingQueries(),",h,");"):e(m,".endQuery();"))}function u(e){var n=t.def(d,".profile");t(d,".profile=",e,";"),t.exit(d,".profile=",n,";")}var c,l,f=e.shared,h=e.stats,d=f.current,m=f.timer;if(n=n.profile){if(L(n))return void(n.enable?(a(t),s(t.exit),u("true")):u("false"));u(n=n.append(e,t))}else n=t.def(d,".profile");a(f=e.block()),t("if(",n,"){",f,"}"),s(e=e.block()),t.exit("if(",n,"){",e,"}")}function z(e,t,n,r,i){function o(n,r,i){function o(){t("if(!",l,".buffer){",u,".enableVertexAttribArray(",c,");}");var n,o=i.type;n=i.size?t.def(i.size,"||",r):r,t("if(",l,".type!==",o,"||",l,".size!==",n,"||",d.map(function(e){return l+"."+e+"!=="+i[e]}).join("||"),"){",u,".bindBuffer(",34962,",",f,".buffer);",u,".vertexAttribPointer(",[c,n,o,i.normalized,i.stride,i.offset],");",l,".type=",o,";",l,".size=",n,";",d.map(function(e){return l+"."+e+"="+i[e]+";"}).join(""),"}"),$&&t("if(",l,".divisor!==",o=i.divisor,"){",e.instancing,".vertexAttribDivisorANGLE(",[c,o],");",l,".divisor=",o,";}")}function s(){t("if(",l,".buffer){",u,".disableVertexAttribArray(",c,");","}if(",xe.map(function(e,t){return l+"."+e+"!=="+h[t]}).join("||"),"){",u,".vertexAttrib4f(",c,",",h,");",xe.map(function(e,t){return l+"."+e+"="+h[t]+";"}).join(""),"}")}var u=a.gl,c=t.def(n,".location"),l=t.def(a.attributes,"[",c,"]"),f=i.buffer,h=[i.x,i.y,i.z,i.w],d=["buffer","normalized","offset","stride"];1===(n=i.state)?o():2===n?s():(t("if(",n,"===",1,"){"),o(),t("}else{"),s(),t("}"))}var a=e.shared;r.forEach(function(r){var a,s=r.name,u=n.attributes[s];if(u){if(!i(u))return;a=u.append(e,t)}else{if(!i(Ae))return;var c=e.scopeAttrib(s);a={},Object.keys(new Q).forEach(function(e){a[e]=t.def(c,".",e)})}o(e.link(r),function(e){switch(e){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(r.info.type),a)})}function I(e,n,r,i,a){for(var s,u=e.shared,c=u.gl,l=0;l<i.length;++l){var f,h=(m=i[l]).name,d=m.info.type,p=r.uniforms[h],m=e.link(m)+".location";if(p){if(!a(p))continue;if(L(p)){if(h=p.value,35678===d||35680===d)n(c,".uniform1i(",m,",",(d=e.link(h._texture||h.color[0]._texture))+".bind());"),n.exit(d,".unbind();");else if(35674===d||35675===d||35676===d)p=2,35675===d?p=3:35676===d&&(p=4),n(c,".uniformMatrix",p,"fv(",m,",false,",h=e.global.def("new Float32Array(["+Array.prototype.slice.call(h)+"])"),");");else{switch(d){case 5126:s="1f";break;case 35664:s="2f";break;case 35665:s="3f";break;case 35666:s="4f";break;case 35670:case 5124:s="1i";break;case 35671:case 35667:s="2i";break;case 35672:case 35668:s="3i";break;case 35673:s="4i";break;case 35669:s="4i"}n(c,".uniform",s,"(",m,",",g(h)?Array.prototype.slice.call(h):h,");")}continue}f=p.append(e,n)}else{if(!a(Ae))continue;f=n.def(u.uniforms,"[",t.id(h),"]")}switch(35678===d?n("if(",f,"&&",f,'._reglType==="framebuffer"){',f,"=",f,".color[0];","}"):35680===d&&n("if(",f,"&&",f,'._reglType==="framebufferCube"){',f,"=",f,".color[0];","}"),h=1,d){case 35678:case 35680:d=n.def(f,"._texture"),n(c,".uniform1i(",m,",",d,".bind());"),n.exit(d,".unbind();");continue;case 5124:case 35670:s="1i";break;case 35667:case 35671:s="2i",h=2;break;case 35668:case 35672:s="3i",h=3;break;case 35669:case 35673:s="4i",h=4;break;case 5126:s="1f";break;case 35664:s="2f",h=2;break;case 35665:s="3f",h=3;break;case 35666:s="4f",h=4;break;case 35674:s="Matrix2fv";break;case 35675:s="Matrix3fv";break;case 35676:s="Matrix4fv"}if(n(c,".uniform",s,"(",m,","),"M"===s.charAt(0)){m=Math.pow(d-35674+2,2);var v=e.global.def("new Float32Array(",m,")");n("false,(Array.isArray(",f,")||",f," instanceof Float32Array)?",f,":(",o(m,function(e){return v+"["+e+"]="+f+"["+e+"]"}),",",v,")")}else n(1<h?o(h,function(e){return f+"["+e+"]"}):f);n(");")}}function H(e,t,n,r){function i(i){var o=h[i];return o?o.append(e,o.contextDep&&r.contextDynamic||o.propDep?n:t):t.def(f,".",i)}function o(){function e(){n(u,".drawElementsInstancedANGLE(",[p,g,v,m+"<<(("+v+"-5121)>>1)",s],");")}function t(){n(u,".drawArraysInstancedANGLE(",[p,m,g,s],");")}d?b?e():(n("if(",d,"){"),e(),n("}else{"),t(),n("}")):t()}function a(){function e(){n(l+".drawElements("+[p,g,v,m+"<<(("+v+"-5121)>>1)"]+");")}function t(){n(l+".drawArrays("+[p,m,g]+");")}d?b?e():(n("if(",d,"){"),e(),n("}else{"),t(),n("}")):t()}var s,u,c=e.shared,l=c.gl,f=c.draw,h=r.draw,d=function(){var i=h.elements,o=t;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(o=n),i=i.append(e,o)):i=o.def(f,".","elements"),i&&o("if("+i+")"+l+".bindBuffer(34963,"+i+".buffer.buffer);"),i}(),p=i("primitive"),m=i("offset"),g=function(){var i=h.count,o=t;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(o=n),i=i.append(e,o)):i=o.def(f,".","count"),i}();if("number"==typeof g){if(0===g)return}else n("if(",g,"){"),n.exit("}");$&&(s=i("instances"),u=e.instancing);var v=d+".type",b=h.elements&&L(h.elements);$&&("number"!=typeof s||0<=s)?"string"==typeof s?(n("if(",s,">0){"),o(),n("}else if(",s,"<0){"),a(),n("}")):o():a()}function U(e,t,n,r,i){return i=(t=x()).proc("body",i),$&&(t.instancing=i.def(t.shared.extensions,".angle_instanced_arrays")),e(t,i,n,r),t.compile().body}function V(e,t,n,r){D(e,t),z(e,t,n,r.attributes,function(){return!0}),I(e,t,n,r.uniforms,function(){return!0}),H(e,t,t,n)}function G(e,t,n,r){function i(){return!0}e.batchId="a1",D(e,t),z(e,t,n,r.attributes,i),I(e,t,n,r.uniforms,i),H(e,t,t,n)}function W(e,t,n,r){function i(e){return e.contextDep&&a||e.propDep}function o(e){return!i(e)}D(e,t);var a=n.contextDep,s=t.def(),u=t.def();e.shared.props=u,e.batchId=s;var c=e.scope(),l=e.scope();t(c.entry,"for(",s,"=0;",s,"<","a1",";++",s,"){",u,"=","a0","[",s,"];",l,"}",c.exit),n.needsContext&&A(e,l,n.context),n.needsFramebuffer&&C(e,l,n.framebuffer),T(e,l,n.state,i),n.profile&&i(n.profile)&&B(e,l,n,!1,!0),r?(z(e,c,n,r.attributes,o),z(e,l,n,r.attributes,i),I(e,c,n,r.uniforms,o),I(e,l,n,r.uniforms,i),H(e,c,l,n)):(t=e.global.def("{}"),r=n.shader.progVar.append(e,l),u=l.def(r,".id"),c=l.def(t,"[",u,"]"),l(e.shared.gl,".useProgram(",r,".program);","if(!",c,"){",c,"=",t,"[",u,"]=",e.link(function(t){return U(G,e,n,t,2)}),"(",r,");}",c,".call(this,a0[",s,"],",s,");"))}function X(e,n){function r(t){var r=n.shader[t];r&&i.set(o.shader,"."+t,r.append(e,i))}var i=e.proc("scope",3);e.batchId="a2";var o=e.shared,a=o.current;A(e,i,n.context),n.framebuffer&&n.framebuffer.append(e,i),F(Object.keys(n.state)).forEach(function(t){var r=n.state[t].append(e,i);g(r)?r.forEach(function(n,r){i.set(e.next[t],"["+r+"]",n)}):i.set(o.next,"."+t,r)}),B(e,i,n,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(t){var r=n.draw[t];r&&i.set(o.draw,"."+t,""+r.append(e,i))}),Object.keys(n.uniforms).forEach(function(r){i.set(o.uniforms,"["+t.id(r)+"]",n.uniforms[r].append(e,i))}),Object.keys(n.attributes).forEach(function(t){var r=n.attributes[t].append(e,i),o=e.scopeAttrib(t);Object.keys(new Q).forEach(function(e){i.set(o,"."+e,r[e])})}),r("vert"),r("frag"),0<Object.keys(n.state).length&&(i(a,".dirty=true;"),i.exit(a,".dirty=true;")),i("a1(",e.shared.context,",a0,",e.batchId,");")}function Y(e,t,n){var r=t.static[n];if(r&&function(e){if("object"==typeof e&&!g(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(q.isDynamic(e[t[n]]))return!0;return!1}}(r)){var i=e.global,o=Object.keys(r),a=!1,s=!1,u=!1,c=e.global.def("{}");o.forEach(function(t){var n=r[t];if(q.isDynamic(n))"function"==typeof n&&(n=r[t]=q.unbox(n)),t=P(n,null),a=a||t.thisDep,u=u||t.propDep,s=s||t.contextDep;else{switch(i(c,".",t,"="),typeof n){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(e.link(n))}i(";")}}),t.dynamic[n]=new q.DynamicVariable(4,{thisDep:a,contextDep:s,propDep:u,ref:c,append:function(e,t){o.forEach(function(n){var i=r[n];q.isDynamic(i)&&(i=e.invoke(t,i),t(c,".",n,"=",i,";"))})}}),delete t.static[n]}}var Q=l.Record,K={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(K.min=32775,K.max=32776);var $=n.angle_instanced_arrays,Z=n.webgl_draw_buffers,ee={dirty:!0,profile:m.profile},te={},re=[],ie={},oe={};b("dither",3024),b("blend.enable",3042),y("blend.color","blendColor",[0,0,0,0]),y("blend.equation","blendEquationSeparate",[32774,32774]),y("blend.func","blendFuncSeparate",[1,0,1,0]),b("depth.enable",2929,!0),y("depth.func","depthFunc",513),y("depth.range","depthRange",[0,1]),y("depth.mask","depthMask",!0),y("colorMask","colorMask",[!0,!0,!0,!0]),b("cull.enable",2884),y("cull.face","cullFace",1029),y("frontFace","frontFace",2305),y("lineWidth","lineWidth",1),b("polygonOffset.enable",32823),y("polygonOffset.offset","polygonOffset",[0,0]),b("sample.alpha",32926),b("sample.enable",32928),y("sample.coverage","sampleCoverage",[1,!1]),b("stencil.enable",2960),y("stencil.mask","stencilMask",-1),y("stencil.func","stencilFunc",[519,0,-1]),y("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),y("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),b("scissor.enable",3089),y("scissor.box","scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),y("viewport","viewport",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var ae={gl:e,context:d,strings:t,next:te,current:ee,draw:h,elements:a,buffer:i,shader:f,attributes:l.state,uniforms:c,framebuffer:u,extensions:n,timer:p,isBufferArgs:O},se={primTypes:ne,compareFuncs:Me,blendFuncs:we,blendEquations:K,stencilOps:ke,glTypes:J,orientationType:Ee};Z&&(se.backBuffer=[1029],se.drawBuffer=o(r.maxDrawbuffers,function(e){return 0===e?[0]:o(e,function(e){return 36064+e})}));var ue=0;return{next:te,current:ee,procs:function(){var e=x(),t=e.proc("poll"),n=e.proc("refresh"),i=e.block();t(i),n(i);var a,s=e.shared,u=s.gl,c=s.next,l=s.current;i(l,".dirty=false;"),C(e,t),C(e,n,null,!0),$&&(a=e.link($));for(var f=0;f<r.maxAttributes;++f){var h=n.def(s.attributes,"[",f,"]"),d=e.cond(h,".buffer");d.then(u,".enableVertexAttribArray(",f,");",u,".bindBuffer(",34962,",",h,".buffer.buffer);",u,".vertexAttribPointer(",f,",",h,".size,",h,".type,",h,".normalized,",h,".stride,",h,".offset);").else(u,".disableVertexAttribArray(",f,");",u,".vertexAttrib4f(",f,",",h,".x,",h,".y,",h,".z,",h,".w);",h,".buffer=null;"),n(d),$&&n(a,".vertexAttribDivisorANGLE(",f,",",h,".divisor);")}return Object.keys(ie).forEach(function(r){var o=ie[r],a=i.def(c,".",r),s=e.block();s("if(",a,"){",u,".enable(",o,")}else{",u,".disable(",o,")}",l,".",r,"=",a,";"),n(s),t("if(",a,"!==",l,".",r,"){",s,"}")}),Object.keys(oe).forEach(function(r){var a,s,f=oe[r],h=ee[r],d=e.block();d(u,".",f,"("),g(h)?(f=h.length,a=e.global.def(c,".",r),s=e.global.def(l,".",r),d(o(f,function(e){return a+"["+e+"]"}),");",o(f,function(e){return s+"["+e+"]="+a+"["+e+"];"}).join("")),t("if(",o(f,function(e){return a+"["+e+"]!=="+s+"["+e+"]"}).join("||"),"){",d,"}")):(a=i.def(c,".",r),s=i.def(l,".",r),d(a,");",l,".",r,"=",a,";"),t("if(",a,"!==",s,"){",d,"}")),n(d)}),e.compile()}(),compile:function(e,t,n,r,i){var o=x();return o.stats=o.link(i),Object.keys(t.static).forEach(function(e){Y(o,t,e)}),_e.forEach(function(t){Y(o,e,t)}),n=E(e,t,n,r),function(e,t){var n=e.proc("draw",1);D(e,n),A(e,n,t.context),C(e,n,t.framebuffer),S(e,n,t),T(e,n,t.state),B(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)V(e,n,t,t.shader.program);else{var i=e.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(e.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",e.link(function(n){return U(V,e,t,n,1)}),"(",r,");",a,".call(this,a0);"))}0<Object.keys(t.state).length&&n(e.shared.current,".dirty=true;")}(o,n),X(o,n),function(e,t){function n(e){return e.contextDep&&i||e.propDep}var r=e.proc("batch",2);e.batchId="0",D(e,r);var i=!1,o=!0;Object.keys(t.context).forEach(function(e){i=i||t.context[e].propDep}),i||(A(e,r,t.context),o=!1);var a=!1;if((s=t.framebuffer)?(s.propDep?i=a=!0:s.contextDep&&i&&(a=!0),a||C(e,r,s)):C(e,r,null),t.state.viewport&&t.state.viewport.propDep&&(i=!0),S(e,r,t),T(e,r,t.state,function(e){return!n(e)}),t.profile&&n(t.profile)||B(e,r,t,!1,"a1"),t.contextDep=i,t.needsContext=o,t.needsFramebuffer=a,(o=t.shader.progVar).contextDep&&i||o.propDep)W(e,r,t,null);else if(o=o.append(e,r),r(e.shared.gl,".useProgram(",o,".program);"),t.shader.program)W(e,r,t,t.shader.program);else{var s=e.global.def("{}"),u=(a=r.def(o,".id"),r.def(s,"[",a,"]"));r(e.cond(u).then(u,".call(this,a0,a1);").else(u,"=",s,"[",a,"]=",e.link(function(n){return U(W,e,t,n,2)}),"(",o,");",u,".call(this,a0,a1);"))}0<Object.keys(t.state).length&&r(e.shared.current,".dirty=true;")}(o,n),o.compile()}}}function z(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var I=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},H=0,q={DynamicVariable:e,define:function(n,r){return new e(n,t(r+""))},isDynamic:function(t){return"function"==typeof t&&!t._reglType||t instanceof e},unbox:function(t,n){return"function"==typeof t?new e(0,t):t},accessor:t},U={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},V="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},G=s();G.zero=s();var W=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(34047));var r=1,i=1;t.webgl_draw_buffers&&(r=e.getParameter(34852),i=e.getParameter(36063));var o=!!t.oes_texture_float;if(o){o=e.createTexture(),e.bindTexture(3553,o),e.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var a=e.createFramebuffer();if(e.bindFramebuffer(36160,a),e.framebufferTexture2D(36160,36064,3553,o,0),e.bindTexture(3553,null),36053!==e.checkFramebufferStatus(36160))o=!1;else{e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(16384);var s=G.allocType(5126,4);e.readPixels(0,0,1,1,6408,5126,s),e.getError()?o=!1:(e.deleteFramebuffer(a),e.deleteTexture(o),o=1===s[0]),G.freeType(s)}}return s=!0,"undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(s=e.createTexture(),a=G.allocType(5121,36),e.activeTexture(33984),e.bindTexture(34067,s),e.texImage2D(34069,0,6408,3,3,0,6408,5121,a),G.freeType(a),e.bindTexture(34067,null),e.deleteTexture(s),s=!e.getError()),{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938),readFloat:o,npotTextureCube:s}},X=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},Y=function(e){return Object.keys(e).map(function(t){return e[t]})},Q={shape:function(e){for(var t=[];e.length;e=e[0])t.push(e.length);return t},flatten:function(e,t,n,r){var i=1;if(t.length)for(var o=0;o<t.length;++o)i*=t[o];else i=0;switch(n=r||G.allocType(n,i),t.length){case 0:break;case 1:for(r=t[0],t=0;t<r;++t)n[t]=e[t];break;case 2:for(r=t[0],t=t[1],o=i=0;o<r;++o)for(var a=e[o],s=0;s<t;++s)n[i++]=a[s];break;case 3:c(e,t[0],t[1],t[2],n,0);break;default:!function e(t,n,r,i,o){for(var a=1,s=r+1;s<n.length;++s)a*=n[s];var u=n[r];if(4==n.length-r){var l=n[r+1],f=n[r+2];for(n=n[r+3],s=0;s<u;++s)c(t[s],l,f,n,i,o),o+=a}else for(s=0;s<u;++s)e(t[s],n,r+1,i,o),o+=a}(e,t,0,n,0)}return n}},K={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},J={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},$={dynamic:35048,stream:35040,static:35044},Z=Q.flatten,ee=Q.shape,te=[];te[5120]=1,te[5122]=2,te[5124]=4,te[5121]=1,te[5123]=2,te[5125]=4,te[5126]=4;var ne={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},re=new Float32Array(1),ie=new Uint32Array(re.buffer),oe=[9984,9986,9985,9987],ae=[0,6409,6410,6407,6408],se={};se[6409]=se[6406]=se[6402]=1,se[34041]=se[6410]=2,se[6407]=se[35904]=3,se[6408]=se[35906]=4;var ue=v("HTMLCanvasElement"),ce=v("CanvasRenderingContext2D"),le=v("ImageBitmap"),fe=v("HTMLImageElement"),he=v("HTMLVideoElement"),de=Object.keys(K).concat([ue,ce,le,fe,he]),pe=[];pe[5121]=1,pe[5126]=4,pe[36193]=2,pe[5123]=2,pe[5125]=4;var me=[];me[32854]=2,me[32855]=2,me[36194]=2,me[34041]=4,me[33776]=.5,me[33777]=.5,me[33778]=1,me[33779]=1,me[35986]=.5,me[35987]=1,me[34798]=1,me[35840]=.5,me[35841]=.25,me[35842]=.5,me[35843]=.25,me[36196]=.5;var ge=[];ge[32854]=2,ge[32855]=2,ge[36194]=2,ge[33189]=2,ge[36168]=1,ge[34041]=4,ge[35907]=4,ge[34836]=16,ge[34842]=8,ge[34843]=6;var ve=function(e,t,n,r,i){function o(e){this.id=c++,this.refCount=1,this.renderbuffer=e,this.format=32854,this.height=this.width=0,i.profile&&(this.stats={size:0})}function a(t){var n=t.renderbuffer;e.bindRenderbuffer(36161,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete l[t.id],r.renderbufferCount--}var s={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(s.srgba=35907),t.ext_color_buffer_half_float&&(s.rgba16f=34842,s.rgb16f=34843),t.webgl_color_buffer_float&&(s.rgba32f=34836);var u=[];Object.keys(s).forEach(function(e){u[s[e]]=e});var c=0,l={};return o.prototype.decRef=function(){0>=--this.refCount&&a(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var e=0;return Object.keys(l).forEach(function(t){e+=l[t].stats.size}),e}),{create:function(t,n){function a(t,n){var r=0,o=0,l=32854;if("object"==typeof t&&t?("shape"in t?(r=0|(o=t.shape)[0],o=0|o[1]):("radius"in t&&(r=o=0|t.radius),"width"in t&&(r=0|t.width),"height"in t&&(o=0|t.height)),"format"in t&&(l=s[t.format])):"number"==typeof t?(r=0|t,o="number"==typeof n?0|n:r):t||(r=o=1),r!==c.width||o!==c.height||l!==c.format)return a.width=c.width=r,a.height=c.height=o,c.format=l,e.bindRenderbuffer(36161,c.renderbuffer),e.renderbufferStorage(36161,l,r,o),i.profile&&(c.stats.size=ge[c.format]*c.width*c.height),a.format=u[c.format],a}var c=new o(e.createRenderbuffer());return l[c.id]=c,r.renderbufferCount++,a(t,n),a.resize=function(t,n){var r=0|t,o=0|n||r;return r===c.width&&o===c.height?a:(a.width=c.width=r,a.height=c.height=o,e.bindRenderbuffer(36161,c.renderbuffer),e.renderbufferStorage(36161,c.format,r,o),i.profile&&(c.stats.size=ge[c.format]*c.width*c.height),a)},a._reglType="renderbuffer",a._renderbuffer=c,i.profile&&(a.stats=c.stats),a.destroy=function(){c.decRef()},a},clear:function(){Y(l).forEach(a)},restore:function(){Y(l).forEach(function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,t.renderbuffer),e.renderbufferStorage(36161,t.format,t.width,t.height)}),e.bindRenderbuffer(36161,null)}}},be=[];be[6408]=4,be[6407]=3;var ye=[];ye[5121]=1,ye[5126]=4,ye[36193]=2;var xe=["x","y","z","w"],_e="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),we={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Me={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ke={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ee={cw:2304,ccw:2305},Ae=new j(!1,!1,!1,function(){});return function(e){function t(){if(0===Q.length)w&&w.update(),Z=null;else{Z=U.next(t),f();for(var e=Q.length-1;0<=e;--e){var n=Q[e];n&&n(D,null,0)}g.flush(),w&&w.update()}}function n(){!Z&&0<Q.length&&(Z=U.next(t))}function r(){Z&&(U.cancel(t),Z=null)}function o(e){e.preventDefault(),r(),K.forEach(function(e){e()})}function a(e){g.getError(),b.restore(),L.restore(),F.restore(),N.restore(),P.restore(),H.restore(),w&&w.restore(),G.procs.refresh(),n(),J.forEach(function(e){e()})}function s(e){function t(e){var t={},n={};return Object.keys(e).forEach(function(r){var i=e[r];q.isDynamic(i)?n[r]=q.unbox(i,r):t[r]=i}),{dynamic:n,static:t}}var n=t(e.context||{}),r=t(e.uniforms||{}),i=t(e.attributes||{}),o=t(function(e){function t(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach(function(r){n[e+"."+r]=t[r]})}}var n=I({},e);return delete n.uniforms,delete n.attributes,delete n.context,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),t("blend"),t("depth"),t("cull"),t("stencil"),t("polygonOffset"),t("scissor"),t("sample"),n}(e)),a=(n=G.compile(o,i,r,n,e={gpuTime:0,cpuTime:0,count:0})).draw,s=n.batch,u=n.scope,c=[];return I(function(e,t){var n;if("function"==typeof e)return u.call(this,null,e,0);if("function"==typeof t)if("number"==typeof e)for(n=0;n<e;++n)u.call(this,null,t,n);else{if(!Array.isArray(e))return u.call(this,e,t,0);for(n=0;n<e.length;++n)u.call(this,e[n],t,n)}else if("number"==typeof e){if(0<e)return s.call(this,function(e){for(;c.length<e;)c.push(null);return c}(0|e),0|e)}else{if(!Array.isArray(e))return a.call(this,e);if(e.length)return s.call(this,e,e.length)}},{stats:e})}function u(e,t){var n=0;G.procs.poll();var r=t.color;r&&(g.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=16384),"depth"in t&&(g.clearDepth(+t.depth),n|=256),"stencil"in t&&(g.clearStencil(0|t.stencil),n|=1024),g.clear(n)}function c(e){return Q.push(e),n(),{cancel:function(){var t=z(Q,e);Q[t]=function e(){var t=z(Q,e);Q[t]=Q[Q.length-1],--Q.length,0>=Q.length&&r()}}}}function l(){var e=X.viewport,t=X.scissor_box;e[0]=e[1]=t[0]=t[1]=0,D.viewportWidth=D.framebufferWidth=D.drawingBufferWidth=e[2]=t[2]=g.drawingBufferWidth,D.viewportHeight=D.framebufferHeight=D.drawingBufferHeight=e[3]=t[3]=g.drawingBufferHeight}function f(){D.tick+=1,D.time=m(),l(),G.procs.poll()}function h(){l(),G.procs.refresh(),w&&w.update()}function m(){return(V()-M)/1e3}if(!(e=i(e)))return null;var g=e.gl,v=g.getContextAttributes();g.isContextLost();var b=function(e,t){function n(t){var n;t=t.toLowerCase();try{n=r[t]=e.getExtension(t)}catch(e){}return!!n}for(var r={},i=0;i<t.extensions.length;++i){var o=t.extensions[i];if(!n(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach(function(e){if(r[e]&&!n(e))throw Error("(regl): error restoring extension "+e)})}}}(g,e);if(!b)return null;var y=function(){var e={"":0},t=[""];return{id:function(n){var r=e[n];return r||(r=e[n]=t.length,t.push(n),r)},str:function(e){return t[e]}}}(),x={bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},_=b.extensions,w=function(e,t){function n(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function r(e,t,r){var i=a.pop()||new n;i.startQueryIndex=e,i.endQueryIndex=t,i.sum=0,i.stats=r,s.push(i)}if(!t.ext_disjoint_timer_query)return null;var i=[],o=[],a=[],s=[],u=[],c=[];return{beginQuery:function(e){var n=i.pop()||t.ext_disjoint_timer_query.createQueryEXT();t.ext_disjoint_timer_query.beginQueryEXT(35007,n),o.push(n),r(o.length-1,o.length,e)},endQuery:function(){t.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:r,update:function(){var e,n;if(0!==(e=o.length)){c.length=Math.max(c.length,e+1),u.length=Math.max(u.length,e+1),u[0]=0;var r=c[0]=0;for(n=e=0;n<o.length;++n)t.ext_disjoint_timer_query.getQueryObjectEXT(l=o[n],34919)?(r+=t.ext_disjoint_timer_query.getQueryObjectEXT(l,34918),i.push(l)):o[e++]=l,u[n+1]=r,c[n+1]=e;for(o.length=e,n=e=0;n<s.length;++n){var l,f=(r=s[n]).startQueryIndex;r.sum+=u[l=r.endQueryIndex]-u[f],(l=c[l])===(f=c[f])?(r.stats.gpuTime+=r.sum/1e6,a.push(r)):(r.startQueryIndex=f,r.endQueryIndex=l,s[e++]=r)}s.length=e}},getNumPendingQueries:function(){return o.length},clear:function(){i.push.apply(i,o);for(var e=0;e<i.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(i[e]);o.length=0,i.length=0},restore:function(){o.length=0,i.length=0}}}(0,_),M=V(),T=g.drawingBufferHeight,D={tick:0,time:0,viewportWidth:O=g.drawingBufferWidth,viewportHeight:T,framebufferWidth:O,framebufferHeight:T,drawingBufferWidth:O,drawingBufferHeight:T,pixelRatio:e.pixelRatio},R=W(g,_),O=function(e,t,n,r){for(e=n.maxAttributes,t=Array(e),n=0;n<e;++n)t[n]=new A;return{Record:A,scope:{},state:t}}(g,_,R),F=d(g,x,e,O),j=p(g,_,F,x),L=C(g,y,x,e),N=k(g,_,R,function(){G.procs.poll()},D,x,e),P=ve(g,_,0,x,e),H=E(g,_,R,N,P,x),G=B(g,y,_,R,F,j,0,H,{},O,L,{elements:null,primitive:4,count:-1,offset:0,instances:-1},D,w,e),X=(y=S(g,H,G.procs.poll,D),G.next),Y=g.canvas,Q=[],K=[],J=[],$=[e.onDestroy],Z=null;Y&&(Y.addEventListener("webglcontextlost",o,!1),Y.addEventListener("webglcontextrestored",a,!1));var ee=H.setFBO=s({framebuffer:q.define.call(null,1,"framebuffer")});return h(),v=I(s,{clear:function(e){if("framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;6>t;++t)ee(I({framebuffer:e.framebuffer.faces[t]},e),u);else ee(e,u);else u(0,e)},prop:q.define.bind(null,1),context:q.define.bind(null,2),this:q.define.bind(null,3),draw:s({}),buffer:function(e){return F.create(e,34962,!1,!1)},elements:function(e){return j.create(e,!1)},texture:N.create2D,cube:N.createCube,renderbuffer:P.create,framebuffer:H.create,framebufferCube:H.createCube,attributes:v,frame:c,on:function(e,t){var n;switch(e){case"frame":return c(t);case"lost":n=K;break;case"restore":n=J;break;case"destroy":n=$}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t){n[e]=n[n.length-1],n.pop();break}}}},limits:R,hasExtension:function(e){return 0<=R.extensions.indexOf(e.toLowerCase())},read:y,destroy:function(){Q.length=0,r(),Y&&(Y.removeEventListener("webglcontextlost",o),Y.removeEventListener("webglcontextrestored",a)),L.clear(),H.clear(),P.clear(),N.clear(),j.clear(),F.clear(),w&&w.clear(),$.forEach(function(e){e()})},_gl:g,_refresh:h,poll:function(){f(),w&&w.update()},now:m,stats:x}),e.onDone(null,v),v}},"object"==typeof n&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define(i):r.createREGL=i()},{}],130:[function(e,t,n){(function(e){t.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],131:[function(e,t,n){(function(e){"use strict";var n=256,r=[],i=void 0===e?window:e,o=Math.pow(n,6),a=Math.pow(2,52),s=2*a,u=n-1,c=Math.random;function l(e){var t,r=e.length,i=this,o=0,a=i.i=i.j=0,s=i.S=[];for(r||(e=[r++]);o<n;)s[o]=o++;for(o=0;o<n;o++)s[o]=s[a=u&a+e[o%r]+(t=s[o])],s[a]=t;(i.g=function(e){for(var t,r=0,o=i.i,a=i.j,s=i.S;e--;)t=s[o=u&o+1],r=r*n+s[u&(s[o]=s[a=u&a+t])+(s[a]=t)];return i.i=o,i.j=a,r})(n)}function f(e,t){for(var n,r=e+"",i=0;i<r.length;)t[u&i]=u&(n^=19*t[u&i])+r.charCodeAt(i++);return h(t)}function h(e){return String.fromCharCode.apply(0,e)}t.exports=function(e,u){if(u&&!0===u.global)return u.global=!1,Math.random=t.exports(e,u),u.global=!0,Math.random;var c=[],d=(f(function e(t,n){var r,i=[],o=(typeof t)[0];if(n&&"o"==o)for(r in t)try{i.push(e(t[r],n-1))}catch(e){}return i.length?i:"s"==o?t:t+"\0"}(u&&u.entropy||!1?[e,h(r)]:0 in arguments?e:function(e){try{return i.crypto.getRandomValues(e=new Uint8Array(n)),h(e)}catch(e){return[+new Date,i,i.navigator&&i.navigator.plugins,i.screen,h(r)]}}(),3),c),new l(c));return f(h(d.S),r),function(){for(var e=d.g(6),t=o,r=0;e<a;)e=(e+r)*n,t*=n,r=d.g(1);for(;e>=s;)e/=2,t/=2,r>>>=1;return(e+r)/t}},t.exports.resetGlobal=function(){Math.random=c},f(Math.random(),r)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],132:[function(e,t,n){!function(){"use strict";var e=.5*(Math.sqrt(3)-1),r=(3-Math.sqrt(3))/6,i=1/6,o=(Math.sqrt(5)-1)/4,a=(5-Math.sqrt(5))/20;function s(e){var t;t="function"==typeof e?e:e?function(){var e=0,t=0,n=0,r=1,i=(o=4022871197,function(e){e=e.toString();for(var t=0;t<e.length;t++){var n=.02519603282416938*(o+=e.charCodeAt(t));n-=o=n>>>0,o=(n*=o)>>>0,o+=4294967296*(n-=o)}return 2.3283064365386963e-10*(o>>>0)});var o;e=i(" "),t=i(" "),n=i(" ");for(var a=0;a<arguments.length;a++)(e-=i(arguments[a]))<0&&(e+=1),(t-=i(arguments[a]))<0&&(t+=1),(n-=i(arguments[a]))<0&&(n+=1);return i=null,function(){var i=2091639*e+2.3283064365386963e-10*r;return e=t,t=n,n=i-(r=0|i)}}(e):Math.random,this.p=u(t),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(var n=0;n<512;n++)this.perm[n]=this.p[255&n],this.permMod12[n]=this.perm[n]%12}function u(e){var t,n=new Uint8Array(256);for(t=0;t<256;t++)n[t]=t;for(t=0;t<255;t++){var r=t+~~(e()*(256-t)),i=n[t];n[t]=n[r],n[r]=i}return n}s.prototype={grad3:new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),grad4:new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]),noise2D:function(t,n){var i,o,a=this.permMod12,s=this.perm,u=this.grad3,c=0,l=0,f=0,h=(t+n)*e,d=Math.floor(t+h),p=Math.floor(n+h),m=(d+p)*r,g=t-(d-m),v=n-(p-m);g>v?(i=1,o=0):(i=0,o=1);var b=g-i+r,y=v-o+r,x=g-1+2*r,_=v-1+2*r,w=255&d,M=255&p,k=.5-g*g-v*v;if(k>=0){var E=3*a[w+s[M]];c=(k*=k)*k*(u[E]*g+u[E+1]*v)}var A=.5-b*b-y*y;if(A>=0){var C=3*a[w+i+s[M+o]];l=(A*=A)*A*(u[C]*b+u[C+1]*y)}var S=.5-x*x-_*_;if(S>=0){var T=3*a[w+1+s[M+1]];f=(S*=S)*S*(u[T]*x+u[T+1]*_)}return 70*(c+l+f)},noise3D:function(e,t,n){var r,o,a,s,u,c,l,f,h,d,p=this.permMod12,m=this.perm,g=this.grad3,v=(e+t+n)*(1/3),b=Math.floor(e+v),y=Math.floor(t+v),x=Math.floor(n+v),_=(b+y+x)*i,w=e-(b-_),M=t-(y-_),k=n-(x-_);w>=M?M>=k?(u=1,c=0,l=0,f=1,h=1,d=0):w>=k?(u=1,c=0,l=0,f=1,h=0,d=1):(u=0,c=0,l=1,f=1,h=0,d=1):M<k?(u=0,c=0,l=1,f=0,h=1,d=1):w<k?(u=0,c=1,l=0,f=0,h=1,d=1):(u=0,c=1,l=0,f=1,h=1,d=0);var E=w-u+i,A=M-c+i,C=k-l+i,S=w-f+2*i,T=M-h+2*i,D=k-d+2*i,R=w-1+.5,O=M-1+.5,F=k-1+.5,j=255&b,L=255&y,N=255&x,P=.6-w*w-M*M-k*k;if(P<0)r=0;else{var B=3*p[j+m[L+m[N]]];r=(P*=P)*P*(g[B]*w+g[B+1]*M+g[B+2]*k)}var z=.6-E*E-A*A-C*C;if(z<0)o=0;else{var I=3*p[j+u+m[L+c+m[N+l]]];o=(z*=z)*z*(g[I]*E+g[I+1]*A+g[I+2]*C)}var H=.6-S*S-T*T-D*D;if(H<0)a=0;else{var q=3*p[j+f+m[L+h+m[N+d]]];a=(H*=H)*H*(g[q]*S+g[q+1]*T+g[q+2]*D)}var U=.6-R*R-O*O-F*F;if(U<0)s=0;else{var V=3*p[j+1+m[L+1+m[N+1]]];s=(U*=U)*U*(g[V]*R+g[V+1]*O+g[V+2]*F)}return 32*(r+o+a+s)},noise4D:function(e,t,n,r){var i,s,u,c,l,f,h,d,p,m,g,v,b,y,x,_,w,M=this.perm,k=this.grad4,E=(e+t+n+r)*o,A=Math.floor(e+E),C=Math.floor(t+E),S=Math.floor(n+E),T=Math.floor(r+E),D=(A+C+S+T)*a,R=e-(A-D),O=t-(C-D),F=n-(S-D),j=r-(T-D),L=0,N=0,P=0,B=0;R>O?L++:N++,R>F?L++:P++,R>j?L++:B++,O>F?N++:P++,O>j?N++:B++,F>j?P++:B++;var z=R-(f=L>=3?1:0)+a,I=O-(h=N>=3?1:0)+a,H=F-(d=P>=3?1:0)+a,q=j-(p=B>=3?1:0)+a,U=R-(m=L>=2?1:0)+2*a,V=O-(g=N>=2?1:0)+2*a,G=F-(v=P>=2?1:0)+2*a,W=j-(b=B>=2?1:0)+2*a,X=R-(y=L>=1?1:0)+3*a,Y=O-(x=N>=1?1:0)+3*a,Q=F-(_=P>=1?1:0)+3*a,K=j-(w=B>=1?1:0)+3*a,J=R-1+4*a,$=O-1+4*a,Z=F-1+4*a,ee=j-1+4*a,te=255&A,ne=255&C,re=255&S,ie=255&T,oe=.6-R*R-O*O-F*F-j*j;if(oe<0)i=0;else{var ae=M[te+M[ne+M[re+M[ie]]]]%32*4;i=(oe*=oe)*oe*(k[ae]*R+k[ae+1]*O+k[ae+2]*F+k[ae+3]*j)}var se=.6-z*z-I*I-H*H-q*q;if(se<0)s=0;else{var ue=M[te+f+M[ne+h+M[re+d+M[ie+p]]]]%32*4;s=(se*=se)*se*(k[ue]*z+k[ue+1]*I+k[ue+2]*H+k[ue+3]*q)}var ce=.6-U*U-V*V-G*G-W*W;if(ce<0)u=0;else{var le=M[te+m+M[ne+g+M[re+v+M[ie+b]]]]%32*4;u=(ce*=ce)*ce*(k[le]*U+k[le+1]*V+k[le+2]*G+k[le+3]*W)}var fe=.6-X*X-Y*Y-Q*Q-K*K;if(fe<0)c=0;else{var he=M[te+y+M[ne+x+M[re+_+M[ie+w]]]]%32*4;c=(fe*=fe)*fe*(k[he]*X+k[he+1]*Y+k[he+2]*Q+k[he+3]*K)}var de=.6-J*J-$*$-Z*Z-ee*ee;if(de<0)l=0;else{var pe=M[te+1+M[ne+1+M[re+1+M[ie+1]]]]%32*4;l=(de*=de)*de*(k[pe]*J+k[pe+1]*$+k[pe+2]*Z+k[pe+3]*ee)}return 27*(i+s+u+c+l)}},s._buildPermutationTable=u,"undefined"!=typeof define&&define.amd&&define(function(){return s}),void 0!==n?n.SimplexNoise=s:"undefined"!=typeof window&&(window.SimplexNoise=s),void 0!==t&&(t.exports=s)}()},{}],133:[function(e,t,n){var r,i;r=this,i=function(e){"use strict";e.createSpring=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;r=r||n;var i=n;return{updateValue:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];i=e,t||(n=e,r=e)},isAtDestination:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.EPSILON;return Math.abs(n-i)<=e&&Math.abs(n-r)<=e},tick:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(o<1)throw new Error("tick() expects `steps` to be greater than 0");if(!Number.isInteger(o))throw new Error("tick() expects `steps` to be an integer");for(var s=n,u=r;o--;){var c=s-u,l=i-s,f=l*e,h=c*-t,d=f+h,p=d+c+s;u=s,s=p}return a&&(r=u,n=s),s}}},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof n&&void 0!==t?i(n):"function"==typeof define&&define.amd?define(["exports"],i):i(r.SpringAnimator=r.SpringAnimator||{})},{}],134:[function(e,t,n){"use strict";var r=e("parse-unit");t.exports=s;var i=a("in",document.body);function o(e,t){var n=r(getComputedStyle(e).getPropertyValue(t));return n[0]*s(n[1],e)}function a(e,t){var n=document.createElement("div");n.style.height="128"+e,t.appendChild(n);var r=o(n,"height")/128;return t.removeChild(n),r}function s(e,t){if(!e)return null;switch(t=t||document.body,e=(e+""||"px").trim().toLowerCase(),t!==window&&t!==document||(t=document.body),e){case"%":return t.clientHeight/100;case"ch":case"ex":return a(e,t);case"em":return o(t,"font-size");case"rem":return o(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return i;case"cm":return i/2.54;case"mm":return i/25.4;case"pt":return i/72;case"pc":return i/6;case"px":return 1}var n=r(e);if(!isNaN(n[0])&&n[1]){var u=s(n[1],t);return"number"==typeof u?n[0]*u:null}return null}},{"parse-unit":126}],135:[function(e,t,n){"use strict";t.exports=function(e){var t=(e=e||{}).center||[0,0,0],n=e.up||[0,1,0],r=e.right||f(n),i=e.radius||1,o=e.theta||0,l=e.phi||0;if(t=[].slice.call(t,0,3),n=[].slice.call(n,0,3),s(n,n),r=[].slice.call(r,0,3),s(r,r),"eye"in e){var d=e.eye,p=[d[0]-t[0],d[1]-t[1],d[2]-t[2]];a(r,p,n),c(r[0],r[1],r[2])<1e-6?r=f(n):s(r,r),i=c(p[0],p[1],p[2]);var m=u(n,p)/i,g=u(r,p)/i;l=Math.acos(m),o=Math.acos(g)}return i=Math.log(i),new h(e.zoomMin,e.zoomMax,t,n,r,i,o,l)};var r=e("filtered-vector"),i=e("gl-mat4/invert"),o=e("gl-mat4/rotate"),a=e("gl-vec3/cross"),s=e("gl-vec3/normalize"),u=e("gl-vec3/dot");function c(e,t,n){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(n,2))}function l(e){return Math.min(1,Math.max(-1,e))}function f(e){var t=Math.abs(e[0]),n=Math.abs(e[1]),r=Math.abs(e[2]),i=[0,0,0];t>Math.max(n,r)?i[2]=1:n>Math.max(t,r)?i[0]=1:i[1]=1;for(var o=0,a=0,u=0;u<3;++u)o+=e[u]*e[u],a+=i[u]*e[u];for(u=0;u<3;++u)i[u]-=a/o*e[u];return s(i,i),i}function h(e,t,n,i,o,a,s,u){this.center=r(n),this.up=r(i),this.right=r(o),this.radius=r([a]),this.angle=r([s,u]),this.angle.bounds=[[-Infinity,-Math.PI/2],[Infinity,Math.PI/2]],this.setDistanceLimits(e,t),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var c=0;c<16;++c)this.computedMatrix[c]=.5;this.recalcMatrix(0)}var d=h.prototype;d.setDistanceLimits=function(e,t){e=e>0?Math.log(e):-Infinity,t=t>0?Math.log(t):Infinity,t=Math.max(t,e),this.radius.bounds[0][0]=e,this.radius.bounds[1][0]=t},d.getDistanceLimits=function(e){var t=this.radius.bounds[0];return e?(e[0]=Math.exp(t[0][0]),e[1]=Math.exp(t[1][0]),e):[Math.exp(t[0][0]),Math.exp(t[1][0])]},d.recalcMatrix=function(e){this.center.curve(e),this.up.curve(e),this.right.curve(e),this.radius.curve(e),this.angle.curve(e);for(var t=this.computedUp,n=this.computedRight,r=0,i=0,o=0;o<3;++o)i+=t[o]*n[o],r+=t[o]*t[o];var u=Math.sqrt(r),l=0;for(o=0;o<3;++o)n[o]-=t[o]*i/r,l+=n[o]*n[o],t[o]/=u;var f=Math.sqrt(l);for(o=0;o<3;++o)n[o]/=f;var h=this.computedToward;a(h,t,n),s(h,h);var d=Math.exp(this.computedRadius[0]),p=this.computedAngle[0],m=this.computedAngle[1],g=Math.cos(p),v=Math.sin(p),b=Math.cos(m),y=Math.sin(m),x=this.computedCenter,_=g*b,w=v*b,M=y,k=-g*y,E=-v*y,A=b,C=this.computedEye,S=this.computedMatrix;for(o=0;o<3;++o){var T=_*n[o]+w*h[o]+M*t[o];S[4*o+1]=k*n[o]+E*h[o]+A*t[o],S[4*o+2]=T,S[4*o+3]=0}var D=S[1],R=S[5],O=S[9],F=S[2],j=S[6],L=S[10],N=R*L-O*j,P=O*F-D*L,B=D*j-R*F,z=c(N,P,B);P/=z,B/=z,S[0]=N/=z,S[4]=P,S[8]=B;for(o=0;o<3;++o)C[o]=x[o]+S[2+4*o]*d;for(o=0;o<3;++o){l=0;for(var I=0;I<3;++I)l+=S[o+4*I]*C[I];S[12+o]=-l}S[15]=1},d.getMatrix=function(e,t){this.recalcMatrix(e);var n=this.computedMatrix;if(t){for(var r=0;r<16;++r)t[r]=n[r];return t}return n};var p=[0,0,0];d.rotate=function(e,t,n,r){if(this.angle.move(e,t,n),r){this.recalcMatrix(e);var i=this.computedMatrix;p[0]=i[2],p[1]=i[6],p[2]=i[10];for(var a=this.computedUp,s=this.computedRight,u=this.computedToward,c=0;c<3;++c)i[4*c]=a[c],i[4*c+1]=s[c],i[4*c+2]=u[c];o(i,i,r,p);for(c=0;c<3;++c)a[c]=i[4*c],s[c]=i[4*c+1];this.up.set(e,a[0],a[1],a[2]),this.right.set(e,s[0],s[1],s[2])}},d.pan=function(e,t,n,r){t=t||0,n=n||0,r=r||0,this.recalcMatrix(e);var i=this.computedMatrix,o=(Math.exp(this.computedRadius[0]),i[1]),a=i[5],s=i[9],u=c(o,a,s),l=i[0],f=i[4],h=i[8],d=l*(o/=u)+f*(a/=u)+h*(s/=u),p=c(l-=o*d,f-=a*d,h-=s*d);this.center.move(e,(l/=p)*t+o*n,(f/=p)*t+a*n,(h/=p)*t+s*n);var m=Math.exp(this.computedRadius[0]);m=Math.max(1e-4,m+r),this.radius.set(e,Math.log(m))},d.translate=function(e,t,n,r){this.center.move(e,t||0,n||0,r||0)},d.setMatrix=function(e,t,n,r){var o=1;"number"==typeof n&&(o=0|n),(o<0||o>3)&&(o=1);var a=(o+2)%3;t||(this.recalcMatrix(e),t=this.computedMatrix);var s=t[o],u=t[o+4],f=t[o+8];if(r){var h=Math.abs(s),d=Math.abs(u),p=Math.abs(f),m=Math.max(h,d,p);h===m?(s=s<0?-1:1,u=f=0):p===m?(f=f<0?-1:1,s=u=0):(u=u<0?-1:1,s=f=0)}else{var g=c(s,u,f);s/=g,u/=g,f/=g}var v,b,y=t[a],x=t[a+4],_=t[a+8],w=y*s+x*u+_*f,M=c(y-=s*w,x-=u*w,_-=f*w),k=u*(_/=M)-f*(x/=M),E=f*(y/=M)-s*_,A=s*x-u*y,C=c(k,E,A);if(k/=C,E/=C,A/=C,this.center.jump(e,q,U,V),this.radius.idle(e),this.up.jump(e,s,u,f),this.right.jump(e,y,x,_),2===o){var S=t[1],T=t[5],D=t[9];v=j<0?-Math.PI/2:Math.PI/2,b=Math.atan2(S*k+T*E+D*A,S*y+T*x+D*_)}else{var R=t[2],O=t[6],F=t[10],j=R*s+O*u+F*f,L=R*y+O*x+F*_,N=R*k+O*E+F*A;v=Math.asin(l(j)),b=Math.atan2(N,L)}this.angle.jump(e,b,v),this.recalcMatrix(e);var P=t[2],B=t[6],z=t[10],I=this.computedMatrix;i(I,t);var H=I[15],q=I[12]/H,U=I[13]/H,V=I[14]/H,G=Math.exp(this.computedRadius[0]);this.center.jump(e,q-P*G,U-B*G,V-z*G)},d.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},d.idle=function(e){this.center.idle(e),this.up.idle(e),this.right.idle(e),this.radius.idle(e),this.angle.idle(e)},d.flush=function(e){this.center.flush(e),this.up.flush(e),this.right.flush(e),this.radius.flush(e),this.angle.flush(e)},d.setDistance=function(e,t){t>0&&this.radius.set(e,Math.log(t))},d.lookAt=function(e,t,n,r){this.recalcMatrix(e),t=t||this.computedEye,n=n||this.computedCenter;var i=(r=r||this.computedUp)[0],o=r[1],a=r[2],s=c(i,o,a);if(!(s<1e-6)){i/=s,o/=s,a/=s;var u=t[0]-n[0],f=t[1]-n[1],h=t[2]-n[2],d=c(u,f,h);if(!(d<1e-6)){u/=d,f/=d,h/=d;var p=this.computedRight,m=p[0],g=p[1],v=p[2],b=i*m+o*g+a*v,y=c(m-=b*i,g-=b*o,v-=b*a);if(!(y<.01&&(y=c(m=o*h-a*f,g=a*u-i*h,v=i*f-o*u))<1e-6)){m/=y,g/=y,v/=y,this.up.set(e,i,o,a),this.right.set(e,m,g,v),this.center.set(e,n[0],n[1],n[2]),this.radius.set(e,Math.log(d));var x=o*v-a*g,_=a*m-i*v,w=i*g-o*m,M=c(x,_,w),k=m*u+g*f+v*h,E=(x/=M)*u+(_/=M)*f+(w/=M)*h,A=Math.asin(l(i*u+o*f+a*h)),C=Math.atan2(E,k),S=this.angle._state,T=S[S.length-1],D=S[S.length-2];T%=2*Math.PI;var R=Math.abs(T+2*Math.PI-C),O=Math.abs(T-C),F=Math.abs(T-2*Math.PI-C);R<O&&(T+=2*Math.PI),F<O&&(T-=2*Math.PI),this.angle.jump(this.angle.lastT(),T,D),this.angle.set(e,C,A)}}}}},{"filtered-vector":29,"gl-mat4/invert":48,"gl-mat4/rotate":54,"gl-vec3/cross":69,"gl-vec3/dot":74,"gl-vec3/normalize":91}],136:[function(e,t,n){const r=e("canvas-sketch"),i=e("regl"),{GUI:o}=e("dat-gui"),{random:a}=e("canvas-sketch-util"),s=e("./common/create-roaming-camera"),u=e("gl-mat4"),c=e("gl-vec3"),l=e("d3-color"),f=()=>p(),h={seed:0,pointCount:2e5,pointSize:15,noiseMag:80,freq:.7,cameraDist:5,hueSpread:200,hueStart:160,saturation:50,lightness:50};let d,p,m=()=>{},g=a.createRandom(h.seed);const v=new o;v.add(h,"seed",0,9999).step(1).onChange(f),v.add(h,"pointCount",0,1e6).step(1).onChange(f),v.add(h,"pointSize",1,100).onChange(f),v.add(h,"noiseMag",0,100).onChange(f),v.add(h,"freq",0,3).onChange(f),v.add(h,"hueStart",0,360).onChange(f),v.add(h,"hueSpread",0,360).onChange(f),v.add(h,"saturation",0,100).onChange(f),v.add(h,"lightness",0,100).onChange(f),v.add(h,"cameraDist",0,10),v.add({next:()=>m()},"next");r(({gl:e,width:t,height:n})=>{const r=s({canvas:e.canvas,zoomSpeed:4,center:[1,1,1],eye:[0,0,0],dampening:.01,stiffness:1.5,getCameraPosition:()=>g.onSphere(h.cameraDist)});m=r.moveToNextPosition;const o=u.perspective([],Math.PI/4,t/n,.01,1e3),f=i({gl:e,extensions:"OES_standard_derivatives"});return(p=function(){const e=(g=a.createRandom(h.seed)).insideSphere(500),t=new Array(h.pointCount).fill(null).map(()=>{const t=g.insideSphere(),[n,r,i]=t,o=(g.noise3D(n,r,i,h.freq)+1)*Math.PI,a=g.noise3D(n+e[0],r+e[1],i+e[2],h.freq),s=Math.acos(a),u=h.noiseMag/100,f=[u*Math.sin(s)*Math.cos(o),u*Math.sin(s)*Math.sin(o),u*Math.cos(s)],d=(.5*a+.5)*h.hueSpread+h.hueStart,{r:p,g:m,b:v}=l.rgb(`hsl(${d}, ${h.saturation}%, ${h.lightness}%)`);return{position:c.add(t,t,f),size:g.range(.5,h.pointSize),color:[p,m,v].map(e=>e/255)}});console.log(t),d=f({vert:"\n        precision highp float;\n        attribute vec3 position;\n        attribute float size;\n        attribute vec3 color;\n\n        uniform mat4 projection;\n        uniform mat4 view;\n        varying vec3 pointColor;\n        \n        void main() {\n          gl_Position = projection * view * vec4(position, 1);\n          gl_PointSize = size;\n          pointColor = color;\n        }\n      ",frag:"\n        #extension GL_OES_standard_derivatives : enable\n        precision highp float;\n        varying vec3 pointColor;\n        void main() {\n          vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n          float r = dot(cxy, cxy);\n          float delta = fwidth(r);\n          float alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n          if (r > 1.0) {\n            discard;\n          }\n          gl_FragColor = vec4(pointColor * alpha, alpha);\n        }\n      ",uniforms:{view:r.getMatrix,projection:o},attributes:{position:t.map(e=>e.position),size:t.map(e=>e.size),color:t.map(e=>e.color)},blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:1,dstRGB:"one minus src alpha",dstAlpha:1},equation:{rgb:"add",alpha:"add"}},primitive:"points",count:t.length})})(),({})=>{f.poll(),r.tick(),f.clear({color:[1,1,1,1],depth:1}),d()}},{animate:!0,context:"webgl",attributes:{antialias:!0},dimensions:[800,800]})},{"./common/create-roaming-camera":137,"canvas-sketch":21,"canvas-sketch-util":7,"d3-color":24,"dat-gui":25,"gl-mat4":47,"gl-vec3":81,regl:129}],137:[function(e,t,n){const{createSpring:r}=e("spring-animator"),i=e("3d-view-controls");t.exports=function(e){const{canvas:t,zoomSpeed:n,center:o,eye:a,getCameraPosition:s,dampening:u,stiffness:c,moveEveryNFrames:l}=e,f=l||600;let h=!0,d=0;t.addEventListener("mousedown",y);const p=i(t,{zoomSpeed:n}),m=r(u,c,o[0]),g=r(u,c,o[1]),v=r(u,c,o[2]);function b(){const[e,t,n]=s();m.updateValue(e),g.updateValue(t),v.updateValue(n)}function y(){h=!1,d=0}function x(){m.updateValue(p.eye[0],!1),g.updateValue(p.eye[1],!1),v.updateValue(p.eye[2],!1),b(),d=0,h=!0}return p.lookAt(o,a,[1,1,1]),b(),window.camera=p,{tick:function(){d+=1,p.tick(),h&&(p.center=[m.tick(),g.tick(),v.tick()]),d>=f&&(b(),d=0)},getMatrix:function(){return p.matrix},getCenter:function(){return p.center},startRoaming:x,stopRoaming:y,_camera:p,moveToNextPosition:x}}},{"3d-view-controls":1,"spring-animator":133}],138:[function(e,t,n){(function(e){e.CANVAS_SKETCH_DEFAULT_STORAGE_KEY=window.location.href}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[136,138]);</script>