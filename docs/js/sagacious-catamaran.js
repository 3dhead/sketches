!function(){function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[a]={exports:{}};t[a][0].call(f.exports,function(e){return i(t[a][1][e]||e)},f,f.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}return e}()({1:[function(e,t,n){"use strict";function r(e,t){function n(t,n,r,o){var a=1/e.clientHeight,s=a*(n-v),u=a*(r-g),c=m.flipX?1:-1,l=m.flipY?1:-1,d=Math.PI*m.rotateSpeed,p=i();if(1&t)o.shift?f.rotate(p,0,0,-s*d):f.rotate(p,c*d*s,-l*d*u,0);else if(2&t)f.pan(p,-m.translateSpeed*s*h,m.translateSpeed*u*h,0);else if(4&t){var _=m.zoomSpeed*u/window.innerHeight*(p-f.lastT())*50;f.pan(p,0,0,h*(Math.exp(_)-1))}v=n,g=r,b=o}e=e||document.body,t=t||{};var r=[.01,1/0];"distanceLimits"in t&&(r[0]=t.distanceLimits[0],r[1]=t.distanceLimits[1]),"zoomMin"in t&&(r[0]=t.zoomMin),"zoomMax"in t&&(r[1]=t.zoomMax);var f=o({center:t.center||[0,0,0],up:t.up||[0,1,0],eye:t.eye||[0,0,10],mode:t.mode||"orbit",distanceLimits:r}),l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],h=0,d=e.clientWidth,p=e.clientHeight,m={view:f,element:e,delay:t.delay||16,rotateSpeed:t.rotateSpeed||1,zoomSpeed:t.zoomSpeed||1,translateSpeed:t.translateSpeed||1,flipX:!!t.flipX,flipY:!!t.flipY,modes:f.modes,tick:function(){var t=i(),n=this.delay;f.idle(t-n),f.flush(t-(100+2*n));var r=t-2*n;f.recalcMatrix(r);for(var o=!0,a=f.computedMatrix,s=0;s<16;++s)o=o&&l[s]===a[s],l[s]=a[s];var u=e.clientWidth===d&&e.clientHeight===p;return d=e.clientWidth,p=e.clientHeight,o?!u:(h=Math.exp(f.computedRadius[0]),!0)},lookAt:function(e,t,n){f.lookAt(f.lastT(),e,t,n)},rotate:function(e,t,n){f.rotate(f.lastT(),e,t,n)},pan:function(e,t,n){f.pan(f.lastT(),e,t,n)},translate:function(e,t,n){f.translate(f.lastT(),e,t,n)}};Object.defineProperties(m,{matrix:{get:function(){return f.computedMatrix},set:function(e){return f.setMatrix(f.lastT(),e),f.computedMatrix},enumerable:!0},mode:{get:function(){return f.getMode()},set:function(e){return f.setMode(e),f.getMode()},enumerable:!0},center:{get:function(){return f.computedCenter},set:function(e){return f.lookAt(f.lastT(),e),f.computedCenter},enumerable:!0},eye:{get:function(){return f.computedEye},set:function(e){return f.lookAt(f.lastT(),null,e),f.computedEye},enumerable:!0},up:{get:function(){return f.computedUp},set:function(e){return f.lookAt(f.lastT(),null,null,e),f.computedUp},enumerable:!0},distance:{get:function(){return h},set:function(e){return f.setDistance(f.lastT(),e),e},enumerable:!0},distanceLimits:{get:function(){return f.getDistanceLimits(r)},set:function(e){return f.setDistanceLimits(e),e},enumerable:!0}}),e.addEventListener("contextmenu",function(e){return e.preventDefault(),!1});var v=0,g=0,b={shift:!1,control:!1,alt:!1,meta:!1};return a(e,n),e.addEventListener("touchstart",function(t){var r=u(t.changedTouches[0],e);n(0,r[0],r[1],b),n(1,r[0],r[1],b),t.preventDefault()},!!c&&{passive:!1}),e.addEventListener("touchmove",function(t){var r=u(t.changedTouches[0],e);n(1,r[0],r[1],b),t.preventDefault()},!!c&&{passive:!1}),e.addEventListener("touchend",function(t){u(t.changedTouches[0],e);n(0,v,g,b),t.preventDefault()},!!c&&{passive:!1}),s(e,function(e,t,n){var r=m.flipX?1:-1,o=m.flipY?1:-1,a=i();if(Math.abs(e)>Math.abs(t))f.rotate(a,0,0,-e*r*Math.PI*m.rotateSpeed/window.innerWidth);else{var s=m.zoomSpeed*o*t/window.innerHeight*(a-f.lastT())/100;f.pan(a,0,0,h*(Math.exp(s)-1))}},!0),m}t.exports=r;var i=e(109),o=e(2),a=e(100),s=e(103),u=e(101),c=e(93)},{100:100,101:101,103:103,109:109,2:2,93:93}],2:[function(e,t,n){"use strict";function r(e,t){this._controllerNames=Object.keys(e),this._controllerList=this._controllerNames.map(function(t){return e[t]}),this._mode=t,this._active=e[t],this._active||(this._mode="turntable",this._active=e.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}function i(e){e=e||{};var t=e.eye||[0,0,1],n=e.center||[0,0,0],i=e.up||[0,1,0],u=e.distanceLimits||[0,1/0],c=e.mode||"turntable",f=o(),l=a(),h=s();return f.setDistanceLimits(u[0],u[1]),f.lookAt(0,t,n,i),l.setDistanceLimits(u[0],u[1]),l.lookAt(0,t,n,i),h.setDistanceLimits(u[0],u[1]),h.lookAt(0,t,n,i),new r({turntable:f,orbit:l,matrix:h},c)}t.exports=i;var o=e(112),a=e(105),s=e(99),u=r.prototype;[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]].forEach(function(e){for(var t=e[0],n=[],r=0;r<e[1];++r)n.push("a"+r);var i="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+e[0]+"("+n.join()+")}";u[t]=Function.apply(null,n.concat(i))}),u.recalcMatrix=function(e){this._active.recalcMatrix(e)},u.getDistance=function(e){return this._active.getDistance(e)},u.getDistanceLimits=function(e){return this._active.getDistanceLimits(e)},u.lastT=function(){return this._active.lastT()},u.setMode=function(e){if(e!==this._mode){var t=this._controllerNames.indexOf(e);if(!(t<0)){var n=this._active,r=this._controllerList[t],i=Math.max(n.lastT(),r.lastT());n.recalcMatrix(i),r.setMatrix(i,n.computedMatrix),this._active=r,this._mode=e,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},u.getMode=function(){return this._mode}},{105:105,112:112,99:99}],3:[function(e,t,n){!function(e,r){"object"==typeof n?t.exports=r():"function"==typeof define&&define.amd?define(r):e.Alea=r()}(this,function(){"use strict";function e(){return function(e){var n=0,r=0,i=0,o=1;0==e.length&&(e=[+new Date]);var a=t();n=a(" "),r=a(" "),i=a(" ");for(var s=0;s<e.length;s++)n-=a(e[s]),n<0&&(n+=1),r-=a(e[s]),r<0&&(r+=1),(i-=a(e[s]))<0&&(i+=1);a=null;var u=function(){var e=2091639*n+2.3283064365386963e-10*o;return n=r,r=i,i=e-(o=0|e)};return u.uint32=function(){return 4294967296*u()},u.fract53=function(){return u()+1.1102230246251565e-16*(2097152*u()|0)},u.version="Alea 0.9",u.args=e,u.exportState=function(){return[n,r,i,o]},u.importState=function(e){n=+e[0]||0,r=+e[1]||0,i=+e[2]||0,o=+e[3]||0},u}(Array.prototype.slice.call(arguments))}function t(){var e=4022871197,t=function(t){t=t.toString();for(var n=0;n<t.length;n++){e+=t.charCodeAt(n);var r=.02519603282416938*e;e=r>>>0,r-=e,r*=e,e=r>>>0,r-=e,e+=4294967296*r}return 2.3283064365386963e-10*(e>>>0)};return t.version="Mash 0.9",t}return e.importState=function(t){var n=new e;return n.importState(t),n},e})},{}],4:[function(e,t,n){"use strict";function r(e,t,n,r,i,o){var a=["function ",e,"(a,l,h,",r.join(","),"){",o?"":"var i=",n?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",i?".get(m)":"[m]"];return o?t.indexOf("c")<0?a.push(";if(x===y){return m}else if(x<=y){"):a.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):a.push(";if(",t,"){i=m;"),n?a.push("l=m+1}else{h=m-1}"):a.push("h=m-1}else{l=m+1}"),a.push("}"),o?a.push("return -1};"):a.push("return i};"),a.join("")}function i(e,t,n,i){return new Function([r("A","x"+e+"y",t,["y"],!1,i),r("B","x"+e+"y",t,["y"],!0,i),r("P","c(x,y)"+e+"0",t,["y","c"],!1,i),r("Q","c(x,y)"+e+"0",t,["y","c"],!0,i),"function dispatchBsearch",n,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",n].join(""))()}t.exports={ge:i(">=",!1,"GE"),gt:i(">",!1,"GT"),lt:i("<",!0,"LT"),le:i("<=",!0,"LE"),eq:i("-",!0,"EQ",!0)}},{}],5:[function(e,t,n){function r(e,t,n){function r(){var t=r.parent||e.parentNode;if("function"==typeof t)var n=t(o)||o,s=n[0],u=n[1];else if(t&&t!==document.body)var c=i(t),s=0|c[0],u=0|c[1];else var s=window.innerWidth,u=window.innerHeight;return a?(e.setAttribute("width",s*r.scale+"px"),e.setAttribute("height",u*r.scale+"px")):(e.width=s*r.scale,e.height=u*r.scale),e.style.width=s+"px",e.style.height=u+"px",r}var a="SVG"===e.nodeName.toUpperCase();return e.style.position=e.style.position||"absolute",e.style.top=0,e.style.left=0,r.scale=parseFloat(n||1),r.parent=t,r()}var i=e(11);t.exports=r;var o=new Float32Array(2)},{11:11}],6:[function(e,t,n){"use strict";function r(e,t,n,r,i,o){var a=6*i*i-6*i,s=3*i*i-4*i+1,u=-6*i*i+6*i,c=3*i*i-2*i;if(e.length){o||(o=new Array(e.length));for(var f=e.length-1;f>=0;--f)o[f]=a*e[f]+s*t[f]+u*n[f]+c*r[f];return o}return a*e+s*t+u*n[f]+c*r}function i(e,t,n,r,i,o){var a=i-1,s=i*i,u=a*a,c=(1+2*i)*u,f=i*u,l=s*(3-2*i),h=s*a;if(e.length){o||(o=new Array(e.length));for(var d=e.length-1;d>=0;--d)o[d]=c*e[d]+f*t[d]+l*n[d]+h*r[d];return o}return c*e+f*t+l*n+h*r}t.exports=i,t.exports.derivative=r},{}],7:[function(e,t,n){t.exports=e(9),t.exports.color=e(8)},{8:8,9:9}],8:[function(e,t,n){var r=t.exports=r||{};r.color=r.color||{},r.utils=r.utils||{},r.utils.common=function(){var e=Array.prototype.forEach,t=Array.prototype.slice;return{BREAK:{},extend:function(e){return this.each(t.call(arguments,1),function(t){for(var n in t)this.isUndefined(t[n])||(e[n]=t[n])},this),e},defaults:function(e){return this.each(t.call(arguments,1),function(t){for(var n in t)this.isUndefined(e[n])&&(e[n]=t[n])},this),e},compose:function(){var e=t.call(arguments);return function(){for(var n=t.call(arguments),r=e.length-1;r>=0;r--)n=[e[r].apply(this,n)];return n[0]}},each:function(t,n,r){if(e&&t.forEach===e)t.forEach(n,r);else if(t.length===t.length+0){for(var i=0,o=t.length;i<o;i++)if(i in t&&n.call(r,t[i],i)===this.BREAK)return}else for(var i in t)if(n.call(r,t[i],i)===this.BREAK)return},defer:function(e){setTimeout(e,0)},toArray:function(e){return e.toArray?e.toArray():t.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){return e!==e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}}}(),r.color.toString=function(e){return function(t){if(1==t.a||e.isUndefined(t.a)){for(var n=t.hex.toString(16);n.length<6;)n="0"+n;return"#"+n}return"rgba("+Math.round(t.r)+","+Math.round(t.g)+","+Math.round(t.b)+","+t.a+")"}}(r.utils.common),r.Color=r.color.Color=function(e,t,n,r){function i(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(a(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(a(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function o(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(s(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(s(this),this.__state.space="HSV"),this.__state[t]=e}})}function a(e,n,i){if("HEX"===e.__state.space)e.__state[n]=t.component_from_hex(e.__state.hex,i);else{if("HSV"!==e.__state.space)throw"Corrupted color state";r.extend(e.__state,t.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}}function s(e){var n=t.rgb_to_hsv(e.r,e.g,e.b);r.extend(e.__state,{s:n.s,v:n.v}),r.isNaN(n.h)?r.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=n.h}var u=function(){if(this.__state=e.apply(this,arguments),!1===this.__state)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return u.COMPONENTS=["r","g","b","h","s","v","hex","a"],r.extend(u.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),i(u.prototype,"r",2),i(u.prototype,"g",1),i(u.prototype,"b",0),o(u.prototype,"h"),o(u.prototype,"s"),o(u.prototype,"v"),Object.defineProperty(u.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(u.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=t.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}}),u}(r.color.interpret=function(e,t){var n,r,i=function(){r=!1;var e=arguments.length>1?t.toArray(arguments):arguments[0];return t.each(o,function(i){if(i.litmus(e))return t.each(i.conversions,function(i,o){if(n=i.read(e),!1===r&&!1!==n)return r=n,n.conversionName=o,n.conversion=i,t.BREAK}),t.BREAK}),r},o=[{litmus:t.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString())}},write:e},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString())}},write:e},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:e},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:e}}},{litmus:t.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:t.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:t.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)&&t.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)&&t.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}];return i}(r.color.toString,r.utils.common),r.color.math=function(){var e;return{hsv_to_rgb:function(e,t,n){var r=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),o=n*(1-t),a=n*(1-i*t),s=n*(1-(1-i)*t),u=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(e,t,n){var r,i,o=Math.min(e,t,n),a=Math.max(e,t,n),s=a-o;return 0==a?{h:NaN,s:0,v:0}:(i=s/a,r=e==a?(t-n)/s:t==a?2+(n-e)/s:4+(e-t)/s,r/=6,r<0&&(r+=1),{h:360*r,s:i,v:a/255})},rgb_to_hex:function(e,t,n){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),r=this.hex_with_component(r,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(t,n,r){return r<<(e=8*n)|t&~(255<<e)}}}(),r.color.toString,r.utils.common)},{}],9:[function(e,t,n){var r=t.exports=r||{};r.gui=r.gui||{},r.utils=r.utils||{},r.controllers=r.controllers||{},r.dom=r.dom||{},r.color=r.color||{},r.utils.css=function(){return{load:function(e,t){t=t||document;var n=t.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)},inject:function(e,t){t=t||document;var n=document.createElement("style");n.type="text/css",n.innerHTML=e,t.getElementsByTagName("head")[0].appendChild(n)}}}(),r.utils.common=function(){var e=Array.prototype.forEach,t=Array.prototype.slice;return{BREAK:{},extend:function(e){return this.each(t.call(arguments,1),function(t){for(var n in t)this.isUndefined(t[n])||(e[n]=t[n])},this),e},defaults:function(e){return this.each(t.call(arguments,1),function(t){for(var n in t)this.isUndefined(e[n])&&(e[n]=t[n])},this),e},compose:function(){var e=t.call(arguments);return function(){for(var n=t.call(arguments),r=e.length-1;r>=0;r--)n=[e[r].apply(this,n)];return n[0]}},each:function(t,n,r){if(e&&t.forEach===e)t.forEach(n,r);else if(t.length===t.length+0){for(var i=0,o=t.length;i<o;i++)if(i in t&&n.call(r,t[i],i)===this.BREAK)return}else for(var i in t)if(n.call(r,t[i],i)===this.BREAK)return},defer:function(e){setTimeout(e,0)},toArray:function(e){return e.toArray?e.toArray():t.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){return e!==e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}}}(),r.controllers.Controller=function(e){var t=function(e,t){this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0};return e.extend(t.prototype,{onChange:function(e){return this.__onChange=e,this},onFinishChange:function(e){return this.__onFinishChange=e,this},setValue:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),t}(r.utils.common),r.dom.dom=function(e){function t(t){if("0"===t||e.isUndefined(t))return 0;var n=t.match(i);return e.isNull(n)?0:parseFloat(n[1])}var n={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},r={};e.each(n,function(t,n){e.each(t,function(e){r[e]=n})});var i=/(\d+(\.\d+)?)px/,o={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(t,n,r){e.isUndefined(n)&&(n=!0),e.isUndefined(r)&&(r=!0),t.style.position="absolute",n&&(t.style.left=0,t.style.right=0),r&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,n,i,o){i=i||{};var a=r[n];if(!a)throw new Error("Event type "+n+" not supported.");var s=document.createEvent(a);switch(a){case"MouseEvents":var u=i.x||i.clientX||0,c=i.y||i.clientY||0;s.initMouseEvent(n,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,u,c,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var f=s.initKeyboardEvent||s.initKeyEvent;e.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),f(n,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:s.initEvent(n,i.bubbles||!1,i.cancelable||!0)}e.defaults(s,o),t.dispatchEvent(s)},bind:function(e,t,n,r){return r=r||!1,e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on"+t,n),o},unbind:function(e,t,n,r){return r=r||!1,e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on"+t,n),o},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);-1==n.indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return o},removeClass:function(e,t){if(t)if(void 0===e.className);else if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),r=n.indexOf(t);-1!=r&&(n.splice(r,1),e.className=n.join(" "))}else e.className=void 0;return o},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var n=getComputedStyle(e);return t(n["border-left-width"])+t(n["border-right-width"])+t(n["padding-left"])+t(n["padding-right"])+t(n.width)},getHeight:function(e){var n=getComputedStyle(e);return t(n["border-top-width"])+t(n["border-bottom-width"])+t(n["padding-top"])+t(n["padding-bottom"])+t(n.height)},getOffset:function(e){var t={left:0,top:0};if(e.offsetParent)do{t.left+=e.offsetLeft,t.top+=e.offsetTop}while(e=e.offsetParent);return t},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}};return o}(r.utils.common),r.controllers.OptionController=function(e,t,n){var r=function(e,i,o){r.superclass.call(this,e,i);var a=this;if(this.__select=document.createElement("select"),n.isArray(o)){var s={};n.each(o,function(e){s[e]=e}),o=s}n.each(o,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),a.__select.appendChild(n)}),this.updateDisplay(),t.bind(this.__select,"change",function(){var e=this.options[this.selectedIndex].value;a.setValue(e)}),this.domElement.appendChild(this.__select)};return r.superclass=e,n.extend(r.prototype,e.prototype,{setValue:function(e){var t=r.superclass.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),t},updateDisplay:function(){return this.__select.value=this.getValue(),r.superclass.prototype.updateDisplay.call(this)}}),r}(r.controllers.Controller,r.dom.dom,r.utils.common),r.controllers.NumberController=function(e,t){function n(e){return e=e.toString(),e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var r=function(e,i,o){r.superclass.call(this,e,i),o=o||{},this.__min=o.min,this.__max=o.max,this.__step=o.step,t.isUndefined(this.__step)?0==this.initialValue?this.__impliedStep=1:this.__impliedStep=Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__impliedStep=this.__step,this.__precision=n(this.__impliedStep)};return r.superclass=e,t.extend(r.prototype,e.prototype,{setValue:function(e){return void 0!==this.__min&&e<this.__min?e=this.__min:void 0!==this.__max&&e>this.__max&&(e=this.__max),void 0!==this.__step&&e%this.__step!=0&&(e=Math.round(e/this.__step)*this.__step),r.superclass.prototype.setValue.call(this,e)},min:function(e){return this.__min=e,this},max:function(e){return this.__max=e,this},step:function(e){return this.__step=e,this}}),r}(r.controllers.Controller,r.utils.common),r.controllers.NumberControllerBox=function(e,t,n){function r(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}var i=function(e,r,o){function a(){var e=parseFloat(h.__input.value);n.isNaN(e)||h.setValue(e)}function s(){a(),h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}function u(e){t.bind(window,"mousemove",c),t.bind(window,"mouseup",f),l=e.clientY}function c(e){var t=l-e.clientY;h.setValue(h.getValue()+t*h.__impliedStep),l=e.clientY}function f(){t.unbind(window,"mousemove",c),t.unbind(window,"mouseup",f)}this.__truncationSuspended=!1,i.superclass.call(this,e,r,o);var l,h=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),t.bind(this.__input,"change",a),t.bind(this.__input,"blur",s),t.bind(this.__input,"mousedown",u),t.bind(this.__input,"keydown",function(e){13===e.keyCode&&(h.__truncationSuspended=!0,this.blur(),h.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return i.superclass=e,n.extend(i.prototype,e.prototype,{updateDisplay:function(){return this.__input.value=this.__truncationSuspended?this.getValue():r(this.getValue(),this.__precision),i.superclass.prototype.updateDisplay.call(this)}}),i}(r.controllers.NumberController,r.dom.dom,r.utils.common),r.controllers.NumberControllerSlider=function(e,t,n,r,i){function o(e,t,n,r,i){return r+(e-t)/(n-t)*(i-r)}var a=function(e,n,r,i,s){function u(e){t.bind(window,"mousemove",c),t.bind(window,"mouseup",f),c(e)}function c(e){e.preventDefault();var n=t.getOffset(l.__background),r=t.getWidth(l.__background);return l.setValue(o(e.clientX,n.left,n.left+r,l.__min,l.__max)),!1}function f(){t.unbind(window,"mousemove",c),t.unbind(window,"mouseup",f),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}a.superclass.call(this,e,n,{min:r,max:i,step:s});var l=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),t.bind(this.__background,"mousedown",u),t.addClass(this.__background,"slider"),t.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return a.superclass=e,a.useDefaultStyles=function(){n.inject(".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}")},r.extend(a.prototype,e.prototype,{updateDisplay:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",a.superclass.prototype.updateDisplay.call(this)}}),a}(r.controllers.NumberController,r.dom.dom,r.utils.css,r.utils.common),r.controllers.FunctionController=function(e,t,n){var r=function(e,n,i){r.superclass.call(this,e,n);var o=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===i?"Fire":i,t.bind(this.__button,"click",function(e){return e.preventDefault(),o.fire(),!1}),t.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return r.superclass=e,n.extend(r.prototype,e.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),r}(r.controllers.Controller,r.dom.dom,r.utils.common),r.controllers.BooleanController=function(e,t,n){var r=function(e,n){function i(){o.setValue(!o.__prev)}r.superclass.call(this,e,n);var o=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),t.bind(this.__checkbox,"change",i,!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return r.superclass=e,n.extend(r.prototype,e.prototype,{setValue:function(e){var t=r.superclass.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),t},updateDisplay:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,r.superclass.prototype.updateDisplay.call(this)}}),r}(r.controllers.Controller,r.dom.dom,r.utils.common),r.color.toString=function(e){return function(t){if(1==t.a||e.isUndefined(t.a)){for(var n=t.hex.toString(16);n.length<6;)n="0"+n;return"#"+n}return"rgba("+Math.round(t.r)+","+Math.round(t.g)+","+Math.round(t.b)+","+t.a+")"}}(r.utils.common),r.color.interpret=function(e,t){var n,r,i=function(){r=!1;var e=arguments.length>1?t.toArray(arguments):arguments[0];return t.each(o,function(i){if(i.litmus(e))return t.each(i.conversions,function(i,o){if(n=i.read(e),!1===r&&!1!==n)return r=n,n.conversionName=o,n.conversion=i,t.BREAK}),t.BREAK}),r},o=[{litmus:t.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString())}},write:e},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString())}},write:e},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:e},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:e}}},{litmus:t.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:t.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:t.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)&&t.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)&&t.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}];return i}(r.color.toString,r.utils.common),r.GUI=r.gui.GUI=function(e,t,n,r,i,o,a,s,u,c,f,l,h,d,p){function m(e,t,n,o){if(void 0===t[n])throw new Error("Object "+t+' has no property "'+n+'"');var a;if(o.color)a=new f(t,n);else{var s=[t,n].concat(o.factoryArgs);a=r.apply(e,s)}o.before instanceof i&&(o.before=o.before.__li),b(e,a),d.addClass(a.domElement,"c");var u=document.createElement("span");d.addClass(u,"property-name"),u.innerHTML=a.property;var c=document.createElement("div");c.appendChild(u),c.appendChild(a.domElement);var l=v(e,c,o.before);return d.addClass(l,B.CLASS_CONTROLLER_ROW),d.addClass(l,typeof a.getValue()),g(e,l,a),e.__controllers.push(a),a}function v(e,t,n){var r=document.createElement("li");return t&&r.appendChild(t),n?e.__ul.insertBefore(r,params.before):e.__ul.appendChild(r),e.onResize(),r}function g(e,t,n){if(n.__li=t,n.__gui=e,p.extend(n,{options:function(t){return arguments.length>1?(n.remove(),m(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[p.toArray(arguments)]})):p.isArray(t)||p.isObject(t)?(n.remove(),m(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[t]})):void 0},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof u){var r=new s(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});p.each(["updateDisplay","onChange","onFinishChange"],function(e){var t=n[e],i=r[e];n[e]=r[e]=function(){var e=Array.prototype.slice.call(arguments);return t.apply(n,e),i.apply(r,e)}}),d.addClass(t,"has-slider"),n.domElement.insertBefore(r.domElement,n.domElement.firstElementChild)}else if(n instanceof s){var i=function(t){return p.isNumber(n.__min)&&p.isNumber(n.__max)?(n.remove(),m(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]})):t};n.min=p.compose(i,n.min),n.max=p.compose(i,n.max)}else n instanceof o?(d.bind(t,"click",function(){d.fakeEvent(n.__checkbox,"click")}),d.bind(n.__checkbox,"click",function(e){e.stopPropagation()})):n instanceof a?(d.bind(t,"click",function(){d.fakeEvent(n.__button,"click")}),d.bind(t,"mouseover",function(){
d.addClass(n.__button,"hover")}),d.bind(t,"mouseout",function(){d.removeClass(n.__button,"hover")})):n instanceof f&&(d.addClass(t,"color"),n.updateDisplay=p.compose(function(e){return t.style.borderLeftColor=n.__color.toString(),e},n.updateDisplay),n.updateDisplay());n.setValue=p.compose(function(t){return e.getRoot().__preset_select&&n.isModified()&&k(e.getRoot(),!0),t},n.setValue)}function b(e,t){var n=e.getRoot(),r=n.__rememberedObjects.indexOf(t.object);if(-1!=r){var i=n.__rememberedObjectIndecesToControllers[r];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[r]=i),i[t.property]=t,n.load&&n.load.remembered){var o,a=n.load.remembered;if(a[e.preset])o=a[e.preset];else{if(!a[D])return;o=a[D]}if(o[r]&&void 0!==o[r][t.property]){var s=o[r][t.property];t.initialValue=s,t.setValue(s)}}}}function _(e,t){return document.location.href+"."+t}function y(e){function t(){c.style.display=e.useLocalStorage?"block":"none"}var n=e.__save_row=document.createElement("li");d.addClass(e.domElement,"has-save"),e.__ul.insertBefore(n,e.__ul.firstChild),d.addClass(n,"save-row");var r=document.createElement("span");r.innerHTML="&nbsp;",d.addClass(r,"button gears");var i=document.createElement("span");i.innerHTML="Save",d.addClass(i,"button"),d.addClass(i,"save");var o=document.createElement("span");o.innerHTML="New",d.addClass(o,"button"),d.addClass(o,"save-as");var a=document.createElement("span");a.innerHTML="Revert",d.addClass(a,"button"),d.addClass(a,"revert");var s=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?p.each(e.load.remembered,function(t,n){E(e,n,n==e.preset)}):E(e,D,!1),d.bind(s,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),n.appendChild(s),n.appendChild(r),n.appendChild(i),n.appendChild(o),n.appendChild(a),O){var u=document.getElementById("dg-save-locally"),c=document.getElementById("dg-local-explain");u.style.display="block";var f=document.getElementById("dg-local-storage");"true"===localStorage.getItem(_(e,"isLocal"))&&f.setAttribute("checked","checked"),t(),d.bind(f,"change",function(){e.useLocalStorage=!e.useLocalStorage,t()})}var l=document.getElementById("dg-new-constructor");d.bind(l,"keydown",function(e){!e.metaKey||67!==e.which&&67!=e.keyCode||C.hide()}),d.bind(r,"click",function(){l.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),C.show(),l.focus(),l.select()}),d.bind(i,"click",function(){e.save()}),d.bind(o,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),d.bind(a,"click",function(){e.revert()})}function x(e){function t(t){return t.preventDefault(),i=t.clientX,d.addClass(e.__closeButton,B.CLASS_DRAG),d.bind(window,"mousemove",n),d.bind(window,"mouseup",r),!1}function n(t){return t.preventDefault(),e.width+=i-t.clientX,e.onResize(),i=t.clientX,!1}function r(){d.removeClass(e.__closeButton,B.CLASS_DRAG),d.unbind(window,"mousemove",n),d.unbind(window,"mouseup",r)}e.__resize_handle=document.createElement("div"),p.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var i;d.bind(e.__resize_handle,"mousedown",t),d.bind(e.__closeButton,"mousedown",t),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function w(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function A(e,t){var n={};return p.each(e.__rememberedObjects,function(r,i){var o={},a=e.__rememberedObjectIndecesToControllers[i];p.each(a,function(e,n){o[n]=t?e.initialValue:e.getValue()}),n[i]=o}),n}function E(e,t,n){var r=document.createElement("option");r.innerHTML=t,r.value=t,e.__preset_select.appendChild(r),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function M(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value==e.preset&&(e.__preset_select.selectedIndex=t)}function k(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}function S(e){0!=e.length&&l(function(){S(e)}),p.each(e,function(e){e.updateDisplay()})}e.inject(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");var C,T,D="Default",O=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}(),L=!0,z=!1,j=[],B=function(e){function t(){localStorage.setItem(_(n,"gui"),JSON.stringify(n.getSaveObject()))}var n=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),d.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],e=e||{},e=p.defaults(e,{autoPlace:!0,width:B.DEFAULT_WIDTH}),e=p.defaults(e,{resizable:e.autoPlace,hideable:e.autoPlace}),p.isUndefined(e.load)?e.load={preset:D}:e.preset&&(e.load.preset=e.preset),p.isUndefined(e.parent)&&e.hideable&&j.push(this),e.resizable=p.isUndefined(e.parent)&&e.resizable,e.autoPlace&&p.isUndefined(e.scrollable)&&(e.scrollable=!0);var r=O&&"true"===localStorage.getItem(_(this,"isLocal"));if(Object.defineProperties(this,{parent:{get:function(){return e.parent}},scrollable:{get:function(){return e.scrollable}},autoPlace:{get:function(){return e.autoPlace}},preset:{get:function(){return n.parent?n.getRoot().preset:e.load.preset},set:function(t){n.parent?n.getRoot().preset=t:e.load.preset=t,M(this),n.revert()}},width:{get:function(){return e.width},set:function(t){e.width=t,w(n,t)}},name:{get:function(){return e.name},set:function(t){e.name=t,o&&(o.innerHTML=e.name)}},closed:{get:function(){return e.closed},set:function(t){e.closed=t,e.closed?d.addClass(n.__ul,B.CLASS_CLOSED):d.removeClass(n.__ul,B.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=t?B.TEXT_OPEN:B.TEXT_CLOSED)}},load:{get:function(){return e.load}},useLocalStorage:{get:function(){return r},set:function(e){O&&(r=e,e?d.bind(window,"unload",t):d.unbind(window,"unload",t),localStorage.setItem(_(n,"isLocal"),e))}}}),p.isUndefined(e.parent)){if(e.closed=!1,d.addClass(this.domElement,B.CLASS_MAIN),d.makeSelectable(this.domElement,!1),O&&r){n.useLocalStorage=!0;var i=localStorage.getItem(_(this,"gui"));i&&(e.load=JSON.parse(i))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=B.TEXT_CLOSED,d.addClass(this.__closeButton,B.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),d.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{void 0===e.closed&&(e.closed=!0);var o=document.createTextNode(e.name);d.addClass(o,"controller-name");var a=v(n,o),s=function(e){return e.preventDefault(),n.closed=!n.closed,!1};d.addClass(this.__ul,B.CLASS_CLOSED),d.addClass(a,"title"),d.bind(a,"click",s),e.closed||(this.closed=!1)}e.autoPlace&&(p.isUndefined(e.parent)&&(L&&(T=document.createElement("div"),d.addClass(T,"dg"),d.addClass(T,B.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(T),L=!1),T.appendChild(this.domElement),d.addClass(this.domElement,B.CLASS_AUTO_PLACE)),this.parent||w(n,e.width)),d.bind(window,"resize",function(){n.onResize()}),d.bind(this.__ul,"webkitTransitionEnd",function(){n.onResize()}),d.bind(this.__ul,"transitionend",function(){n.onResize()}),d.bind(this.__ul,"oTransitionEnd",function(){n.onResize()}),this.onResize(),e.resizable&&x(this);n.getRoot();e.parent||function(){var e=n.getRoot();e.width+=1,p.defer(function(){e.width-=1})}()};return B.toggleHide=function(){z=!z,p.each(j,function(e){e.domElement.style.zIndex=z?-999:999,e.domElement.style.opacity=z?0:1})},B.CLASS_AUTO_PLACE="a",B.CLASS_AUTO_PLACE_CONTAINER="ac",B.CLASS_MAIN="main",B.CLASS_CONTROLLER_ROW="cr",B.CLASS_TOO_TALL="taller-than-window",B.CLASS_CLOSED="closed",B.CLASS_CLOSE_BUTTON="close-button",B.CLASS_DRAG="drag",B.DEFAULT_WIDTH=245,B.TEXT_CLOSED="Close Controls",B.TEXT_OPEN="Open Controls",d.bind(window,"keydown",function(e){"text"===document.activeElement.type||72!==e.which&&72!=e.keyCode||B.toggleHide()},!1),p.extend(B.prototype,{add:function(e,t){return m(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return m(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.slice(this.__controllers.indexOf(e),1);var t=this;p.defer(function(){t.onResize()})},destroy:function(){this.autoPlace&&T.removeChild(this.domElement)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new B(t);this.__folders[e]=n;var r=v(this,n.domElement);return d.addClass(r,"folder"),n},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=d.getOffset(e.__ul).top,n=0;p.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(n+=d.getHeight(t))}),window.innerHeight-t-20<n?(d.addClass(e.domElement,B.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(d.removeClass(e.domElement,B.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&p.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},remember:function(){if(p.isUndefined(C)&&(C=new h,C.domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;p.each(Array.prototype.slice.call(arguments),function(t){0==e.__rememberedObjects.length&&y(e),-1==e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&w(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=A(this)),e.folders={},p.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=A(this),k(this,!1)},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[D]=A(this,!0)),this.load.remembered[e]=A(this),this.preset=e,E(this,e,!0)},revert:function(e){p.each(this.__controllers,function(t){this.getRoot().load.remembered?b(e||this.getRoot(),t):t.setValue(t.initialValue)},this),p.each(this.__folders,function(e){e.revert(e)}),e||k(this.getRoot(),!1)},listen:function(e){var t=0==this.__listening.length;this.__listening.push(e),t&&S(this.__listening)}}),B}(r.utils.css,0,0,r.controllers.factory=function(e,t,n,r,i,o,a){return function(s,u){var c=s[u];return a.isArray(arguments[2])||a.isObject(arguments[2])?new e(s,u,arguments[2]):a.isNumber(c)?a.isNumber(arguments[2])&&a.isNumber(arguments[3])?new n(s,u,arguments[2],arguments[3]):new t(s,u,{min:arguments[2],max:arguments[3]}):a.isString(c)?new r(s,u):a.isFunction(c)?new i(s,u,""):a.isBoolean(c)?new o(s,u):void 0}}(r.controllers.OptionController,r.controllers.NumberControllerBox,r.controllers.NumberControllerSlider,r.controllers.StringController=function(e,t,n){var r=function(e,n){function i(){a.setValue(a.__input.value)}function o(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}r.superclass.call(this,e,n);var a=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),t.bind(this.__input,"keyup",i),t.bind(this.__input,"change",i),t.bind(this.__input,"blur",o),t.bind(this.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return r.superclass=e,n.extend(r.prototype,e.prototype,{updateDisplay:function(){return t.isActive(this.__input)||(this.__input.value=this.getValue()),r.superclass.prototype.updateDisplay.call(this)}}),r}(r.controllers.Controller,r.dom.dom,r.utils.common),r.controllers.FunctionController,r.controllers.BooleanController,r.utils.common),r.controllers.Controller,r.controllers.BooleanController,r.controllers.FunctionController,r.controllers.NumberControllerBox,r.controllers.NumberControllerSlider,r.controllers.OptionController,r.controllers.ColorController=function(e,t,n,r,i){function o(e,t,n,r){e.style.background="",i.each(u,function(i){e.style.cssText+="background: "+i+"linear-gradient("+t+", "+n+" 0%, "+r+" 100%); "})}function a(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var s=function(e,u){function c(e){d(e),t.bind(window,"mousemove",d),t.bind(window,"mouseup",f)}function f(){t.unbind(window,"mousemove",d),t.unbind(window,"mouseup",f)}function l(){var e=r(this.value);!1!==e?(m.__color.__state=e,m.setValue(m.__color.toOriginal())):this.value=m.__color.toString()}function h(){t.unbind(window,"mousemove",p),t.unbind(window,"mouseup",h)}function d(e){e.preventDefault();var n=t.getWidth(m.__saturation_field),r=t.getOffset(m.__saturation_field),i=(e.clientX-r.left+document.body.scrollLeft)/n,o=1-(e.clientY-r.top+document.body.scrollTop)/n;return o>1?o=1:o<0&&(o=0),i>1?i=1:i<0&&(i=0),m.__color.v=o,m.__color.s=i,m.setValue(m.__color.toOriginal()),!1}function p(e){e.preventDefault();var n=t.getHeight(m.__hue_field),r=t.getOffset(m.__hue_field),i=1-(e.clientY-r.top+document.body.scrollTop)/n;return i>1?i=1:i<0&&(i=0),m.__color.h=360*i,m.setValue(m.__color.toOriginal()),!1}s.superclass.call(this,e,u),this.__color=new n(this.getValue()),this.__temp=new n(0);var m=this;this.domElement=document.createElement("div"),t.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",t.bind(this.__input,"keydown",function(e){13===e.keyCode&&l.call(this)}),t.bind(this.__input,"blur",l),t.bind(this.__selector,"mousedown",function(e){t.addClass(this,"drag").bind(window,"mouseup",function(e){t.removeClass(m.__selector,"drag")})});var v=document.createElement("div");i.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),i.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),i.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),i.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),i.extend(v.style,{width:"100%",height:"100%",background:"none"}),o(v,"top","rgba(0,0,0,0)","#000"),i.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),a(this.__hue_field),i.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),t.bind(this.__saturation_field,"mousedown",c),t.bind(this.__field_knob,"mousedown",c),t.bind(this.__hue_field,"mousedown",function(e){p(e),t.bind(window,"mousemove",p),t.bind(window,"mouseup",h)}),this.__saturation_field.appendChild(v),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};s.superclass=e,i.extend(s.prototype,e.prototype,{updateDisplay:function(){var e=r(this.getValue());if(!1!==e){var t=!1;i.each(n.COMPONENTS,function(n){if(!i.isUndefined(e[n])&&!i.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}},this),t&&i.extend(this.__color.__state,e)}i.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var a=this.__color.v<.5||this.__color.s>.5?255:0,s=255-a;i.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+a+","+a+","+a+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,o(this.__saturation_field,"left","#fff",this.__temp.toString()),i.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+a+","+a+","+a+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}});var u=["-moz-","-o-","-webkit-","-ms-",""];return s}(r.controllers.Controller,r.dom.dom,r.color.Color=function(e,t,n,r){function i(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(a(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(a(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function o(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(s(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(s(this),this.__state.space="HSV"),this.__state[t]=e}})}function a(e,n,i){if("HEX"===e.__state.space)e.__state[n]=t.component_from_hex(e.__state.hex,i);else{if("HSV"!==e.__state.space)throw"Corrupted color state";r.extend(e.__state,t.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}}function s(e){var n=t.rgb_to_hsv(e.r,e.g,e.b);r.extend(e.__state,{s:n.s,v:n.v}),r.isNaN(n.h)?r.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=n.h}var u=function(){if(this.__state=e.apply(this,arguments),!1===this.__state)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return u.COMPONENTS=["r","g","b","h","s","v","hex","a"],r.extend(u.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),i(u.prototype,"r",2),i(u.prototype,"g",1),i(u.prototype,"b",0),o(u.prototype,"h"),o(u.prototype,"s"),o(u.prototype,"v"),Object.defineProperty(u.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(u.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=t.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}}),u}(r.color.interpret,r.color.math=function(){var e;return{hsv_to_rgb:function(e,t,n){var r=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),o=n*(1-t),a=n*(1-i*t),s=n*(1-(1-i)*t),u=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(e,t,n){var r,i,o=Math.min(e,t,n),a=Math.max(e,t,n),s=a-o;return 0==a?{h:NaN,s:0,v:0}:(i=s/a,r=e==a?(t-n)/s:t==a?2+(n-e)/s:4+(e-t)/s,r/=6,r<0&&(r+=1),{h:360*r,s:i,v:a/255})},rgb_to_hex:function(e,t,n){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),r=this.hex_with_component(r,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(t,n,r){return r<<(e=8*n)|t&~(255<<e)}}}(),r.color.toString,r.utils.common),r.color.interpret,r.utils.common),r.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}(),r.dom.CenteredDiv=function(e,t){var n=function(){this.backgroundElement=document.createElement("div"),t.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),e.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),t.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var n=this;e.bind(this.backgroundElement,"click",function(){n.hide()})};return n.prototype.show=function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),t.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})},n.prototype.hide=function(){var t=this,n=function(){t.domElement.style.display="none",t.backgroundElement.style.display="none",e.unbind(t.domElement,"webkitTransitionEnd",n),e.unbind(t.domElement,"transitionend",n),e.unbind(t.domElement,"oTransitionEnd",n)};e.bind(this.domElement,"webkitTransitionEnd",n),e.bind(this.domElement,"transitionend",n),e.bind(this.domElement,"oTransitionEnd",n),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},n.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-e.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-e.getHeight(this.domElement)/2+"px"},n}(r.dom.dom,r.utils.common),r.dom.dom,r.utils.common)},{}],10:[function(e,t,n){"use strict";function r(e,t,n){t||(t=p),n||(n=m);for(var r=1/0,a=1/0,h=-1/0,d=-1/0,v=this.coords=[],g=this.ids=new Uint32Array(e.length),b=0;b<e.length;b++){var _=e[b],y=t(_),x=n(_);g[b]=b,v[2*b]=y,v[2*b+1]=x,y<r&&(r=y),x<a&&(a=x),y>h&&(h=y),x>d&&(d=x)}var w,A,E,M=(r+h)/2,k=(a+d)/2,S=1/0;for(b=0;b<e.length;b++){var C=i(M,k,v[2*b],v[2*b+1]);C<S&&(w=b,S=C)}for(S=1/0,b=0;b<e.length;b++)b!==w&&(C=i(v[2*w],v[2*w+1],v[2*b],v[2*b+1]))<S&&C>0&&(A=b,S=C);var T=1/0;for(b=0;b<e.length;b++)if(b!==w&&b!==A){var D=s(v[2*w],v[2*w+1],v[2*A],v[2*A+1],v[2*b],v[2*b+1]);D<T&&(E=b,T=D)}if(T===1/0)throw new Error("No Delaunay triangulation exists for this input.");if(o(v[2*w],v[2*w+1],v[2*A],v[2*A+1],v[2*E],v[2*E+1])<0){var O=A;A=E,E=O}var L=v[2*w],z=v[2*w+1],j=v[2*A],B=v[2*A+1],R=v[2*E],F=v[2*E+1],I=u(L,z,j,B,R,F);for(this._cx=I.x,this._cy=I.y,l(g,v,0,g.length-1,I.x,I.y),this._hashSize=Math.ceil(Math.sqrt(e.length)),this._hash=[],b=0;b<this._hashSize;b++)this._hash[b]=null;var N=this.hull=c(v,w);this._hashEdge(N),N.t=0,N=c(v,A,N),this._hashEdge(N),N.t=1,N=c(v,E,N),this._hashEdge(N),N.t=2;var P=2*e.length-5,H=this.triangles=new Uint32Array(3*P),U=this.halfedges=new Int32Array(3*P);this.trianglesLen=0,this._addTriangle(w,A,E,-1,-1,-1);for(var V,q,G=0;G<g.length;G++)if(b=g[G],y=v[2*b],x=v[2*b+1],!(y===V&&x===q||(V=y,q=x,y===L&&x===z||y===j&&x===B||y===R&&x===F))){var W,X=this._hashKey(y,x),K=X;do{W=this._hash[K],K=(K+1)%this._hashSize}while((!W||W.removed)&&K!==X);for(N=W;o(y,x,N.x,N.y,N.next.x,N.next.y)>=0;)if((N=N.next)===W)throw new Error("Something is wrong with the input points.");var Q=N===W,Y=this._addTriangle(N.i,b,N.next.i,-1,-1,N.t);N.t=Y,N=c(v,b,N),N.t=this._legalize(Y+2),N.prev.prev.t===U[Y+1]&&(N.prev.prev.t=Y+2);for(var J=N.next;o(y,x,J.x,J.y,J.next.x,J.next.y)<0;)Y=this._addTriangle(J.i,b,J.next.i,J.prev.t,-1,J.t),J.prev.t=this._legalize(Y+2),this.hull=f(J),J=J.next;if(Q)for(J=N.prev;o(y,x,J.prev.x,J.prev.y,J.x,J.y)<0;)Y=this._addTriangle(J.prev.i,b,J.i,-1,J.t,J.prev.t),this._legalize(Y+2),J.prev.t=Y,this.hull=f(J),J=J.prev;this._hashEdge(N),this._hashEdge(N.prev)}this.triangles=H.subarray(0,this.trianglesLen),this.halfedges=U.subarray(0,this.trianglesLen)}function i(e,t,n,r){var i=e-n,o=t-r;return i*i+o*o}function o(e,t,n,r,i,o){return(r-t)*(i-n)-(n-e)*(o-r)}function a(e,t,n,r,i,o,a,s){e-=a,t-=s,n-=a,r-=s,i-=a,o-=s;var u=e*e+t*t,c=n*n+r*r,f=i*i+o*o;return e*(r*f-c*o)-t*(n*f-c*i)+u*(n*o-r*i)<0}function s(e,t,n,r,i,o){n-=e,r-=t,i-=e,o-=t;var a=n*n+r*r,s=i*i+o*o;if(0===a||0===s)return 1/0;var u=n*o-r*i;if(0===u)return 1/0;var c=.5*(o*a-r*s)/u,f=.5*(n*s-i*a)/u;return c*c+f*f}function u(e,t,n,r,i,o){n-=e,r-=t,i-=e,o-=t;var a=n*n+r*r,s=i*i+o*o,u=n*o-r*i;return{x:e+.5*(o*a-r*s)/u,y:t+.5*(n*s-i*a)/u}}function c(e,t,n){var r={i:t,x:e[2*t],y:e[2*t+1],t:0,prev:null,next:null,removed:!1};return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function f(e){return e.prev.next=e.next,e.next.prev=e.prev,e.removed=!0,e.prev}function l(e,t,n,r,i,o){var a,s,u;if(r-n<=20)for(a=n+1;a<=r;a++){for(u=e[a],s=a-1;s>=n&&h(t,e[s],u,i,o)>0;)e[s+1]=e[s--];e[s+1]=u}else{var c=n+r>>1;for(a=n+1,s=r,d(e,c,a),h(t,e[n],e[r],i,o)>0&&d(e,n,r),h(t,e[a],e[r],i,o)>0&&d(e,a,r),h(t,e[n],e[a],i,o)>0&&d(e,n,a),u=e[a];;){do{a++}while(h(t,e[a],u,i,o)<0);do{s--}while(h(t,e[s],u,i,o)>0);if(s<a)break;d(e,a,s)}e[n+1]=e[s],e[s]=u,r-a+1>=s-n?(l(e,t,a,r,i,o),l(e,t,n,s-1,i,o)):(l(e,t,n,s-1,i,o),l(e,t,a,r,i,o))}}function h(e,t,n,r,o){
return i(e[2*t],e[2*t+1],r,o)-i(e[2*n],e[2*n+1],r,o)||e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]}function d(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function p(e){return e[0]}function m(e){return e[1]}t.exports=r,t.exports.default=r,r.prototype={_hashEdge:function(e){this._hash[this._hashKey(e.x,e.y)]=e},_hashKey:function(e,t){var n=e-this._cx,r=t-this._cy,i=1-n/(Math.abs(n)+Math.abs(r));return Math.floor((2+(r<0?-i:i))/4*this._hashSize)},_legalize:function(e){var t=this.triangles,n=this.coords,r=this.halfedges,i=r[e],o=e-e%3,s=i-i%3,u=o+(e+1)%3,c=o+(e+2)%3,f=s+(i+2)%3,l=t[c],h=t[e],d=t[u],p=t[f];if(a(n[2*l],n[2*l+1],n[2*h],n[2*h+1],n[2*d],n[2*d+1],n[2*p],n[2*p+1])){t[e]=p,t[i]=l,this._link(e,r[f]),this._link(i,r[c]),this._link(c,f);var m=s+(i+1)%3;return this._legalize(e),this._legalize(m)}return c},_link:function(e,t){this.halfedges[e]=t,-1!==t&&(this.halfedges[t]=e)},_addTriangle:function(e,t,n,r,i,o){var a=this.trianglesLen;return this.triangles[a]=e,this.triangles[a+1]=t,this.triangles[a+2]=n,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}},{}],11:[function(e,t,n){function r(e){if(e===window||e===document.body)return[window.innerWidth,window.innerHeight];if(!e.parentNode){var t=!0;document.body.appendChild(e)}var n=e.getBoundingClientRect(),r=getComputedStyle(e),o=(0|n.height)+i(r.getPropertyValue("margin-top"))+i(r.getPropertyValue("margin-bottom")),a=(0|n.width)+i(r.getPropertyValue("margin-left"))+i(r.getPropertyValue("margin-right"));return t&&document.body.removeChild(e),[a,o]}function i(e){return parseFloat(e)||0}t.exports=r},{}],12:[function(e,t,n){"use strict";function r(e,t,n){return Math.min(t,Math.max(e,n))}function i(e,t,n){this.dimension=e.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var r=0;r<this.dimension;++r)this.bounds[0][r]=-1/0,this.bounds[1][r]=1/0;this._state=e.slice().reverse(),this._velocity=t.slice().reverse(),this._time=[n],this._scratch=[e.slice(),e.slice(),e.slice(),e.slice(),e.slice()]}function o(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function a(e,t,n){switch(arguments.length){case 0:return new i([0],[0],0);case 1:if("number"==typeof e){var r=o(e);return new i(r,r,0)}return new i(e,o(e.length),0);case 2:if("number"==typeof t){var r=o(e.length);return new i(e,r,+t)}n=0;case 3:if(e.length!==t.length)throw new Error("state and velocity lengths must match");return new i(e,t,n)}}t.exports=a;var s=e(6),u=e(4),c=i.prototype;c.flush=function(e){var t=u.gt(this._time,e)-1;t<=0||(this._time.splice(0,t),this._state.splice(0,t*this.dimension),this._velocity.splice(0,t*this.dimension))},c.curve=function(e){var t=this._time,n=t.length,i=u.le(t,e),o=this._scratch[0],a=this._state,c=this._velocity,f=this.dimension,l=this.bounds;if(i<0)for(var h=f-1,d=0;d<f;++d,--h)o[d]=a[h];else if(i>=n-1)for(var h=a.length-1,p=e-t[n-1],d=0;d<f;++d,--h)o[d]=a[h]+p*c[h];else{for(var h=f*(i+1)-1,m=t[i],v=t[i+1],g=v-m||1,b=this._scratch[1],_=this._scratch[2],y=this._scratch[3],x=this._scratch[4],w=!0,d=0;d<f;++d,--h)b[d]=a[h],y[d]=c[h]*g,_[d]=a[h+f],x[d]=c[h+f]*g,w=w&&b[d]===_[d]&&y[d]===x[d]&&0===y[d];if(w)for(var d=0;d<f;++d)o[d]=b[d];else s(b,y,_,x,(e-m)/g,o)}for(var A=l[0],E=l[1],d=0;d<f;++d)o[d]=r(A[d],E[d],o[d]);return o},c.dcurve=function(e){var t=this._time,n=t.length,r=u.le(t,e),i=this._scratch[0],o=this._state,a=this._velocity,c=this.dimension;if(r>=n-1)for(var f=o.length-1,l=(t[n-1],0);l<c;++l,--f)i[l]=a[f];else{for(var f=c*(r+1)-1,h=t[r],d=t[r+1],p=d-h||1,m=this._scratch[1],v=this._scratch[2],g=this._scratch[3],b=this._scratch[4],_=!0,l=0;l<c;++l,--f)m[l]=o[f],g[l]=a[f]*p,v[l]=o[f+c],b[l]=a[f+c]*p,_=_&&m[l]===v[l]&&g[l]===b[l]&&0===g[l];if(_)for(var l=0;l<c;++l)i[l]=0;else{s.derivative(m,g,v,b,(e-h)/p,i);for(var l=0;l<c;++l)i[l]/=p}}return i},c.lastT=function(){var e=this._time;return e[e.length-1]},c.stable=function(){for(var e=this._velocity,t=e.length,n=this.dimension-1;n>=0;--n)if(e[--t])return!1;return!0},c.jump=function(e){var t=this.lastT(),n=this.dimension;if(!(e<t||arguments.length!==n+1)){var i=this._state,o=this._velocity,a=i.length-this.dimension,s=this.bounds,u=s[0],c=s[1];this._time.push(t,e);for(var f=0;f<2;++f)for(var l=0;l<n;++l)i.push(i[a++]),o.push(0);this._time.push(e);for(var l=n;l>0;--l)i.push(r(u[l-1],c[l-1],arguments[l])),o.push(0)}},c.push=function(e){var t=this.lastT(),n=this.dimension;if(!(e<t||arguments.length!==n+1)){var i=this._state,o=this._velocity,a=i.length-this.dimension,s=e-t,u=this.bounds,c=u[0],f=u[1],l=s>1e-6?1/s:0;this._time.push(e);for(var h=n;h>0;--h){var d=r(c[h-1],f[h-1],arguments[h]);i.push(d),o.push((d-i[a++])*l)}}},c.set=function(e){var t=this.dimension;if(!(e<this.lastT()||arguments.length!==t+1)){var n=this._state,i=this._velocity,o=this.bounds,a=o[0],s=o[1];this._time.push(e);for(var u=t;u>0;--u)n.push(r(a[u-1],s[u-1],arguments[u])),i.push(0)}},c.move=function(e){var t=this.lastT(),n=this.dimension;if(!(e<=t||arguments.length!==n+1)){var i=this._state,o=this._velocity,a=i.length-this.dimension,s=this.bounds,u=s[0],c=s[1],f=e-t,l=f>1e-6?1/f:0;this._time.push(e);for(var h=n;h>0;--h){var d=arguments[h];i.push(r(u[h-1],c[h-1],i[a++]+d)),o.push(d*l)}}},c.idle=function(e){var t=this.lastT();if(!(e<t)){var n=this.dimension,i=this._state,o=this._velocity,a=i.length-n,s=this.bounds,u=s[0],c=s[1],f=e-t;this._time.push(e);for(var l=n-1;l>=0;--l)i.push(r(u[l],c[l],i[a]+f*o[a])),o.push(0),a+=1}}},{4:4,6:6}],13:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],f=t[8],l=t[9],h=t[10],d=t[11],p=t[12],m=t[13],v=t[14],g=t[15];return e[0]=s*(h*g-d*v)-l*(u*g-c*v)+m*(u*d-c*h),e[1]=-(r*(h*g-d*v)-l*(i*g-o*v)+m*(i*d-o*h)),e[2]=r*(u*g-c*v)-s*(i*g-o*v)+m*(i*c-o*u),e[3]=-(r*(u*d-c*h)-s*(i*d-o*h)+l*(i*c-o*u)),e[4]=-(a*(h*g-d*v)-f*(u*g-c*v)+p*(u*d-c*h)),e[5]=n*(h*g-d*v)-f*(i*g-o*v)+p*(i*d-o*h),e[6]=-(n*(u*g-c*v)-a*(i*g-o*v)+p*(i*c-o*u)),e[7]=n*(u*d-c*h)-a*(i*d-o*h)+f*(i*c-o*u),e[8]=a*(l*g-d*m)-f*(s*g-c*m)+p*(s*d-c*l),e[9]=-(n*(l*g-d*m)-f*(r*g-o*m)+p*(r*d-o*l)),e[10]=n*(s*g-c*m)-a*(r*g-o*m)+p*(r*c-o*s),e[11]=-(n*(s*d-c*l)-a*(r*d-o*l)+f*(r*c-o*s)),e[12]=-(a*(l*v-h*m)-f*(s*v-u*m)+p*(s*h-u*l)),e[13]=n*(l*v-h*m)-f*(r*v-i*m)+p*(r*h-i*l),e[14]=-(n*(s*v-u*m)-a*(r*v-i*m)+p*(r*u-i*s)),e[15]=n*(s*h-u*l)-a*(r*h-i*l)+f*(r*u-i*s),e}t.exports=r},{}],14:[function(e,t,n){function r(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}t.exports=r},{}],15:[function(e,t,n){function r(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}t.exports=r},{}],16:[function(e,t,n){function r(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],17:[function(e,t,n){function r(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],f=e[9],l=e[10],h=e[11],d=e[12],p=e[13],m=e[14],v=e[15];return(t*a-n*o)*(l*v-h*m)-(t*s-r*o)*(f*v-h*p)+(t*u-i*o)*(f*m-l*p)+(n*s-r*a)*(c*v-h*d)-(n*u-i*a)*(c*m-l*d)+(r*u-i*s)*(c*p-f*d)}t.exports=r},{}],18:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,c=n*a,f=r*a,l=r*s,h=i*a,d=i*s,p=i*u,m=o*a,v=o*s,g=o*u;return e[0]=1-l-p,e[1]=f+g,e[2]=h-v,e[3]=0,e[4]=f-g,e[5]=1-c-p,e[6]=d+m,e[7]=0,e[8]=h+v,e[9]=d-m,e[10]=1-c-l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],19:[function(e,t,n){function r(e,t,n){var r,i,o,a=n[0],s=n[1],u=n[2],c=Math.sqrt(a*a+s*s+u*u);return Math.abs(c)<1e-6?null:(c=1/c,a*=c,s*=c,u*=c,r=Math.sin(t),i=Math.cos(t),o=1-i,e[0]=a*a*o+i,e[1]=s*a*o+u*r,e[2]=u*a*o-s*r,e[3]=0,e[4]=a*s*o-u*r,e[5]=s*s*o+i,e[6]=u*s*o+a*r,e[7]=0,e[8]=a*u*o+s*r,e[9]=s*u*o-a*r,e[10]=u*u*o+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}t.exports=r},{}],20:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,u=i+i,c=o+o,f=r*s,l=r*u,h=r*c,d=i*u,p=i*c,m=o*c,v=a*s,g=a*u,b=a*c;return e[0]=1-(d+m),e[1]=l+b,e[2]=h-g,e[3]=0,e[4]=l-b,e[5]=1-(f+m),e[6]=p+v,e[7]=0,e[8]=h+g,e[9]=p-v,e[10]=1-(f+d),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}t.exports=r},{}],21:[function(e,t,n){function r(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],22:[function(e,t,n){function r(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}t.exports=r},{}],23:[function(e,t,n){function r(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],24:[function(e,t,n){function r(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],25:[function(e,t,n){function r(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],26:[function(e,t,n){function r(e,t,n,r,i,o,a){var s=1/(n-t),u=1/(i-r),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*u,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e}t.exports=r},{}],27:[function(e,t,n){function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],28:[function(e,t,n){t.exports={create:e(16),clone:e(14),copy:e(15),identity:e(27),transpose:e(42),invert:e(29),adjoint:e(13),determinant:e(17),multiply:e(31),translate:e(41),scale:e(39),rotate:e(35),rotateX:e(36),rotateY:e(37),rotateZ:e(38),fromRotation:e(19),fromRotationTranslation:e(20),fromScaling:e(21),fromTranslation:e(22),fromXRotation:e(23),fromYRotation:e(24),fromZRotation:e(25),fromQuat:e(18),frustum:e(26),perspective:e(33),perspectiveFromFieldOfView:e(34),ortho:e(32),lookAt:e(30),str:e(40)}},{13:13,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:21,22:22,23:23,24:24,25:25,26:26,27:27,29:29,30:30,31:31,32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42}],29:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],f=t[8],l=t[9],h=t[10],d=t[11],p=t[12],m=t[13],v=t[14],g=t[15],b=n*s-r*a,_=n*u-i*a,y=n*c-o*a,x=r*u-i*s,w=r*c-o*s,A=i*c-o*u,E=f*m-l*p,M=f*v-h*p,k=f*g-d*p,S=l*v-h*m,C=l*g-d*m,T=h*g-d*v,D=b*T-_*C+y*S+x*k-w*M+A*E;return D?(D=1/D,e[0]=(s*T-u*C+c*S)*D,e[1]=(i*C-r*T-o*S)*D,e[2]=(m*A-v*w+g*x)*D,e[3]=(h*w-l*A-d*x)*D,e[4]=(u*k-a*T-c*M)*D,e[5]=(n*T-i*k+o*M)*D,e[6]=(v*y-p*A-g*_)*D,e[7]=(f*A-h*y+d*_)*D,e[8]=(a*C-s*k+c*E)*D,e[9]=(r*k-n*C-o*E)*D,e[10]=(p*w-m*y+g*b)*D,e[11]=(l*y-f*w-d*b)*D,e[12]=(s*M-a*S-u*E)*D,e[13]=(n*S-r*M+i*E)*D,e[14]=(m*_-p*x-v*b)*D,e[15]=(f*x-l*_+h*b)*D,e):null}t.exports=r},{}],30:[function(e,t,n){function r(e,t,n,r){var o,a,s,u,c,f,l,h,d,p,m=t[0],v=t[1],g=t[2],b=r[0],_=r[1],y=r[2],x=n[0],w=n[1],A=n[2];return Math.abs(m-x)<1e-6&&Math.abs(v-w)<1e-6&&Math.abs(g-A)<1e-6?i(e):(l=m-x,h=v-w,d=g-A,p=1/Math.sqrt(l*l+h*h+d*d),l*=p,h*=p,d*=p,o=_*d-y*h,a=y*l-b*d,s=b*h-_*l,p=Math.sqrt(o*o+a*a+s*s),p?(p=1/p,o*=p,a*=p,s*=p):(o=0,a=0,s=0),u=h*s-d*a,c=d*o-l*s,f=l*a-h*o,p=Math.sqrt(u*u+c*c+f*f),p?(p=1/p,u*=p,c*=p,f*=p):(u=0,c=0,f=0),e[0]=o,e[1]=u,e[2]=l,e[3]=0,e[4]=a,e[5]=c,e[6]=h,e[7]=0,e[8]=s,e[9]=f,e[10]=d,e[11]=0,e[12]=-(o*m+a*v+s*g),e[13]=-(u*m+c*v+f*g),e[14]=-(l*m+h*v+d*g),e[15]=1,e)}var i=e(27);t.exports=r},{27:27}],31:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=t[8],h=t[9],d=t[10],p=t[11],m=t[12],v=t[13],g=t[14],b=t[15],_=n[0],y=n[1],x=n[2],w=n[3];return e[0]=_*r+y*s+x*l+w*m,e[1]=_*i+y*u+x*h+w*v,e[2]=_*o+y*c+x*d+w*g,e[3]=_*a+y*f+x*p+w*b,_=n[4],y=n[5],x=n[6],w=n[7],e[4]=_*r+y*s+x*l+w*m,e[5]=_*i+y*u+x*h+w*v,e[6]=_*o+y*c+x*d+w*g,e[7]=_*a+y*f+x*p+w*b,_=n[8],y=n[9],x=n[10],w=n[11],e[8]=_*r+y*s+x*l+w*m,e[9]=_*i+y*u+x*h+w*v,e[10]=_*o+y*c+x*d+w*g,e[11]=_*a+y*f+x*p+w*b,_=n[12],y=n[13],x=n[14],w=n[15],e[12]=_*r+y*s+x*l+w*m,e[13]=_*i+y*u+x*h+w*v,e[14]=_*o+y*c+x*d+w*g,e[15]=_*a+y*f+x*p+w*b,e}t.exports=r},{}],32:[function(e,t,n){function r(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(a+o)*c,e[15]=1,e}t.exports=r},{}],33:[function(e,t,n){function r(e,t,n,r,i){var o=1/Math.tan(t/2),a=1/(r-i);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*a,e[15]=0,e}t.exports=r},{}],34:[function(e,t,n){function r(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-s)*u*.5,e[9]=(i-o)*c*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}t.exports=r},{}],35:[function(e,t,n){function r(e,t,n,r){var i,o,a,s,u,c,f,l,h,d,p,m,v,g,b,_,y,x,w,A,E,M,k,S,C=r[0],T=r[1],D=r[2],O=Math.sqrt(C*C+T*T+D*D);return Math.abs(O)<1e-6?null:(O=1/O,C*=O,T*=O,D*=O,i=Math.sin(n),o=Math.cos(n),a=1-o,s=t[0],u=t[1],c=t[2],f=t[3],l=t[4],h=t[5],d=t[6],p=t[7],m=t[8],v=t[9],g=t[10],b=t[11],_=C*C*a+o,y=T*C*a+D*i,x=D*C*a-T*i,w=C*T*a-D*i,A=T*T*a+o,E=D*T*a+C*i,M=C*D*a+T*i,k=T*D*a-C*i,S=D*D*a+o,e[0]=s*_+l*y+m*x,e[1]=u*_+h*y+v*x,e[2]=c*_+d*y+g*x,e[3]=f*_+p*y+b*x,e[4]=s*w+l*A+m*E,e[5]=u*w+h*A+v*E,e[6]=c*w+d*A+g*E,e[7]=f*w+p*A+b*E,e[8]=s*M+l*k+m*S,e[9]=u*M+h*k+v*S,e[10]=c*M+d*k+g*S,e[11]=f*M+p*k+b*S,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}t.exports=r},{}],36:[function(e,t,n){function r(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],f=t[9],l=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=a*i+f*r,e[6]=s*i+l*r,e[7]=u*i+h*r,e[8]=c*i-o*r,e[9]=f*i-a*r,e[10]=l*i-s*r,e[11]=h*i-u*r,e}t.exports=r},{}],37:[function(e,t,n){function r(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],f=t[9],l=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*r,e[1]=a*i-f*r,e[2]=s*i-l*r,e[3]=u*i-h*r,e[8]=o*r+c*i,e[9]=a*r+f*i,e[10]=s*r+l*i,e[11]=u*r+h*i,e}t.exports=r},{}],38:[function(e,t,n){function r(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[4],f=t[5],l=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*r,e[1]=a*i+f*r,e[2]=s*i+l*r,e[3]=u*i+h*r,e[4]=c*i-o*r,e[5]=f*i-a*r,e[6]=l*i-s*r,e[7]=h*i-u*r,e}t.exports=r},{}],39:[function(e,t,n){function r(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}t.exports=r},{}],40:[function(e,t,n){function r(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}t.exports=r},{}],41:[function(e,t,n){function r(e,t,n){var r,i,o,a,s,u,c,f,l,h,d,p,m=n[0],v=n[1],g=n[2];return t===e?(e[12]=t[0]*m+t[4]*v+t[8]*g+t[12],e[13]=t[1]*m+t[5]*v+t[9]*g+t[13],e[14]=t[2]*m+t[6]*v+t[10]*g+t[14],e[15]=t[3]*m+t[7]*v+t[11]*g+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=t[8],h=t[9],d=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=f,e[8]=l,e[9]=h,e[10]=d,e[11]=p,e[12]=r*m+s*v+l*g+t[12],e[13]=i*m+u*v+h*g+t[13],e[14]=o*m+c*v+d*g+t[14],e[15]=a*m+f*v+p*g+t[15]),e}t.exports=r},{}],42:[function(e,t,n){function r(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}t.exports=r},{}],43:[function(e,t,n){function r(e,t,n,r){var i,o,a,s,u,c=t[0],f=t[1],l=t[2],h=t[3],d=n[0],p=n[1],m=n[2],v=n[3];return o=c*d+f*p+l*m+h*v,o<0&&(o=-o,d=-d,p=-p,m=-m,v=-v),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),e[0]=s*c+u*d,e[1]=s*f+u*p,e[2]=s*l+u*m,e[3]=s*h+u*v,e}t.exports=r},{}],44:[function(e,t,n){function r(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}t.exports=r},{}],45:[function(e,t,n){function r(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}t.exports=r},{}],46:[function(e,t,n){function r(e){var t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t}t.exports=r},{}],47:[function(e,t,n){function r(e,t){return e[0]=t[0],e[1]=t[1],e}t.exports=r},{}],48:[function(e,t,n){function r(){var e=new Float32Array(2);return e[0]=0,e[1]=0,e}t.exports=r},{}],49:[function(e,t,n){function r(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e}t.exports=r},{}],50:[function(e,t,n){t.exports=e(51)},{51:51}],51:[function(e,t,n){function r(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)}t.exports=r},{}],52:[function(e,t,n){t.exports=e(53)},{53:53}],53:[function(e,t,n){function r(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}t.exports=r},{}],54:[function(e,t,n){function r(e,t){return e[0]*t[0]+e[1]*t[1]}t.exports=r},{}],55:[function(e,t,n){t.exports=1e-6},{}],56:[function(e,t,n){function r(e,t){var n=e[0],r=e[1],o=t[0],a=t[1];return Math.abs(n-o)<=i*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=i*Math.max(1,Math.abs(r),Math.abs(a))}t.exports=r;var i=e(55)},{55:55}],57:[function(e,t,n){function r(e,t){return e[0]===t[0]&&e[1]===t[1]}t.exports=r},{}],58:[function(e,t,n){function r(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}t.exports=r},{}],59:[function(e,t,n){function r(e,t,n,r,o,a){var s,u;for(t||(t=2),n||(n=0),u=r?Math.min(r*t+n,e.length):e.length,s=n;s<u;s+=t)i[0]=e[s],i[1]=e[s+1],o(i,i,a),e[s]=i[0],e[s+1]=i[1];return e}t.exports=r;var i=e(48)()},{48:48}],60:[function(e,t,n){function r(e,t){var n=new Float32Array(2);return n[0]=e,n[1]=t,n}t.exports=r},{}],61:[function(e,t,n){t.exports={EPSILON:e(55),create:e(48),clone:e(46),fromValues:e(60),copy:e(47),set:e(77),equals:e(56),exactEquals:e(57),add:e(44),subtract:e(83),sub:e(82),multiply:e(69),mul:e(68),divide:e(53),div:e(52),inverse:e(62),min:e(67),max:e(66),rotate:e(73),floor:e(58),ceil:e(45),round:e(74),scale:e(75),scaleAndAdd:e(76),distance:e(51),dist:e(50),squaredDistance:e(80),sqrDist:e(78),length:e(64),len:e(63),squaredLength:e(81),sqrLen:e(79),negate:e(70),normalize:e(71),dot:e(54),cross:e(49),lerp:e(65),random:e(72),transformMat2:e(84),transformMat2d:e(85),transformMat3:e(86),transformMat4:e(87),forEach:e(59)}},{44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87}],62:[function(e,t,n){function r(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}t.exports=r},{}],63:[function(e,t,n){t.exports=e(64)},{64:64}],64:[function(e,t,n){function r(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)}t.exports=r},{}],65:[function(e,t,n){function r(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e}t.exports=r},{}],66:[function(e,t,n){function r(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}t.exports=r},{}],67:[function(e,t,n){function r(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}t.exports=r},{}],68:[function(e,t,n){t.exports=e(69)},{69:69}],69:[function(e,t,n){function r(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}t.exports=r},{}],70:[function(e,t,n){function r(e,t){return e[0]=-t[0],e[1]=-t[1],e}t.exports=r},{}],71:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e}t.exports=r},{}],72:[function(e,t,n){function r(e,t){t=t||1;var n=2*Math.random()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e}t.exports=r},{}],73:[function(e,t,n){function r(e,t,n){var r=Math.cos(n),i=Math.sin(n),o=t[0],a=t[1];return e[0]=o*r-a*i,e[1]=o*i+a*r,e}t.exports=r},{}],74:[function(e,t,n){function r(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}t.exports=r},{}],75:[function(e,t,n){function r(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}t.exports=r},{}],76:[function(e,t,n){function r(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e}t.exports=r},{}],77:[function(e,t,n){function r(e,t,n){return e[0]=t,e[1]=n,e}t.exports=r},{}],78:[function(e,t,n){t.exports=e(80)},{80:80}],79:[function(e,t,n){t.exports=e(81)},{81:81}],80:[function(e,t,n){function r(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}t.exports=r},{}],81:[function(e,t,n){function r(e){var t=e[0],n=e[1];return t*t+n*n}t.exports=r},{}],82:[function(e,t,n){t.exports=e(83)},{83:83}],83:[function(e,t,n){function r(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}t.exports=r},{}],84:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e}t.exports=r},{}],85:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e}t.exports=r},{}],86:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e}t.exports=r},{}],87:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}t.exports=r},{}],88:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2];return e[0]=i*u-o*s,e[1]=o*a-r*u,e[2]=r*s-i*a,e}t.exports=r},{}],89:[function(e,t,n){function r(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}t.exports=r},{}],90:[function(e,t,n){function r(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}t.exports=r},{}],91:[function(e,t,n){function r(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e}t.exports=r},{}],92:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e}t.exports=r},{}],93:[function(e,t,n){"use strict";var r=e(94);t.exports=r&&function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=!1}return e}()},{94:94}],94:[function(e,t,n){t.exports=!0},{}],95:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,e}function i(e,t){e[0][0]=t[0],e[0][1]=t[1],e[0][2]=t[2],e[1][0]=t[4],e[1][1]=t[5],e[1][2]=t[6],e[2][0]=t[8],e[2][1]=t[9],e[2][2]=t[10]}function o(e,t,n,r,i){e[0]=t[0]*r+n[0]*i,e[1]=t[1]*r+n[1]*i,e[2]=t[2]*r+n[2]*i}var a=e(96),s=e(16),u=e(14),c=e(17),f=e(29),l=e(42),h={length:e(90),normalize:e(92),dot:e(89),cross:e(88)},d=s(),p=s(),m=[0,0,0,0],v=[[0,0,0],[0,0,0],[0,0,0]],g=[0,0,0];t.exports=function(e,t,n,s,b,_){if(t||(t=[0,0,0]),n||(n=[0,0,0]),s||(s=[0,0,0]),b||(b=[0,0,0,1]),_||(_=[0,0,0,1]),!a(d,e))return!1;if(u(p,d),p[3]=0,p[7]=0,p[11]=0,p[15]=1,Math.abs(c(p)<1e-8))return!1;var y=d[3],x=d[7],w=d[11],A=d[12],E=d[13],M=d[14],k=d[15];if(0!==y||0!==x||0!==w){m[0]=y,m[1]=x,m[2]=w,m[3]=k;if(!f(p,p))return!1;l(p,p),r(b,m,p)}else b[0]=b[1]=b[2]=0,b[3]=1;if(t[0]=A,t[1]=E,t[2]=M,i(v,d),n[0]=h.length(v[0]),h.normalize(v[0],v[0]),s[0]=h.dot(v[0],v[1]),o(v[1],v[1],v[0],1,-s[0]),n[1]=h.length(v[1]),h.normalize(v[1],v[1]),s[0]/=n[1],s[1]=h.dot(v[0],v[2]),o(v[2],v[2],v[0],1,-s[1]),s[2]=h.dot(v[1],v[2]),o(v[2],v[2],v[1],1,-s[2]),n[2]=h.length(v[2]),h.normalize(v[2],v[2]),s[1]/=n[2],s[2]/=n[2],h.cross(g,v[1],v[2]),h.dot(v[0],g)<0)for(var S=0;S<3;S++)n[S]*=-1,v[S][0]*=-1,v[S][1]*=-1,v[S][2]*=-1;return _[0]=.5*Math.sqrt(Math.max(1+v[0][0]-v[1][1]-v[2][2],0)),_[1]=.5*Math.sqrt(Math.max(1-v[0][0]+v[1][1]-v[2][2],0)),_[2]=.5*Math.sqrt(Math.max(1-v[0][0]-v[1][1]+v[2][2],0)),_[3]=.5*Math.sqrt(Math.max(1+v[0][0]+v[1][1]+v[2][2],0)),v[2][1]>v[1][2]&&(_[0]=-_[0]),v[0][2]>v[2][0]&&(_[1]=-_[1]),v[1][0]>v[0][1]&&(_[2]=-_[2]),!0}},{14:14,16:16,17:17,29:29,42:42,88:88,89:89,90:90,92:92,96:96}],96:[function(e,t,n){t.exports=function(e,t){var n=t[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)e[i]=t[i]*r;return!0}},{}],97:[function(e,t,n){function r(e,t,n,r){if(0===f(t)||0===f(n))return!1;var i=c(t,h.translate,h.scale,h.skew,h.perspective,h.quaternion),o=c(n,d.translate,d.scale,d.skew,d.perspective,d.quaternion);return!(!i||!o)&&(s(p.translate,h.translate,d.translate,r),s(p.skew,h.skew,d.skew,r),s(p.scale,h.scale,d.scale,r),s(p.perspective,h.perspective,d.perspective,r),l(p.quaternion,h.quaternion,d.quaternion,r),u(e,p.translate,p.scale,p.skew,p.perspective,p.quaternion),!0)}function i(){return{translate:o(),scale:o(1),skew:o(),perspective:a(),quaternion:a()}}function o(e){return[e||0,e||0,e||0]}function a(){return[0,0,0,1]}var s=e(91),u=e(98),c=e(95),f=e(17),l=e(107),h=i(),d=i(),p=i();t.exports=r},{107:107,17:17,91:91,95:95,98:98}],98:[function(e,t,n){var r={identity:e(27),translate:e(41),multiply:e(31),create:e(16),scale:e(39),fromRotationTranslation:e(20)},i=(r.create(),r.create());t.exports=function(e,t,n,o,a,s){return r.identity(e),r.fromRotationTranslation(e,s,t),e[3]=a[0],e[7]=a[1],e[11]=a[2],e[15]=a[3],r.identity(i),0!==o[2]&&(i[9]=o[2],r.multiply(e,e,i)),0!==o[1]&&(i[9]=0,i[8]=o[1],r.multiply(e,e,i)),0!==o[0]&&(i[8]=0,i[4]=o[0],r.multiply(e,e,i)),r.scale(e,e,n),e}},{16:16,20:20,27:27,31:31,39:39,41:41}],99:[function(e,t,n){"use strict";function r(e){this._components=e.slice(),this._time=[0],this.prevMatrix=e.slice(),this.nextMatrix=e.slice(),this.computedMatrix=e.slice(),this.computedInverse=e.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}function i(e){return e=e||{},new r(e.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}var o=e(4),a=e(97),s=e(29),u=e(36),c=e(37),f=e(38),l=e(30),h=e(41),d=(e(39),e(92)),p=[0,0,0];t.exports=i;var m=r.prototype;m.recalcMatrix=function(e){var t=this._time,n=o.le(t,e),r=this.computedMatrix;if(!(n<0)){var i=this._components;if(n===t.length-1)for(var u=16*n,c=0;c<16;++c)r[c]=i[u++];else{for(var f=t[n+1]-t[n],u=16*n,l=this.prevMatrix,h=!0,c=0;c<16;++c)l[c]=i[u++];for(var p=this.nextMatrix,c=0;c<16;++c)p[c]=i[u++],h=h&&l[c]===p[c];if(f<1e-6||h)for(var c=0;c<16;++c)r[c]=l[c];else a(r,l,p,(e-t[n])/f)}var m=this.computedUp;m[0]=r[1],m[1]=r[5],m[2]=r[9],d(m,m);var v=this.computedInverse;s(v,r);var g=this.computedEye,b=v[15];g[0]=v[12]/b,g[1]=v[13]/b,g[2]=v[14]/b;for(var _=this.computedCenter,y=Math.exp(this.computedRadius[0]),c=0;c<3;++c)_[c]=g[c]-r[2+4*c]*y}},m.idle=function(e){if(!(e<this.lastT())){for(var t=this._components,n=t.length-16,r=0;r<16;++r)t.push(t[n++]);this._time.push(e)}},m.flush=function(e){var t=o.gt(this._time,e)-2;t<0||(this._time.splice(0,t),this._components.splice(0,16*t))},m.lastT=function(){return this._time[this._time.length-1]},m.lookAt=function(e,t,n,r){this.recalcMatrix(e),t=t||this.computedEye,n=n||p,r=r||this.computedUp,this.setMatrix(e,l(this.computedMatrix,t,n,r));for(var i=0,o=0;o<3;++o)i+=Math.pow(n[o]-t[o],2);i=Math.log(Math.sqrt(i)),this.computedRadius[0]=i},m.rotate=function(e,t,n,r){this.recalcMatrix(e);var i=this.computedInverse;t&&c(i,i,t),n&&u(i,i,n),r&&f(i,i,r),this.setMatrix(e,s(this.computedMatrix,i))};var v=[0,0,0];m.pan=function(e,t,n,r){v[0]=-(t||0),v[1]=-(n||0),v[2]=-(r||0),this.recalcMatrix(e);var i=this.computedInverse;h(i,i,v),this.setMatrix(e,s(i,i))},m.translate=function(e,t,n,r){v[0]=t||0,v[1]=n||0,v[2]=r||0,this.recalcMatrix(e);var i=this.computedMatrix;h(i,i,v),this.setMatrix(e,i)},m.setMatrix=function(e,t){if(!(e<this.lastT())){this._time.push(e);for(var n=0;n<16;++n)this._components.push(t[n])}},m.setDistance=function(e,t){this.computedRadius[0]=t},m.setDistanceLimits=function(e,t){var n=this._limits;n[0]=e,n[1]=t},m.getDistanceLimits=function(e){var t=this._limits;return e?(e[0]=t[0],e[1]=t[1],e):t}},{29:29,30:30,36:36,37:37,38:38,39:39,4:4,41:41,92:92,97:97}],100:[function(e,t,n){"use strict";function r(e,t){function n(e){var t=!1;return"altKey"in e&&(t=t||e.altKey!==v.alt,v.alt=!!e.altKey),"shiftKey"in e&&(t=t||e.shiftKey!==v.shift,v.shift=!!e.shiftKey),"ctrlKey"in e&&(t=t||e.ctrlKey!==v.control,v.control=!!e.ctrlKey),"metaKey"in e&&(t=t||e.metaKey!==v.meta,v.meta=!!e.metaKey),t}function r(e,r){var o=i.x(r),a=i.y(r);"buttons"in r&&(e=0|r.buttons),(e!==d||o!==p||a!==m||n(r))&&(d=0|e,p=o||0,m=a||0,t&&t(d,p,m,v))}function o(e){r(0,e)}function a(){(d||p||m||v.shift||v.alt||v.meta||v.control)&&(p=m=0,d=0,v.shift=v.alt=v.control=v.meta=!1,t&&t(0,0,0,v))}function s(e){n(e)&&t&&t(d,p,m,v)}function u(e){0===i.buttons(e)?r(0,e):r(d,e)}function c(e){r(d|i.buttons(e),e)}function f(e){r(d&~i.buttons(e),e)}function l(){g||(g=!0,e.addEventListener("mousemove",u),e.addEventListener("mousedown",c),e.addEventListener("mouseup",f),e.addEventListener("mouseleave",o),e.addEventListener("mouseenter",o),e.addEventListener("mouseout",o),e.addEventListener("mouseover",o),e.addEventListener("blur",a),e.addEventListener("keyup",s),e.addEventListener("keydown",s),e.addEventListener("keypress",s),e!==window&&(window.addEventListener("blur",a),window.addEventListener("keyup",s),window.addEventListener("keydown",s),window.addEventListener("keypress",s)))}function h(){g&&(g=!1,e.removeEventListener("mousemove",u),e.removeEventListener("mousedown",c),e.removeEventListener("mouseup",f),e.removeEventListener("mouseleave",o),e.removeEventListener("mouseenter",o),e.removeEventListener("mouseout",o),e.removeEventListener("mouseover",o),e.removeEventListener("blur",a),e.removeEventListener("keyup",s),e.removeEventListener("keydown",s),e.removeEventListener("keypress",s),e!==window&&(window.removeEventListener("blur",a),window.removeEventListener("keyup",s),window.removeEventListener("keydown",s),window.removeEventListener("keypress",s)))}t||(t=e,e=window);var d=0,p=0,m=0,v={shift:!1,alt:!1,control:!1,meta:!1},g=!1;l();var b={element:e};return Object.defineProperties(b,{enabled:{get:function(){return g},set:function(e){e?l():h()},enumerable:!0},buttons:{get:function(){return d},enumerable:!0},x:{get:function(){return p},enumerable:!0},y:{get:function(){return m},enumerable:!0},mods:{get:function(){return v},enumerable:!0}}),b}t.exports=r;var i=e(102)},{102:102}],101:[function(e,t,n){function r(e,t,n){t=t||e.currentTarget||e.srcElement,Array.isArray(n)||(n=[0,0]);var r=e.clientX||0,o=e.clientY||0,a=i(t);return n[0]=r-a.left,n[1]=o-a.top,n}function i(e){return e===window||e===document||e===document.body?o:e.getBoundingClientRect()}var o={left:0,top:0};t.exports=r},{}],102:[function(e,t,n){"use strict";function r(e){if("object"==typeof e){if("buttons"in e)return e.buttons;if("which"in e){var t=e.which;if(2===t)return 4;if(3===t)return 2;if(t>0)return 1<<t-1}else if("button"in e){var t=e.button;if(1===t)return 4;if(2===t)return 2;if(t>=0)return 1<<t}}return 0}function i(e){return e.target||e.srcElement||window}function o(e){if("object"==typeof e){if("offsetX"in e)return e.offsetX;var t=i(e),n=t.getBoundingClientRect();return e.clientX-n.left}return 0}function a(e){if("object"==typeof e){if("offsetY"in e)return e.offsetY;var t=i(e),n=t.getBoundingClientRect();return e.clientY-n.top}return 0}n.buttons=r,n.element=i,n.x=o,n.y=a},{}],103:[function(e,t,n){"use strict";function r(e,t,n){"function"==typeof e&&(n=!!t,
t=e,e=window);var r=i("ex",e),o=function(e){n&&e.preventDefault();var i=e.deltaX||0,o=e.deltaY||0,a=e.deltaZ||0,s=e.deltaMode,u=1;switch(s){case 1:u=r;break;case 2:u=window.innerHeight}if(i*=u,o*=u,a*=u,i||o||a)return t(i,o,a,e)};return e.addEventListener("wheel",o),o}var i=e(111);t.exports=r},{111:111}],104:[function(e,t,n){"use strict";function r(e,t,n,r,i,o,a,s,u,c){var f=t+o+c;if(l>0){var l=Math.sqrt(f+1);e[0]=.5*(a-u)/l,e[1]=.5*(s-r)/l,e[2]=.5*(n-o)/l,e[3]=.5*l}else{var h=Math.max(t,o,c),l=Math.sqrt(2*h-f+1);t>=h?(e[0]=.5*l,e[1]=.5*(i+n)/l,e[2]=.5*(s+r)/l,e[3]=.5*(a-u)/l):o>=h?(e[0]=.5*(n+i)/l,e[1]=.5*l,e[2]=.5*(u+a)/l,e[3]=.5*(s-r)/l):(e[0]=.5*(r+s)/l,e[1]=.5*(a+u)/l,e[2]=.5*l,e[3]=.5*(n-i)/l)}return e}t.exports=r},{}],105:[function(e,t,n){"use strict";function r(e,t,n){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(n,2))}function i(e,t,n,r){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(n,2)+Math.pow(r,2))}function o(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],s=i(n,r,o,a);s>1e-6?(e[0]=n/s,e[1]=r/s,e[2]=o/s,e[3]=a/s):(e[0]=e[1]=e[2]=0,e[3]=1)}function a(e,t,n){this.radius=u([n]),this.center=u(t),this.rotation=u(e),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}function s(e){e=e||{};var t=e.center||[0,0,0],n=e.rotation||[0,0,0,1],r=e.radius||1;t=[].slice.call(t,0,3),n=[].slice.call(n,0,4),o(n,n);var i=new a(n,t,Math.log(r));return i.setDistanceLimits(e.zoomMin,e.zoomMax),("eye"in e||"up"in e)&&i.lookAt(0,e.eye,e.center,e.up),i}t.exports=s;var u=e(12),c=e(30),f=e(18),l=e(29),h=e(104),d=a.prototype;d.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},d.recalcMatrix=function(e){this.radius.curve(e),this.center.curve(e),this.rotation.curve(e);var t=this.computedRotation;o(t,t);var n=this.computedMatrix;f(n,t);var r=this.computedCenter,i=this.computedEye,a=this.computedUp,s=Math.exp(this.computedRadius[0]);i[0]=r[0]+s*n[2],i[1]=r[1]+s*n[6],i[2]=r[2]+s*n[10],a[0]=n[1],a[1]=n[5],a[2]=n[9];for(var u=0;u<3;++u){for(var c=0,l=0;l<3;++l)c+=n[u+4*l]*i[l];n[12+u]=-c}},d.getMatrix=function(e,t){this.recalcMatrix(e);var n=this.computedMatrix;if(t){for(var r=0;r<16;++r)t[r]=n[r];return t}return n},d.idle=function(e){this.center.idle(e),this.radius.idle(e),this.rotation.idle(e)},d.flush=function(e){this.center.flush(e),this.radius.flush(e),this.rotation.flush(e)},d.pan=function(e,t,n,i){t=t||0,n=n||0,i=i||0,this.recalcMatrix(e);var o=this.computedMatrix,a=o[1],s=o[5],u=o[9],c=r(a,s,u);a/=c,s/=c,u/=c;var f=o[0],l=o[4],h=o[8],d=f*a+l*s+h*u;f-=a*d,l-=s*d,h-=u*d;var p=r(f,l,h);f/=p,l/=p,h/=p;var m=o[2],v=o[6],g=o[10],b=m*a+v*s+g*u,_=m*f+v*l+g*h;m-=b*a+_*f,v-=b*s+_*l,g-=b*u+_*h;var y=r(m,v,g);m/=y,v/=y,g/=y;var x=f*t+a*n,w=l*t+s*n,A=h*t+u*n;this.center.move(e,x,w,A);var E=Math.exp(this.computedRadius[0]);E=Math.max(1e-4,E+i),this.radius.set(e,Math.log(E))},d.rotate=function(e,t,n,o){this.recalcMatrix(e),t=t||0,n=n||0;var a=this.computedMatrix,s=a[0],u=a[4],c=a[8],f=a[1],l=a[5],h=a[9],d=a[2],p=a[6],m=a[10],v=t*s+n*f,g=t*u+n*l,b=t*c+n*h,_=-(p*b-m*g),y=-(m*v-d*b),x=-(d*g-p*v),w=Math.sqrt(Math.max(0,1-Math.pow(_,2)-Math.pow(y,2)-Math.pow(x,2))),A=i(_,y,x,w);A>1e-6?(_/=A,y/=A,x/=A,w/=A):(_=y=x=0,w=1);var E=this.computedRotation,M=E[0],k=E[1],S=E[2],C=E[3],T=M*w+C*_+k*x-S*y,D=k*w+C*y+S*_-M*x,O=S*w+C*x+M*y-k*_,L=C*w-M*_-k*y-S*x;if(o){_=d,y=p,x=m;var z=Math.sin(o)/r(_,y,x);_*=z,y*=z,x*=z,w=Math.cos(t),T=T*w+L*_+D*x-O*y,D=D*w+L*y+O*_-T*x,O=O*w+L*x+T*y-D*_,L=L*w-T*_-D*y-O*x}var j=i(T,D,O,L);j>1e-6?(T/=j,D/=j,O/=j,L/=j):(T=D=O=0,L=1),this.rotation.set(e,T,D,O,L)},d.lookAt=function(e,t,n,r){this.recalcMatrix(e),n=n||this.computedCenter,t=t||this.computedEye,r=r||this.computedUp;var i=this.computedMatrix;c(i,t,n,r);var a=this.computedRotation;h(a,i[0],i[1],i[2],i[4],i[5],i[6],i[8],i[9],i[10]),o(a,a),this.rotation.set(e,a[0],a[1],a[2],a[3]);for(var s=0,u=0;u<3;++u)s+=Math.pow(n[u]-t[u],2);this.radius.set(e,.5*Math.log(Math.max(s,1e-6))),this.center.set(e,n[0],n[1],n[2])},d.translate=function(e,t,n,r){this.center.move(e,t||0,n||0,r||0)},d.setMatrix=function(e,t){var n=this.computedRotation;h(n,t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]),o(n,n),this.rotation.set(e,n[0],n[1],n[2],n[3]);var r=this.computedMatrix;l(r,t);var i=r[15];if(Math.abs(i)>1e-6){var a=r[12]/i,s=r[13]/i,u=r[14]/i;this.recalcMatrix(e);var c=Math.exp(this.computedRadius[0]);this.center.set(e,a-r[2]*c,s-r[6]*c,u-r[10]*c),this.radius.idle(e)}else this.center.idle(e),this.radius.idle(e)},d.setDistance=function(e,t){t>0&&this.radius.set(e,Math.log(t))},d.setDistanceLimits=function(e,t){e=e>0?Math.log(e):-1/0,t=t>0?Math.log(t):1/0,t=Math.max(t,e),this.radius.bounds[0][0]=e,this.radius.bounds[1][0]=t},d.getDistanceLimits=function(e){var t=this.radius.bounds;return e?(e[0]=Math.exp(t[0][0]),e[1]=Math.exp(t[1][0]),e):[Math.exp(t[0][0]),Math.exp(t[1][0])]},d.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},d.fromJSON=function(e){var t=this.lastT(),n=e.center;n&&this.center.set(t,n[0],n[1],n[2]);var r=e.rotation;r&&this.rotation.set(t,r[0],r[1],r[2],r[3]);var i=e.distance;i&&i>0&&this.radius.set(t,Math.log(i)),this.setDistanceLimits(e.zoomMin,e.zoomMax)}},{104:104,12:12,18:18,29:29,30:30}],106:[function(e,t,n){t.exports=function(e,t){t||(t=[0,""]),e=String(e);var n=parseFloat(e,10);return t[0]=n,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t}},{}],107:[function(e,t,n){t.exports=e(43)},{43:43}],108:[function(e,t,n){!function(e,r){"object"==typeof n&&void 0!==t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.createREGL=r()}(this,function(){function e(e,t){this.id=K++,this.type=e,this.data=t}function t(e){if(0===e.length)return[];var n=e.charAt(0),r=e.charAt(e.length-1);if(1<e.length&&n===r&&('"'===n||"'"===n))return['"'+e.substr(1,e.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(n=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e))return t(e.substr(0,n.index)).concat(t(n[1])).concat(t(e.substr(n.index+n[0].length)));if(n=e.split("."),1===n.length)return['"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(e=[],r=0;r<n.length;++r)e=e.concat(t(n[r]));return e}function n(e){return"["+t(e).join("][")+"]"}function r(){var e={"":0},t=[""];return{id:function(n){var r=e[n];return r||(r=e[n]=t.length,t.push(n),r)},str:function(e){return t[e]}}}function i(e,t,n){function r(){var t=window.innerWidth,r=window.innerHeight;e!==document.body&&(r=e.getBoundingClientRect(),t=r.right-r.left,r=r.bottom-r.top),i.width=n*t,i.height=n*r,X(i.style,{width:t+"px",height:r+"px"})}var i=document.createElement("canvas");return X(i.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(i),e===document.body&&(i.style.position="absolute",X(e.style,{margin:0,padding:0})),window.addEventListener("resize",r,!1),r(),{canvas:i,onDestroy:function(){window.removeEventListener("resize",r),e.removeChild(i)}}}function o(e,t){function n(n){try{return e.getContext(n,t)}catch(e){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function a(e){return"string"==typeof e?e.split():e}function s(e){return"string"==typeof e?document.querySelector(e):e}function u(e){var t,n,r,u,c=e||{};e={};var f=[],l=[],h="undefined"==typeof window?1:window.devicePixelRatio,d=!1,p=function(e){},m=function(){};if("string"==typeof c?t=document.querySelector(c):"object"==typeof c&&("string"==typeof c.nodeName&&"function"==typeof c.appendChild&&"function"==typeof c.getBoundingClientRect?t=c:"function"==typeof c.drawArrays||"function"==typeof c.drawElements?(u=c,r=u.canvas):("gl"in c?u=c.gl:"canvas"in c?r=s(c.canvas):"container"in c&&(n=s(c.container)),"attributes"in c&&(e=c.attributes),"extensions"in c&&(f=a(c.extensions)),"optionalExtensions"in c&&(l=a(c.optionalExtensions)),"onDone"in c&&(p=c.onDone),"profile"in c&&(d=!!c.profile),"pixelRatio"in c&&(h=+c.pixelRatio))),t&&("canvas"===t.nodeName.toLowerCase()?r=t:n=t),!u){if(!r){if(!(t=i(n||document.body,p,h)))return null;r=t.canvas,m=t.onDestroy}u=o(r,e)}return u?{gl:u,canvas:r,container:n,extensions:f,optionalExtensions:l,pixelRatio:h,profile:d,onDone:p,onDestroy:m}:(m(),p("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function c(e,t){function n(t){t=t.toLowerCase();var n;try{n=r[t]=e.getExtension(t)}catch(e){}return!!n}for(var r={},i=0;i<t.extensions.length;++i){var o=t.extensions[i];if(!n(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach(function(e){if(!n(e))throw Error("(regl): error restoring extension "+e)})}}}function f(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||$(e.data))}function l(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}function h(e){var t,n;return t=(65535<e)<<4,e>>>=t,n=(255<e)<<3,e>>>=n,t|=n,n=(15<e)<<2,e>>>=n,t|=n,n=(3<e)<<1,t|n|e>>>n>>1}function d(e){e:{for(var t=16;268435456>=t;t*=16)if(e<=t){e=t;break e}e=0}return t=te[h(e)>>2],0<t.length?t.pop():new ArrayBuffer(e)}function p(e){te[h(e.byteLength)>>2].push(e)}function m(e,t,n,r,i,o){for(var a=0;a<t;++a)for(var s=e[a],u=0;u<n;++u)for(var c=s[u],f=0;f<r;++f)i[o++]=c[f]}function v(e,t,n,r,i){for(var o=1,a=n+1;a<t.length;++a)o*=t[a];var s=t[n];if(4==t.length-n){var u=t[n+1],c=t[n+2];for(t=t[n+3],a=0;a<s;++a)m(e[a],u,c,t,r,i),i+=o}else for(a=0;a<s;++a)v(e[a],t,n+1,r,i),i+=o}function g(e){return 0|ie[Object.prototype.toString.call(e)]}function b(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function _(e,t,n,r,i,o,a){for(var s=0,u=0;u<n;++u)for(var c=0;c<r;++c)e[s++]=t[i*u+o*c+a]}function y(e,t,n){function r(t){this.id=s++,this.buffer=e.createBuffer(),this.type=t,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,n.profile&&(this.stats={size:0})}function i(t,n,r){t.byteLength=n.byteLength,e.bufferData(t.type,n,r)}function o(e,t,n,r,o,a){if(e.usage=n,Array.isArray(t)){if(e.dtype=r||5126,0<t.length)if(Array.isArray(t[0])){o=ue(t);for(var s=r=1;s<o.length;++s)r*=o[s];e.dimension=r,t=se(t,o,e.dtype),i(e,t,n),a?e.persistentData=t:ne.freeType(t)}else"number"==typeof t[0]?(e.dimension=o,o=ne.allocType(e.dtype,t.length),b(o,t),i(e,o,n),a?e.persistentData=o:ne.freeType(o)):$(t[0])&&(e.dimension=t[0].length,e.dtype=r||g(t[0])||5126,t=se(t,[t.length,t[0].length],e.dtype),i(e,t,n),a?e.persistentData=t:ne.freeType(t))}else if($(t))e.dtype=r||g(t),e.dimension=o,i(e,t,n),a&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(f(t)){o=t.shape;var u=t.stride,s=t.offset,c=0,l=0,h=0,d=0;1===o.length?(c=o[0],l=1,h=u[0],d=0):2===o.length&&(c=o[0],l=o[1],h=u[0],d=u[1]),e.dtype=r||g(t.data)||5126,e.dimension=l,o=ne.allocType(e.dtype,c*l),_(o,t.data,c,l,h,d,s),i(e,o,n),a?e.persistentData=o:ne.freeType(o)}}function a(n){t.bufferCount--,e.deleteBuffer(n.buffer),n.buffer=null,delete u[n.id]}var s=0,u={};r.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},r.prototype.destroy=function(){a(this)};var c=[];return n.profile&&(t.getTotalBufferSize=function(){var e=0;return Object.keys(u).forEach(function(t){e+=u[t].stats.size}),e}),{create:function(i,s,c,l){function h(t){var r=35044,i=null,a=0,s=0,u=1;return Array.isArray(t)||$(t)||f(t)?i=t:"number"==typeof t?a=0|t:t&&("data"in t&&(i=t.data),"usage"in t&&(r=ae[t.usage]),"type"in t&&(s=oe[t.type]),"dimension"in t&&(u=0|t.dimension),"length"in t&&(a=0|t.length)),d.bind(),i?o(d,i,r,s,u,l):(e.bufferData(d.type,a,r),d.dtype=s||5121,d.usage=r,d.dimension=u,d.byteLength=a),n.profile&&(d.stats.size=d.byteLength*ce[d.dtype]),h}t.bufferCount++;var d=new r(s);return u[d.id]=d,c||h(i),h._reglType="buffer",h._buffer=d,h.subdata=function(t,n){var r,i=0|(n||0);if(d.bind(),$(t))e.bufferSubData(d.type,i,t);else if(Array.isArray(t)){if(0<t.length)if("number"==typeof t[0]){var o=ne.allocType(d.dtype,t.length);b(o,t),e.bufferSubData(d.type,i,o),ne.freeType(o)}else(Array.isArray(t[0])||$(t[0]))&&(r=ue(t),o=se(t,r,d.dtype),e.bufferSubData(d.type,i,o),ne.freeType(o))}else if(f(t)){r=t.shape;var a=t.stride,s=o=0,u=0,c=0;1===r.length?(o=r[0],s=1,u=a[0],c=0):2===r.length&&(o=r[0],s=r[1],u=a[0],c=a[1]),r=Array.isArray(t.data)?d.dtype:g(t.data),r=ne.allocType(r,o*s),_(r,t.data,o,s,u,c,t.offset),e.bufferSubData(d.type,i,r),ne.freeType(r)}return h},n.profile&&(h.stats=d.stats),h.destroy=function(){a(d)},h},createStream:function(e,t){var n=c.pop();return n||(n=new r(e)),n.bind(),o(n,t,35040,0,1,!1),n},destroyStream:function(e){c.push(e)},clear:function(){ee(u).forEach(a),c.forEach(a)},getBuffer:function(e){return e&&e._buffer instanceof r?e._buffer:null},restore:function(){ee(u).forEach(function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)})},_initBuffer:o}}function x(e,t,n,r){function i(e){this.id=u++,s[this.id]=this,this.buffer=e,this.primType=4,this.type=this.vertCount=0}function o(r,i,o,a,s,u,c){if(r.buffer.bind(),i){var l=c;c||$(i)&&(!f(i)||$(i.data))||(l=t.oes_element_index_uint?5125:5123),n._initBuffer(r.buffer,i,o,l,3)}else e.bufferData(34963,u,o),r.buffer.dtype=l||5121,r.buffer.usage=o,r.buffer.dimension=3,r.buffer.byteLength=u;if(l=c,!c){switch(r.buffer.dtype){case 5121:case 5120:l=5121;break;case 5123:case 5122:l=5123;break;case 5125:case 5124:l=5125}r.buffer.dtype=l}r.type=l,i=s,0>i&&(i=r.buffer.byteLength,5123===l?i>>=1:5125===l&&(i>>=2)),r.vertCount=i,i=a,0>a&&(i=4,a=r.buffer.dimension,1===a&&(i=0),2===a&&(i=1),3===a&&(i=4)),r.primType=i}function a(e){r.elementsCount--,delete s[e.id],e.buffer.destroy(),e.buffer=null}var s={},u=0,c={uint8:5121,uint16:5123};t.oes_element_index_uint&&(c.uint32=5125),i.prototype.bind=function(){this.buffer.bind()};var l=[];return{create:function(e,t){function s(e){if(e)if("number"==typeof e)u(e),l.primType=4,l.vertCount=0|e,l.type=5121;else{var t=null,n=35044,r=-1,i=-1,a=0,h=0;Array.isArray(e)||$(e)||f(e)?t=e:("data"in e&&(t=e.data),"usage"in e&&(n=ae[e.usage]),"primitive"in e&&(r=fe[e.primitive]),"count"in e&&(i=0|e.count),"type"in e&&(h=c[e.type]),"length"in e?a=0|e.length:(a=i,5123===h||5122===h?a*=2:5125!==h&&5124!==h||(a*=4))),o(l,t,n,r,i,a,h)}else u(),l.primType=4,l.vertCount=0,l.type=5121;return s}var u=n.create(null,34963,!0),l=new i(u._buffer);return r.elementsCount++,s(e),s._reglType="elements",s._elements=l,s.subdata=function(e,t){return u.subdata(e,t),s},s.destroy=function(){a(l)},s},createStream:function(e){var t=l.pop();return t||(t=new i(n.create(null,34963,!0,!1)._buffer)),o(t,e,35040,-1,-1,0,0),t},destroyStream:function(e){l.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof i?e._elements:null},clear:function(){ee(s).forEach(a)}}}function w(e){for(var t=ne.allocType(5123,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(1/0===e[n])t[n]=31744;else if(-1/0===e[n])t[n]=64512;else{le[0]=e[n];var r=he[0],i=r>>>31<<15,o=(r<<1>>>24)-127,r=r>>13&1023;t[n]=-24>o?i:-14>o?i+(r+1024>>-14-o):15<o?i+31744:i+(o+15<<10)+r}return t}function A(e){return Array.isArray(e)||$(e)}function E(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function M(e){return!(!Array.isArray(e)||0===e.length||!A(e[0]))}function k(e){return Object.prototype.toString.call(e)}function S(e){if(!e)return!1;var t=k(e);return 0<=ve.indexOf(t)||(E(e)||M(e)||f(e))}function C(e,t){36193===e.type?(e.data=w(t),ne.freeType(t)):e.data=t}function T(e,t,n,r,i,o){if(e=void 0!==be[e]?be[e]:me[e]*ge[t],o&&(e*=6),i){for(r=0;1<=n;)r+=e*n*n,n/=2;return r}return e*n*r}function D(e,t,n,r,i,o,a){function s(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function u(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function c(e,t){if("object"==typeof t&&t){"premultiplyAlpha"in t&&(e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(e.flipY=t.flipY),"alignment"in t&&(e.unpackAlignment=t.alignment),"colorSpace"in t&&(e.colorSpace=U[t.colorSpace]),"type"in t&&(e.type=V[t.type]);var n=e.width,r=e.height,i=e.channels,o=!1;"shape"in t?(n=t.shape[0],r=t.shape[1],3===t.shape.length&&(i=t.shape[2],o=!0)):("radius"in t&&(n=r=t.radius),"width"in t&&(n=t.width),"height"in t&&(r=t.height),"channels"in t&&(i=t.channels,o=!0)),e.width=0|n,e.height=0|r,e.channels=0|i,n=!1,"format"in t&&(n=t.format,r=e.internalformat=q[n],e.format=oe[r],n in V&&!("type"in t)&&(e.type=V[n]),n in G&&(e.compressed=!0),n=!0),!o&&n?e.channels=me[e.format]:o&&!n&&e.channels!==pe[e.format]&&(e.format=e.internalformat=pe[e.channels])}}function l(t){e.pixelStorei(37440,t.flipY),e.pixelStorei(37441,t.premultiplyAlpha),e.pixelStorei(37443,t.colorSpace),e.pixelStorei(3317,t.unpackAlignment)}function h(){s.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function d(e,t){var n=null;if(S(t)?n=t:t&&(c(e,t),"x"in t&&(e.xOffset=0|t.x),"y"in t&&(e.yOffset=0|t.y),S(t.data)&&(n=t.data)),t.copy){var r=i.viewportWidth,o=i.viewportHeight;e.width=e.width||r-e.xOffset,e.height=e.height||o-e.yOffset,e.needsCopy=!0}else if(n){if($(n))e.channels=e.channels||4,e.data=n,"type"in t||5121!==e.type||(e.type=0|ie[Object.prototype.toString.call(n)]);else if(E(n)){switch(e.channels=e.channels||4,r=n,o=r.length,e.type){case 5121:case 5123:case 5125:case 5126:o=ne.allocType(e.type,o),o.set(r),e.data=o;break;case 36193:e.data=w(r)}e.alignment=1,e.needsFree=!0}else if(f(n)){r=n.data,Array.isArray(r)||5121!==e.type||(e.type=0|ie[Object.prototype.toString.call(r)]);var a,s,u,l,o=n.shape,h=n.stride;3===o.length?(u=o[2],l=h[2]):l=u=1,a=o[0],s=o[1],o=h[0],h=h[1],e.alignment=1,e.width=a,e.height=s,e.channels=u,e.format=e.internalformat=pe[u],e.needsFree=!0,a=l,n=n.offset,u=e.width,l=e.height,s=e.channels;for(var d=ne.allocType(36193===e.type?5126:e.type,u*l*s),p=0,m=0;m<l;++m)for(var v=0;v<u;++v)for(var g=0;g<s;++g)d[p++]=r[o*v+h*m+a*g+n];C(e,d)}else if("[object HTMLCanvasElement]"===k(n)||"[object CanvasRenderingContext2D]"===k(n))"[object HTMLCanvasElement]"===k(n)?e.element=n:e.element=n.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if("[object HTMLImageElement]"===k(n))e.element=n,e.width=n.naturalWidth,e.height=n.naturalHeight,e.channels=4;else if("[object HTMLVideoElement]"===k(n))e.element=n,e.width=n.videoWidth,e.height=n.videoHeight,e.channels=4;else if(M(n)){for(r=e.width||n[0].length,o=e.height||n.length,h=e.channels,h=A(n[0][0])?h||n[0][0].length:h||1,a=re.shape(n),u=1,l=0;l<a.length;++l)u*=a[l];u=ne.allocType(36193===e.type?5126:e.type,u),re.flatten(n,a,"",u),C(e,u),e.alignment=1,e.width=r,e.height=o,e.channels=h,e.format=e.internalformat=pe[h],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4}function p(t,n,i,o,a){var s=t.element,u=t.data,c=t.internalformat,f=t.format,h=t.type,d=t.width,p=t.height;l(t),s?e.texSubImage2D(n,a,i,o,f,h,s):t.compressed?e.compressedTexSubImage2D(n,a,i,o,c,d,p,u):t.needsCopy?(r(),e.copyTexSubImage2D(n,a,i,o,t.xOffset,t.yOffset,d,p)):e.texSubImage2D(n,a,i,o,d,p,f,h,u)}function m(){return ae.pop()||new h}function v(e){e.needsFree&&ne.freeType(e.data),h.call(e),ae.push(e)}function g(){s.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function b(e,t,n){var r=e.images[0]=m();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function _(e,t){var n=null;if(S(t))n=e.images[0]=m(),u(n,e),d(n,t),e.mipmask=1;else if(c(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,i=0;i<r.length;++i)n=e.images[i]=m(),u(n,e),n.width>>=i,n.height>>=i,d(n,r[i]),e.mipmask|=1<<i;else n=e.images[0]=m(),u(n,e),d(n,t),e.mipmask=1;u(e,e.images[0])}function y(t,n){for(var i=t.images,o=0;o<i.length&&i[o];++o){var a=i[o],s=n,u=o,c=a.element,f=a.data,h=a.internalformat,d=a.format,p=a.type,m=a.width,v=a.height;l(a),c?e.texImage2D(s,u,d,d,p,c):a.compressed?e.compressedTexImage2D(s,u,h,m,v,0,f):a.needsCopy?(r(),e.copyTexImage2D(s,u,d,a.xOffset,a.yOffset,m,v,0)):e.texImage2D(s,u,d,m,v,0,d,p,f)}}function x(){var e=se.pop()||new g;s.call(e);for(var t=e.mipmask=0;16>t;++t)e.images[t]=null;return e}function D(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&v(t[n]),t[n]=null;se.push(e)}function O(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function L(e,t){"min"in t&&(e.minFilter=H[t.min],0<=de.indexOf(e.minFilter)&&(e.genMipmaps=!0)),"mag"in t&&(e.magFilter=P[t.mag]);var n=e.wrapS,r=e.wrapT;if("wrap"in t){var i=t.wrap;"string"==typeof i?n=r=N[i]:Array.isArray(i)&&(n=N[i[0]],r=N[i[1]])}else"wrapS"in t&&(n=N[t.wrapS]),"wrapT"in t&&(r=N[t.wrapT]);if(e.wrapS=n,e.wrapT=r,"anisotropic"in t&&(e.anisotropic=t.anisotropic),"mipmap"in t){switch(n=!1,typeof t.mipmap){case"string":e.mipmapHint=I[t.mipmap],n=e.genMipmaps=!0;break;case"boolean":n=e.genMipmaps=t.mipmap;break;case"object":e.genMipmaps=!1,n=!0}!n||"min"in t||(e.minFilter=9984)}}function z(n,r){e.texParameteri(r,10241,n.minFilter),e.texParameteri(r,10240,n.magFilter),e.texParameteri(r,10242,n.wrapS),e.texParameteri(r,10243,n.wrapT),t.ext_texture_filter_anisotropic&&e.texParameteri(r,34046,n.anisotropic),n.genMipmaps&&(e.hint(33170,n.mipmapHint),e.generateMipmap(r))}function j(t){s.call(this),this.mipmask=0,this.internalformat=6408,this.id=ue++,this.refCount=1,this.target=t,this.texture=e.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new O,a.profile&&(this.stats={size:0})}function B(t){e.activeTexture(33984),e.bindTexture(t.target,t.texture)}function R(){var t=le[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(3553,null)}function F(t){var n=t.texture,r=t.unit,i=t.target;0<=r&&(e.activeTexture(33984+r),e.bindTexture(i,null),le[r]=null),e.deleteTexture(n),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete ce[t.id],o.textureCount--}var I={"don't care":4352,"dont care":4352,nice:4354,fast:4353},N={repeat:10497,clamp:33071,mirror:33648},P={nearest:9728,linear:9729},H=X({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},P),U={none:0,browser:37444},V={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},q={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},G={};t.ext_srgb&&(q.srgb=35904,q.srgba=35906),t.oes_texture_float&&(V.float32=V.float=5126),t.oes_texture_half_float&&(V.float16=V["half float"]=36193),t.webgl_depth_texture&&(X(q,{depth:6402,"depth stencil":34041}),X(V,{uint16:5123,uint32:5125,"depth stencil":34042})),t.webgl_compressed_texture_s3tc&&X(G,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),t.webgl_compressed_texture_atc&&X(G,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),t.webgl_compressed_texture_pvrtc&&X(G,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),t.webgl_compressed_texture_etc1&&(G["rgb etc1"]=36196);var W=Array.prototype.slice.call(e.getParameter(34467));Object.keys(G).forEach(function(e){var t=G[e];0<=W.indexOf(t)&&(q[e]=t)});var K=Object.keys(q);n.textureFormats=K;var Q=[];Object.keys(q).forEach(function(e){Q[q[e]]=e});var Y=[];Object.keys(V).forEach(function(e){Y[V[e]]=e});var J=[];Object.keys(P).forEach(function(e){J[P[e]]=e});var Z=[];Object.keys(H).forEach(function(e){Z[H[e]]=e});var te=[];Object.keys(N).forEach(function(e){te[N[e]]=e});var oe=K.reduce(function(e,t){var n=q[t];return 6409===n||6406===n||6409===n||6410===n||6402===n||34041===n?e[n]=n:32855===n||0<=t.indexOf("rgba")?e[n]=6408:e[n]=6407,e},{}),ae=[],se=[],ue=0,ce={},fe=n.maxTextureUnits,le=Array(fe).map(function(){return null});return X(j.prototype,{bind:function(){this.bindCount+=1;var t=this.unit;if(0>t){for(var n=0;n<fe;++n){var r=le[n];if(r){if(0<r.bindCount)continue;r.unit=-1}le[n]=this,t=n;break}a.profile&&o.maxTextureUnits<t+1&&(o.maxTextureUnits=t+1),this.unit=t,e.activeTexture(33984+t),e.bindTexture(this.target,this.texture)}return t},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&F(this)}}),a.profile&&(o.getTotalTextureSize=function(){var e=0;return Object.keys(ce).forEach(function(t){e+=ce[t].stats.size}),e}),{create2D:function(t,n){function r(e,t){var n=i.texInfo;O.call(n);var o=x();return"number"==typeof e?"number"==typeof t?b(o,0|e,0|t):b(o,0|e,0|e):e?(L(n,e),_(o,e)):b(o,1,1),n.genMipmaps&&(o.mipmask=(o.width<<1)-1),i.mipmask=o.mipmask,u(i,o),i.internalformat=o.internalformat,r.width=o.width,r.height=o.height,B(i),y(o,3553),z(n,3553),R(),D(o),a.profile&&(i.stats.size=T(i.internalformat,i.type,o.width,o.height,n.genMipmaps,!1)),r.format=Q[i.internalformat],r.type=Y[i.type],r.mag=J[n.magFilter],r.min=Z[n.minFilter],r.wrapS=te[n.wrapS],r.wrapT=te[n.wrapT],r}var i=new j(3553);return ce[i.id]=i,o.textureCount++,r(t,n),r.subimage=function(e,t,n,o){t|=0,n|=0,o|=0;var a=m();return u(a,i),a.width=0,a.height=0,d(a,e),a.width=a.width||(i.width>>o)-t,a.height=a.height||(i.height>>o)-n,B(i),p(a,3553,t,n,o),R(),v(a),r},r.resize=function(t,n){var o=0|t,s=0|n||o;if(o===i.width&&s===i.height)return r;r.width=i.width=o,r.height=i.height=s,B(i);for(var u=0;i.mipmask>>u;++u)e.texImage2D(3553,u,i.format,o>>u,s>>u,0,i.format,i.type,null);return R(),a.profile&&(i.stats.size=T(i.internalformat,i.type,o,s,!1,!1)),r},r._reglType="texture2d",r._texture=i,a.profile&&(r.stats=i.stats),r.destroy=function(){i.decRef()},r},createCube:function(t,n,r,i,s,f){function l(e,t,n,r,i,o){var s,f=h.texInfo;for(O.call(f),s=0;6>s;++s)g[s]=x();if("number"!=typeof e&&e){if("object"==typeof e)if(t)_(g[0],e),_(g[1],t),_(g[2],n),_(g[3],r),_(g[4],i),_(g[5],o);else if(L(f,e),c(h,e),"faces"in e)for(e=e.faces,s=0;6>s;++s)u(g[s],h),_(g[s],e[s]);else for(s=0;6>s;++s)_(g[s],e)}else for(e=0|e||1,s=0;6>s;++s)b(g[s],e,e);for(u(h,g[0]),h.mipmask=f.genMipmaps?(g[0].width<<1)-1:g[0].mipmask,h.internalformat=g[0].internalformat,l.width=g[0].width,l.height=g[0].height,B(h),s=0;6>s;++s)y(g[s],34069+s);for(z(f,34067),R(),a.profile&&(h.stats.size=T(h.internalformat,h.type,l.width,l.height,f.genMipmaps,!0)),l.format=Q[h.internalformat],l.type=Y[h.type],l.mag=J[f.magFilter],l.min=Z[f.minFilter],l.wrapS=te[f.wrapS],l.wrapT=te[f.wrapT],s=0;6>s;++s)D(g[s]);return l}var h=new j(34067);ce[h.id]=h,o.cubeCount++;var g=Array(6);return l(t,n,r,i,s,f),l.subimage=function(e,t,n,r,i){n|=0,r|=0,i|=0;var o=m();return u(o,h),o.width=0,o.height=0,d(o,t),o.width=o.width||(h.width>>i)-n,o.height=o.height||(h.height>>i)-r,B(h),p(o,34069+e,n,r,i),R(),v(o),l},l.resize=function(t){if((t|=0)!==h.width){l.width=h.width=t,l.height=h.height=t,B(h);for(var n=0;6>n;++n)for(var r=0;h.mipmask>>r;++r)e.texImage2D(34069+n,r,h.format,t>>r,t>>r,0,h.format,h.type,null);return R(),a.profile&&(h.stats.size=T(h.internalformat,h.type,l.width,l.height,!1,!0)),l}},l._reglType="textureCube",l._texture=h,a.profile&&(l.stats=h.stats),l.destroy=function(){h.decRef()},l},clear:function(){for(var t=0;t<fe;++t)e.activeTexture(33984+t),e.bindTexture(3553,null),le[t]=null;ee(ce).forEach(F),o.cubeCount=0,o.textureCount=0},getTexture:function(e){return null},restore:function(){ee(ce).forEach(function(t){t.texture=e.createTexture(),e.bindTexture(t.target,t.texture);for(var n=0;32>n;++n)if(0!=(t.mipmask&1<<n))if(3553===t.target)e.texImage2D(3553,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);else for(var r=0;6>r;++r)e.texImage2D(34069+r,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);z(t.texInfo,t.target)})}}}function O(e,t,n,r,i,o){function a(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=e=0;t?(e=t.width,r=t.height):n&&(e=n.width,r=n.height),this.width=e,this.height=r}function s(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function u(e,t,n){e&&(e.texture?e.texture._texture.refCount+=1:e.renderbuffer._renderbuffer.refCount+=1)}function c(t,n){n&&(n.texture?e.framebufferTexture2D(36160,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(36160,t,36161,n.renderbuffer._renderbuffer.renderbuffer))}function f(e){var t=3553,n=null,r=null,i=e;return"object"==typeof e&&(i=e.data,"target"in e&&(t=0|e.target)),e=i._reglType,"texture2d"===e?n=i:"textureCube"===e?n=i:"renderbuffer"===e&&(r=i,t=36161),new a(t,n,r)}function l(e,t,n,o,s){return n?(e=r.create2D({width:e,height:t,format:o,type:s}),e._texture.refCount=0,new a(3553,e,null)):(e=i.create({width:e,height:t,format:o}),e._renderbuffer.refCount=0,new a(36161,null,e))}function h(e){return e&&(e.texture||e.renderbuffer)}function d(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n))}function p(){this.id=A++,E[this.id]=this,this.framebuffer=e.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function m(e){e.colorAttachments.forEach(s),s(e.depthAttachment),s(e.stencilAttachment),s(e.depthStencilAttachment)}function v(t){e.deleteFramebuffer(t.framebuffer),t.framebuffer=null,o.framebufferCount--,delete E[t.id]}function g(t){var r;e.bindFramebuffer(36160,t.framebuffer);var i=t.colorAttachments;for(r=0;r<i.length;++r)c(36064+r,i[r]);for(r=i.length;r<n.maxColorAttachments;++r)e.framebufferTexture2D(36160,36064+r,3553,null,0);e.framebufferTexture2D(36160,33306,3553,null,0),e.framebufferTexture2D(36160,36096,3553,null,0),e.framebufferTexture2D(36160,36128,3553,null,0),c(36096,t.depthAttachment),c(36128,t.stencilAttachment),c(33306,t.depthStencilAttachment),e.checkFramebufferStatus(36160),e.bindFramebuffer(36160,_.next),_.cur=_.next,e.getError()}function b(e,t){function n(e,t){var i,o=0,a=0,s=!0,c=!0;i=null;var d=!0,p="rgba",v="uint8",b=1,_=null,w=null,A=null,E=!1;"number"==typeof e?(o=0|e,a=0|t||o):e?("shape"in e?(a=e.shape,o=a[0],a=a[1]):("radius"in e&&(o=a=e.radius),"width"in e&&(o=e.width),"height"in e&&(a=e.height)),("color"in e||"colors"in e)&&(i=e.color||e.colors,Array.isArray(i)),i||("colorCount"in e&&(b=0|e.colorCount),"colorTexture"in e&&(d=!!e.colorTexture,p="rgba4"),"colorType"in e&&(v=e.colorType,!d)&&("half float"===v||"float16"===v?p="rgba16f":"float"!==v&&"float32"!==v||(p="rgba32f")),"colorFormat"in e&&(p=e.colorFormat,0<=y.indexOf(p)?d=!0:0<=x.indexOf(p)&&(d=!1))),("depthTexture"in e||"depthStencilTexture"in e)&&(E=!(!e.depthTexture&&!e.depthStencilTexture)),"depth"in e&&("boolean"==typeof e.depth?s=e.depth:(_=e.depth,c=!1)),"stencil"in e&&("boolean"==typeof e.stencil?c=e.stencil:(w=e.stencil,s=!1)),"depthStencil"in e&&("boolean"==typeof e.depthStencil?s=c=e.depthStencil:(A=e.depthStencil,c=s=!1))):o=a=1;var M=null,k=null,S=null,C=null;if(Array.isArray(i))M=i.map(f);else if(i)M=[f(i)];else for(M=Array(b),i=0;i<b;++i)M[i]=l(o,a,d,p,v);for(o=o||M[0].width,a=a||M[0].height,_?k=f(_):s&&!c&&(k=l(o,a,E,"depth","uint32")),w?S=f(w):c&&!s&&(S=l(o,a,!1,"stencil","uint8")),A?C=f(A):!_&&!w&&c&&s&&(C=l(o,a,E,"depth stencil","depth stencil")),s=null,i=0;i<M.length;++i)u(M[i],o,a),M[i]&&M[i].texture&&(c=xe[M[i].texture._texture.format]*we[M[i].texture._texture.type],null===s&&(s=c));return u(k,o,a),u(S,o,a),u(C,o,a),m(r),r.width=o,r.height=a,
r.colorAttachments=M,r.depthAttachment=k,r.stencilAttachment=S,r.depthStencilAttachment=C,n.color=M.map(h),n.depth=h(k),n.stencil=h(S),n.depthStencil=h(C),n.width=r.width,n.height=r.height,g(r),n}var r=new p;return o.framebufferCount++,n(e,t),X(n,{resize:function(e,t){var i=0|e,o=0|t||i;if(i===r.width&&o===r.height)return n;for(var a=r.colorAttachments,s=0;s<a.length;++s)d(a[s],i,o);return d(r.depthAttachment,i,o),d(r.stencilAttachment,i,o),d(r.depthStencilAttachment,i,o),r.width=n.width=i,r.height=n.height=o,g(r),n},_reglType:"framebuffer",_framebuffer:r,destroy:function(){v(r),m(r)},use:function(e){_.setFBO({framebuffer:n},e)}})}var _={cur:null,next:null,dirty:!1,setFBO:null},y=["rgba"],x=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&x.push("srgba"),t.ext_color_buffer_half_float&&x.push("rgba16f","rgb16f"),t.webgl_color_buffer_float&&x.push("rgba32f");var w=["uint8"];t.oes_texture_half_float&&w.push("half float","float16"),t.oes_texture_float&&w.push("float","float32");var A=0,E={};return X(_,{getFramebuffer:function(e){return"function"==typeof e&&"framebuffer"===e._reglType&&(e=e._framebuffer)instanceof p?e:null},create:b,createCube:function(e){function t(e){var i,o={color:null},a=0,s=null;i="rgba";var u="uint8",c=1;if("number"==typeof e?a=0|e:e?("shape"in e?a=e.shape[0]:("radius"in e&&(a=0|e.radius),"width"in e?a=0|e.width:"height"in e&&(a=0|e.height)),("color"in e||"colors"in e)&&(s=e.color||e.colors,Array.isArray(s)),s||("colorCount"in e&&(c=0|e.colorCount),"colorType"in e&&(u=e.colorType),"colorFormat"in e&&(i=e.colorFormat)),"depth"in e&&(o.depth=e.depth),"stencil"in e&&(o.stencil=e.stencil),"depthStencil"in e&&(o.depthStencil=e.depthStencil)):a=1,s)if(Array.isArray(s))for(e=[],i=0;i<s.length;++i)e[i]=s[i];else e=[s];else for(e=Array(c),s={radius:a,format:i,type:u},i=0;i<c;++i)e[i]=r.createCube(s);for(o.color=Array(e.length),i=0;i<e.length;++i)c=e[i],a=a||c.width,o.color[i]={target:34069,data:e[i]};for(i=0;6>i;++i){for(c=0;c<e.length;++c)o.color[c].target=34069+i;0<i&&(o.depth=n[0].depth,o.stencil=n[0].stencil,o.depthStencil=n[0].depthStencil),n[i]?n[i](o):n[i]=b(o)}return X(t,{width:a,height:a,color:e})}var n=Array(6);return t(e),X(t,{faces:n,resize:function(e){var r=0|e;if(r===t.width)return t;var i=t.color;for(e=0;e<i.length;++e)i[e].resize(r);for(e=0;6>e;++e)n[e].resize(r);return t.width=t.height=r,t},_reglType:"framebufferCube",destroy:function(){n.forEach(function(e){e.destroy()})}})},clear:function(){ee(E).forEach(v)},restore:function(){ee(E).forEach(function(t){t.framebuffer=e.createFramebuffer(),g(t)})}})}function L(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function z(e,t,n,r,i){for(e=n.maxAttributes,t=Array(e),n=0;n<e;++n)t[n]=new L;return{Record:L,scope:{},state:t}}function j(e,t,n,r){function i(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function o(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function a(n,r,i){i=35632===n?c:f;var o=i[r];if(!o){var a=t.str(r),o=e.createShader(n);e.shaderSource(o,a),e.compileShader(o),i[r]=o}return o}function s(e,t){this.id=d++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function u(n,s){var u,c;u=a(35632,n.fragId),c=a(35633,n.vertId);var f=n.program=e.createProgram();e.attachShader(f,u),e.attachShader(f,c),e.linkProgram(f);var l=e.getProgramParameter(f,35718);r.profile&&(n.stats.uniformsCount=l);var h=n.uniforms;for(u=0;u<l;++u)if(c=e.getActiveUniform(f,u))if(1<c.size)for(var d=0;d<c.size;++d){var p=c.name.replace("[0]","["+d+"]");o(h,new i(p,t.id(p),e.getUniformLocation(f,p),c))}else o(h,new i(c.name,t.id(c.name),e.getUniformLocation(f,c.name),c));for(l=e.getProgramParameter(f,35721),r.profile&&(n.stats.attributesCount=l),h=n.attributes,u=0;u<l;++u)(c=e.getActiveAttrib(f,u))&&o(h,new i(c.name,t.id(c.name),e.getAttribLocation(f,c.name),c))}var c={},f={},l={},h=[],d=0;return r.profile&&(n.getMaxUniformsCount=function(){var e=0;return h.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},n.getMaxAttributesCount=function(){var e=0;return h.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var t=e.deleteShader.bind(e);ee(c).forEach(t),c={},ee(f).forEach(t),f={},h.forEach(function(t){e.deleteProgram(t.program)}),h.length=0,l={},n.shaderCount=0},program:function(e,t,r){var i=l[t];i||(i=l[t]={});var o=i[e];return o||(o=new s(t,e),n.shaderCount++,u(o,r),i[e]=o,h.push(o)),o},restore:function(){c={},f={};for(var e=0;e<h.length;++e)u(h[e])},shader:a,frag:-1,vert:-1}}function B(e,t,n,r,i,o){function a(i){var o;o=null===t.next?5121:t.next.colorAttachments[0].texture._texture.type;var a=0,s=0,u=r.framebufferWidth,c=r.framebufferHeight,f=null;return $(i)?f=i:i&&(a=0|i.x,s=0|i.y,u=0|(i.width||r.framebufferWidth-a),c=0|(i.height||r.framebufferHeight-s),f=i.data||null),n(),i=u*c*4,f||(5121===o?f=new Uint8Array(i):5126===o&&(f=f||new Float32Array(i))),e.pixelStorei(3333,4),e.readPixels(a,s,u,c,6408,o,f),f}function s(e){var n;return t.setFBO({framebuffer:e.framebuffer},function(){n=a(e)}),n}return function(e){return e&&"framebuffer"in e?s(e):a(e)}}function R(e){return Array.prototype.slice.call(e)}function F(e){return R(e).join("")}function I(){function e(){var e=[],t=[];return X(function(){e.push.apply(e,R(arguments))},{def:function(){var r="v"+n++;return t.push(r),0<arguments.length&&(e.push(r,"="),e.push.apply(e,R(arguments)),e.push(";")),r},toString:function(){return F([0<t.length?"var "+t+";":"",F(e)])}})}function t(){function t(e,t){r(e,t,"=",n.def(e,t),";")}var n=e(),r=e(),i=n.toString,o=r.toString;return X(function(){n.apply(n,R(arguments))},{def:n.def,entry:n,exit:r,save:t,set:function(e,r,i){t(e,r),n(e,r,"=",i,";")},toString:function(){return i()+o()}})}var n=0,r=[],i=[],o=e(),a={};return{global:o,link:function(e){for(var t=0;t<i.length;++t)if(i[t]===e)return r[t];return t="g"+n++,r.push(t),i.push(e),t},block:e,proc:function(e,n){function r(){var e="a"+i.length;return i.push(e),e}var i=[];n=n||0;for(var o=0;o<n;++o)r();var o=t(),s=o.toString;return a[e]=X(o,{arg:r,toString:function(){return F(["function(",i.join(),"){",s(),"}"])}})},scope:t,cond:function(){var e=F(arguments),n=t(),r=t(),i=n.toString,o=r.toString;return X(n,{then:function(){return n.apply(n,R(arguments)),this},else:function(){return r.apply(r,R(arguments)),this},toString:function(){var t=o();return t&&(t="else{"+t+"}"),F(["if(",e,"){",i(),"}",t])}})},compile:function(){var e=['"use strict";',o,"return {"];Object.keys(a).forEach(function(t){e.push('"',t,'":',a[t].toString(),",")}),e.push("}");var t=F(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,r.concat(t)).apply(null,i)}}}function N(e){return Array.isArray(e)||$(e)||f(e)}function P(e){return e.sort(function(e,t){return"viewport"===e?-1:"viewport"===t?1:e<t?-1:1})}function H(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function U(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function V(e){return new H(!1,!1,!1,e)}function q(e,t){var n=e.type;return 0===n?(n=e.data.length,new H(!0,1<=n,2<=n,t)):4===n?(n=e.data,new H(n.thisDep,n.contextDep,n.propDep,t)):new H(3===n,2===n,1===n,t)}function G(e,t,n,r,i,o,a,s,u,c,f,h,d,p,m){function v(e){return e.replace(".","_")}function g(e,t,n){var r=v(e);le.push(e),ce[r]=ue[r]=!!n,he[r]=t}function b(e,t,n){var r=v(e);le.push(e),Array.isArray(n)?(ue[r]=n.slice(),ce[r]=n.slice()):ue[r]=ce[r]=n,de[r]=t}function _(){var e=I(),n=e.link,r=e.global;e.id=ve++,e.batchId="0";var i=n(pe),o=e.shared={props:"a0"};Object.keys(pe).forEach(function(e){o[e]=r.def(i,".",e)});var a=e.next={},s=e.current={};Object.keys(de).forEach(function(e){Array.isArray(ue[e])&&(a[e]=r.def(o.next,".",e),s[e]=r.def(o.current,".",e))});var u=e.constants={};Object.keys(me).forEach(function(e){u[e]=r.def(JSON.stringify(me[e]))}),e.invoke=function(t,r){switch(r.type){case 0:var i=["this",o.context,o.props,e.batchId];return t.def(n(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case 1:return t.def(o.props,r.data);case 2:return t.def(o.context,r.data);case 3:return t.def("this",r.data);case 4:return r.data.append(e,t),r.data.ref}},e.attribCache={};var f={};return e.scopeAttrib=function(e){if((e=t.id(e))in f)return f[e];var r=c.scope[e];return r||(r=c.scope[e]=new re),f[e]=n(r)},e}function y(e){var t=e.static;e=e.dynamic;var n;if("profile"in t){var r=!!t.profile;n=V(function(e,t){return r}),n.enable=r}else if("profile"in e){var i=e.profile;n=q(i,function(e,t){return e.invoke(t,i)})}return n}function x(e,t){var n=e.static,r=e.dynamic;if("framebuffer"in n){var i=n.framebuffer;return i?(i=s.getFramebuffer(i),V(function(e,t){var n=e.link(i),r=e.shared;return t.set(r.framebuffer,".next",n),r=r.context,t.set(r,".framebufferWidth",n+".width"),t.set(r,".framebufferHeight",n+".height"),n})):V(function(e,t){var n=e.shared;return t.set(n.framebuffer,".next","null"),n=n.context,t.set(n,".framebufferWidth",n+".drawingBufferWidth"),t.set(n,".framebufferHeight",n+".drawingBufferHeight"),"null"})}if("framebuffer"in r){var o=r.framebuffer;return q(o,function(e,t){var n=e.invoke(t,o),r=e.shared,i=r.framebuffer,n=t.def(i,".getFramebuffer(",n,")");return t.set(i,".next",n),r=r.context,t.set(r,".framebufferWidth",n+"?"+n+".width:"+r+".drawingBufferWidth"),t.set(r,".framebufferHeight",n+"?"+n+".height:"+r+".drawingBufferHeight"),n})}return null}function w(e,t,n){function r(e){if(e in i){var n=i[e];e=!0;var r,a,s=0|n.x,u=0|n.y;return"width"in n?r=0|n.width:e=!1,"height"in n?a=0|n.height:e=!1,new H(!e&&t&&t.thisDep,!e&&t&&t.contextDep,!e&&t&&t.propDep,function(e,t){var i=e.shared.context,o=r;"width"in n||(o=t.def(i,".","framebufferWidth","-",s));var c=a;return"height"in n||(c=t.def(i,".","framebufferHeight","-",u)),[s,u,o,c]})}if(e in o){var c=o[e];return e=q(c,function(e,t){var n=e.invoke(t,c),r=e.shared.context,i=t.def(n,".x|0"),o=t.def(n,".y|0"),a=t.def('"width" in ',n,"?",n,".width|0:","(",r,".","framebufferWidth","-",i,")"),n=t.def('"height" in ',n,"?",n,".height|0:","(",r,".","framebufferHeight","-",o,")");return[i,o,a,n]}),t&&(e.thisDep=e.thisDep||t.thisDep,e.contextDep=e.contextDep||t.contextDep,e.propDep=e.propDep||t.propDep),e}return t?new H(t.thisDep,t.contextDep,t.propDep,function(e,t){var n=e.shared.context;return[0,0,t.def(n,".","framebufferWidth"),t.def(n,".","framebufferHeight")]}):null}var i=e.static,o=e.dynamic;if(e=r("viewport")){var a=e;e=new H(e.thisDep,e.contextDep,e.propDep,function(e,t){var n=a.append(e,t),r=e.shared.context;return t.set(r,".viewportWidth",n[2]),t.set(r,".viewportHeight",n[3]),n})}return{viewport:e,scissor_box:r("scissor.box")}}function E(e){function n(e){if(e in r){var n=t.id(r[e]);return e=V(function(){return n}),e.id=n,e}if(e in i){var o=i[e];return q(o,function(e,t){var n=e.invoke(t,o);return t.def(e.shared.strings,".id(",n,")")})}return null}var r=e.static,i=e.dynamic,o=n("frag"),a=n("vert"),s=null;return U(o)&&U(a)?(s=f.program(a.id,o.id),e=V(function(e,t){return e.link(s)})):e=new H(o&&o.thisDep||a&&a.thisDep,o&&o.contextDep||a&&a.contextDep,o&&o.propDep||a&&a.propDep,function(e,t){var n,r=e.shared.shader;n=o?o.append(e,t):t.def(r,".","frag");var i;return i=a?a.append(e,t):t.def(r,".","vert"),t.def(r+".program("+i+","+n+")")}),{frag:o,vert:a,progVar:e,program:s}}function M(e,t){function n(e,t){if(e in r){var n=0|r[e];return V(function(e,r){return t&&(e.OFFSET=n),n})}if(e in i){var o=i[e];return q(o,function(e,n){var r=e.invoke(n,o);return t&&(e.OFFSET=r),r})}return t&&a?V(function(e,t){return e.OFFSET="0",0}):null}var r=e.static,i=e.dynamic,a=function(){if("elements"in r){var e=r.elements;N(e)?e=o.getElements(o.create(e,!0)):e&&(e=o.getElements(e));var t=V(function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r}return t.ELEMENTS=null});return t.value=e,t}if("elements"in i){var n=i.elements;return q(n,function(e,t){var r=e.shared,i=r.isBufferArgs,r=r.elements,o=e.invoke(t,n),a=t.def("null"),i=t.def(i,"(",o,")"),o=e.cond(i).then(a,"=",r,".createStream(",o,");").else(a,"=",r,".getElements(",o,");");return t.entry(o),t.exit(e.cond(i).then(r,".destroyStream(",a,");")),e.ELEMENTS=a})}return null}(),s=n("offset",!0);return{elements:a,primitive:function(){if("primitive"in r){var e=r.primitive;return V(function(t,n){return fe[e]})}if("primitive"in i){var t=i.primitive;return q(t,function(e,n){var r=e.constants.primTypes,i=e.invoke(n,t);return n.def(r,"[",i,"]")})}return a?U(a)?V(a.value?function(e,t){return t.def(e.ELEMENTS,".primType")}:function(){return 4}):new H(a.thisDep,a.contextDep,a.propDep,function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",4)}):null}(),count:function(){if("count"in r){var e=0|r.count;return V(function(){return e})}if("count"in i){var t=i.count;return q(t,function(e,n){return e.invoke(n,t)})}return a?U(a)?a?s?new H(s.thisDep,s.contextDep,s.propDep,function(e,t){return t.def(e.ELEMENTS,".vertCount-",e.OFFSET)}):V(function(e,t){return t.def(e.ELEMENTS,".vertCount")}):V(function(){return-1}):new H(a.thisDep||s.thisDep,a.contextDep||s.contextDep,a.propDep||s.propDep,function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")}):null}(),instances:n("instances",!1),offset:s}}function k(e,t){var n=e.static,r=e.dynamic,i={};return le.forEach(function(e){function t(t,a){if(e in n){var s=t(n[e]);i[o]=V(function(){return s})}else if(e in r){var u=r[e];i[o]=q(u,function(e,t){return a(e,t,e.invoke(t,u))})}}var o=v(e);switch(e){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return t(function(e){return e},function(e,t,n){return n});case"depth.func":return t(function(e){return ke[e]},function(e,t,n){return t.def(e.constants.compareFuncs,"[",n,"]")});case"depth.range":return t(function(e){return e},function(e,t,n){return e=t.def("+",n,"[0]"),t=t.def("+",n,"[1]"),[e,t]});case"blend.func":return t(function(e){return[Me["srcRGB"in e?e.srcRGB:e.src],Me["dstRGB"in e?e.dstRGB:e.dst],Me["srcAlpha"in e?e.srcAlpha:e.src],Me["dstAlpha"in e?e.dstAlpha:e.dst]]},function(e,t,n){function r(e,r){return t.def('"',e,r,'" in ',n,"?",n,".",e,r,":",n,".",e)}e=e.constants.blendFuncs;var i=r("src","RGB"),o=r("dst","RGB"),i=t.def(e,"[",i,"]"),a=t.def(e,"[",r("src","Alpha"),"]"),o=t.def(e,"[",o,"]");return e=t.def(e,"[",r("dst","Alpha"),"]"),[i,o,a,e]});case"blend.equation":return t(function(e){return"string"==typeof e?[ie[e],ie[e]]:"object"==typeof e?[ie[e.rgb],ie[e.alpha]]:void 0},function(e,t,n){var r=e.constants.blendEquations,i=t.def(),o=t.def();return e=e.cond("typeof ",n,'==="string"'),e.then(i,"=",o,"=",r,"[",n,"];"),e.else(i,"=",r,"[",n,".rgb];",o,"=",r,"[",n,".alpha];"),t(e),[i,o]});case"blend.color":return t(function(e){return l(4,function(t){return+e[t]})},function(e,t,n){return l(4,function(e){return t.def("+",n,"[",e,"]")})});case"stencil.mask":return t(function(e){return 0|e},function(e,t,n){return t.def(n,"|0")});case"stencil.func":return t(function(e){return[ke[e.cmp||"keep"],e.ref||0,"mask"in e?e.mask:-1]},function(e,t,n){e=t.def('"cmp" in ',n,"?",e.constants.compareFuncs,"[",n,".cmp]",":",7680);var r=t.def(n,".ref|0");return t=t.def('"mask" in ',n,"?",n,".mask|0:-1"),[e,r,t]});case"stencil.opFront":case"stencil.opBack":return t(function(t){return["stencil.opBack"===e?1029:1028,Se[t.fail||"keep"],Se[t.zfail||"keep"],Se[t.zpass||"keep"]]},function(t,n,r){function i(e){return n.def('"',e,'" in ',r,"?",o,"[",r,".",e,"]:",7680)}var o=t.constants.stencilOps;return["stencil.opBack"===e?1029:1028,i("fail"),i("zfail"),i("zpass")]});case"polygonOffset.offset":return t(function(e){return[0|e.factor,0|e.units]},function(e,t,n){return e=t.def(n,".factor|0"),t=t.def(n,".units|0"),[e,t]});case"cull.face":return t(function(e){var t=0;return"front"===e?t=1028:"back"===e&&(t=1029),t},function(e,t,n){return t.def(n,'==="front"?',1028,":",1029)});case"lineWidth":return t(function(e){return e},function(e,t,n){return n});case"frontFace":return t(function(e){return Ce[e]},function(e,t,n){return t.def(n+'==="cw"?2304:2305')});case"colorMask":return t(function(e){return e.map(function(e){return!!e})},function(e,t,n){return l(4,function(e){return"!!"+n+"["+e+"]"})});case"sample.coverage":return t(function(e){return["value"in e?e.value:1,!!e.invert]},function(e,t,n){return e=t.def('"value" in ',n,"?+",n,".value:1"),t=t.def("!!",n,".invert"),[e,t]})}}),i}function S(e,t){var n=e.static,r=e.dynamic,i={};return Object.keys(n).forEach(function(e){var t,r=n[e];if("number"==typeof r||"boolean"==typeof r)t=V(function(){return r});else if("function"==typeof r){var o=r._reglType;"texture2d"===o||"textureCube"===o?t=V(function(e){return e.link(r)}):"framebuffer"!==o&&"framebufferCube"!==o||(t=V(function(e){return e.link(r.color[0])}))}else A(r)&&(t=V(function(e){return e.global.def("[",l(r.length,function(e){return r[e]}),"]")}));t.value=r,i[e]=t}),Object.keys(r).forEach(function(e){var t=r[e];i[e]=q(t,function(e,n){return e.invoke(n,t)})}),i}function C(e,n){var r=e.static,o=e.dynamic,a={};return Object.keys(r).forEach(function(e){var n=r[e],o=t.id(e),s=new re;if(N(n))s.state=1,s.buffer=i.getBuffer(i.create(n,34962,!1,!0)),s.type=0;else{var u=i.getBuffer(n);if(u)s.state=1,s.buffer=u,s.type=0;else if(n.constant){var c=n.constant;s.buffer="null",s.state=2,"number"==typeof c?s.x=c:Ae.forEach(function(e,t){t<c.length&&(s[e]=c[t])})}else{var u=N(n.buffer)?i.getBuffer(i.create(n.buffer,34962,!1,!0)):i.getBuffer(n.buffer),f=0|n.offset,l=0|n.stride,h=0|n.size,d=!!n.normalized,p=0;"type"in n&&(p=oe[n.type]),n=0|n.divisor,s.buffer=u,s.state=1,s.size=h,s.normalized=d,s.type=p||u.dtype,s.offset=f,s.stride=l,s.divisor=n}}a[e]=V(function(e,t){var n=e.attribCache;if(o in n)return n[o];var r={isStream:!1};return Object.keys(s).forEach(function(e){r[e]=s[e]}),s.buffer&&(r.buffer=e.link(s.buffer),r.type=r.type||r.buffer+".dtype"),n[o]=r})}),Object.keys(o).forEach(function(e){var t=o[e];a[e]=q(t,function(e,n){function r(e){n(u[e],"=",i,".",e,"|0;")}var i=e.invoke(n,t),o=e.shared,a=o.isBufferArgs,s=o.buffer,u={isStream:n.def(!1)},c=new re;c.state=1,Object.keys(c).forEach(function(e){u[e]=n.def(""+c[e])});var f=u.buffer,l=u.type;return n("if(",a,"(",i,")){",u.isStream,"=true;",f,"=",s,".createStream(",34962,",",i,");",l,"=",f,".dtype;","}else{",f,"=",s,".getBuffer(",i,");","if(",f,"){",l,"=",f,".dtype;",'}else if("constant" in ',i,"){",u.state,"=",2,";","if(typeof "+i+'.constant === "number"){',u[Ae[0]],"=",i,".constant;",Ae.slice(1).map(function(e){return u[e]}).join("="),"=0;","}else{",Ae.map(function(e,t){return u[e]+"="+i+".constant.length>="+t+"?"+i+".constant["+t+"]:0;"}).join(""),"}}else{","if(",a,"(",i,".buffer)){",f,"=",s,".createStream(",34962,",",i,".buffer);","}else{",f,"=",s,".getBuffer(",i,".buffer);","}",l,'="type" in ',i,"?",o.glTypes,"[",i,".type]:",f,".dtype;",u.normalized,"=!!",i,".normalized;"),r("size"),r("offset"),r("stride"),r("divisor"),n("}}"),n.exit("if(",u.isStream,"){",s,".destroyStream(",f,");","}"),u})}),a}function T(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach(function(e){var n=t[e];r[e]=V(function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)})}),Object.keys(n).forEach(function(e){var t=n[e];r[e]=q(t,function(e,n){return e.invoke(n,t)})}),r}function D(e,t,n,r,i){var o=x(e,i),a=w(e,o,i),s=M(e,i),u=k(e,i),c=E(e,i),f=a.viewport;return f&&(u.viewport=f),f=v("scissor.box"),(a=a[f])&&(u[f]=a),a=0<Object.keys(u).length,o={framebuffer:o,draw:s,shader:c,state:u,dirty:a},o.profile=y(e,i),o.uniforms=S(n,i),o.attributes=C(t,i),o.context=T(r,i),o}function O(e,t,n){var r=e.shared.context,i=e.scope();Object.keys(n).forEach(function(o){t.save(r,"."+o),i(r,".",o,"=",n[o].append(e,t),";")}),t(i)}function L(e,t,n,r){var i,o=e.shared,a=o.gl,s=o.framebuffer;se&&(i=t.def(o.extensions,".webgl_draw_buffers"));var u=e.constants,o=u.drawBuffer,u=u.backBuffer;e=n?n.append(e,t):t.def(s,".next"),r||t("if(",e,"!==",s,".cur){"),t("if(",e,"){",a,".bindFramebuffer(",36160,",",e,".framebuffer);"),se&&t(i,".drawBuffersWEBGL(",o,"[",e,".colorAttachments.length]);"),t("}else{",a,".bindFramebuffer(",36160,",null);"),se&&t(i,".drawBuffersWEBGL(",u,");"),t("}",s,".cur=",e,";"),r||t("}")}function z(e,t,n){var r=e.shared,i=r.gl,o=e.current,a=e.next,s=r.current,u=r.next,c=e.cond(s,".dirty");le.forEach(function(t){if(!((t=v(t))in n.state)){var r,f;if(t in a){r=a[t],f=o[t];var h=l(ue[t].length,function(e){return c.def(r,"[",e,"]")});c(e.cond(h.map(function(e,t){return e+"!=="+f+"["+t+"]"}).join("||")).then(i,".",de[t],"(",h,");",h.map(function(e,t){return f+"["+t+"]="+e}).join(";"),";"))}else r=c.def(u,".",t),h=e.cond(r,"!==",s,".",t),c(h),t in he?h(e.cond(r).then(i,".enable(",he[t],");").else(i,".disable(",he[t],");"),s,".",t,"=",r,";"):h(i,".",de[t],"(",r,");",s,".",t,"=",r,";")}}),0===Object.keys(n.state).length&&c(s,".dirty=false;"),t(c)}function j(e,t,n,r){var i=e.shared,o=e.current,a=i.current,s=i.gl;P(Object.keys(n)).forEach(function(i){var u=n[i];if(!r||r(u)){var c=u.append(e,t);if(he[i]){var f=he[i];U(u)?c?t(s,".enable(",f,");"):t(s,".disable(",f,");"):t(e.cond(c).then(s,".enable(",f,");").else(s,".disable(",f,");")),t(a,".",i,"=",c,";")}else if(A(c)){var l=o[i];t(s,".",de[i],"(",c,");",c.map(function(e,t){return l+"["+t+"]="+e}).join(";"),";")}else t(s,".",de[i],"(",c,");",a,".",i,"=",c,";")}})}function B(e,t){ae&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function R(e,t,n,r,i){function o(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function a(e){d=t.def(),e(d,"=",o(),";"),"string"==typeof i?e(f,".count+=",i,";"):e(f,".count++;"),p&&(r?(m=t.def(),e(m,"=",h,".getNumPendingQueries();")):e(h,".beginQuery(",f,");"))}function s(e){e(f,".cpuTime+=",o(),"-",d,";"),p&&(r?e(h,".pushScopeStats(",m,",",h,".getNumPendingQueries(),",f,");"):e(h,".endQuery();"))}function u(e){var n=t.def(l,".profile");t(l,".profile=",e,";"),t.exit(l,".profile=",n,";")}var c=e.shared,f=e.stats,l=c.current,h=c.timer;n=n.profile;var d,m;if(n){if(U(n))return void(n.enable?(a(t),s(t.exit),u("true")):u("false"));n=n.append(e,t),u(n)}else n=t.def(l,".profile");c=e.block(),a(c),t("if(",n,"){",c,"}"),e=e.block(),s(e),t.exit("if(",n,"){",e,"}")}function F(e,t,n,r,i){function o(e){switch(e){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function a(n,r,i){function o(){t("if(!",f,".buffer){",u,".enableVertexAttribArray(",c,");}");var n,o=i.type;n=i.size?t.def(i.size,"||",r):r,t("if(",f,".type!==",o,"||",f,".size!==",n,"||",d.map(function(e){return f+"."+e+"!=="+i[e]}).join("||"),"){",u,".bindBuffer(",34962,",",l,".buffer);",u,".vertexAttribPointer(",[c,n,o,i.normalized,i.stride,i.offset],");",f,".type=",o,";",f,".size=",n,";",d.map(function(e){return f+"."+e+"="+i[e]+";"}).join(""),"}"),ae&&(o=i.divisor,t("if(",f,".divisor!==",o,"){",e.instancing,".vertexAttribDivisorANGLE(",[c,o],");",f,".divisor=",o,";}"))}function a(){t("if(",f,".buffer){",u,".disableVertexAttribArray(",c,");","}if(",Ae.map(function(e,t){return f+"."+e+"!=="+h[t]}).join("||"),"){",u,".vertexAttrib4f(",c,",",h,");",Ae.map(function(e,t){return f+"."+e+"="+h[t]+";"}).join(""),"}")}var u=s.gl,c=t.def(n,".location"),f=t.def(s.attributes,"[",c,"]");n=i.state;var l=i.buffer,h=[i.x,i.y,i.z,i.w],d=["buffer","normalized","offset","stride"];1===n?o():2===n?a():(t("if(",n,"===",1,"){"),o(),t("}else{"),a(),t("}"))}var s=e.shared;r.forEach(function(r){var s,u=r.name,c=n.attributes[u];if(c){if(!i(c))return;s=c.append(e,t)}else{if(!i(Te))return;var f=e.scopeAttrib(u);s={},Object.keys(new re).forEach(function(e){s[e]=t.def(f,".",e)})}a(e.link(r),o(r.info.type),s)})}function G(e,n,r,i,o){for(var a,s=e.shared,u=s.gl,c=0;c<i.length;++c){var f,h=i[c],d=h.name,p=h.info.type,m=r.uniforms[d],h=e.link(h)+".location";if(m){if(!o(m))continue;if(U(m)){if(d=m.value,35678===p||35680===p)p=e.link(d._texture||d.color[0]._texture),n(u,".uniform1i(",h,",",p+".bind());"),n.exit(p,".unbind();");else if(35674===p||35675===p||35676===p)d=e.global.def("new Float32Array(["+Array.prototype.slice.call(d)+"])"),m=2,35675===p?m=3:35676===p&&(m=4),n(u,".uniformMatrix",m,"fv(",h,",false,",d,");");else{switch(p){case 5126:a="1f";break;case 35664:a="2f";break;case 35665:a="3f";break;case 35666:a="4f";break;case 35670:case 5124:a="1i";break;case 35671:case 35667:a="2i";break;case 35672:case 35668:a="3i";break;case 35673:a="4i";break;case 35669:a="4i"}n(u,".uniform",a,"(",h,",",A(d)?Array.prototype.slice.call(d):d,");")}continue}f=m.append(e,n)}else{if(!o(Te))continue;f=n.def(s.uniforms,"[",t.id(d),"]")}switch(35678===p?n("if(",f,"&&",f,'._reglType==="framebuffer"){',f,"=",f,".color[0];","}"):35680===p&&n("if(",f,"&&",f,'._reglType==="framebufferCube"){',f,"=",f,".color[0];","}"),d=1,p){case 35678:case 35680:p=n.def(f,"._texture"),n(u,".uniform1i(",h,",",p,".bind());"),n.exit(p,".unbind();");continue;case 5124:case 35670:a="1i";break;case 35667:case 35671:a="2i",d=2;break;case 35668:case 35672:a="3i",d=3;break;case 35669:case 35673:a="4i",d=4;break;case 5126:a="1f";break;case 35664:a="2f",d=2;break;case 35665:a="3f",d=3;break;case 35666:a="4f",d=4;break;case 35674:a="Matrix2fv";break;case 35675:a="Matrix3fv";break;case 35676:a="Matrix4fv"}if(n(u,".uniform",a,"(",h,","),"M"===a.charAt(0)){var h=Math.pow(p-35674+2,2),v=e.global.def("new Float32Array(",h,")");n("false,(Array.isArray(",f,")||",f," instanceof Float32Array)?",f,":(",l(h,function(e){return v+"["+e+"]="+f+"["+e+"]"}),",",v,")")}else n(1<d?l(d,function(e){return f+"["+e+"]"}):f);n(");")}}function W(e,t,n,r){function i(i){var o=f[i];return o?o.contextDep&&r.contextDynamic||o.propDep?o.append(e,n):o.append(e,t):t.def(c,".",i)}function o(){function e(){n(v,".drawElementsInstancedANGLE(",[h,p,g,d+"<<(("+g+"-5121)>>1)",m],");")}function t(){n(v,".drawArraysInstancedANGLE(",[h,d,p,m],");")}l?b?e():(n("if(",l,"){"),e(),n("}else{"),t(),n("}")):t()}function a(){function e(){n(u+".drawElements("+[h,p,g,d+"<<(("+g+"-5121)>>1)"]+");")}function t(){n(u+".drawArrays("+[h,d,p]+");")}l?b?e():(n("if(",l,"){"),e(),n("}else{"),t(),n("}")):t()}var s=e.shared,u=s.gl,c=s.draw,f=r.draw,l=function(){var i=f.elements,o=t;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(o=n),i=i.append(e,o)):i=o.def(c,".","elements"),i&&o("if("+i+")"+u+".bindBuffer(34963,"+i+".buffer.buffer);"),i}(),h=i("primitive"),d=i("offset"),p=function(){var i=f.count,o=t;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(o=n),i=i.append(e,o)):i=o.def(c,".","count"),i}();if("number"==typeof p){if(0===p)return}else n("if(",p,"){"),n.exit("}");var m,v;ae&&(m=i("instances"),v=e.instancing);var g=l+".type",b=f.elements&&U(f.elements);ae&&("number"!=typeof m||0<=m)?"string"==typeof m?(n("if(",m,">0){"),o(),n("}else if(",m,"<0){"),a(),n("}")):o():a()}function X(e,t,n,r,i){return t=_(),i=t.proc("body",i),ae&&(t.instancing=i.def(t.shared.extensions,".angle_instanced_arrays")),e(t,i,n,r),t.compile().body}function K(e,t,n,r){B(e,t),F(e,t,n,r.attributes,function(){return!0}),G(e,t,n,r.uniforms,function(){return!0}),W(e,t,t,n)}function Y(e,t){var n=e.proc("draw",1);B(e,n),O(e,n,t.context),L(e,n,t.framebuffer),z(e,n,t),j(e,n,t.state),R(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)K(e,n,t,t.shader.program);else{var i=e.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(e.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",e.link(function(n){return X(K,e,t,n,1)}),"(",r,");",a,".call(this,a0);"))}0<Object.keys(t.state).length&&n(e.shared.current,".dirty=true;")}function J(e,t,n,r){function i(){return!0}e.batchId="a1",B(e,t),F(e,t,n,r.attributes,i),G(e,t,n,r.uniforms,i),W(e,t,t,n)}function Z(e,t,n,r){function i(e){return e.contextDep&&a||e.propDep}function o(e){return!i(e)}B(e,t);var a=n.contextDep,s=t.def(),u=t.def();e.shared.props=u,e.batchId=s;var c=e.scope(),f=e.scope();t(c.entry,"for(",s,"=0;",s,"<","a1",";++",s,"){",u,"=","a0","[",s,"];",f,"}",c.exit),n.needsContext&&O(e,f,n.context),n.needsFramebuffer&&L(e,f,n.framebuffer),j(e,f,n.state,i),n.profile&&i(n.profile)&&R(e,f,n,!1,!0),r?(F(e,c,n,r.attributes,o),F(e,f,n,r.attributes,i),G(e,c,n,r.uniforms,o),G(e,f,n,r.uniforms,i),W(e,c,f,n)):(t=e.global.def("{}"),r=n.shader.progVar.append(e,f),u=f.def(r,".id"),c=f.def(t,"[",u,"]"),f(e.shared.gl,".useProgram(",r,".program);","if(!",c,"){",c,"=",t,"[",u,"]=",e.link(function(t){return X(J,e,n,t,2)}),"(",r,");}",c,".call(this,a0[",s,"],",s,");"))}function $(e,t){function n(e){return e.contextDep&&i||e.propDep}var r=e.proc("batch",2);e.batchId="0",B(e,r);var i=!1,o=!0;Object.keys(t.context).forEach(function(e){i=i||t.context[e].propDep}),i||(O(e,r,t.context),o=!1);var a=t.framebuffer,s=!1;if(a?(a.propDep?i=s=!0:a.contextDep&&i&&(s=!0),s||L(e,r,a)):L(e,r,null),t.state.viewport&&t.state.viewport.propDep&&(i=!0),z(e,r,t),j(e,r,t.state,function(e){return!n(e)}),t.profile&&n(t.profile)||R(e,r,t,!1,"a1"),t.contextDep=i,t.needsContext=o,t.needsFramebuffer=s,o=t.shader.progVar,o.contextDep&&i||o.propDep)Z(e,r,t,null);else if(o=o.append(e,r),r(e.shared.gl,".useProgram(",o,".program);"),t.shader.program)Z(e,r,t,t.shader.program);else{var a=e.global.def("{}"),s=r.def(o,".id"),u=r.def(a,"[",s,"]");r(e.cond(u).then(u,".call(this,a0,a1);").else(u,"=",a,"[",s,"]=",e.link(function(n){return X(Z,e,t,n,2)}),"(",o,");",u,".call(this,a0,a1);"))}0<Object.keys(t.state).length&&r(e.shared.current,".dirty=true;")}function ee(e,n){function r(t){var r=n.shader[t];r&&i.set(o.shader,"."+t,r.append(e,i))}var i=e.proc("scope",3);e.batchId="a2";var o=e.shared,a=o.current;O(e,i,n.context),n.framebuffer&&n.framebuffer.append(e,i),P(Object.keys(n.state)).forEach(function(t){var r=n.state[t].append(e,i);A(r)?r.forEach(function(n,r){i.set(e.next[t],"["+r+"]",n)}):i.set(o.next,"."+t,r)}),R(e,i,n,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(t){var r=n.draw[t];r&&i.set(o.draw,"."+t,""+r.append(e,i))}),Object.keys(n.uniforms).forEach(function(r){i.set(o.uniforms,"["+t.id(r)+"]",n.uniforms[r].append(e,i))}),Object.keys(n.attributes).forEach(function(t){var r=n.attributes[t].append(e,i),o=e.scopeAttrib(t);Object.keys(new re).forEach(function(e){i.set(o,"."+e,r[e])})}),r("vert"),r("frag"),0<Object.keys(n.state).length&&(i(a,".dirty=true;"),i.exit(a,".dirty=true;")),i("a1(",e.shared.context,",a0,",e.batchId,");")}function te(e){if("object"==typeof e&&!A(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(Q.isDynamic(e[t[n]]))return!0;return!1}}function ne(e,t,n){function r(e,t){a.forEach(function(n){var r=i[n];Q.isDynamic(r)&&(r=e.invoke(t,r),t(f,".",n,"=",r,";"))})}var i=t.static[n];if(i&&te(i)){var o=e.global,a=Object.keys(i),s=!1,u=!1,c=!1,f=e.global.def("{}");a.forEach(function(t){var n=i[t];if(Q.isDynamic(n))"function"==typeof n&&(n=i[t]=Q.unbox(n)),t=q(n,null),s=s||t.thisDep,c=c||t.propDep,u=u||t.contextDep;else{switch(o(f,".",t,"="),typeof n){case"number":o(n);break;case"string":o('"',n,'"');break;case"object":Array.isArray(n)&&o("[",n.join(),"]");break;default:o(e.link(n))}o(";")}}),t.dynamic[n]=new Q.DynamicVariable(4,{thisDep:s,contextDep:u,propDep:c,ref:f,append:r}),delete t.static[n]}}var re=c.Record,ie={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(ie.min=32775,ie.max=32776);var ae=n.angle_instanced_arrays,se=n.webgl_draw_buffers,ue={dirty:!0,profile:m.profile},ce={},le=[],he={},de={};g("dither",3024),g("blend.enable",3042),b("blend.color","blendColor",[0,0,0,0]),b("blend.equation","blendEquationSeparate",[32774,32774]),b("blend.func","blendFuncSeparate",[1,0,1,0]),g("depth.enable",2929,!0),b("depth.func","depthFunc",513),b("depth.range","depthRange",[0,1]),
b("depth.mask","depthMask",!0),b("colorMask","colorMask",[!0,!0,!0,!0]),g("cull.enable",2884),b("cull.face","cullFace",1029),b("frontFace","frontFace",2305),b("lineWidth","lineWidth",1),g("polygonOffset.enable",32823),b("polygonOffset.offset","polygonOffset",[0,0]),g("sample.alpha",32926),g("sample.enable",32928),b("sample.coverage","sampleCoverage",[1,!1]),g("stencil.enable",2960),b("stencil.mask","stencilMask",-1),b("stencil.func","stencilFunc",[519,0,-1]),b("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),b("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),g("scissor.enable",3089),b("scissor.box","scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),b("viewport","viewport",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var pe={gl:e,context:d,strings:t,next:ce,current:ue,draw:h,elements:o,buffer:i,shader:f,attributes:c.state,uniforms:u,framebuffer:s,extensions:n,timer:p,isBufferArgs:N},me={primTypes:fe,compareFuncs:ke,blendFuncs:Me,blendEquations:ie,stencilOps:Se,glTypes:oe,orientationType:Ce};se&&(me.backBuffer=[1029],me.drawBuffer=l(r.maxDrawbuffers,function(e){return 0===e?[0]:l(e,function(e){return 36064+e})}));var ve=0;return{next:ce,current:ue,procs:function(){var t=_(),n=t.proc("poll"),i=t.proc("refresh"),o=t.block();n(o),i(o);var a=t.shared,s=a.gl,u=a.next,c=a.current;o(c,".dirty=false;"),L(t,n),L(t,i,null,!0);var f,h=e.getExtension("angle_instanced_arrays");h&&(f=t.link(h));for(var d=0;d<r.maxAttributes;++d){var p=i.def(a.attributes,"[",d,"]"),m=t.cond(p,".buffer");m.then(s,".enableVertexAttribArray(",d,");",s,".bindBuffer(",34962,",",p,".buffer.buffer);",s,".vertexAttribPointer(",d,",",p,".size,",p,".type,",p,".normalized,",p,".stride,",p,".offset);").else(s,".disableVertexAttribArray(",d,");",s,".vertexAttrib4f(",d,",",p,".x,",p,".y,",p,".z,",p,".w);",p,".buffer=null;"),i(m),h&&i(f,".vertexAttribDivisorANGLE(",d,",",p,".divisor);")}return Object.keys(he).forEach(function(e){var r=he[e],a=o.def(u,".",e),f=t.block();f("if(",a,"){",s,".enable(",r,")}else{",s,".disable(",r,")}",c,".",e,"=",a,";"),i(f),n("if(",a,"!==",c,".",e,"){",f,"}")}),Object.keys(de).forEach(function(e){var r,a,f=de[e],h=ue[e],d=t.block();d(s,".",f,"("),A(h)?(f=h.length,r=t.global.def(u,".",e),a=t.global.def(c,".",e),d(l(f,function(e){return r+"["+e+"]"}),");",l(f,function(e){return a+"["+e+"]="+r+"["+e+"];"}).join("")),n("if(",l(f,function(e){return r+"["+e+"]!=="+a+"["+e+"]"}).join("||"),"){",d,"}")):(r=o.def(u,".",e),a=o.def(c,".",e),d(r,");",c,".",e,"=",r,";"),n("if(",r,"!==",a,"){",d,"}")),i(d)}),t.compile()}(),compile:function(e,t,n,r,i){var o=_();return o.stats=o.link(i),Object.keys(t.static).forEach(function(e){ne(o,t,e)}),Ee.forEach(function(t){ne(o,e,t)}),n=D(e,t,n,r,o),Y(o,n),ee(o,n),$(o,n),o.compile()}}}function W(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var X=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},K=0,Q={DynamicVariable:e,define:function(t,r){return new e(t,n(r+""))},isDynamic:function(t){return"function"==typeof t&&!t._reglType||t instanceof e},unbox:function(t,n){return"function"==typeof t?new e(0,t):t},accessor:n},Y={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},J="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},Z=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(34047));var r=1,i=1;return t.webgl_draw_buffers&&(r=e.getParameter(34852),i=e.getParameter(36063)),{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938)}},$=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},ee=function(e){return Object.keys(e).map(function(t){return e[t]})},te=l(8,function(){return[]}),ne={alloc:d,free:p,allocType:function(e,t){var n=null;switch(e){case 5120:n=new Int8Array(d(t),0,t);break;case 5121:n=new Uint8Array(d(t),0,t);break;case 5122:n=new Int16Array(d(2*t),0,t);break;case 5123:n=new Uint16Array(d(2*t),0,t);break;case 5124:n=new Int32Array(d(4*t),0,t);break;case 5125:n=new Uint32Array(d(4*t),0,t);break;case 5126:n=new Float32Array(d(4*t),0,t);break;default:return null}return n.length!==t?n.subarray(0,t):n},freeType:function(e){p(e.buffer)}},re={shape:function(e){for(var t=[];e.length;e=e[0])t.push(e.length);return t},flatten:function(e,t,n,r){var i=1;if(t.length)for(var o=0;o<t.length;++o)i*=t[o];else i=0;switch(n=r||ne.allocType(n,i),t.length){case 0:break;case 1:for(r=t[0],t=0;t<r;++t)n[t]=e[t];break;case 2:for(r=t[0],t=t[1],o=i=0;o<r;++o)for(var a=e[o],s=0;s<t;++s)n[i++]=a[s];break;case 3:m(e,t[0],t[1],t[2],n,0);break;default:v(e,t,0,n,0)}return n}},ie={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},oe={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ae={dynamic:35048,stream:35040,static:35044},se=re.flatten,ue=re.shape,ce=[];ce[5120]=1,ce[5122]=2,ce[5124]=4,ce[5121]=1,ce[5123]=2,ce[5125]=4,ce[5126]=4;var fe={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},le=new Float32Array(1),he=new Uint32Array(le.buffer),de=[9984,9986,9985,9987],pe=[0,6409,6410,6407,6408],me={};me[6409]=me[6406]=me[6402]=1,me[34041]=me[6410]=2,me[6407]=me[35904]=3,me[6408]=me[35906]=4;var ve=Object.keys(ie).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),ge=[];ge[5121]=1,ge[5126]=4,ge[36193]=2,ge[5123]=2,ge[5125]=4;var be=[];be[32854]=2,be[32855]=2,be[36194]=2,be[34041]=4,be[33776]=.5,be[33777]=.5,be[33778]=1,be[33779]=1,be[35986]=.5,be[35987]=1,be[34798]=1,be[35840]=.5,be[35841]=.25,be[35842]=.5,be[35843]=.25,be[36196]=.5;var _e=[];_e[32854]=2,_e[32855]=2,_e[36194]=2,_e[33189]=2,_e[36168]=1,_e[34041]=4,_e[35907]=4,_e[34836]=16,_e[34842]=8,_e[34843]=6;var ye=function(e,t,n,r,i){function o(e){this.id=c++,this.refCount=1,this.renderbuffer=e,this.format=32854,this.height=this.width=0,i.profile&&(this.stats={size:0})}function a(t){var n=t.renderbuffer;e.bindRenderbuffer(36161,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete f[t.id],r.renderbufferCount--}var s={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(s.srgba=35907),t.ext_color_buffer_half_float&&(s.rgba16f=34842,s.rgb16f=34843),t.webgl_color_buffer_float&&(s.rgba32f=34836);var u=[];Object.keys(s).forEach(function(e){u[s[e]]=e});var c=0,f={};return o.prototype.decRef=function(){0>=--this.refCount&&a(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var e=0;return Object.keys(f).forEach(function(t){e+=f[t].stats.size}),e}),{create:function(t,n){function a(t,n){var r=0,o=0,f=32854;if("object"==typeof t&&t?("shape"in t?(o=t.shape,r=0|o[0],o=0|o[1]):("radius"in t&&(r=o=0|t.radius),"width"in t&&(r=0|t.width),"height"in t&&(o=0|t.height)),"format"in t&&(f=s[t.format])):"number"==typeof t?(r=0|t,o="number"==typeof n?0|n:r):t||(r=o=1),r!==c.width||o!==c.height||f!==c.format)return a.width=c.width=r,a.height=c.height=o,c.format=f,e.bindRenderbuffer(36161,c.renderbuffer),e.renderbufferStorage(36161,f,r,o),i.profile&&(c.stats.size=_e[c.format]*c.width*c.height),a.format=u[c.format],a}var c=new o(e.createRenderbuffer());return f[c.id]=c,r.renderbufferCount++,a(t,n),a.resize=function(t,n){var r=0|t,o=0|n||r;return r===c.width&&o===c.height?a:(a.width=c.width=r,a.height=c.height=o,e.bindRenderbuffer(36161,c.renderbuffer),e.renderbufferStorage(36161,c.format,r,o),i.profile&&(c.stats.size=_e[c.format]*c.width*c.height),a)},a._reglType="renderbuffer",a._renderbuffer=c,i.profile&&(a.stats=c.stats),a.destroy=function(){c.decRef()},a},clear:function(){ee(f).forEach(a)},restore:function(){ee(f).forEach(function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,t.renderbuffer),e.renderbufferStorage(36161,t.format,t.width,t.height)}),e.bindRenderbuffer(36161,null)}}},xe=[];xe[6408]=4;var we=[];we[5121]=1,we[5126]=4,we[36193]=2;var Ae=["x","y","z","w"],Ee="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Me={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ke={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Se={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ce={cw:2304,ccw:2305},Te=new H(!1,!1,!1,function(){}),De=function(e,t){function n(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function r(e,t,r){var i=s.pop()||new n;i.startQueryIndex=e,i.endQueryIndex=t,i.sum=0,i.stats=r,u.push(i)}var i=t.ext_disjoint_timer_query;if(!i)return null;var o=[],a=[],s=[],u=[],c=[],f=[];return{beginQuery:function(e){var t=o.pop()||i.createQueryEXT();i.beginQueryEXT(35007,t),a.push(t),r(a.length-1,a.length,e)},endQuery:function(){i.endQueryEXT(35007)},pushScopeStats:r,update:function(){var e,t;if(0!==(e=a.length)){f.length=Math.max(f.length,e+1),c.length=Math.max(c.length,e+1),c[0]=0;var n=f[0]=0;for(t=e=0;t<a.length;++t){var r=a[t];i.getQueryObjectEXT(r,34919)?(n+=i.getQueryObjectEXT(r,34918),o.push(r)):a[e++]=r,c[t+1]=n,f[t+1]=e}for(a.length=e,t=e=0;t<u.length;++t){var n=u[t],l=n.startQueryIndex,r=n.endQueryIndex;n.sum+=c[r]-c[l],l=f[l],r=f[r],r===l?(n.stats.gpuTime+=n.sum/1e6,s.push(n)):(n.startQueryIndex=l,n.endQueryIndex=r,u[e++]=n)}u.length=e}},getNumPendingQueries:function(){return a.length},clear:function(){o.push.apply(o,a);for(var e=0;e<o.length;e++)i.deleteQueryEXT(o[e]);a.length=0,o.length=0},restore:function(){a.length=0,o.length=0}}};return function(e){function t(){if(0===q.length)E&&E.update(),te=null;else{te=Y.next(t),d();for(var e=q.length-1;0<=e;--e){var n=q[e];n&&n(C,null,0)}v.flush(),E&&E.update()}}function n(){!te&&0<q.length&&(te=Y.next(t))}function i(){te&&(Y.cancel(t),te=null)}function o(e){e.preventDefault(),i(),K.forEach(function(e){e()})}function a(e){v.getError(),b.restore(),F.restore(),L.restore(),I.restore(),N.restore(),P.restore(),E&&E.restore(),H.procs.refresh(),n(),$.forEach(function(e){e()})}function s(e){function t(e){var t={},n={};return Object.keys(e).forEach(function(r){var i=e[r];Q.isDynamic(i)?n[r]=Q.unbox(i,r):t[r]=i}),{dynamic:n,static:t}}function n(e){for(;f.length<e;)f.push(null);return f}var r=t(e.context||{}),i=t(e.uniforms||{}),o=t(e.attributes||{}),a=t(function(e){function t(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach(function(r){n[e+"."+r]=t[r]})}}var n=X({},e);return delete n.uniforms,delete n.attributes,delete n.context,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),t("blend"),t("depth"),t("cull"),t("stencil"),t("polygonOffset"),t("scissor"),t("sample"),n}(e));e={gpuTime:0,cpuTime:0,count:0};var r=H.compile(a,o,i,r,e),s=r.draw,u=r.batch,c=r.scope,f=[];return X(function(e,t){var r;if("function"==typeof e)return c.call(this,null,e,0);if("function"==typeof t)if("number"==typeof e)for(r=0;r<e;++r)c.call(this,null,t,r);else{if(!Array.isArray(e))return c.call(this,e,t,0);for(r=0;r<e.length;++r)c.call(this,e[r],t,r)}else if("number"==typeof e){if(0<e)return u.call(this,n(0|e),0|e)}else{if(!Array.isArray(e))return s.call(this,e);if(e.length)return u.call(this,e,e.length)}},{stats:e})}function f(e,t){var n=0;H.procs.poll();var r=t.color;r&&(v.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=16384),"depth"in t&&(v.clearDepth(+t.depth),n|=256),"stencil"in t&&(v.clearStencil(0|t.stencil),n|=1024),v.clear(n)}function l(e){return q.push(e),n(),{cancel:function(){function t(){var e=W(q,t);q[e]=q[q.length-1],0>=--q.length&&i()}var n=W(q,e);q[n]=t}}}function h(){var e=U.viewport,t=U.scissor_box;e[0]=e[1]=t[0]=t[1]=0,C.viewportWidth=C.framebufferWidth=C.drawingBufferWidth=e[2]=t[2]=v.drawingBufferWidth,C.viewportHeight=C.framebufferHeight=C.drawingBufferHeight=e[3]=t[3]=v.drawingBufferHeight}function d(){C.tick+=1,C.time=m(),h(),H.procs.poll()}function p(){h(),H.procs.refresh(),E&&E.update()}function m(){return(J()-M)/1e3}if(!(e=u(e)))return null;var v=e.gl,g=v.getContextAttributes();v.isContextLost();var b=c(v,e);if(!b)return null;var _=r(),w={bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},A=b.extensions,E=De(0,A),M=J(),k=v.drawingBufferWidth,S=v.drawingBufferHeight,C={tick:0,time:0,viewportWidth:k,viewportHeight:S,framebufferWidth:k,framebufferHeight:S,drawingBufferWidth:k,drawingBufferHeight:S,pixelRatio:e.pixelRatio},T=Z(v,A),L=y(v,w,e),R=x(v,A,L,w),k=z(v,A,T,L,_),F=j(v,_,w,e),I=D(v,A,T,function(){H.procs.poll()},C,w,e),N=ye(v,A,0,w,e),P=O(v,A,T,I,N,w),H=G(v,_,A,T,L,R,I,P,{},k,F,{elements:null,primitive:4,count:-1,offset:0,instances:-1},C,E,e),_=B(v,P,H.procs.poll,C,g,A),U=H.next,V=v.canvas,q=[],K=[],$=[],ee=[e.onDestroy],te=null;V&&(V.addEventListener("webglcontextlost",o,!1),V.addEventListener("webglcontextrestored",a,!1));var ne=P.setFBO=s({framebuffer:Q.define.call(null,1,"framebuffer")});return p(),g=X(s,{clear:function(e){if("framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;6>t;++t)ne(X({framebuffer:e.framebuffer.faces[t]},e),f);else ne(e,f);else f(null,e)},prop:Q.define.bind(null,1),context:Q.define.bind(null,2),this:Q.define.bind(null,3),draw:s({}),buffer:function(e){return L.create(e,34962,!1,!1)},elements:function(e){return R.create(e,!1)},texture:I.create2D,cube:I.createCube,renderbuffer:N.create,framebuffer:P.create,framebufferCube:P.createCube,attributes:g,frame:l,on:function(e,t){var n;switch(e){case"frame":return l(t);case"lost":n=K;break;case"restore":n=$;break;case"destroy":n=ee}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t){n[e]=n[n.length-1],n.pop();break}}}},limits:T,hasExtension:function(e){return 0<=T.extensions.indexOf(e.toLowerCase())},read:_,destroy:function(){q.length=0,i(),V&&(V.removeEventListener("webglcontextlost",o),V.removeEventListener("webglcontextrestored",a)),F.clear(),P.clear(),N.clear(),I.clear(),R.clear(),L.clear(),E&&E.clear(),ee.forEach(function(e){e()})},_gl:v,_refresh:p,poll:function(){d(),E&&E.update()},now:m,stats:w}),e.onDone(null,g),g}})},{}],109:[function(e,t,n){(function(e){t.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],110:[function(e,t,n){!function(){"use strict";function e(e){var t;t="function"==typeof e?e:e?i(e):Math.random,this.p=r(t),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(var n=0;n<512;n++)this.perm[n]=this.p[255&n],this.permMod12[n]=this.perm[n]%12}function r(e){var t,n=new Uint8Array(256);for(t=0;t<256;t++)n[t]=t;for(t=0;t<255;t++){var r=t+~~(e()*(256-t)),i=n[t];n[t]=n[r],n[r]=i}return n}function i(){var e=0,t=0,n=0,r=1,i=o();e=i(" "),t=i(" "),n=i(" ");for(var a=0;a<arguments.length;a++)e-=i(arguments[a]),e<0&&(e+=1),t-=i(arguments[a]),t<0&&(t+=1),(n-=i(arguments[a]))<0&&(n+=1);return i=null,function(){var i=2091639*e+2.3283064365386963e-10*r;return e=t,t=n,n=i-(r=0|i)}}function o(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){e+=t.charCodeAt(n);var r=.02519603282416938*e;e=r>>>0,r-=e,r*=e,e=r>>>0,r-=e,e+=4294967296*r}return 2.3283064365386963e-10*(e>>>0)}}var a=.5*(Math.sqrt(3)-1),s=(3-Math.sqrt(3))/6,u=1/6,c=(Math.sqrt(5)-1)/4,f=(5-Math.sqrt(5))/20;e.prototype={grad3:new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),grad4:new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]),noise2D:function(e,t){var n,r,i=this.permMod12,o=this.perm,u=this.grad3,c=0,f=0,l=0,h=(e+t)*a,d=Math.floor(e+h),p=Math.floor(t+h),m=(d+p)*s,v=d-m,g=p-m,b=e-v,_=t-g;b>_?(n=1,r=0):(n=0,r=1);var y=b-n+s,x=_-r+s,w=b-1+2*s,A=_-1+2*s,E=255&d,M=255&p,k=.5-b*b-_*_;if(k>=0){var S=3*i[E+o[M]];k*=k,c=k*k*(u[S]*b+u[S+1]*_)}var C=.5-y*y-x*x;if(C>=0){var T=3*i[E+n+o[M+r]];C*=C,f=C*C*(u[T]*y+u[T+1]*x)}var D=.5-w*w-A*A;if(D>=0){var O=3*i[E+1+o[M+1]];D*=D,l=D*D*(u[O]*w+u[O+1]*A)}return 70*(c+f+l)},noise3D:function(e,t,n){var r,i,o,a,s,c,f,l,h,d,p=this.permMod12,m=this.perm,v=this.grad3,g=(e+t+n)*(1/3),b=Math.floor(e+g),_=Math.floor(t+g),y=Math.floor(n+g),x=(b+_+y)*u,w=b-x,A=_-x,E=y-x,M=e-w,k=t-A,S=n-E;M>=k?k>=S?(s=1,c=0,f=0,l=1,h=1,d=0):M>=S?(s=1,c=0,f=0,l=1,h=0,d=1):(s=0,c=0,f=1,l=1,h=0,d=1):k<S?(s=0,c=0,f=1,l=0,h=1,d=1):M<S?(s=0,c=1,f=0,l=0,h=1,d=1):(s=0,c=1,f=0,l=1,h=1,d=0);var C=M-s+u,T=k-c+u,D=S-f+u,O=M-l+2*u,L=k-h+2*u,z=S-d+2*u,j=M-1+.5,B=k-1+.5,R=S-1+.5,F=255&b,I=255&_,N=255&y,P=.6-M*M-k*k-S*S;if(P<0)r=0;else{var H=3*p[F+m[I+m[N]]];P*=P,r=P*P*(v[H]*M+v[H+1]*k+v[H+2]*S)}var U=.6-C*C-T*T-D*D;if(U<0)i=0;else{var V=3*p[F+s+m[I+c+m[N+f]]];U*=U,i=U*U*(v[V]*C+v[V+1]*T+v[V+2]*D)}var q=.6-O*O-L*L-z*z;if(q<0)o=0;else{var G=3*p[F+l+m[I+h+m[N+d]]];q*=q,o=q*q*(v[G]*O+v[G+1]*L+v[G+2]*z)}var W=.6-j*j-B*B-R*R;if(W<0)a=0;else{var X=3*p[F+1+m[I+1+m[N+1]]];W*=W,a=W*W*(v[X]*j+v[X+1]*B+v[X+2]*R)}return 32*(r+i+o+a)},noise4D:function(e,t,n,r){var i,o,a,s,u,l=this.perm,h=this.grad4,d=(e+t+n+r)*c,p=Math.floor(e+d),m=Math.floor(t+d),v=Math.floor(n+d),g=Math.floor(r+d),b=(p+m+v+g)*f,_=p-b,y=m-b,x=v-b,w=g-b,A=e-_,E=t-y,M=n-x,k=r-w,S=0,C=0,T=0,D=0;A>E?S++:C++,A>M?S++:T++,A>k?S++:D++,E>M?C++:T++,E>k?C++:D++,M>k?T++:D++;var O,L,z,j,B,R,F,I,N,P,H,U;O=S>=3?1:0,L=C>=3?1:0,z=T>=3?1:0,j=D>=3?1:0,B=S>=2?1:0,R=C>=2?1:0,F=T>=2?1:0,I=D>=2?1:0,N=S>=1?1:0,P=C>=1?1:0,H=T>=1?1:0,U=D>=1?1:0;var V=A-O+f,q=E-L+f,G=M-z+f,W=k-j+f,X=A-B+2*f,K=E-R+2*f,Q=M-F+2*f,Y=k-I+2*f,J=A-N+3*f,Z=E-P+3*f,$=M-H+3*f,ee=k-U+3*f,te=A-1+4*f,ne=E-1+4*f,re=M-1+4*f,ie=k-1+4*f,oe=255&p,ae=255&m,se=255&v,ue=255&g,ce=.6-A*A-E*E-M*M-k*k;if(ce<0)i=0;else{var fe=l[oe+l[ae+l[se+l[ue]]]]%32*4;ce*=ce,i=ce*ce*(h[fe]*A+h[fe+1]*E+h[fe+2]*M+h[fe+3]*k)}var le=.6-V*V-q*q-G*G-W*W;if(le<0)o=0;else{var he=l[oe+O+l[ae+L+l[se+z+l[ue+j]]]]%32*4;le*=le,o=le*le*(h[he]*V+h[he+1]*q+h[he+2]*G+h[he+3]*W)}var de=.6-X*X-K*K-Q*Q-Y*Y;if(de<0)a=0;else{var pe=l[oe+B+l[ae+R+l[se+F+l[ue+I]]]]%32*4;de*=de,a=de*de*(h[pe]*X+h[pe+1]*K+h[pe+2]*Q+h[pe+3]*Y)}var me=.6-J*J-Z*Z-$*$-ee*ee;if(me<0)s=0;else{var ve=l[oe+N+l[ae+P+l[se+H+l[ue+U]]]]%32*4;me*=me,s=me*me*(h[ve]*J+h[ve+1]*Z+h[ve+2]*$+h[ve+3]*ee)}var ge=.6-te*te-ne*ne-re*re-ie*ie;if(ge<0)u=0;else{var be=l[oe+1+l[ae+1+l[se+1+l[ue+1]]]]%32*4;ge*=ge,u=ge*ge*(h[be]*te+h[be+1]*ne+h[be+2]*re+h[be+3]*ie)}return 27*(i+o+a+s+u)}},e._buildPermutationTable=r,"undefined"!=typeof define&&define.amd&&define(function(){return e}),void 0!==n?n.SimplexNoise=e:"undefined"!=typeof window&&(window.SimplexNoise=e),void 0!==t&&(t.exports=e)}()},{}],111:[function(e,t,n){"use strict";function r(e,t){var n=a(getComputedStyle(e).getPropertyValue(t));return n[0]*o(n[1],e)}function i(e,t){var n=document.createElement("div");n.style["font-size"]="128"+e,t.appendChild(n);var i=r(n,"font-size")/128;return t.removeChild(n),i}function o(e,t){switch(t=t||document.body,e=(e||"px").trim().toLowerCase(),t!==window&&t!==document||(t=document.body),e){case"%":return t.clientHeight/100;case"ch":case"ex":return i(e,t);case"em":return r(t,"font-size");case"rem":return r(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return s;case"cm":return s/2.54;case"mm":return s/25.4;case"pt":return s/72;case"pc":return s/6}return 1}var a=e(106);t.exports=o;var s=96},{106:106}],112:[function(e,t,n){"use strict";function r(e,t,n){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(n,2))}function i(e){return Math.min(1,Math.max(-1,e))}function o(e){var t=Math.abs(e[0]),n=Math.abs(e[1]),r=Math.abs(e[2]),i=[0,0,0];t>Math.max(n,r)?i[2]=1:n>Math.max(t,r)?i[0]=1:i[1]=1;for(var o=0,a=0,s=0;s<3;++s)o+=e[s]*e[s],a+=i[s]*e[s];for(var s=0;s<3;++s)i[s]-=a/o*e[s];return h(i,i),i}function a(e,t,n,r,i,o,a,s){this.center=u(n),this.up=u(r),this.right=u(i),this.radius=u([o]),this.angle=u([a,s]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(e,t),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var c=0;c<16;++c)this.computedMatrix[c]=.5;this.recalcMatrix(0)}function s(e){e=e||{};var t=e.center||[0,0,0],n=e.up||[0,1,0],i=e.right||o(n),s=e.radius||1,u=e.theta||0,c=e.phi||0;if(t=[].slice.call(t,0,3),n=[].slice.call(n,0,3),h(n,n),i=[].slice.call(i,0,3),h(i,i),"eye"in e){var f=e.eye,p=[f[0]-t[0],f[1]-t[1],f[2]-t[2]];l(i,p,n),r(i[0],i[1],i[2])<1e-6?i=o(n):h(i,i),s=r(p[0],p[1],p[2]);var m=d(n,p)/s,v=d(i,p)/s;c=Math.acos(m),u=Math.acos(v)}return s=Math.log(s),new a(e.zoomMin,e.zoomMax,t,n,i,s,u,c)}t.exports=s;var u=e(12),c=e(29),f=e(35),l=e(88),h=e(92),d=e(89),p=a.prototype;p.setDistanceLimits=function(e,t){e=e>0?Math.log(e):-1/0,t=t>0?Math.log(t):1/0,t=Math.max(t,e),this.radius.bounds[0][0]=e,this.radius.bounds[1][0]=t},p.getDistanceLimits=function(e){var t=this.radius.bounds[0];return e?(e[0]=Math.exp(t[0][0]),e[1]=Math.exp(t[1][0]),e):[Math.exp(t[0][0]),Math.exp(t[1][0])]},p.recalcMatrix=function(e){this.center.curve(e),this.up.curve(e),this.right.curve(e),this.radius.curve(e),this.angle.curve(e);for(var t=this.computedUp,n=this.computedRight,i=0,o=0,a=0;a<3;++a)o+=t[a]*n[a],i+=t[a]*t[a];for(var s=Math.sqrt(i),u=0,a=0;a<3;++a)n[a]-=t[a]*o/i,u+=n[a]*n[a],t[a]/=s;for(var c=Math.sqrt(u),a=0;a<3;++a)n[a]/=c;var f=this.computedToward;l(f,t,n),h(f,f);for(var d=Math.exp(this.computedRadius[0]),p=this.computedAngle[0],m=this.computedAngle[1],v=Math.cos(p),g=Math.sin(p),b=Math.cos(m),_=Math.sin(m),y=this.computedCenter,x=v*b,w=g*b,A=_,E=-v*_,M=-g*_,k=b,S=this.computedEye,C=this.computedMatrix,a=0;a<3;++a){var T=x*n[a]+w*f[a]+A*t[a];C[4*a+1]=E*n[a]+M*f[a]+k*t[a],C[4*a+2]=T,C[4*a+3]=0}var D=C[1],O=C[5],L=C[9],z=C[2],j=C[6],B=C[10],R=O*B-L*j,F=L*z-D*B,I=D*j-O*z,N=r(R,F,I);R/=N,F/=N,I/=N,C[0]=R,C[4]=F,C[8]=I;for(var a=0;a<3;++a)S[a]=y[a]+C[2+4*a]*d;for(var a=0;a<3;++a){for(var u=0,P=0;P<3;++P)u+=C[a+4*P]*S[P];C[12+a]=-u}C[15]=1},p.getMatrix=function(e,t){this.recalcMatrix(e);var n=this.computedMatrix;if(t){for(var r=0;r<16;++r)t[r]=n[r];return t}return n};var m=[0,0,0];p.rotate=function(e,t,n,r){if(this.angle.move(e,t,n),r){this.recalcMatrix(e);var i=this.computedMatrix;m[0]=i[2],m[1]=i[6],m[2]=i[10];for(var o=this.computedUp,a=this.computedRight,s=this.computedToward,u=0;u<3;++u)i[4*u]=o[u],i[4*u+1]=a[u],i[4*u+2]=s[u];f(i,i,r,m);for(var u=0;u<3;++u)o[u]=i[4*u],a[u]=i[4*u+1];this.up.set(e,o[0],o[1],o[2]),this.right.set(e,a[0],a[1],a[2])}},p.pan=function(e,t,n,i){t=t||0,n=n||0,i=i||0,this.recalcMatrix(e);var o=this.computedMatrix,a=(Math.exp(this.computedRadius[0]),o[1]),s=o[5],u=o[9],c=r(a,s,u);a/=c,s/=c,u/=c;var f=o[0],l=o[4],h=o[8],d=f*a+l*s+h*u;f-=a*d,l-=s*d,h-=u*d;var p=r(f,l,h);f/=p,l/=p,h/=p;var m=f*t+a*n,v=l*t+s*n,g=h*t+u*n;this.center.move(e,m,v,g);var b=Math.exp(this.computedRadius[0]);b=Math.max(1e-4,b+i),this.radius.set(e,Math.log(b))},p.translate=function(e,t,n,r){this.center.move(e,t||0,n||0,r||0)},p.setMatrix=function(e,t,n,o){var a=1;"number"==typeof n&&(a=0|n),(a<0||a>3)&&(a=1);var s=(a+2)%3;t||(this.recalcMatrix(e),t=this.computedMatrix);var u=t[a],f=t[a+4],l=t[a+8];if(o){var h=Math.abs(u),d=Math.abs(f),p=Math.abs(l),m=Math.max(h,d,p);h===m?(u=u<0?-1:1,f=l=0):p===m?(l=l<0?-1:1,u=f=0):(f=f<0?-1:1,u=l=0)}else{var v=r(u,f,l);u/=v,f/=v,l/=v}var g=t[s],b=t[s+4],_=t[s+8],y=g*u+b*f+_*l;g-=u*y,b-=f*y,_-=l*y;var x=r(g,b,_);g/=x,b/=x,_/=x;var w=f*_-l*b,A=l*g-u*_,E=u*b-f*g,M=r(w,A,E);w/=M,A/=M,E/=M,this.center.jump(e,q,G,W),this.radius.idle(e),this.up.jump(e,u,f,l),this.right.jump(e,g,b,_);var k,S;if(2===a){var C=t[1],T=t[5],D=t[9],O=C*g+T*b+D*_,L=C*w+T*A+D*E;k=R<0?-Math.PI/2:Math.PI/2,S=Math.atan2(L,O)}else{var z=t[2],j=t[6],B=t[10],R=z*u+j*f+B*l,F=z*g+j*b+B*_,I=z*w+j*A+B*E;k=Math.asin(i(R)),S=Math.atan2(I,F)}this.angle.jump(e,S,k),this.recalcMatrix(e);var N=t[2],P=t[6],H=t[10],U=this.computedMatrix;c(U,t);var V=U[15],q=U[12]/V,G=U[13]/V,W=U[14]/V,X=Math.exp(this.computedRadius[0]);this.center.jump(e,q-N*X,G-P*X,W-H*X)},p.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},p.idle=function(e){this.center.idle(e),this.up.idle(e),this.right.idle(e),this.radius.idle(e),this.angle.idle(e)},p.flush=function(e){this.center.flush(e),this.up.flush(e),this.right.flush(e),this.radius.flush(e),this.angle.flush(e)},p.setDistance=function(e,t){t>0&&this.radius.set(e,Math.log(t))},p.lookAt=function(e,t,n,o){this.recalcMatrix(e),t=t||this.computedEye,n=n||this.computedCenter,o=o||this.computedUp;var a=o[0],s=o[1],u=o[2],c=r(a,s,u);if(!(c<1e-6)){a/=c,s/=c,u/=c;var f=t[0]-n[0],l=t[1]-n[1],h=t[2]-n[2],d=r(f,l,h);if(!(d<1e-6)){f/=d,l/=d,h/=d;var p=this.computedRight,m=p[0],v=p[1],g=p[2],b=a*m+s*v+u*g;m-=b*a,v-=b*s,g-=b*u;var _=r(m,v,g);if(!(_<.01&&(m=s*h-u*l,v=u*f-a*h,g=a*l-s*f,(_=r(m,v,g))<1e-6))){m/=_,v/=_,g/=_,this.up.set(e,a,s,u),this.right.set(e,m,v,g),this.center.set(e,n[0],n[1],n[2]),this.radius.set(e,Math.log(d));var y=s*g-u*v,x=u*m-a*g,w=a*v-s*m,A=r(y,x,w);y/=A,x/=A,w/=A;var E=a*f+s*l+u*h,M=m*f+v*l+g*h,k=y*f+x*l+w*h,S=Math.asin(i(E)),C=Math.atan2(k,M),T=this.angle._state,D=T[T.length-1],O=T[T.length-2];D%=2*Math.PI;var L=Math.abs(D+2*Math.PI-C),z=Math.abs(D-C),j=Math.abs(D-2*Math.PI-C);L<z&&(D+=2*Math.PI),j<z&&(D-=2*Math.PI),this.angle.jump(this.angle.lastT(),D,O),this.angle.set(e,C,S)}}}}},{12:12,29:29,35:35,88:88,89:89,92:92}],113:[function(e,t,n){"use strict";function r(){for(var e=new a(_.seed),t=new s(e),n=[],r=Math.ceil(Math.sqrt(_.points)),o=r;o--;)for(var u=r;u--;)n.push([o/r*2-1,u/r*2-1]);for(var c=new f(n),l=[],h=0;h<c.triangles.length;h+=3){var d=n[c.triangles[h]],m=n[c.triangles[h+1]],v=n[c.triangles[h+2]];if(!(p.distance(d,m)>_.maxTileSideLen||p.distance(m,v)>_.maxTileSideLen||p.distance(v,d)>_.maxTileSideLen)){var g=[Math.min(d[0],m[0],v[0]),Math.min(d[1],m[1],v[1])],w=t.noise2D(g[0],g[1])/5;e()<.4||l.push([[d[0],d[1],w],[m[0],m[1],w],[v[0],v[1],w]])}}x=i(b,l,_);for(var A={tileIndex:[],pointIndex:[],order:[]},E=0;E<l.length;E++)A.tileIndex.push(E,E,E),A.order.push(0,1,2),A.pointIndex.push(0,1,2,2,0,1,1,2,0),A.tileIndex.push(E,E,E),A.order.push(0,1,2),A.pointIndex.push(0,5,3,3,0,5,5,3,0),A.tileIndex.push(E,E,E),A.order.push(0,1,2),A.pointIndex.push(0,2,5,5,0,2,2,5,0),A.tileIndex.push(E,E,E),A.order.push(0,1,2),A.pointIndex.push(2,4,5,5,2,4,4,5,2),A.tileIndex.push(E,E,E),A.order.push(0,1,2),A.pointIndex.push(2,1,4,4,2,1,1,4,2),A.tileIndex.push(E,E,E),A.order.push(0,1,2),A.pointIndex.push(1,3,4,4,1,3,3,4,1),A.tileIndex.push(E,E,E),A.order.push(0,1,2),A.pointIndex.push(1,0,3,3,1,0,0,3,1);y=b({
vert:"\n    attribute float tileIndex;\n    attribute vec3 pointIndex;\n    attribute float order;\n\n    varying vec4 fragColor;\n    varying vec3 barycentricCoords;\n\n    uniform mat4 projection;\n    uniform mat4 view;\n    uniform vec3 lightSource;\n    uniform float tick;\n    uniform float textureSize;\n    uniform sampler2D tileState;\n\n    vec3 getNormal(vec3 pt1, vec3 pt2, vec3 pt3) {\n      vec3 normal = cross(pt1 - pt2, pt2 - pt3);\n      return normalize(normal);\n    }\n\n    vec3 calculatePosition(vec3 position, bool isBase) {\n      float z;\n      if (isBase) {\n        z = 0.0;\n      } else {\n        z = clamp(position.z, 0.0, 1.0);\n        // z = sin(position.z * 10.0 + tick / 200.0) * 0.1 + 0.02;\n        // z = clamp(z, 0.0, 1.0);\n      }\n      return vec3(position.xy, z);\n    }\n\n    // should prob use ints in here?\n    vec3 getPositionFromTexture (float tileNumber, float pointNumber) {\n      float index = tileNumber * 3.0 + mod(pointNumber, 3.0);\n      float xLookup = mod(index, textureSize);\n      float yLookup = floor(index / textureSize);\n      vec2 lookup = vec2(\n        xLookup / textureSize,\n        yLookup / textureSize\n      );\n      vec4 point = texture2D(tileState, lookup);\n      return point.xyz;\n    }\n\n    void main() {\n      vec3 position = getPositionFromTexture(tileIndex, pointIndex.x);\n      vec3 adjacentPositionA = getPositionFromTexture(tileIndex, pointIndex.y);\n      vec3 adjacentPositionB = getPositionFromTexture(tileIndex, pointIndex.z);\n\n      vec3 computedPosition = calculatePosition(position, pointIndex.x > 2.0);\n      vec3 computedAdjacentA = calculatePosition(adjacentPositionA, pointIndex.y > 2.0);\n      vec3 computedAdjacentB = calculatePosition(adjacentPositionB, pointIndex.z > 2.0);\n      // if all zs are 0, let's throw this triangle away\n      if (computedPosition.z == 0.0 && computedAdjacentA.z == 0.0 && computedAdjacentB.z == 0.0) {\n        computedPosition = vec3(0);\n      }\n\n      vec3 normal = getNormal(computedPosition, computedAdjacentA, computedAdjacentB);\n      vec3 lightDirection = normalize(lightSource - position);\n\n      // do something with the dotProduct to figure out shading\n      vec3 color = vec3(0.95, 0.95, 0.95);\n      if (abs(normal.z) < 0.0001) {\n        vec3 blue = vec3(0.67, 0.76, 0.9);\n        // vec3 green = vec3(0.52, 0.8, 0.56);\n        vec3 purple = vec3(0.55, 0.51, 0.8);\n        vec3 white = vec3(0.95);\n        float a = smoothstep(0.0, 1.0, abs(dot(vec2(0, 1), normal.xy)));\n        color = mix(purple, blue, a);\n        color = mix(color, white, computedPosition.z);\n      }\n      barycentricCoords = vec3(0, 0, 1);\n      if (order == 0.0) {\n        barycentricCoords = vec3(0, 1, 0);\n      }\n      if (order == 1.0) {\n        barycentricCoords = vec3(1, 0, 0);\n      }\n\n      // ignore sides\n      // if (computedPosition.z == 0.0 || computedAdjacentA.z == 0.0 || computedAdjacentB.z == 0.0) {\n      //   barycentricCoords = vec3(1, 1, 1);\n      // }\n\n      fragColor = vec4(color, 1.0);\n      gl_Position = projection * view * vec4(computedPosition, 1.0);\n    }\n    ",frag:"\n    precision highp float;\n\n    varying vec4 fragColor;\n    varying vec3 barycentricCoords;\n\n    uniform float wireframeSize;\n\n    void main() {\n      if (barycentricCoords.x < wireframeSize || barycentricCoords.y < wireframeSize || barycentricCoords.z < wireframeSize) {\n        vec3 gray = vec3(0.3, 0.3, 0.3);\n        gl_FragColor = fragColor;\n      } else {\n        discard;\n        // gl_FragColor = vec4(0);\n      }\n    }\n    ",attributes:A,count:A.tileIndex.length})}function i(e,t,n){function r(e){u(),x()}function i(){return b}function a(){return c}function s(t,n){console.log(t);var r=e.texture({data:t,shape:[n,n,4],type:"float"});return e.framebuffer({color:r,depth:!1,stencil:!1})}function u(){var e=g;g=b,b=_,_=e}var c=Math.ceil(Math.sqrt(3*t.length));console.log("texture size: "+c+" x "+c+" for "+t.length+" tiles");for(var f=c*c,l=new Float32Array(4*f),h=0;h<t.length;++h){var d=o(t[h],3),p=d[0],m=d[1],v=d[2];l[12*h]=p[0],l[12*h+1]=p[1],l[12*h+2]=p[2],l[12*h+3]=0,l[12*h+4]=m[0],l[12*h+5]=m[1],l[12*h+6]=m[2],l[12*h+7]=0,l[12*h+8]=v[0],l[12*h+9]=v[1],l[12*h+10]=v[2],l[12*h+11]=0}var g=s(l,c),b=s(l,c),_=s(l,c),y=.5;document.body.addEventListener("click",function(e){y=Math.random()});var x=e({framebuffer:function(){return _},vert:"\n    precision mediump float;\n\n    attribute vec2 position;\n\n    varying vec2 tileStateIndex;\n\n    void main() {\n      // map bottom left -1,-1 (normalized device coords) to 0,0 (particle texture index)\n      // and 1,1 (ndc) to 1,1 (texture)\n      tileStateIndex = 0.5 * (1.0 + position);\n      gl_Position = vec4(position, 0, 1);\n    }\n    ",frag:"\n    precision mediump float;\n\n    uniform sampler2D curTileStateTexture;\n    uniform sampler2D prevTileStateTexture;\n    // uniform sampler2D tripMetaDataTexture;\n\n    uniform float dampening;\n    uniform float stiffness;\n    uniform float height;\n\n    varying vec2 tileStateIndex;\n\n    float getNextValue(float cur, float prev, float dest, float s, float d) {\n      float velocity = clamp(0.0, 0.02, cur - prev);\n      float delta = dest - cur;\n      float spring = delta * s;\n      float damper = velocity * -1.0 * d;\n      return spring + damper + velocity + cur;\n    }\n\n    void main() {\n      vec4 curState = texture2D(curTileStateTexture, tileStateIndex);\n      vec4 prevState = texture2D(prevTileStateTexture, tileStateIndex);\n\n      // float i = cos(height * 20.0 + tileStateIndex.y * 2.0) / 5.0;\n      // float j = sin(height * 50.0 + tileStateIndex.y * 3.0) / 5.0;\n      float h = sin(height * 30.0 + tileStateIndex.y * 3.0) + 1.0;\n\n      float x = getNextValue(curState.x, prevState.x, curState.x, stiffness, dampening);\n      float y = getNextValue(curState.y, prevState.y, curState.y, stiffness, dampening);\n      float z = getNextValue(curState.z, prevState.z, h / 5.0, stiffness, dampening * pow(length(curState.xy), 1.1));\n\n      gl_FragColor = vec4(x, y, z, 0.0);\n    }\n    ",attributes:{position:[-1,-1,1,-1,-1,1,1,1]},uniforms:{curTileStateTexture:function(){return b},prevTileStateTexture:function(){return g},dampening:1,stiffness:.1,height:function(){return y}},count:4,primitive:"triangle strip"});return{tick:r,getTextureSize:a,getStateTexture:i}}var o=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e(3),s=e(110),u=e(7),c=u.GUI,f=e(10),l=e(108),h=e(5),d=e(28),p=e(61),m=e(1),v=document.createElement("canvas"),g=m(v),b=l({extensions:"OES_texture_float",canvas:v});g.zoomSpeed=4,g.lookAt([2.5,2.5,2.5],[0,0,0],[.52,-.11,50]),window.camera=g,window.addEventListener("resize",h(v),!1),document.body.appendChild(v);var _=function(e,t){var n={},r=new c;for(var i in e){n[i]=e[i][0];var o=r.add(n,i,e[i][1],e[i][2]);e[i][3]&&o.step(e[i][3]),e[i][4]&&o.onChange(t)}return n}({seed:[442,0,1e3,1,!0],points:[80,24,5e4,1,!0],minPtDistance:[.5,.01,.5,.01,!0],maxTileSideLen:[1,.001,1,.001,!0],roam:[!1]},r),y=void 0,x=void 0;r();var w=b({uniforms:{projection:function(e){var t=e.viewportWidth,n=e.viewportHeight;return d.perspective([],Math.PI/8,t/n,.01,1e3)},view:function(){return g.matrix},lightSource:[5,5,5],tick:function(e){return e.tick},tileState:function(){return x.getStateTexture()},textureSize:function(){return x.getTextureSize()},wireframeSize:function(e){e.tick;return.05}},primitive:"triangles"});b.frame(function(e){var t=e.time;b.clear({color:[.95,.95,.95,1],depth:1}),g.tick(),g.up=[g.up[0],g.up[1],999],x.tick(),_.roam&&(g.center=[2.5*Math.sin(t/4)+2.5,2.5*Math.cos(t/4)+2.5,2.5*(Math.sin(t/4)+1.5)]),w(function(){return y()})})},{1:1,10:10,108:108,110:110,28:28,3:3,5:5,61:61,7:7}]},{},[113]);