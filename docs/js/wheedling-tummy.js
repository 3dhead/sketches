!function t(e,n,r){function a(o,u){if(!n[o]){if(!e[o]){var f="function"==typeof require&&require;if(!u&&f)return f(o,!0);if(i)return i(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var l=n[o]={exports:{}};e[o][0].call(l.exports,function(t){var n=e[o][1][t];return a(n?n:t)},l,l.exports,t,e,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(t,e,n){function r(t,e,n){function r(){var e=r.parent||t.parentNode;if("function"==typeof e)var n=e(i)||i,u=n[0],f=n[1];else if(e&&e!==document.body)var s=a(e),u=0|s[0],f=0|s[1];else var u=window.innerWidth,f=window.innerHeight;return o?(t.setAttribute("width",u*r.scale+"px"),t.setAttribute("height",f*r.scale+"px")):(t.width=u*r.scale,t.height=f*r.scale),t.style.width=u+"px",t.style.height=f+"px",r}var o="SVG"===t.nodeName.toUpperCase();return t.style.position=t.style.position||"absolute",t.style.top=0,t.style.left=0,r.scale=parseFloat(n||1),r.parent=e,r()}var a=t(4);e.exports=r;var i=new Float32Array(2)},{4:4}],2:[function(t,e,n){function r(t,e){function n(){var n=f("<control>")||f("<alt>"),a=f("<shift>"),i=t.height,o=t.width;if(e.rotate&&l.left&&!n&&!a&&m.rotate([c.x/o-.5,c.y/i-.5],[c.prevX/o-.5,c.prevY/i-.5]),(e.pan&&l.right||l.left&&n&&!a)&&m.pan([s*(c.x-c.prevX)/o,s*(c.y-c.prevY)/i]),e.scale&&r[1]&&(m.distance*=Math.exp(r[1]/i)),e.scale&&(l.middle||l.left&&!n&&a)){var u=c.y-c.prevY;if(!u)return;m.distance*=Math.exp(u/i)}r.flush(),c.flush()}e=e||{},e.pan=e.pan!==!1,e.scale=e.scale!==!1,e.rotate=e.rotate!==!1;var r=i(t,e.scale),l=u(t,e.rotate),c=o(t),m=a([0,10,30],[0,0,0],[0,1,0]);return m.tick=n,m}var a=t(48),i=t(51),o=t(45),u=t(46),f=t(44),s=1;e.exports=r},{44:44,45:45,46:46,48:48,51:51}],3:[function(t,e,n){var r=t(40),a=t(42),i=t(41),o=function(t,e,n,i,o,u,f,s,l){var c,m,d,h,p,b;return c=[],m=[],d=[],h=[],p=[],b=[],r(c,a([],t,(u-l)/(u-o)),a([],e,(l-o)/(u-o))),r(m,a([],e,(f-l)/(f-u)),a([],n,(l-u)/(f-u))),r(d,a([],n,(s-l)/(s-f)),a([],i,(l-f)/(s-f))),r(h,a([],c,(f-l)/(f-o)),a([],m,(l-o)/(f-o))),r(p,a([],m,(s-l)/(s-u)),a([],d,(l-u)/(s-u))),r(b,a([],h,(f-l)/(f-u)),a([],p,(l-u)/(f-u))),b},u=function(t,e,n,r,a,u){var f,s,l,c,m,d,h=[];d=i(e,n),s=0,l=Math.pow(i(t,e),u),c=Math.pow(d,u)+l,m=Math.pow(i(n,r),u)+c,a||(a=1.5*d);var p=(c-l)/a;for(f=l;f<c;)f+=p,h.push(o(t,e,n,r,s,l,c,m,f));return h},f=function(t,e){if(t.length<4)throw"Must have at least 4 control points to generate catmull rom spline";var n,r,a,i,o,f=[];e=e||{};var s=e.knot||.5,l=e.samples;return t.forEach(function(e,c){o=1,n=e;do r=t[c+o],o++;while(n&&r&&n[0]===r[0]&&n[1]===r[1]);do a=t[c+o],o++;while(r&&a&&r[0]===a[0]&&r[1]===a[1]);do i=t[c+o],o++;while(a&&i&&a[0]===i[0]&&a[1]===i[1]);r&&a&&i&&(f.push(r),f=f.concat(u(n,r,a,i,l,s)),t[o]||f.push(a))}),f};e.exports=f},{40:40,41:41,42:42}],4:[function(t,e,n){function r(t){if(t===window||t===document.body)return[window.innerWidth,window.innerHeight];if(!t.parentNode){var e=!0;document.body.appendChild(t)}var n=t.getBoundingClientRect(),r=getComputedStyle(t),i=(0|n.height)+a(r.getPropertyValue("margin-top"))+a(r.getPropertyValue("margin-bottom")),o=(0|n.width)+a(r.getPropertyValue("margin-left"))+a(r.getPropertyValue("margin-right"));return e&&document.body.removeChild(t),[o,i]}function a(t){return parseFloat(t)||0}e.exports=r},{}],5:[function(t,e,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(t){return"function"==typeof t}function i(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function u(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!i(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,i,f,s;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}if(n=this._events[t],u(n))return!1;if(a(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(o(n))for(i=Array.prototype.slice.call(arguments,1),s=n.slice(),r=s.length,f=0;f<r;f++)s[f].apply(this,i);return!0},r.prototype.addListener=function(t,e){var n;if(!a(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,a(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(n=u(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!a(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},r.prototype.removeListener=function(t,e){var n,r,i,u;if(!a(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],i=n.length,r=-1,n===e||a(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(n)){for(u=i;u-- >0;)if(n[u]===e||n[u].listener&&n[u].listener===e){r=u;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],a(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?a(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(a(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},{}],6:[function(t,e,n){function r(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],f=e[6],s=e[7],l=e[8],c=e[9],m=e[10],d=e[11],h=e[12],p=e[13],b=e[14],v=e[15];return t[0]=u*(m*v-d*b)-c*(f*v-s*b)+p*(f*d-s*m),t[1]=-(r*(m*v-d*b)-c*(a*v-i*b)+p*(a*d-i*m)),t[2]=r*(f*v-s*b)-u*(a*v-i*b)+p*(a*s-i*f),t[3]=-(r*(f*d-s*m)-u*(a*d-i*m)+c*(a*s-i*f)),t[4]=-(o*(m*v-d*b)-l*(f*v-s*b)+h*(f*d-s*m)),t[5]=n*(m*v-d*b)-l*(a*v-i*b)+h*(a*d-i*m),t[6]=-(n*(f*v-s*b)-o*(a*v-i*b)+h*(a*s-i*f)),t[7]=n*(f*d-s*m)-o*(a*d-i*m)+l*(a*s-i*f),t[8]=o*(c*v-d*p)-l*(u*v-s*p)+h*(u*d-s*c),t[9]=-(n*(c*v-d*p)-l*(r*v-i*p)+h*(r*d-i*c)),t[10]=n*(u*v-s*p)-o*(r*v-i*p)+h*(r*s-i*u),t[11]=-(n*(u*d-s*c)-o*(r*d-i*c)+l*(r*s-i*u)),t[12]=-(o*(c*b-m*p)-l*(u*b-f*p)+h*(u*m-f*c)),t[13]=n*(c*b-m*p)-l*(r*b-a*p)+h*(r*m-a*c),t[14]=-(n*(u*b-f*p)-o*(r*b-a*p)+h*(r*f-a*u)),t[15]=n*(u*m-f*c)-o*(r*m-a*c)+l*(r*f-a*u),t}e.exports=r},{}],7:[function(t,e,n){function r(t){var e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}e.exports=r},{}],8:[function(t,e,n){function r(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}e.exports=r},{}],9:[function(t,e,n){function r(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}e.exports=r},{}],10:[function(t,e,n){function r(t){var e=t[0],n=t[1],r=t[2],a=t[3],i=t[4],o=t[5],u=t[6],f=t[7],s=t[8],l=t[9],c=t[10],m=t[11],d=t[12],h=t[13],p=t[14],b=t[15],v=e*o-n*i,g=e*u-r*i,x=e*f-a*i,y=n*u-r*o,M=n*f-a*o,S=r*f-a*u,w=s*h-l*d,D=s*p-c*d,I=s*b-m*d,F=l*p-c*h,A=l*b-m*h,E=c*b-m*p;return v*E-g*A+x*F+y*I-M*D+S*w}e.exports=r},{}],11:[function(t,e,n){function r(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n+n,u=r+r,f=a+a,s=n*o,l=r*o,c=r*u,m=a*o,d=a*u,h=a*f,p=i*o,b=i*u,v=i*f;return t[0]=1-c-h,t[1]=l+v,t[2]=m-b,t[3]=0,t[4]=l-v,t[5]=1-s-h,t[6]=d+p,t[7]=0,t[8]=m+b,t[9]=d-p,t[10]=1-s-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}e.exports=r},{}],12:[function(t,e,n){function r(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=r+r,f=a+a,s=i+i,l=r*u,c=r*f,m=r*s,d=a*f,h=a*s,p=i*s,b=o*u,v=o*f,g=o*s;return t[0]=1-(d+p),t[1]=c+g,t[2]=m-v,t[3]=0,t[4]=c-g,t[5]=1-(l+p),t[6]=h+b,t[7]=0,t[8]=m+v,t[9]=h-b,t[10]=1-(l+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}e.exports=r},{}],13:[function(t,e,n){function r(t,e,n,r,a,i,o){var u=1/(n-e),f=1/(a-r),s=1/(i-o);return t[0]=2*i*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*f,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(a+r)*f,t[10]=(o+i)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*s,t[15]=0,t}e.exports=r},{}],14:[function(t,e,n){function r(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}e.exports=r},{}],15:[function(t,e,n){e.exports={create:t(9),clone:t(7),copy:t(8),identity:t(14),transpose:t(29),invert:t(16),adjoint:t(6),determinant:t(10),multiply:t(18),translate:t(28),scale:t(26),rotate:t(22),rotateX:t(23),rotateY:t(24),rotateZ:t(25),fromRotationTranslation:t(12),fromQuat:t(11),frustum:t(13),perspective:t(20),perspectiveFromFieldOfView:t(21),ortho:t(19),lookAt:t(17),str:t(27)}},{10:10,11:11,12:12,13:13,14:14,16:16,17:17,18:18,19:19,20:20,21:21,22:22,23:23,24:24,25:25,26:26,27:27,28:28,29:29,6:6,7:7,8:8,9:9}],16:[function(t,e,n){function r(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],f=e[6],s=e[7],l=e[8],c=e[9],m=e[10],d=e[11],h=e[12],p=e[13],b=e[14],v=e[15],g=n*u-r*o,x=n*f-a*o,y=n*s-i*o,M=r*f-a*u,S=r*s-i*u,w=a*s-i*f,D=l*p-c*h,I=l*b-m*h,F=l*v-d*h,A=c*b-m*p,E=c*v-d*p,_=m*v-d*b,k=g*_-x*E+y*A+M*F-S*I+w*D;return k?(k=1/k,t[0]=(u*_-f*E+s*A)*k,t[1]=(a*E-r*_-i*A)*k,t[2]=(p*w-b*S+v*M)*k,t[3]=(m*S-c*w-d*M)*k,t[4]=(f*F-o*_-s*I)*k,t[5]=(n*_-a*F+i*I)*k,t[6]=(b*y-h*w-v*x)*k,t[7]=(l*w-m*y+d*x)*k,t[8]=(o*E-u*F+s*D)*k,t[9]=(r*F-n*E-i*D)*k,t[10]=(h*S-p*y+v*g)*k,t[11]=(c*y-l*S-d*g)*k,t[12]=(u*I-o*A-f*D)*k,t[13]=(n*A-r*I+a*D)*k,t[14]=(p*x-h*M-b*g)*k,t[15]=(l*M-c*x+m*g)*k,t):null}e.exports=r},{}],17:[function(t,e,n){function r(t,e,n,r){var i,o,u,f,s,l,c,m,d,h,p=e[0],b=e[1],v=e[2],g=r[0],x=r[1],y=r[2],M=n[0],S=n[1],w=n[2];return Math.abs(p-M)<1e-6&&Math.abs(b-S)<1e-6&&Math.abs(v-w)<1e-6?a(t):(c=p-M,m=b-S,d=v-w,h=1/Math.sqrt(c*c+m*m+d*d),c*=h,m*=h,d*=h,i=x*d-y*m,o=y*c-g*d,u=g*m-x*c,h=Math.sqrt(i*i+o*o+u*u),h?(h=1/h,i*=h,o*=h,u*=h):(i=0,o=0,u=0),f=m*u-d*o,s=d*i-c*u,l=c*o-m*i,h=Math.sqrt(f*f+s*s+l*l),h?(h=1/h,f*=h,s*=h,l*=h):(f=0,s=0,l=0),t[0]=i,t[1]=f,t[2]=c,t[3]=0,t[4]=o,t[5]=s,t[6]=m,t[7]=0,t[8]=u,t[9]=l,t[10]=d,t[11]=0,t[12]=-(i*p+o*b+u*v),t[13]=-(f*p+s*b+l*v),t[14]=-(c*p+m*b+d*v),t[15]=1,t)}var a=t(14);e.exports=r},{14:14}],18:[function(t,e,n){function r(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=e[4],f=e[5],s=e[6],l=e[7],c=e[8],m=e[9],d=e[10],h=e[11],p=e[12],b=e[13],v=e[14],g=e[15],x=n[0],y=n[1],M=n[2],S=n[3];return t[0]=x*r+y*u+M*c+S*p,t[1]=x*a+y*f+M*m+S*b,t[2]=x*i+y*s+M*d+S*v,t[3]=x*o+y*l+M*h+S*g,x=n[4],y=n[5],M=n[6],S=n[7],t[4]=x*r+y*u+M*c+S*p,t[5]=x*a+y*f+M*m+S*b,t[6]=x*i+y*s+M*d+S*v,t[7]=x*o+y*l+M*h+S*g,x=n[8],y=n[9],M=n[10],S=n[11],t[8]=x*r+y*u+M*c+S*p,t[9]=x*a+y*f+M*m+S*b,t[10]=x*i+y*s+M*d+S*v,t[11]=x*o+y*l+M*h+S*g,x=n[12],y=n[13],M=n[14],S=n[15],t[12]=x*r+y*u+M*c+S*p,t[13]=x*a+y*f+M*m+S*b,t[14]=x*i+y*s+M*d+S*v,t[15]=x*o+y*l+M*h+S*g,t}e.exports=r},{}],19:[function(t,e,n){function r(t,e,n,r,a,i,o){var u=1/(e-n),f=1/(r-a),s=1/(i-o);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(e+n)*u,t[13]=(a+r)*f,t[14]=(o+i)*s,t[15]=1,t}e.exports=r},{}],20:[function(t,e,n){function r(t,e,n,r,a){var i=1/Math.tan(e/2),o=1/(r-a);return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+r)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*r*o,t[15]=0,t}e.exports=r},{}],21:[function(t,e,n){function r(t,e,n,r){var a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),f=2/(o+u),s=2/(a+i);return t[0]=f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-((o-u)*f*.5),t[9]=(a-i)*s*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}e.exports=r},{}],22:[function(t,e,n){function r(t,e,n,r){var a,i,o,u,f,s,l,c,m,d,h,p,b,v,g,x,y,M,S,w,D,I,F,A,E=r[0],_=r[1],k=r[2],z=Math.sqrt(E*E+_*_+k*k);return Math.abs(z)<1e-6?null:(z=1/z,E*=z,_*=z,k*=z,a=Math.sin(n),i=Math.cos(n),o=1-i,u=e[0],f=e[1],s=e[2],l=e[3],c=e[4],m=e[5],d=e[6],h=e[7],p=e[8],b=e[9],v=e[10],g=e[11],x=E*E*o+i,y=_*E*o+k*a,M=k*E*o-_*a,S=E*_*o-k*a,w=_*_*o+i,D=k*_*o+E*a,I=E*k*o+_*a,F=_*k*o-E*a,A=k*k*o+i,t[0]=u*x+c*y+p*M,t[1]=f*x+m*y+b*M,t[2]=s*x+d*y+v*M,t[3]=l*x+h*y+g*M,t[4]=u*S+c*w+p*D,t[5]=f*S+m*w+b*D,t[6]=s*S+d*w+v*D,t[7]=l*S+h*w+g*D,t[8]=u*I+c*F+p*A,t[9]=f*I+m*F+b*A,t[10]=s*I+d*F+v*A,t[11]=l*I+h*F+g*A,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}e.exports=r},{}],23:[function(t,e,n){function r(t,e,n){var r=Math.sin(n),a=Math.cos(n),i=e[4],o=e[5],u=e[6],f=e[7],s=e[8],l=e[9],c=e[10],m=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*a+s*r,t[5]=o*a+l*r,t[6]=u*a+c*r,t[7]=f*a+m*r,t[8]=s*a-i*r,t[9]=l*a-o*r,t[10]=c*a-u*r,t[11]=m*a-f*r,t}e.exports=r},{}],24:[function(t,e,n){function r(t,e,n){var r=Math.sin(n),a=Math.cos(n),i=e[0],o=e[1],u=e[2],f=e[3],s=e[8],l=e[9],c=e[10],m=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a-s*r,t[1]=o*a-l*r,t[2]=u*a-c*r,t[3]=f*a-m*r,t[8]=i*r+s*a,t[9]=o*r+l*a,t[10]=u*r+c*a,t[11]=f*r+m*a,t}e.exports=r},{}],25:[function(t,e,n){function r(t,e,n){var r=Math.sin(n),a=Math.cos(n),i=e[0],o=e[1],u=e[2],f=e[3],s=e[4],l=e[5],c=e[6],m=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a+s*r,t[1]=o*a+l*r,t[2]=u*a+c*r,t[3]=f*a+m*r,t[4]=s*a-i*r,t[5]=l*a-o*r,t[6]=c*a-u*r,t[7]=m*a-f*r,t}e.exports=r},{}],26:[function(t,e,n){function r(t,e,n){var r=n[0],a=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}e.exports=r},{}],27:[function(t,e,n){function r(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}e.exports=r},{}],28:[function(t,e,n){function r(t,e,n){var r,a,i,o,u,f,s,l,c,m,d,h,p=n[0],b=n[1],v=n[2];return e===t?(t[12]=e[0]*p+e[4]*b+e[8]*v+e[12],t[13]=e[1]*p+e[5]*b+e[9]*v+e[13],t[14]=e[2]*p+e[6]*b+e[10]*v+e[14],t[15]=e[3]*p+e[7]*b+e[11]*v+e[15]):(r=e[0],a=e[1],i=e[2],o=e[3],u=e[4],f=e[5],s=e[6],l=e[7],c=e[8],m=e[9],d=e[10],h=e[11],t[0]=r,t[1]=a,t[2]=i,t[3]=o,t[4]=u,t[5]=f,t[6]=s,t[7]=l,t[8]=c,t[9]=m,t[10]=d,t[11]=h,t[12]=r*p+u*b+c*v+e[12],t[13]=a*p+f*b+m*v+e[13],t[14]=i*p+s*b+d*v+e[14],t[15]=o*p+l*b+h*v+e[15]),t}e.exports=r},{}],29:[function(t,e,n){function r(t,e){if(t===e){var n=e[1],r=e[2],a=e[3],i=e[6],o=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=a,t[13]=o,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}e.exports=r},{}],30:[function(t,e,n){n.glMatrix=t(31),n.mat2=t(32),n.mat2d=t(33),n.mat3=t(34),n.mat4=t(35),n.quat=t(36),n.vec2=t(37),n.vec3=t(38),n.vec4=t(39)},{31:31,32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39}],31:[function(t,e,n){var r={};r.EPSILON=1e-6,r.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,r.RANDOM=Math.random,r.ENABLE_SIMD=!1,r.SIMD_AVAILABLE=r.ARRAY_TYPE===Float32Array&&"SIMD"in this,r.USE_SIMD=r.ENABLE_SIMD&&r.SIMD_AVAILABLE,r.setMatrixArrayType=function(t){r.ARRAY_TYPE=t};var a=Math.PI/180;r.toRadian=function(t){return t*a},r.equals=function(t,e){return Math.abs(t-e)<=r.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.exports=r},{}],32:[function(t,e,n){var r=t(31),a={};a.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},a.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},a.fromValues=function(t,e,n,a){var i=new r.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=a,i},a.set=function(t,e,n,r,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t},a.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},a.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n*i-a*r;return o?(o=1/o,t[0]=i*o,t[1]=-r*o,t[2]=-a*o,t[3]=n*o,t):null},a.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},a.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},a.multiply=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=n[0],f=n[1],s=n[2],l=n[3];return t[0]=r*u+i*f,t[1]=a*u+o*f,t[2]=r*s+i*l,t[3]=a*s+o*l,t},a.mul=a.multiply,a.rotate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=Math.sin(n),f=Math.cos(n);return t[0]=r*f+i*u,t[1]=a*f+o*u,t[2]=r*-u+i*f,t[3]=a*-u+o*f,t},a.scale=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=n[0],f=n[1];return t[0]=r*u,t[1]=a*u,t[2]=i*f,t[3]=o*f,t},a.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},a.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},a.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},a.sub=a.subtract,a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.equals=function(t,e){var n=t[0],a=t[1],i=t[2],o=t[3],u=e[0],f=e[1],s=e[2],l=e[3];return Math.abs(n-u)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-f)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(i-s)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-l)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},a.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},a.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},e.exports=a},{31:31}],33:[function(t,e,n){var r=t(31),a={};a.create=function(){var t=new r.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},a.clone=function(t){var e=new r.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},a.fromValues=function(t,e,n,a,i,o){var u=new r.ARRAY_TYPE(6);return u[0]=t,u[1]=e,u[2]=n,u[3]=a,u[4]=i,u[5]=o,u},a.set=function(t,e,n,r,a,i,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=i,t[5]=o,t},a.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],f=n*i-r*a;return f?(f=1/f,t[0]=i*f,t[1]=-r*f,t[2]=-a*f,t[3]=n*f,t[4]=(a*u-i*o)*f,t[5]=(r*o-n*u)*f,t):null},a.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},a.multiply=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=e[4],f=e[5],s=n[0],l=n[1],c=n[2],m=n[3],d=n[4],h=n[5];return t[0]=r*s+i*l,t[1]=a*s+o*l,t[2]=r*c+i*m,t[3]=a*c+o*m,t[4]=r*d+i*h+u,t[5]=a*d+o*h+f,t},a.mul=a.multiply,a.rotate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=e[4],f=e[5],s=Math.sin(n),l=Math.cos(n);return t[0]=r*l+i*s,t[1]=a*l+o*s,t[2]=r*-s+i*l,t[3]=a*-s+o*l,t[4]=u,t[5]=f,t},a.scale=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=e[4],f=e[5],s=n[0],l=n[1];return t[0]=r*s,t[1]=a*s,t[2]=i*l,t[3]=o*l,t[4]=u,t[5]=f,t},a.translate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=e[4],f=e[5],s=n[0],l=n[1];return t[0]=r,t[1]=a,t[2]=i,t[3]=o,t[4]=r*s+i*l+u,t[5]=a*s+o*l+f,t},a.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},a.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},a.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},a.equals=function(t,e){var n=t[0],a=t[1],i=t[2],o=t[3],u=t[4],f=t[5],s=e[0],l=e[1],c=e[2],m=e[3],d=e[4],h=e[5];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-l)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(i-c)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-m)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(u-d)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(d))&&Math.abs(f-h)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(h))},e.exports=a},{31:31}],34:[function(t,e,n){var r=t(31),a={};a.create=function(){var t=new r.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},a.clone=function(t){var e=new r.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},a.fromValues=function(t,e,n,a,i,o,u,f,s){var l=new r.ARRAY_TYPE(9);return l[0]=t,l[1]=e,l[2]=n,l[3]=a,l[4]=i,l[5]=o,l[6]=u,l[7]=f,l[8]=s,l},a.set=function(t,e,n,r,a,i,o,u,f,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=i,t[5]=o,t[6]=u,t[7]=f,t[8]=s,t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},a.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],f=e[6],s=e[7],l=e[8],c=l*o-u*s,m=-l*i+u*f,d=s*i-o*f,h=n*c+r*m+a*d;return h?(h=1/h,t[0]=c*h,t[1]=(-l*r+a*s)*h,t[2]=(u*r-a*o)*h,t[3]=m*h,t[4]=(l*n-a*f)*h,t[5]=(-u*n+a*i)*h,t[6]=d*h,t[7]=(-s*n+r*f)*h,t[8]=(o*n-r*i)*h,t):null},a.adjoint=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],f=e[6],s=e[7],l=e[8];return t[0]=o*l-u*s,t[1]=a*s-r*l,t[2]=r*u-a*o,t[3]=u*f-i*l,t[4]=n*l-a*f,t[5]=a*i-n*u,t[6]=i*s-o*f,t[7]=r*f-n*s,t[8]=n*o-r*i,t},a.determinant=function(t){var e=t[0],n=t[1],r=t[2],a=t[3],i=t[4],o=t[5],u=t[6],f=t[7],s=t[8];return e*(s*i-o*f)+n*(-s*a+o*u)+r*(f*a-i*u)},a.multiply=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=e[4],f=e[5],s=e[6],l=e[7],c=e[8],m=n[0],d=n[1],h=n[2],p=n[3],b=n[4],v=n[5],g=n[6],x=n[7],y=n[8];return t[0]=m*r+d*o+h*s,t[1]=m*a+d*u+h*l,t[2]=m*i+d*f+h*c,t[3]=p*r+b*o+v*s,t[4]=p*a+b*u+v*l,t[5]=p*i+b*f+v*c,t[6]=g*r+x*o+y*s,t[7]=g*a+x*u+y*l,t[8]=g*i+x*f+y*c,t},a.mul=a.multiply,a.translate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=e[4],f=e[5],s=e[6],l=e[7],c=e[8],m=n[0],d=n[1];return t[0]=r,t[1]=a,t[2]=i,t[3]=o,t[4]=u,t[5]=f,t[6]=m*r+d*o+s,t[7]=m*a+d*u+l,t[8]=m*i+d*f+c,t},a.rotate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=e[4],f=e[5],s=e[6],l=e[7],c=e[8],m=Math.sin(n),d=Math.cos(n);return t[0]=d*r+m*o,t[1]=d*a+m*u,t[2]=d*i+m*f,t[3]=d*o-m*r,t[4]=d*u-m*a,t[5]=d*f-m*i,t[6]=s,t[7]=l,t[8]=c,t},a.scale=function(t,e,n){var r=n[0],a=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},a.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},a.fromQuat=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n+n,u=r+r,f=a+a,s=n*o,l=r*o,c=r*u,m=a*o,d=a*u,h=a*f,p=i*o,b=i*u,v=i*f;return t[0]=1-c-h,t[3]=l-v,t[6]=m+b,t[1]=l+v,t[4]=1-s-h,t[7]=d-p,t[2]=m-b,t[5]=d+p,t[8]=1-s-c,t},a.normalFromMat4=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],f=e[6],s=e[7],l=e[8],c=e[9],m=e[10],d=e[11],h=e[12],p=e[13],b=e[14],v=e[15],g=n*u-r*o,x=n*f-a*o,y=n*s-i*o,M=r*f-a*u,S=r*s-i*u,w=a*s-i*f,D=l*p-c*h,I=l*b-m*h,F=l*v-d*h,A=c*b-m*p,E=c*v-d*p,_=m*v-d*b,k=g*_-x*E+y*A+M*F-S*I+w*D;return k?(k=1/k,t[0]=(u*_-f*E+s*A)*k,t[1]=(f*F-o*_-s*I)*k,t[2]=(o*E-u*F+s*D)*k,t[3]=(a*E-r*_-i*A)*k,t[4]=(n*_-a*F+i*I)*k,t[5]=(r*F-n*E-i*D)*k,t[6]=(p*w-b*S+v*M)*k,t[7]=(b*y-h*w-v*x)*k,t[8]=(h*S-p*y+v*g)*k,t):null},a.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},a.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},a.equals=function(t,e){var n=t[0],a=t[1],i=t[2],o=t[3],u=t[4],f=t[5],s=t[6],l=t[7],c=t[8],m=e[0],d=e[1],h=e[2],p=e[3],b=e[4],v=e[5],g=t[6],x=e[7],y=e[8];return Math.abs(n-m)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(a-d)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(i-h)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-p)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(u-b)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(f-v)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(v))&&Math.abs(s-g)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(l-x)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(x))&&Math.abs(c-y)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))},e.exports=a},{31:31}],35:[function(t,e,n){var r=t(31),a={scalar:{},SIMD:{}};a.create=function(){var t=new r.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.clone=function(t){var e=new r.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.fromValues=function(t,e,n,a,i,o,u,f,s,l,c,m,d,h,p,b){var v=new r.ARRAY_TYPE(16);return v[0]=t,v[1]=e,v[2]=n,v[3]=a,v[4]=i,v[5]=o,v[6]=u,v[7]=f,v[8]=s,v[9]=l,v[10]=c,v[11]=m,v[12]=d,v[13]=h,v[14]=p,v[15]=b,v},a.set=function(t,e,n,r,a,i,o,u,f,s,l,c,m,d,h,p,b){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=i,t[5]=o,t[6]=u,t[7]=f,t[8]=s,t[9]=l,t[10]=c,t[11]=m,t[12]=d,t[13]=h,t[14]=p,t[15]=b,t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.scalar.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],a=e[3],i=e[6],o=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=a,t[13]=o,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},a.SIMD.transpose=function(t,e){var n,r,a,i,o,u,f,s,l,c;return n=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),o=SIMD.Float32x4.shuffle(n,r,0,1,4,5),u=SIMD.Float32x4.shuffle(a,i,0,1,4,5),f=SIMD.Float32x4.shuffle(o,u,0,2,4,6),s=SIMD.Float32x4.shuffle(o,u,1,3,5,7),SIMD.Float32x4.store(t,0,f),SIMD.Float32x4.store(t,4,s),o=SIMD.Float32x4.shuffle(n,r,2,3,6,7),u=SIMD.Float32x4.shuffle(a,i,2,3,6,7),l=SIMD.Float32x4.shuffle(o,u,0,2,4,6),c=SIMD.Float32x4.shuffle(o,u,1,3,5,7),SIMD.Float32x4.store(t,8,l),SIMD.Float32x4.store(t,12,c),t},a.transpose=r.USE_SIMD?a.SIMD.transpose:a.scalar.transpose,a.scalar.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],f=e[6],s=e[7],l=e[8],c=e[9],m=e[10],d=e[11],h=e[12],p=e[13],b=e[14],v=e[15],g=n*u-r*o,x=n*f-a*o,y=n*s-i*o,M=r*f-a*u,S=r*s-i*u,w=a*s-i*f,D=l*p-c*h,I=l*b-m*h,F=l*v-d*h,A=c*b-m*p,E=c*v-d*p,_=m*v-d*b,k=g*_-x*E+y*A+M*F-S*I+w*D;return k?(k=1/k,t[0]=(u*_-f*E+s*A)*k,t[1]=(a*E-r*_-i*A)*k,t[2]=(p*w-b*S+v*M)*k,t[3]=(m*S-c*w-d*M)*k,t[4]=(f*F-o*_-s*I)*k,t[5]=(n*_-a*F+i*I)*k,t[6]=(b*y-h*w-v*x)*k,t[7]=(l*w-m*y+d*x)*k,t[8]=(o*E-u*F+s*D)*k,t[9]=(r*F-n*E-i*D)*k,t[10]=(h*S-p*y+v*g)*k,t[11]=(c*y-l*S-d*g)*k,t[12]=(u*I-o*A-f*D)*k,t[13]=(n*A-r*I+a*D)*k,t[14]=(p*x-h*M-b*g)*k,t[15]=(l*M-c*x+m*g)*k,t):null},a.SIMD.invert=function(t,e){var n,r,a,i,o,u,f,s,l,c,m=SIMD.Float32x4.load(e,0),d=SIMD.Float32x4.load(e,4),h=SIMD.Float32x4.load(e,8),p=SIMD.Float32x4.load(e,12);return o=SIMD.Float32x4.shuffle(m,d,0,1,4,5),r=SIMD.Float32x4.shuffle(h,p,0,1,4,5),n=SIMD.Float32x4.shuffle(o,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,o,1,3,5,7),o=SIMD.Float32x4.shuffle(m,d,2,3,6,7),
i=SIMD.Float32x4.shuffle(h,p,2,3,6,7),a=SIMD.Float32x4.shuffle(o,i,0,2,4,6),i=SIMD.Float32x4.shuffle(i,o,1,3,5,7),o=SIMD.Float32x4.mul(a,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.mul(r,o),f=SIMD.Float32x4.mul(n,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),u),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),o=SIMD.Float32x4.mul(r,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),u),l=SIMD.Float32x4.mul(n,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(i,o)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),o=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),u),s=SIMD.Float32x4.mul(n,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(a,o)),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),o=SIMD.Float32x4.mul(n,r),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),s),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,o),l),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),s),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(a,o)),o=SIMD.Float32x4.mul(n,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(a,o)),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,o),s),o=SIMD.Float32x4.swizzle(o,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),f),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(r,o)),o=SIMD.Float32x4.mul(n,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),f),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,o)),o=SIMD.Float32x4.swizzle(o,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(i,o)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,o),l),c=SIMD.Float32x4.mul(n,u),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,1,0,3,2),c),o=SIMD.Float32x4.reciprocalApproximation(c),c=SIMD.Float32x4.sub(SIMD.Float32x4.add(o,o),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(o,o))),(c=SIMD.Float32x4.swizzle(c,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(c,u)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(c,f)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(c,s)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(c,l)),t):null},a.invert=r.USE_SIMD?a.SIMD.invert:a.scalar.invert,a.scalar.adjoint=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],f=e[6],s=e[7],l=e[8],c=e[9],m=e[10],d=e[11],h=e[12],p=e[13],b=e[14],v=e[15];return t[0]=u*(m*v-d*b)-c*(f*v-s*b)+p*(f*d-s*m),t[1]=-(r*(m*v-d*b)-c*(a*v-i*b)+p*(a*d-i*m)),t[2]=r*(f*v-s*b)-u*(a*v-i*b)+p*(a*s-i*f),t[3]=-(r*(f*d-s*m)-u*(a*d-i*m)+c*(a*s-i*f)),t[4]=-(o*(m*v-d*b)-l*(f*v-s*b)+h*(f*d-s*m)),t[5]=n*(m*v-d*b)-l*(a*v-i*b)+h*(a*d-i*m),t[6]=-(n*(f*v-s*b)-o*(a*v-i*b)+h*(a*s-i*f)),t[7]=n*(f*d-s*m)-o*(a*d-i*m)+l*(a*s-i*f),t[8]=o*(c*v-d*p)-l*(u*v-s*p)+h*(u*d-s*c),t[9]=-(n*(c*v-d*p)-l*(r*v-i*p)+h*(r*d-i*c)),t[10]=n*(u*v-s*p)-o*(r*v-i*p)+h*(r*s-i*u),t[11]=-(n*(u*d-s*c)-o*(r*d-i*c)+l*(r*s-i*u)),t[12]=-(o*(c*b-m*p)-l*(u*b-f*p)+h*(u*m-f*c)),t[13]=n*(c*b-m*p)-l*(r*b-a*p)+h*(r*m-a*c),t[14]=-(n*(u*b-f*p)-o*(r*b-a*p)+h*(r*f-a*u)),t[15]=n*(u*m-f*c)-o*(r*m-a*c)+l*(r*f-a*u),t},a.SIMD.adjoint=function(t,e){var n,r,a,i,o,u,f,s,l,c,m,d,h,n=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12);return l=SIMD.Float32x4.shuffle(n,r,0,1,4,5),u=SIMD.Float32x4.shuffle(a,i,0,1,4,5),o=SIMD.Float32x4.shuffle(l,u,0,2,4,6),u=SIMD.Float32x4.shuffle(u,l,1,3,5,7),l=SIMD.Float32x4.shuffle(n,r,2,3,6,7),s=SIMD.Float32x4.shuffle(a,i,2,3,6,7),f=SIMD.Float32x4.shuffle(l,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,l,1,3,5,7),l=SIMD.Float32x4.mul(f,s),l=SIMD.Float32x4.swizzle(l,1,0,3,2),c=SIMD.Float32x4.mul(u,l),m=SIMD.Float32x4.mul(o,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,l),c),m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,l),m),m=SIMD.Float32x4.swizzle(m,2,3,0,1),l=SIMD.Float32x4.mul(u,f),l=SIMD.Float32x4.swizzle(l,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,l),c),h=SIMD.Float32x4.mul(o,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(s,l)),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,l),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),l=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,3,0,1),s),l=SIMD.Float32x4.swizzle(l,1,0,3,2),f=SIMD.Float32x4.swizzle(f,2,3,0,1),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,l),c),d=SIMD.Float32x4.mul(o,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(f,l)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,l),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),l=SIMD.Float32x4.mul(o,u),l=SIMD.Float32x4.swizzle(l,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,l),d),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,l),h),l=SIMD.Float32x4.swizzle(l,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,l),d),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(f,l)),l=SIMD.Float32x4.mul(o,s),l=SIMD.Float32x4.swizzle(l,1,0,3,2),m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(f,l)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,l),d),l=SIMD.Float32x4.swizzle(l,2,3,0,1),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,l),m),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(u,l)),l=SIMD.Float32x4.mul(o,f),l=SIMD.Float32x4.swizzle(l,1,0,3,2),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,l),m),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,l)),l=SIMD.Float32x4.swizzle(l,2,3,0,1),m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(s,l)),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,l),h),SIMD.Float32x4.store(t,0,c),SIMD.Float32x4.store(t,4,m),SIMD.Float32x4.store(t,8,d),SIMD.Float32x4.store(t,12,h),t},a.adjoint=r.USE_SIMD?a.SIMD.adjoint:a.scalar.adjoint,a.determinant=function(t){var e=t[0],n=t[1],r=t[2],a=t[3],i=t[4],o=t[5],u=t[6],f=t[7],s=t[8],l=t[9],c=t[10],m=t[11],d=t[12],h=t[13],p=t[14],b=t[15],v=e*o-n*i,g=e*u-r*i,x=e*f-a*i,y=n*u-r*o,M=n*f-a*o,S=r*f-a*u,w=s*h-l*d,D=s*p-c*d,I=s*b-m*d,F=l*p-c*h,A=l*b-m*h,E=c*b-m*p;return v*E-g*A+x*F+y*I-M*D+S*w},a.SIMD.multiply=function(t,e,n){var r=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4.load(n,0),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),o))));SIMD.Float32x4.store(t,0,f);var s=SIMD.Float32x4.load(n,4),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),o))));SIMD.Float32x4.store(t,4,l);var c=SIMD.Float32x4.load(n,8),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),o))));SIMD.Float32x4.store(t,8,m);var d=SIMD.Float32x4.load(n,12),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),o))));return SIMD.Float32x4.store(t,12,h),t},a.scalar.multiply=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=e[4],f=e[5],s=e[6],l=e[7],c=e[8],m=e[9],d=e[10],h=e[11],p=e[12],b=e[13],v=e[14],g=e[15],x=n[0],y=n[1],M=n[2],S=n[3];return t[0]=x*r+y*u+M*c+S*p,t[1]=x*a+y*f+M*m+S*b,t[2]=x*i+y*s+M*d+S*v,t[3]=x*o+y*l+M*h+S*g,x=n[4],y=n[5],M=n[6],S=n[7],t[4]=x*r+y*u+M*c+S*p,t[5]=x*a+y*f+M*m+S*b,t[6]=x*i+y*s+M*d+S*v,t[7]=x*o+y*l+M*h+S*g,x=n[8],y=n[9],M=n[10],S=n[11],t[8]=x*r+y*u+M*c+S*p,t[9]=x*a+y*f+M*m+S*b,t[10]=x*i+y*s+M*d+S*v,t[11]=x*o+y*l+M*h+S*g,x=n[12],y=n[13],M=n[14],S=n[15],t[12]=x*r+y*u+M*c+S*p,t[13]=x*a+y*f+M*m+S*b,t[14]=x*i+y*s+M*d+S*v,t[15]=x*o+y*l+M*h+S*g,t},a.multiply=r.USE_SIMD?a.SIMD.multiply:a.scalar.multiply,a.mul=a.multiply,a.scalar.translate=function(t,e,n){var r,a,i,o,u,f,s,l,c,m,d,h,p=n[0],b=n[1],v=n[2];return e===t?(t[12]=e[0]*p+e[4]*b+e[8]*v+e[12],t[13]=e[1]*p+e[5]*b+e[9]*v+e[13],t[14]=e[2]*p+e[6]*b+e[10]*v+e[14],t[15]=e[3]*p+e[7]*b+e[11]*v+e[15]):(r=e[0],a=e[1],i=e[2],o=e[3],u=e[4],f=e[5],s=e[6],l=e[7],c=e[8],m=e[9],d=e[10],h=e[11],t[0]=r,t[1]=a,t[2]=i,t[3]=o,t[4]=u,t[5]=f,t[6]=s,t[7]=l,t[8]=c,t[9]=m,t[10]=d,t[11]=h,t[12]=r*p+u*b+c*v+e[12],t[13]=a*p+f*b+m*v+e[13],t[14]=i*p+s*b+d*v+e[14],t[15]=o*p+l*b+h*v+e[15]),t},a.SIMD.translate=function(t,e,n){var r=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4(n[0],n[1],n[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(u,0,0,0,0)),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(u,1,1,1,1)),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(u,2,2,2,2));var f=SIMD.Float32x4.add(r,SIMD.Float32x4.add(a,SIMD.Float32x4.add(i,o)));return SIMD.Float32x4.store(t,12,f),t},a.translate=r.USE_SIMD?a.SIMD.translate:a.scalar.translate,a.scalar.scale=function(t,e,n){var r=n[0],a=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.SIMD.scale=function(t,e,n){var r,a,i,o=SIMD.Float32x4(n[0],n[1],n[2],0);return r=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(o,0,0,0,0))),a=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(o,1,1,1,1))),i=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(o,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.scale=r.USE_SIMD?a.SIMD.scale:a.scalar.scale,a.rotate=function(t,e,n,a){var i,o,u,f,s,l,c,m,d,h,p,b,v,g,x,y,M,S,w,D,I,F,A,E,_=a[0],k=a[1],z=a[2],T=Math.sqrt(_*_+k*k+z*z);return Math.abs(T)<r.EPSILON?null:(T=1/T,_*=T,k*=T,z*=T,i=Math.sin(n),o=Math.cos(n),u=1-o,f=e[0],s=e[1],l=e[2],c=e[3],m=e[4],d=e[5],h=e[6],p=e[7],b=e[8],v=e[9],g=e[10],x=e[11],y=_*_*u+o,M=k*_*u+z*i,S=z*_*u-k*i,w=_*k*u-z*i,D=k*k*u+o,I=z*k*u+_*i,F=_*z*u+k*i,A=k*z*u-_*i,E=z*z*u+o,t[0]=f*y+m*M+b*S,t[1]=s*y+d*M+v*S,t[2]=l*y+h*M+g*S,t[3]=c*y+p*M+x*S,t[4]=f*w+m*D+b*I,t[5]=s*w+d*D+v*I,t[6]=l*w+h*D+g*I,t[7]=c*w+p*D+x*I,t[8]=f*F+m*A+b*E,t[9]=s*F+d*A+v*E,t[10]=l*F+h*A+g*E,t[11]=c*F+p*A+x*E,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},a.scalar.rotateX=function(t,e,n){var r=Math.sin(n),a=Math.cos(n),i=e[4],o=e[5],u=e[6],f=e[7],s=e[8],l=e[9],c=e[10],m=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*a+s*r,t[5]=o*a+l*r,t[6]=u*a+c*r,t[7]=f*a+m*r,t[8]=s*a-i*r,t[9]=l*a-o*r,t[10]=c*a-u*r,t[11]=m*a-f*r,t},a.SIMD.rotateX=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),a=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,r))),t},a.rotateX=r.USE_SIMD?a.SIMD.rotateX:a.scalar.rotateX,a.scalar.rotateY=function(t,e,n){var r=Math.sin(n),a=Math.cos(n),i=e[0],o=e[1],u=e[2],f=e[3],s=e[8],l=e[9],c=e[10],m=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a-s*r,t[1]=o*a-l*r,t[2]=u*a-c*r,t[3]=f*a-m*r,t[8]=i*r+s*a,t[9]=o*r+l*a,t[10]=u*r+c*a,t[11]=f*r+m*a,t},a.SIMD.rotateY=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),a=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,r),SIMD.Float32x4.mul(o,a))),t},a.rotateY=r.USE_SIMD?a.SIMD.rotateY:a.scalar.rotateY,a.scalar.rotateZ=function(t,e,n){var r=Math.sin(n),a=Math.cos(n),i=e[0],o=e[1],u=e[2],f=e[3],s=e[4],l=e[5],c=e[6],m=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a+s*r,t[1]=o*a+l*r,t[2]=u*a+c*r,t[3]=f*a+m*r,t[4]=s*a-i*r,t[5]=l*a-o*r,t[6]=c*a-u*r,t[7]=m*a-f*r,t},a.SIMD.rotateZ=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),a=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,r))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,r))),t},a.rotateZ=r.USE_SIMD?a.SIMD.rotateZ:a.scalar.rotateZ,a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotation=function(t,e,n){var a,i,o,u=n[0],f=n[1],s=n[2],l=Math.sqrt(u*u+f*f+s*s);return Math.abs(l)<r.EPSILON?null:(l=1/l,u*=l,f*=l,s*=l,a=Math.sin(e),i=Math.cos(e),o=1-i,t[0]=u*u*o+i,t[1]=f*u*o+s*a,t[2]=s*u*o-f*a,t[3]=0,t[4]=u*f*o-s*a,t[5]=f*f*o+i,t[6]=s*f*o+u*a,t[7]=0,t[8]=u*s*o+f*a,t[9]=f*s*o-u*a,t[10]=s*s*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},a.fromXRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromYRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromZRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotationTranslation=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=r+r,f=a+a,s=i+i,l=r*u,c=r*f,m=r*s,d=a*f,h=a*s,p=i*s,b=o*u,v=o*f,g=o*s;return t[0]=1-(d+p),t[1]=c+g,t[2]=m-v,t[3]=0,t[4]=c-g,t[5]=1-(l+p),t[6]=h+b,t[7]=0,t[8]=m+v,t[9]=h-b,t[10]=1-(l+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},a.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},a.getRotation=function(t,e){var n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},a.fromRotationTranslationScale=function(t,e,n,r){var a=e[0],i=e[1],o=e[2],u=e[3],f=a+a,s=i+i,l=o+o,c=a*f,m=a*s,d=a*l,h=i*s,p=i*l,b=o*l,v=u*f,g=u*s,x=u*l,y=r[0],M=r[1],S=r[2];return t[0]=(1-(h+b))*y,t[1]=(m+x)*y,t[2]=(d-g)*y,t[3]=0,t[4]=(m-x)*M,t[5]=(1-(c+b))*M,t[6]=(p+v)*M,t[7]=0,t[8]=(d+g)*S,t[9]=(p-v)*S,t[10]=(1-(c+h))*S,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},a.fromRotationTranslationScaleOrigin=function(t,e,n,r,a){var i=e[0],o=e[1],u=e[2],f=e[3],s=i+i,l=o+o,c=u+u,m=i*s,d=i*l,h=i*c,p=o*l,b=o*c,v=u*c,g=f*s,x=f*l,y=f*c,M=r[0],S=r[1],w=r[2],D=a[0],I=a[1],F=a[2];return t[0]=(1-(p+v))*M,t[1]=(d+y)*M,t[2]=(h-x)*M,t[3]=0,t[4]=(d-y)*S,t[5]=(1-(m+v))*S,t[6]=(b+g)*S,t[7]=0,t[8]=(h+x)*w,t[9]=(b-g)*w,t[10]=(1-(m+p))*w,t[11]=0,t[12]=n[0]+D-(t[0]*D+t[4]*I+t[8]*F),t[13]=n[1]+I-(t[1]*D+t[5]*I+t[9]*F),t[14]=n[2]+F-(t[2]*D+t[6]*I+t[10]*F),t[15]=1,t},a.fromQuat=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n+n,u=r+r,f=a+a,s=n*o,l=r*o,c=r*u,m=a*o,d=a*u,h=a*f,p=i*o,b=i*u,v=i*f;return t[0]=1-c-h,t[1]=l+v,t[2]=m-b,t[3]=0,t[4]=l-v,t[5]=1-s-h,t[6]=d+p,t[7]=0,t[8]=m+b,t[9]=d-p,t[10]=1-s-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.frustum=function(t,e,n,r,a,i,o){var u=1/(n-e),f=1/(a-r),s=1/(i-o);return t[0]=2*i*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*f,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(a+r)*f,t[10]=(o+i)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*s,t[15]=0,t},a.perspective=function(t,e,n,r,a){var i=1/Math.tan(e/2),o=1/(r-a);return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+r)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*r*o,t[15]=0,t},a.perspectiveFromFieldOfView=function(t,e,n,r){var a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),f=2/(o+u),s=2/(a+i);return t[0]=f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-((o-u)*f*.5),t[9]=(a-i)*s*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},a.ortho=function(t,e,n,r,a,i,o){var u=1/(e-n),f=1/(r-a),s=1/(i-o);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(e+n)*u,t[13]=(a+r)*f,t[14]=(o+i)*s,t[15]=1,t},a.lookAt=function(t,e,n,i){var o,u,f,s,l,c,m,d,h,p,b=e[0],v=e[1],g=e[2],x=i[0],y=i[1],M=i[2],S=n[0],w=n[1],D=n[2];return Math.abs(b-S)<r.EPSILON&&Math.abs(v-w)<r.EPSILON&&Math.abs(g-D)<r.EPSILON?a.identity(t):(m=b-S,d=v-w,h=g-D,p=1/Math.sqrt(m*m+d*d+h*h),m*=p,d*=p,h*=p,o=y*h-M*d,u=M*m-x*h,f=x*d-y*m,p=Math.sqrt(o*o+u*u+f*f),p?(p=1/p,o*=p,u*=p,f*=p):(o=0,u=0,f=0),s=d*f-h*u,l=h*o-m*f,c=m*u-d*o,p=Math.sqrt(s*s+l*l+c*c),p?(p=1/p,s*=p,l*=p,c*=p):(s=0,l=0,c=0),t[0]=o,t[1]=s,t[2]=m,t[3]=0,t[4]=u,t[5]=l,t[6]=d,t[7]=0,t[8]=f,t[9]=c,t[10]=h,t[11]=0,t[12]=-(o*b+u*v+f*g),t[13]=-(s*b+l*v+c*g),t[14]=-(m*b+d*v+h*g),t[15]=1,t)},a.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},a.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},a.equals=function(t,e){var n=t[0],a=t[1],i=t[2],o=t[3],u=t[4],f=t[5],s=t[6],l=t[7],c=t[8],m=t[9],d=t[10],h=t[11],p=t[12],b=t[13],v=t[14],g=t[15],x=e[0],y=e[1],M=e[2],S=e[3],w=e[4],D=e[5],I=e[6],F=e[7],A=e[8],E=e[9],_=e[10],k=e[11],z=e[12],T=e[13],O=e[14],L=e[15];return Math.abs(n-x)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(a-y)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(i-M)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(o-S)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(u-w)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(f-D)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(s-I)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(I))&&Math.abs(l-F)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(c-A)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(m-E)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(E))&&Math.abs(d-_)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(_))&&Math.abs(h-k)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(k))&&Math.abs(p-z)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(z))&&Math.abs(b-T)<=r.EPSILON*Math.max(1,Math.abs(b),Math.abs(T))&&Math.abs(v-O)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(g-L)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(L))},e.exports=a},{31:31}],36:[function(t,e,n){var r=t(31),a=t(34),i=t(38),o=t(39),u={};u.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.rotationTo=function(){var t=i.create(),e=i.fromValues(1,0,0),n=i.fromValues(0,1,0);return function(r,a,o){var f=i.dot(a,o);return f<-.999999?(i.cross(t,e,a),i.length(t)<1e-6&&i.cross(t,n,a),i.normalize(t,t),u.setAxisAngle(r,t,Math.PI),r):f>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(i.cross(t,a,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+f,u.normalize(r,r))}}(),u.setAxes=function(){var t=a.create();return function(e,n,r,a){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],u.normalize(e,u.fromMat3(e,t))}}(),u.clone=o.clone,u.fromValues=o.fromValues,u.copy=o.copy,u.set=o.set,u.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.setAxisAngle=function(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t},u.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return 0!=r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n},u.add=o.add,u.multiply=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],u=n[0],f=n[1],s=n[2],l=n[3];return t[0]=r*l+o*u+a*s-i*f,t[1]=a*l+o*f+i*u-r*s,t[2]=i*l+o*s+r*f-a*u,t[3]=o*l-r*u-a*f-i*s,t},u.mul=u.multiply,u.scale=o.scale,u.rotateX=function(t,e,n){n*=.5;var r=e[0],a=e[1],i=e[2],o=e[3],u=Math.sin(n),f=Math.cos(n);return t[0]=r*f+o*u,t[1]=a*f+i*u,t[2]=i*f-a*u,t[3]=o*f-r*u,t},u.rotateY=function(t,e,n){n*=.5;var r=e[0],a=e[1],i=e[2],o=e[3],u=Math.sin(n),f=Math.cos(n);return t[0]=r*f-i*u,t[1]=a*f+o*u,t[2]=i*f+r*u,t[3]=o*f-a*u,t},u.rotateZ=function(t,e,n){n*=.5;var r=e[0],a=e[1],i=e[2],o=e[3],u=Math.sin(n),f=Math.cos(n);return t[0]=r*f+a*u,t[1]=a*f-r*u,t[2]=i*f+o*u,t[3]=o*f-i*u,t},u.calculateW=function(t,e){var n=e[0],r=e[1],a=e[2];return t[0]=n,t[1]=r,t[2]=a,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-a*a)),t},u.dot=o.dot,u.lerp=o.lerp,u.slerp=function(t,e,n,r){var a,i,o,u,f,s=e[0],l=e[1],c=e[2],m=e[3],d=n[0],h=n[1],p=n[2],b=n[3];return i=s*d+l*h+c*p+m*b,i<0&&(i=-i,d=-d,h=-h,p=-p,b=-b),1-i>1e-6?(a=Math.acos(i),o=Math.sin(a),u=Math.sin((1-r)*a)/o,f=Math.sin(r*a)/o):(u=1-r,f=r),t[0]=u*s+f*d,t[1]=u*l+f*h,t[2]=u*c+f*p,t[3]=u*m+f*b,t},u.sqlerp=function(){var t=u.create(),e=u.create();return function(n,r,a,i,o,f){return u.slerp(t,r,o,f),u.slerp(e,a,i,f),u.slerp(n,t,e,2*f*(1-f)),n}}(),u.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n*n+r*r+a*a+i*i,u=o?1/o:0;return t[0]=-n*u,t[1]=-r*u,t[2]=-a*u,t[3]=i*u,t},u.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},u.length=o.length,u.len=u.length,u.squaredLength=o.squaredLength,u.sqrLen=u.squaredLength,u.normalize=o.normalize,u.fromMat3=function(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;n=Math.sqrt(e[3*a+a]-e[3*i+i]-e[3*o+o]+1),t[a]=.5*n,n=.5/n,t[3]=(e[3*i+o]-e[3*o+i])*n,t[i]=(e[3*i+a]+e[3*a+i])*n,t[o]=(e[3*o+a]+e[3*a+o])*n}return t},u.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},u.exactEquals=o.exactEquals,u.equals=o.equals,e.exports=u},{31:31,34:34,38:38,39:39}],37:[function(t,e,n){var r=t(31),a={};a.create=function(){var t=new r.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},a.clone=function(t){var e=new r.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},a.fromValues=function(t,e){var n=new r.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},a.set=function(t,e,n){return t[0]=e,t[1]=n,t},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},a.sub=a.subtract,a.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},a.mul=a.multiply,a.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},a.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},a.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},a.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},a.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},a.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},a.dist=a.distance,a.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},a.len=a.length,a.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},a.normalize=function(t,e){var n=e[0],r=e[1],a=n*n+r*r;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},a.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},a.lerp=function(t,e,n,r){var a=e[0],i=e[1];return t[0]=a+r*(n[0]-a),t[1]=i+r*(n[1]-i),t},a.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},a.transformMat2=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[2]*a,t[1]=n[1]*r+n[3]*a,t},a.transformMat2d=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[2]*a+n[4],t[1]=n[1]*r+n[3]*a+n[5],t},a.transformMat3=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[3]*a+n[6],t[1]=n[1]*r+n[4]*a+n[7],t},a.transformMat4=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[4]*a+n[12],t[1]=n[1]*r+n[5]*a+n[13],t},a.forEach=function(){var t=a.create();return function(e,n,r,a,i,o){var u,f;for(n||(n=2),r||(r=0),f=a?Math.min(a*n+r,e.length):e.length,u=r;u<f;u+=n)t[0]=e[u],t[1]=e[u+1],i(t,t,o),e[u]=t[0],e[u+1]=t[1];return e}}(),a.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},a.equals=function(t,e){var n=t[0],a=t[1],i=e[0],o=e[1];return Math.abs(n-i)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(a-o)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(o))},e.exports=a},{31:31}],38:[function(t,e,n){var r=t(31),a={};a.create=function(){var t=new r.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},a.clone=function(t){var e=new r.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},a.fromValues=function(t,e,n){var a=new r.ARRAY_TYPE(3);return a[0]=t,a[1]=e,a[2]=n,a},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},a.sub=a.subtract,a.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},a.mul=a.multiply,a.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},a.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},a.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},a.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},a.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},a.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2];return Math.sqrt(n*n+r*r+a*a)},a.dist=a.distance,a.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2];return n*n+r*r+a*a},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)},a.len=a.length,a.squaredLength=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},a.normalize=function(t,e){var n=e[0],r=e[1],a=e[2],i=n*n+r*r+a*a;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},a.cross=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=n[0],u=n[1],f=n[2];return t[0]=a*f-i*u,t[1]=i*o-r*f,t[2]=r*u-a*o,t},a.lerp=function(t,e,n,r){var a=e[0],i=e[1],o=e[2];return t[0]=a+r*(n[0]-a),t[1]=i+r*(n[1]-i),t[2]=o+r*(n[2]-o),t},a.hermite=function(t,e,n,r,a,i){var o=i*i,u=o*(2*i-3)+1,f=o*(i-2)+i,s=o*(i-1),l=o*(3-2*i);return t[0]=e[0]*u+n[0]*f+r[0]*s+a[0]*l,t[1]=e[1]*u+n[1]*f+r[1]*s+a[1]*l,t[2]=e[2]*u+n[2]*f+r[2]*s+a[2]*l,t},a.bezier=function(t,e,n,r,a,i){var o=1-i,u=o*o,f=i*i,s=u*o,l=3*i*u,c=3*f*o,m=f*i;return t[0]=e[0]*s+n[0]*l+r[0]*c+a[0]*m,t[1]=e[1]*s+n[1]*l+r[1]*c+a[1]*m,t[2]=e[2]*s+n[2]*l+r[2]*c+a[2]*m,t},a.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI,a=2*r.RANDOM()-1,i=Math.sqrt(1-a*a)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=a*e,t},a.transformMat4=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=n[3]*r+n[7]*a+n[11]*i+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*a+n[8]*i+n[12])/o,t[1]=(n[1]*r+n[5]*a+n[9]*i+n[13])/o,t[2]=(n[2]*r+n[6]*a+n[10]*i+n[14])/o,t},a.transformMat3=function(t,e,n){var r=e[0],a=e[1],i=e[2];return t[0]=r*n[0]+a*n[3]+i*n[6],t[1]=r*n[1]+a*n[4]+i*n[7],t[2]=r*n[2]+a*n[5]+i*n[8],t},a.transformQuat=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=n[0],u=n[1],f=n[2],s=n[3],l=s*r+u*i-f*a,c=s*a+f*r-o*i,m=s*i+o*a-u*r,d=-o*r-u*a-f*i;return t[0]=l*s+d*-o+c*-f-m*-u,t[1]=c*s+d*-u+m*-o-l*-f,t[2]=m*s+d*-f+l*-u-c*-o,t},a.rotateX=function(t,e,n,r){var a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[0],i[1]=a[1]*Math.cos(r)-a[2]*Math.sin(r),i[2]=a[1]*Math.sin(r)+a[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},a.rotateY=function(t,e,n,r){var a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[2]*Math.sin(r)+a[0]*Math.cos(r),i[1]=a[1],i[2]=a[2]*Math.cos(r)-a[0]*Math.sin(r),t[0]=i[0]+n[0],
t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},a.rotateZ=function(t,e,n,r){var a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[0]*Math.cos(r)-a[1]*Math.sin(r),i[1]=a[0]*Math.sin(r)+a[1]*Math.cos(r),i[2]=a[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},a.forEach=function(){var t=a.create();return function(e,n,r,a,i,o){var u,f;for(n||(n=3),r||(r=0),f=a?Math.min(a*n+r,e.length):e.length,u=r;u<f;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],i(t,t,o),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}(),a.angle=function(t,e){var n=a.fromValues(t[0],t[1],t[2]),r=a.fromValues(e[0],e[1],e[2]);a.normalize(n,n),a.normalize(r,r);var i=a.dot(n,r);return i>1?0:Math.acos(i)},a.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},a.equals=function(t,e){var n=t[0],a=t[1],i=t[2],o=e[0],u=e[1],f=e[2];return Math.abs(n-o)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(a-u)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-f)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))},e.exports=a},{31:31}],39:[function(t,e,n){var r=t(31),a={};a.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},a.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.fromValues=function(t,e,n,a){var i=new r.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=a,i},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.set=function(t,e,n,r,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},a.sub=a.subtract,a.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},a.mul=a.multiply,a.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},a.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},a.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},a.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},a.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},a.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return Math.sqrt(n*n+r*r+a*a+i*i)},a.dist=a.distance,a.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return n*n+r*r+a*a+i*i},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],n=t[1],r=t[2],a=t[3];return Math.sqrt(e*e+n*n+r*r+a*a)},a.len=a.length,a.squaredLength=function(t){var e=t[0],n=t[1],r=t[2],a=t[3];return e*e+n*n+r*r+a*a},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},a.normalize=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n*n+r*r+a*a+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=n*o,t[1]=r*o,t[2]=a*o,t[3]=i*o),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},a.lerp=function(t,e,n,r){var a=e[0],i=e[1],o=e[2],u=e[3];return t[0]=a+r*(n[0]-a),t[1]=i+r*(n[1]-i),t[2]=o+r*(n[2]-o),t[3]=u+r*(n[3]-u),t},a.random=function(t,e){return e=e||1,t[0]=r.RANDOM(),t[1]=r.RANDOM(),t[2]=r.RANDOM(),t[3]=r.RANDOM(),a.normalize(t,t),a.scale(t,t,e),t},a.transformMat4=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3];return t[0]=n[0]*r+n[4]*a+n[8]*i+n[12]*o,t[1]=n[1]*r+n[5]*a+n[9]*i+n[13]*o,t[2]=n[2]*r+n[6]*a+n[10]*i+n[14]*o,t[3]=n[3]*r+n[7]*a+n[11]*i+n[15]*o,t},a.transformQuat=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=n[0],u=n[1],f=n[2],s=n[3],l=s*r+u*i-f*a,c=s*a+f*r-o*i,m=s*i+o*a-u*r,d=-o*r-u*a-f*i;return t[0]=l*s+d*-o+c*-f-m*-u,t[1]=c*s+d*-u+m*-o-l*-f,t[2]=m*s+d*-f+l*-u-c*-o,t[3]=e[3],t},a.forEach=function(){var t=a.create();return function(e,n,r,a,i,o){var u,f;for(n||(n=4),r||(r=0),f=a?Math.min(a*n+r,e.length):e.length,u=r;u<f;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],i(t,t,o),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}(),a.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.equals=function(t,e){var n=t[0],a=t[1],i=t[2],o=t[3],u=e[0],f=e[1],s=e[2],l=e[3];return Math.abs(n-u)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-f)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(i-s)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-l)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},e.exports=a},{31:31}],40:[function(t,e,n){function r(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}e.exports=r},{}],41:[function(t,e,n){function r(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}e.exports=r},{}],42:[function(t,e,n){function r(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}e.exports=r},{}],43:[function(t,e,n){e.exports=function(t){"string"==typeof t&&(t=[t]);for(var e=[].slice.call(arguments,1),n=[],r=0;r<t.length-1;r++)n.push(t[r],e[r]||"");return n.push(t[r]),n.join("")}},{}],44:[function(t,e,n){(function(n){function r(t){return t?s[t]:s}function a(){f.forEach(function(t){s[u[t]]=!1})}function i(t){s[u[t.keyCode]]=!1}function o(t){s[u[t.keyCode]]=!0}var u=t(52),f=Object.keys(u),s={};a(),e.exports=r,n.browser&&(window.addEventListener("keydown",o,!1),window.addEventListener("keyup",i,!1),window.addEventListener("blur",a,!1))}).call(this,t(49))},{49:49,52:52}],45:[function(t,e,n){function r(t,e){function n(){this.prevX=this.x,this.prevY=this.y}var r=new a;return r.x=0,r.y=0,r.prevX=0,r.prevY=0,r.flush=n,"undefined"==typeof window?r:(e=e||t||window,t=t||document.body,e.addEventListener("mousemove",t===document.body||t===window?function(t){r.prevX=r.x,r.prevY=r.y,r.x=t.clientX,r.y=t.clientY,r.emit("move",t)}:function(e){r.prevX=r.x,r.prevY=r.y;var n=t.getBoundingClientRect();r.x=e.clientX-n.left,r.y=e.clientY-n.top,r.emit("move",e)},!1),r)}var a=t(5);e.exports=r},{5:5}],46:[function(t,e,n){function r(t,e){function n(t){if(o.right=!1,o[i[t.button]]=!0,o.emit("down",t),e){if(!t.preventDefault)return!1;t.preventDefault(),t.stopPropagation()}}function r(t){o.right=!1,o[i[t.button]]=!1,o.emit("up",t),e&&t.preventDefault&&(t.preventDefault(),t.stopPropagation())}var o=new a;return o.left=!1,o.right=!1,o.middle=!1,"undefined"!=typeof window&&(t=t||window,t.addEventListener("mousedown",n,!1),t.addEventListener("mouseup",r,!1),e&&t.addEventListener("contextmenu",function(t){return t.preventDefault&&t.preventDefault()&&!1},!1)),o}var a=t(5),i=["left","middle","right"];e.exports=r},{5:5}],47:[function(t,e,n){function r(t,e){t=t||0;for(var n=new Array(t),r=0;r<t;r++)n[r]=e;return n}e.exports=r},{}],48:[function(t,e,n){"use strict";function r(t,e,n){this.rotation=t,this.center=e,this.distance=n}function a(t,e){var n=e[0],r=e[1],a=(e[2],n*n+r*r);a>1&&(a=1),t[0]=-e[0],t[1]=e[1],t[2]=e[2]||Math.sqrt(1-a),t[3]=0}function i(t,e,n){t=t||[0,0,-1],e=e||[0,0,0],n=n||[0,1,0];var a=new r(l.create(),u.create(),1);return a.lookAt(t,e,n),a}var o=t(30),u=o.vec3,f=o.mat3,s=o.mat4,l=o.quat,c=new Float32Array(16),m=new Float32Array(16),d=r.prototype;d.view=function(t){return t||(t=s.create()),m[0]=m[1]=0,m[2]=-this.distance,s.fromRotationTranslation(t,l.conjugate(c,this.rotation),m),s.translate(t,t,u.negate(c,this.center)),t},d.lookAt=function(t,e,n){s.lookAt(c,t,e,n),f.fromMat4(c,c),l.fromMat3(this.rotation,c),u.copy(this.center,e),this.distance=u.distance(t,e)},d.pan=function(t){var e=this.distance;c[0]=-e*(t[0]||0),c[1]=e*(t[1]||0),c[2]=e*(t[2]||0),u.transformQuat(c,c,this.rotation),u.add(this.center,this.center,c)},d.zoom=function(t){this.distance+=t,this.distance<0&&(this.distance=0)},d.rotate=function(t,e){a(c,t),a(m,e),l.invert(m,m),l.multiply(c,c,m),l.length(c)<1e-6||(l.multiply(this.rotation,this.rotation,c),l.normalize(this.rotation,this.rotation))},e.exports=i},{30:30}],49:[function(t,e,n){function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function i(t){if(c===setTimeout)return setTimeout(t,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(t){if(m===clearTimeout)return clearTimeout(t);if((m===a||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(t);try{return m(t)}catch(e){try{return m.call(null,t)}catch(e){return m.call(this,t)}}}function u(){b&&h&&(b=!1,h.length?p=h.concat(p):v=-1,p.length&&f())}function f(){if(!b){var t=i(u);b=!0;for(var e=p.length;e;){for(h=p,p=[];++v<e;)h&&h[v].run();v=-1,e=p.length}h=null,b=!1,o(t)}}function s(t,e){this.fun=t,this.array=e}function l(){}var c,m,d=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(t){c=r}try{m="function"==typeof clearTimeout?clearTimeout:a}catch(t){m=a}}();var h,p=[],b=!1,v=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new s(t,e)),1!==p.length||b||i(f)},s.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=l,d.addListener=l,d.once=l,d.off=l,d.removeListener=l,d.removeAllListeners=l,d.emit=l,d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],50:[function(t,e,n){!function(t,r){"object"==typeof n&&"undefined"!=typeof e?e.exports=r():"function"==typeof define&&define.amd?define(r):t.createREGL=r()}(this,function(){"use strict";function t(t){return"undefined"!=typeof btoa?btoa(t):"base64:"+t}function e(t){var e=new Error("(regl) "+t);throw console.error(e),e}function n(t,n){t||e(n)}function r(t){return t?": "+t:""}function a(t,n,a){t in n||e("unknown parameter ("+t+")"+r(a)+". possible values: "+Object.keys(n).join())}function i(t,n){Kt(t)||e("invalid parameter type"+r(n)+". must be a typed array")}function o(t,n,a){typeof t!==n&&e("invalid parameter type"+r(a)+". expected "+n+", got "+typeof t)}function u(t,n){t>=0&&(0|t)===t||e("invalid parameter type, ("+t+")"+r(n)+". must be a nonnegative integer")}function f(t,n,a){n.indexOf(t)<0&&e("invalid value"+r(a)+". must be one of: "+n)}function s(t){Object.keys(t).forEach(function(t){te.indexOf(t)<0&&e('invalid regl constructor argument "'+t+'". must be one of '+te)})}function l(t,e){for(t+="";t.length<e;)t=" "+t;return t}function c(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function m(t,e){this.number=t,this.line=e,this.errors=[]}function d(t,e,n){this.file=t,this.line=e,this.message=n}function h(){var t=new Error,e=(t.stack||t).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(e);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(e);return r?r[1]:"unknown"}function p(){var t=new Error,e=(t.stack||t).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(e);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(e);return r?r[1]:"unknown"}function b(e,n){var r=e.split("\n"),a=1,i=0,o={unknown:new c,0:new c};o.unknown.name=o[0].name=n||h(),o.unknown.lines.push(new m(0,""));for(var u=0;u<r.length;++u){var f=r[u],s=/^\s*\#\s*(\w+)\s+(.+)\s*$/.exec(f);if(s)switch(s[1]){case"line":var l=/(\d+)(\s+\d+)?/.exec(s[2]);l&&(a=0|l[1],l[2]&&(i=0|l[2],i in o||(o[i]=new c)));break;case"define":var d=/SHADER_NAME(_B64)?\s+(.*)$/.exec(s[2]);d&&(o[i].name=d[1]?t(d[2]):d[2])}o[i].lines.push(new m(a++,f))}return Object.keys(o).forEach(function(t){var e=o[t];e.lines.forEach(function(t){e.index[t.number]=t})}),o}function v(t){var e=[];return t.split("\n").forEach(function(t){if(!(t.length<5)){var n=/^ERROR\:\s+(\d+)\:(\d+)\:\s*(.*)$/.exec(t);n?e.push(new d(0|n[1],0|n[2],n[3].trim())):t.length>0&&e.push(new d("unknown",0,t))}}),e}function g(t,e){e.forEach(function(e){var n=t[e.file];if(n){var r=n.index[e.line];if(r)return r.errors.push(e),void(n.hasErrors=!0)}t.unknown.hasErrors=!0,t.unknown.lines[0].errors.push(e)})}function x(t,e,r,a,i){if(!t.getShaderParameter(e,t.COMPILE_STATUS)){var o=t.getShaderInfoLog(e),u=a===t.FRAGMENT_SHADER?"fragment":"vertex";F(r,"string",u+" shader source must be a string",i);var f=b(r,i),s=v(o);g(f,s),Object.keys(f).forEach(function(t){function e(t,e){r.push(t),a.push(e||"")}var n=f[t];if(n.hasErrors){var r=[""],a=[""];e("file number "+t+": "+n.name+"\n","color:red;text-decoration:underline;font-weight:bold"),n.lines.forEach(function(t){if(t.errors.length>0){e(l(t.number,4)+"|  ","background-color:yellow; font-weight:bold"),e(t.line+"\n","color:red; background-color:yellow; font-weight:bold");var n=0;t.errors.forEach(function(r){var a=r.message,i=/^\s*\'(.*)\'\s*\:\s*(.*)$/.exec(a);if(i){var o=i[1];switch(a=i[2],o){case"assign":o="="}n=Math.max(t.line.indexOf(o,n),0)}else n=0;e(l("| ",6)),e(l("^^^",n+3)+"\n","font-weight:bold"),e(l("| ",6)),e(a+"\n","font-weight:bold")}),e(l("| ",6)+"\n")}else e(l(t.number,4)+"|  "),e(t.line+"\n","color:red")}),"undefined"!=typeof document?(a[0]=r.join("%c"),console.log.apply(console,a)):console.log(r.join(""))}}),n.raise("Error compiling "+u+" shader, "+f[0].name)}}function y(t,e,r,a,i){if(!t.getProgramParameter(e,t.LINK_STATUS)){var o=t.getProgramInfoLog(e),u=b(r,i),f=b(a,i),s='Error linking program with vertex shader, "'+f[0].name+'", and fragment shader "'+u[0].name+'"';"undefined"!=typeof document?console.log("%c"+s+"\n%c"+o,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(s+"\n"+o),n.raise(s)}}function M(t){t._commandRef=h()}function S(t,e,n,r){function a(t){return t?r.id(t):0}function i(t,e){Object.keys(e).forEach(function(e){t[r.id(e)]=!0})}M(t),t._fragId=a(t.static.frag),t._vertId=a(t.static.vert);var o=t._uniformSet={};i(o,e.static),i(o,e.dynamic);var u=t._attributeSet={};i(u,n.static),i(u,n.dynamic),t._hasCount="count"in t.static||"count"in t.dynamic||"elements"in t.static||"elements"in t.dynamic}function w(t,n){var r=p();e(t+" in command "+(n||h())+("unknown"===r?"":" called from "+r))}function D(t,e,n){t||w(e,n||h())}function I(t,e,n,a){t in e||w("unknown parameter ("+t+")"+r(n)+". possible values: "+Object.keys(e).join(),a||h())}function F(t,e,n,a){typeof t!==e&&w("invalid parameter type"+r(n)+". expected "+e+", got "+typeof t,a||h())}function A(t){t()}function E(t,e,n){t.texture?f(t.texture._texture.internalformat,e,"unsupported texture format for attachment"):f(t.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")}function _(t,e){return t===pe||t===he||t===be?2:t===ve?4:xe[t]*e}function k(t){return!(t&t-1||!t)}function z(t,e,r){var a,i=e.width,o=e.height,u=e.channels;n(i>0&&i<=r.maxTextureSize&&o>0&&o<=r.maxTextureSize,"invalid texture shape"),t.wrapS===ee&&t.wrapT===ee||n(k(i)&&k(o),"incompatible wrap mode for texture, both width and height must be power of 2"),1===e.mipmask?1!==i&&1!==o&&n(t.minFilter!==re&&t.minFilter!==ie&&t.minFilter!==ae&&t.minFilter!==oe,"min filter requires mipmap"):(n(k(i)&&k(o),"texture must be a square power of 2 to support mipmapping"),n(e.mipmask===(i<<1)-1,"missing or incomplete mipmap data")),e.type===de&&(r.extensions.indexOf("oes_texture_float_linear")<0&&n(t.minFilter===ne&&t.magFilter===ne,"filter not supported, must enable oes_texture_float_linear"),n(!t.genMipmaps,"mipmap generation not supported with float textures"));var f=e.images;for(a=0;a<16;++a)if(f[a]){var s=i>>a,l=o>>a;n(e.mipmask&1<<a,"missing mipmap data");var c=f[a];if(n(c.width===s&&c.height===l,"invalid shape for mip images"),n(c.format===e.format&&c.internalformat===e.internalformat&&c.type===e.type,"incompatible type for mip image"),c.compressed);else if(c.data){var m=Math.ceil(_(c.type,u)*s/c.unpackAlignment)*c.unpackAlignment;n(c.data.byteLength===m*l,"invalid data for image, buffer size is inconsistent with image format")}else c.element||c.copy}else t.genMipmaps||n(0===(e.mipmask&1<<a),"extra mipmap data");e.compressed&&n(!t.genMipmaps,"mipmap generation for compressed images not supported")}function T(t,e,r,a){var i=t.width,o=t.height,u=t.channels;n(i>0&&i<=a.maxTextureSize&&o>0&&o<=a.maxTextureSize,"invalid texture shape"),n(i===o,"cube map must be square"),n(e.wrapS===ee&&e.wrapT===ee,"wrap mode not supported by cube map");for(var f=0;f<r.length;++f){var s=r[f];n(s.width===i&&s.height===o,"inconsistent cube map face shape"),e.genMipmaps&&(n(!s.compressed,"can not generate mipmap for compressed textures"),n(1===s.mipmask,"can not specify mipmaps and generate mipmaps"));for(var l=s.images,c=0;c<16;++c){var m=l[c];if(m){var d=i>>c,h=o>>c;n(s.mipmask&1<<c,"missing mipmap data"),n(m.width===d&&m.height===h,"invalid shape for mip images"),n(m.format===t.format&&m.internalformat===t.internalformat&&m.type===t.type,"incompatible type for mip image"),m.compressed||(m.data?n(m.data.byteLength===d*h*Math.max(_(m.type,u),m.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):m.element||m.copy)}}}}function O(t,e){this.id=Me++,this.type=t,this.data=e}function L(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function P(t){if(0===t.length)return[];var e=t.charAt(0),n=t.charAt(t.length-1);if(t.length>1&&e===n&&('"'===e||"'"===e))return['"'+L(t.substr(1,t.length-2))+'"'];var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t);if(r)return P(t.substr(0,r.index)).concat(P(r[1])).concat(P(t.substr(r.index+r[0].length)));var a=t.split(".");if(1===a.length)return['"'+L(t)+'"'];for(var i=[],o=0;o<a.length;++o)i=i.concat(P(a[o]));return i}function j(t){return"["+P(t).join("][")+"]"}function C(t,e){return new O(t,j(e+""))}function R(t){return"function"==typeof t&&!t._reglType||t instanceof O}function q(t,e){return"function"==typeof t?new O(Se,t):t}function N(){var t={"":0},e=[""];return{id:function(n){var r=t[n];return r?r:(r=t[n]=e.length,e.push(n),r)},str:function(t){return e[t]}}}function B(t,e,n){function r(){var e=window.innerWidth,r=window.innerHeight;if(t!==document.body){var a=t.getBoundingClientRect();e=a.right-a.left,r=a.bottom-a.top}i.width=n*e,i.height=n*r,Jt(i.style,{width:e+"px",height:r+"px"})}function a(){window.removeEventListener("resize",r),t.removeChild(i)}var i=document.createElement("canvas");return Jt(i.style,{border:0,margin:0,padding:0,top:0,left:0}),t.appendChild(i),t===document.body&&(i.style.position="absolute",Jt(t.style,{margin:0,padding:0})),window.addEventListener("resize",r,!1),r(),{canvas:i,onDestroy:a}}function Y(t,e){function n(n){try{return t.getContext(n,e)}catch(t){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function U(t){return"string"==typeof t.nodeName&&"function"==typeof t.appendChild&&"function"==typeof t.getBoundingClientRect}function V(t){return"function"==typeof t.drawArrays||"function"==typeof t.drawElements}function W(t){return"string"==typeof t?t.split():(ye(Array.isArray(t),"invalid extension array"),t)}function H(t){return"string"==typeof t?(ye("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(t)):t}function G(t){var e,n,r,a,i=t||{},o={},u=[],f=[],s="undefined"==typeof window?1:window.devicePixelRatio,l=!1,c=function(t){t&&ye.raise(t)},m=function(){};if("string"==typeof i?(ye("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),e=document.querySelector(i),ye(e,"invalid query string for element")):"object"==typeof i?U(i)?e=i:V(i)?(a=i,r=a.canvas):(ye.constructor(i),"gl"in i?a=i.gl:"canvas"in i?r=H(i.canvas):"container"in i&&(n=H(i.container)),"attributes"in i&&(o=i.attributes,ye.type(o,"object","invalid context attributes")),"extensions"in i&&(u=W(i.extensions)),"optionalExtensions"in i&&(f=W(i.optionalExtensions)),"onDone"in i&&(ye.type(i.onDone,"function","invalid or missing onDone callback"),c=i.onDone),"profile"in i&&(l=!!i.profile),"pixelRatio"in i&&(s=+i.pixelRatio,ye(s>0,"invalid pixel ratio"))):ye.raise("invalid arguments to regl"),e&&("canvas"===e.nodeName.toLowerCase()?r=e:n=e),!a){if(!r){ye("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var d=B(n||document.body,c,s);if(!d)return null;r=d.canvas,m=d.onDestroy}a=Y(r,o)}return a?{gl:a,canvas:r,container:n,extensions:u,optionalExtensions:f,pixelRatio:s,profile:l,onDone:c,onDestroy:m}:(m(),c("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function X(t,e){function n(e){ye.type(e,"string","extension name must be string");var n,a=e.toLowerCase();try{n=r[a]=t.getExtension(a)}catch(t){}return!!n}for(var r={},a=0;a<e.extensions.length;++a){var i=e.extensions[a];if(!n(i))return e.onDestroy(),e.onDone('"'+i+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach(function(t){if(!n(t))throw new Error("(regl): error restoring extension "+t)})}}}function Q(t){return!!t&&"object"==typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"==typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||Kt(t.data))}function Z(t,e){for(var n=Array(t),r=0;r<t;++r)n[r]=e(r);return n}function $(t){for(var e=16;e<=1<<28;e*=16)if(t<=e)return e;return 0}function K(t){var e,n;return e=(t>65535)<<4,t>>>=e,n=(t>255)<<3,t>>>=n,e|=n,n=(t>15)<<2,t>>>=n,e|=n,n=(t>3)<<1,t>>>=n,e|=n,e|t>>1}function J(t){var e=$(t),n=sn[K(e)>>2];return n.length>0?n.pop():new ArrayBuffer(e)}function tt(t){sn[K(t.byteLength)>>2].push(t)}function et(t,e){var n=null;switch(t){case en:n=new Int8Array(J(e),0,e);break;case nn:n=new Uint8Array(J(e),0,e);break;case rn:n=new Int16Array(J(2*e),0,e);break;case an:n=new Uint16Array(J(2*e),0,e);break;case on:n=new Int32Array(J(4*e),0,e);break;case un:n=new Uint32Array(J(4*e),0,e);break;case fn:n=new Float32Array(J(4*e),0,e);break;default:return null}return n.length!==e?n.subarray(0,e):n}function nt(t){tt(t.buffer)}function rt(t,e,n){for(var r=0;r<e;++r)n[r]=t[r]}function at(t,e,n,r){for(var a=0,i=0;i<e;++i)for(var o=t[i],u=0;u<n;++u)r[a++]=o[u]}function it(t,e,n,r,a,i){for(var o=i,u=0;u<e;++u)for(var f=t[u],s=0;s<n;++s)for(var l=f[s],c=0;c<r;++c)a[o++]=l[c]}function ot(t,e,n,r,a){for(var i=1,o=n+1;o<e.length;++o)i*=e[o];var u=e[n];if(e.length-n===4){var f=e[n+1],s=e[n+2],l=e[n+3];for(o=0;o<u;++o)it(t[o],f,s,l,r,a),a+=i}else for(o=0;o<u;++o)ot(t[o],e,n+1,r,a),a+=i}function ut(t,e,n,r){var a=1;if(e.length)for(var i=0;i<e.length;++i)a*=e[i];else a=0;var o=r||ln.allocType(n,a);switch(e.length){case 0:break;case 1:rt(t,e[0],o);break;case 2:at(t,e[0],e[1],o);break;case 3:it(t,e[0],e[1],e[2],o,0);break;default:ot(t,e,0,o,0)}return o}function ft(t){for(var e=[],n=t;n.length;n=n[0])e.push(n.length);return e}function st(t){return 0|$t[Object.prototype.toString.call(t)]}function lt(t,e){for(var n=0;n<e.length;++n)t[n]=e[n]}function ct(t,e,n,r,a,i,o){for(var u=0,f=0;f<n;++f)for(var s=0;s<r;++s)t[u++]=e[a*f+i*s+o]}function mt(t,e,n){function r(e){this.id=c++,this.buffer=t.createBuffer(),this.type=e,this.usage=Fn,this.byteLength=0,this.dimension=1,this.dtype=En,this.persistentData=null,n.profile&&(this.stats={size:0})}function a(t,e){var n=d.pop();return n||(n=new r(t)),n.bind(),u(n,e,An,0,1,!1),n}function i(t){d.push(t)}function o(e,n,r){e.byteLength=n.byteLength,t.bufferData(e.type,n,r)}function u(t,e,n,r,a,i){var u;if(t.usage=n,Array.isArray(e)){if(t.dtype=r||_n,e.length>0){var f;if(Array.isArray(e[0])){u=In(e);for(var s=1,l=1;l<u.length;++l)s*=u[l];t.dimension=s,f=Dn(e,u,t.dtype),o(t,f,n),i?t.persistentData=f:ln.freeType(f)}else if("number"==typeof e[0]){t.dimension=a;var c=ln.allocType(t.dtype,e.length);lt(c,e),o(t,c,n),i?t.persistentData=c:ln.freeType(c)}else Kt(e[0])?(t.dimension=e[0].length,t.dtype=r||st(e[0])||_n,f=Dn(e,[e.length,e[0].length],t.dtype),o(t,f,n),i?t.persistentData=f:ln.freeType(f)):ye.raise("invalid buffer data")}}else if(Kt(e))t.dtype=r||st(e),t.dimension=a,o(t,e,n),i&&(t.persistentData=new Uint8Array(new Uint8Array(e.buffer)));else if(Q(e)){u=e.shape;var m=e.stride,d=e.offset,h=0,p=0,b=0,v=0;1===u.length?(h=u[0],p=1,b=m[0],v=0):2===u.length?(h=u[0],p=u[1],b=m[0],v=m[1]):ye.raise("invalid shape"),t.dtype=r||st(e.data)||_n,t.dimension=p;var g=ln.allocType(t.dtype,h*p);ct(g,e.data,h,p,b,v,d),o(t,g,n),i?t.persistentData=g:ln.freeType(g)}else ye.raise("invalid buffer data")}function f(n){e.bufferCount--;var r=n.buffer;ye(r,"buffer must not be deleted already"),t.deleteBuffer(r),n.buffer=null,delete m[n.id]}function s(a,i,o,s){function l(e){var r=Fn,a=null,i=0,o=0,f=1;return Array.isArray(e)||Kt(e)||Q(e)?a=e:"number"==typeof e?i=0|e:e&&(ye.type(e,"object","buffer arguments must be an object, a number or an array"),"data"in e&&(ye(null===a||Array.isArray(a)||Kt(a)||Q(a),"invalid data for buffer"),a=e.data),"usage"in e&&(ye.parameter(e.usage,wn,"invalid buffer usage"),r=wn[e.usage]),"type"in e&&(ye.parameter(e.type,yn,"invalid buffer type"),o=yn[e.type]),"dimension"in e&&(ye.type(e.dimension,"number","invalid dimension"),f=0|e.dimension),"length"in e&&(ye.nni(i,"buffer length must be a nonnegative integer"),i=0|e.length)),h.bind(),a?u(h,a,r,o,f,s):(t.bufferData(h.type,i,r),h.dtype=o||En,h.usage=r,h.dimension=f,h.byteLength=i),n.profile&&(h.stats.size=h.byteLength*kn[h.dtype]),l}function c(e,n){ye(n+e.byteLength<=h.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+e.byteLength+" starting from offset "+n+" to a buffer of size "+h.byteLength),t.bufferSubData(h.type,n,e)}function d(t,e){var n,r=0|(e||0);if(h.bind(),Array.isArray(t)){if(t.length>0)if("number"==typeof t[0]){var a=ln.allocType(h.dtype,t.length);lt(a,t),c(a,r),ln.freeType(a)}else if(Array.isArray(t[0])||Kt(t[0])){n=In(t);var i=Dn(t,n,h.dtype);c(i,r),ln.freeType(i)}else ye.raise("invalid buffer data")}else if(Kt(t))c(t,r);else if(Q(t)){n=t.shape;var o=t.stride,u=0,f=0,s=0,m=0;1===n.length?(u=n[0],f=1,s=o[0],m=0):2===n.length?(u=n[0],f=n[1],s=o[0],m=o[1]):ye.raise("invalid shape");var d=Array.isArray(t.data)?h.dtype:st(t.data),p=ln.allocType(d,u*f);ct(p,t.data,u,f,s,m,t.offset),c(p,r),ln.freeType(p)}else ye.raise("invalid data for buffer subdata");return l}e.bufferCount++;var h=new r(i);return m[h.id]=h,o||l(a),l._reglType="buffer",l._buffer=h,l.subdata=d,n.profile&&(l.stats=h.stats),l.destroy=function(){f(h)},l}function l(){tn(m).forEach(function(e){e.buffer=t.createBuffer(),t.bindBuffer(e.type,e.buffer),t.bufferData(e.type,e.persistentData||e.byteLength,e.usage)})}var c=0,m={};r.prototype.bind=function(){t.bindBuffer(this.type,this.buffer)},r.prototype.destroy=function(){f(this)};var d=[];return n.profile&&(e.getTotalBufferSize=function(){var t=0;return Object.keys(m).forEach(function(e){t+=m[e].stats.size}),t}),{create:s,createStream:a,destroyStream:i,clear:function(){tn(m).forEach(f),d.forEach(f)},getBuffer:function(t){return t&&t._buffer instanceof r?t._buffer:null},restore:l,_initBuffer:u}}function dt(t,e,n,r){function a(t){this.id=c++,l[this.id]=this,this.buffer=t,this.primType=Nn,this.vertCount=0,this.type=0}function i(t){var e=d.pop();return e||(e=new a(n.create(null,Gn,!0,!1)._buffer)),u(e,t,Xn,-1,-1,0,0),e}function o(t){d.push(t)}function u(r,a,i,o,u,f,s){if(r.buffer.bind(),a){var l=s;s||Kt(a)&&(!Q(a)||Kt(a.data))||(l=e.oes_element_index_uint?Hn:Vn),n._initBuffer(r.buffer,a,i,l,3)}else t.bufferData(Gn,f,i),r.buffer.dtype=c||Yn,r.buffer.usage=i,r.buffer.dimension=3,r.buffer.byteLength=f;var c=s;if(!s){switch(r.buffer.dtype){case Yn:case Bn:c=Yn;break;case Vn:case Un:c=Vn;break;case Hn:case Wn:c=Hn;break;default:ye.raise("unsupported type for element array")}r.buffer.dtype=c}r.type=c,ye(c!==Hn||!!e.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var m=u;m<0&&(m=r.buffer.byteLength,c===Vn?m>>=1:c===Hn&&(m>>=2)),r.vertCount=m;var d=o;if(o<0){d=Nn;var h=r.buffer.dimension;1===h&&(d=Rn),2===h&&(d=qn),3===h&&(d=Nn)}r.primType=d}function f(t){r.elementsCount--,ye(null!==t.buffer,"must not double destroy elements"),delete l[t.id],t.buffer.destroy(),t.buffer=null}function s(t,e){function i(t){if(t)if("number"==typeof t)o(t),s.primType=Nn,s.vertCount=0|t,s.type=Yn;else{var e=null,n=Qn,r=-1,a=-1,f=0,l=0;Array.isArray(t)||Kt(t)||Q(t)?e=t:(ye.type(t,"object","invalid arguments for elements"),"data"in t&&(e=t.data,ye(Array.isArray(e)||Kt(e)||Q(e),"invalid data for element buffer")),"usage"in t&&(ye.parameter(t.usage,wn,"invalid element buffer usage"),n=wn[t.usage]),"primitive"in t&&(ye.parameter(t.primitive,Cn,"invalid element buffer primitive"),r=Cn[t.primitive]),"count"in t&&(ye("number"==typeof t.count&&t.count>=0,"invalid vertex count for elements"),a=0|t.count),"type"in t&&(ye.parameter(t.type,m,"invalid buffer type"),l=m[t.type]),"length"in t?f=0|t.length:(f=a,l===Vn||l===Un?f*=2:l!==Hn&&l!==Wn||(f*=4))),u(s,e,n,r,a,f,l)}else o(),s.primType=Nn,s.vertCount=0,s.type=Yn;return i}var o=n.create(null,Gn,!0),s=new a(o._buffer);return r.elementsCount++,i(t),i._reglType="elements",i._elements=s,i.subdata=function(t,e){return o.subdata(t,e),i},i.destroy=function(){f(s)},i}var l={},c=0,m={uint8:Yn,uint16:Vn};e.oes_element_index_uint&&(m.uint32=Hn),a.prototype.bind=function(){this.buffer.bind()};var d=[];return{create:s,createStream:i,destroyStream:o,getElements:function(t){return"function"==typeof t&&t._elements instanceof a?t._elements:null},clear:function(){tn(l).forEach(f)}}}function ht(t){for(var e=ln.allocType(Kn,t.length),n=0;n<t.length;++n)if(isNaN(t[n]))e[n]=65535;else if(t[n]===1/0)e[n]=31744;else if(t[n]===-(1/0))e[n]=64512;else{Zn[0]=t[n];var r=$n[0],a=r>>>31<<15,i=(r<<1>>>24)-127,o=r>>13&1023;if(i<-24)e[n]=a;else if(i<-14){var u=-14-i;e[n]=a+(o+1024>>u)}else i>15?e[n]=a+31744:e[n]=a+(i+15<<10)+o}return e}function pt(t){return Array.isArray(t)||Kt(t)}function bt(t){return"[object "+t+"]"}function vt(t){return Array.isArray(t)&&(0===t.length||"number"==typeof t[0])}function gt(t){if(!Array.isArray(t))return!1;var e=t.length;return!(0===e||!pt(t[0]))}function xt(t){return Object.prototype.toString.call(t)}function yt(t){return xt(t)===sa}function Mt(t){return xt(t)===la}function St(t){return xt(t)===ca}function wt(t){return xt(t)===ma}function Dt(t){if(!t)return!1;var e=xt(t);return da.indexOf(e)>=0||(vt(t)||gt(t)||Q(t))}function It(t){return 0|$t[Object.prototype.toString.call(t)]}function Ft(t,e){var n=e.length;switch(t.type){case Tr:case Or:case Lr:case Pr:var r=ln.allocType(t.type,n);r.set(e),t.data=r;break;case xr:t.data=ht(e);break;default:ye.raise("unsupported texture type, must specify a typed array")}}function At(t,e){return ln.allocType(t.type===xr?Pr:t.type,e)}function Et(t,e){t.type===xr?(t.data=ht(e),ln.freeType(e)):t.data=e}function _t(t,e,n,r,a,i){for(var o=t.width,u=t.height,f=t.channels,s=o*u*f,l=At(t,s),c=0,m=0;m<u;++m)for(var d=0;d<o;++d)for(var h=0;h<f;++h)l[c++]=e[n*d+r*m+a*h+i];Et(t,l)}function kt(t,e,n,r,a,i){var o;if(o="undefined"!=typeof pa[t]?pa[t]:fa[t]*ha[e],i&&(o*=6),a){for(var u=0,f=n;f>=1;)u+=o*f*f,f/=2;return u}return o*n*r}function zt(t,e,n,r,a,i,o){function u(){this.internalformat=rr,this.format=rr,this.type=Tr,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=0,this.width=0,this.height=0,this.channels=0}function f(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,
t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function s(t,r){if("object"==typeof r&&r){if("premultiplyAlpha"in r&&(ye.type(r.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),t.premultiplyAlpha=r.premultiplyAlpha),"flipY"in r&&(ye.type(r.flipY,"boolean","invalid texture flip"),t.flipY=r.flipY),"alignment"in r&&(ye.oneOf(r.alignment,[1,2,4,8],"invalid texture unpack alignment"),t.unpackAlignment=r.alignment),"colorSpace"in r&&(ye.parameter(r.colorSpace,R,"invalid colorSpace"),t.colorSpace=R[r.colorSpace]),"type"in r){var a=r.type;ye(e.oes_texture_float||!("float"===a||"float32"===a),"you must enable the OES_texture_float extension in order to use floating point textures."),ye(e.oes_texture_half_float||!("half float"===a||"float16"===a),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),ye(e.webgl_depth_texture||!("uint16"===a||"uint32"===a||"depth stencil"===a),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),ye.parameter(a,q,"invalid texture type"),t.type=q[a]}var i=t.width,o=t.height,u=t.channels,f=!1;"shape"in r?(ye(Array.isArray(r.shape)&&r.shape.length>=2,"shape must be an array"),i=r.shape[0],o=r.shape[1],3===r.shape.length&&(u=r.shape[2],ye(u>0&&u<=4,"invalid number of channels"),f=!0),ye(i>=0&&i<=n.maxTextureSize,"invalid width"),ye(o>=0&&o<=n.maxTextureSize,"invalid height")):("radius"in r&&(i=o=r.radius,ye(i>=0&&i<=n.maxTextureSize,"invalid radius")),"width"in r&&(i=r.width,ye(i>=0&&i<=n.maxTextureSize,"invalid width")),"height"in r&&(o=r.height,ye(o>=0&&o<=n.maxTextureSize,"invalid height")),"channels"in r&&(u=r.channels,ye(u>0&&u<=4,"invalid number of channels"),f=!0)),t.width=0|i,t.height=0|o,t.channels=0|u;var s=!1;if("format"in r){var l=r.format;ye(e.webgl_depth_texture||!("depth"===l||"depth stencil"===l),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),ye.parameter(l,N,"invalid texture format");var c=t.internalformat=N[l];t.format=Z[c],l in q&&("type"in r||(t.type=q[l])),l in B&&(t.compressed=!0),s=!0}!f&&s?t.channels=fa[t.format]:f&&!s?t.channels!==ua[t.format]&&(t.format=t.internalformat=ua[t.channels]):s&&f&&ye(t.channels===fa[t.format],"number of channels inconsistent with specified format")}}function l(e){t.pixelStorei(ea,e.flipY),t.pixelStorei(na,e.premultiplyAlpha),t.pixelStorei(ra,e.colorSpace),t.pixelStorei(ta,e.unpackAlignment)}function c(){u.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function m(t,e){var r=null;if(Dt(e)?r=e:e&&(ye.type(e,"object","invalid pixel data type"),s(t,e),"x"in e&&(t.xOffset=0|e.x),"y"in e&&(t.yOffset=0|e.y),Dt(e.data)&&(r=e.data)),ye(!t.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),e.copy){ye(!r,"can not specify copy and data field for the same texture");var i=a.viewportWidth,o=a.viewportHeight;t.width=t.width||i-t.xOffset,t.height=t.height||o-t.yOffset,t.needsCopy=!0,ye(t.xOffset>=0&&t.xOffset<i&&t.yOffset>=0&&t.yOffset<o&&t.width>0&&t.width<=i&&t.height>0&&t.height<=o,"copy texture read out of bounds")}else if(r){if(Kt(r))t.channels=t.channels||4,t.data=r,"type"in e||t.type!==Tr||(t.type=It(r));else if(vt(r))t.channels=t.channels||4,Ft(t,r),t.alignment=1,t.needsFree=!0;else if(Q(r)){var u=r.data;Array.isArray(u)||t.type!==Tr||(t.type=It(u));var f,l,c,m,d,h,p=r.shape,b=r.stride;3===p.length?(c=p[2],h=b[2]):(ye(2===p.length,"invalid ndarray pixel data, must be 2 or 3D"),c=1,h=1),f=p[0],l=p[1],m=b[0],d=b[1],t.alignment=1,t.width=f,t.height=l,t.channels=c,t.format=t.internalformat=ua[c],t.needsFree=!0,_t(t,u,m,d,h,r.offset)}else if(yt(r)||Mt(r))yt(r)?t.element=r:t.element=r.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(St(r))t.element=r,t.width=r.naturalWidth,t.height=r.naturalHeight,t.channels=4;else if(wt(r))t.element=r,t.width=r.videoWidth,t.height=r.videoHeight,t.channels=4;else if(gt(r)){var v=t.width||r[0].length,g=t.height||r.length,x=t.channels;x=pt(r[0][0])?x||r[0][0].length:x||1;for(var y=cn.shape(r),M=1,S=0;S<y.length;++S)M*=y[S];var w=At(t,M);cn.flatten(r,y,"",w),Et(t,w),t.alignment=1,t.width=v,t.height=g,t.channels=x,t.format=t.internalformat=ua[x],t.needsFree=!0}}else t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;t.type===Pr?ye(n.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):t.type===xr&&ye(n.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function d(e,n,a){var i=e.element,o=e.data,u=e.internalformat,f=e.format,s=e.type,c=e.width,m=e.height;l(e),i?t.texImage2D(n,a,f,f,s,i):e.compressed?t.compressedTexImage2D(n,a,u,c,m,0,o):e.needsCopy?(r(),t.copyTexImage2D(n,a,f,e.xOffset,e.yOffset,c,m,0)):t.texImage2D(n,a,f,c,m,0,f,s,o)}function h(e,n,a,i,o){var u=e.element,f=e.data,s=e.internalformat,c=e.format,m=e.type,d=e.width,h=e.height;l(e),u?t.texSubImage2D(n,o,a,i,c,m,u):e.compressed?t.compressedTexSubImage2D(n,o,a,i,s,d,h,f):e.needsCopy?(r(),t.copyTexSubImage2D(n,o,a,i,e.xOffset,e.yOffset,d,h)):t.texSubImage2D(n,o,a,i,d,h,c,m,f)}function p(){return $.pop()||new c}function b(t){t.needsFree&&ln.freeType(t.data),c.call(t),$.push(t)}function v(){u.call(this),this.genMipmaps=!1,this.mipmapHint=Zr,this.mipmask=0,this.images=Array(16)}function g(t,e,n){var r=t.images[0]=p();t.mipmask=1,r.width=t.width=e,r.height=t.height=n,r.channels=t.channels=4}function x(t,e){var n=null;if(Dt(e))n=t.images[0]=p(),f(n,t),m(n,e),t.mipmask=1;else if(s(t,e),Array.isArray(e.mipmap))for(var r=e.mipmap,a=0;a<r.length;++a)n=t.images[a]=p(),f(n,t),n.width>>=a,n.height>>=a,m(n,r[a]),t.mipmask|=1<<a;else n=t.images[0]=p(),f(n,t),m(n,e),t.mipmask=1;f(t,t.images[0]),(t.compressed&&t.internalformat===yr||t.internalformat===Mr||t.internalformat===Sr||t.internalformat===wr)&&ye(t.width%4===0&&t.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function y(t,e){for(var n=t.images,r=0;r<n.length;++r){if(!n[r])return;d(n[r],e,r)}}function M(){var t=K.pop()||new v;u.call(t),t.mipmask=0;for(var e=0;e<16;++e)t.images[e]=null;return t}function S(t){for(var e=t.images,n=0;n<e.length;++n)e[n]&&b(e[n]),e[n]=null;K.push(t)}function w(){this.minFilter=Ur,this.magFilter=Ur,this.wrapS=qr,this.wrapT=qr,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Zr}function D(t,e){if("min"in e){var r=e.min;ye.parameter(r,C),t.minFilter=C[r],oa.indexOf(t.minFilter)>=0&&(t.genMipmaps=!0)}if("mag"in e){var a=e.mag;ye.parameter(a,j),t.magFilter=j[a]}var i=t.wrapS,o=t.wrapT;if("wrap"in e){var u=e.wrap;"string"==typeof u?(ye.parameter(u,P),i=o=P[u]):Array.isArray(u)&&(ye.parameter(u[0],P),ye.parameter(u[1],P),i=P[u[0]],o=P[u[1]])}else{if("wrapS"in e){var f=e.wrapS;ye.parameter(f,P),i=P[f]}if("wrapT"in e){var s=e.wrapT;ye.parameter(s,P),o=P[s]}}if(t.wrapS=i,t.wrapT=o,"anisotropic"in e){var l=e.anisotropic;ye("number"==typeof l&&l>=1&&l<=n.maxAnisotropic,"aniso samples must be between 1 and "),t.anisotropic=e.anisotropic}if("mipmap"in e){var c=!1;switch(typeof e.mipmap){case"string":ye.parameter(e.mipmap,L,"invalid mipmap hint"),t.mipmapHint=L[e.mipmap],t.genMipmaps=!0,c=!0;break;case"boolean":c=t.genMipmaps=e.mipmap;break;case"object":ye(Array.isArray(e.mipmap),"invalid mipmap type"),t.genMipmaps=!1,c=!0;break;default:ye.raise("invalid mipmap type")}!c||"min"in e||(t.minFilter=Wr)}}function I(n,r){t.texParameteri(r,Yr,n.minFilter),t.texParameteri(r,Br,n.magFilter),t.texParameteri(r,jr,n.wrapS),t.texParameteri(r,Cr,n.wrapT),e.ext_texture_filter_anisotropic&&t.texParameteri(r,Jr,n.anisotropic),n.genMipmaps&&(t.hint(Qr,n.mipmapHint),t.generateMipmap(r))}function F(e){u.call(this),this.mipmask=0,this.internalformat=rr,this.id=J++,this.refCount=1,this.target=e,this.texture=t.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new w,o.profile&&(this.stats={size:0})}function A(e){t.activeTexture(ia),t.bindTexture(e.target,e.texture)}function E(){var e=nt[0];e?t.bindTexture(e.target,e.texture):t.bindTexture(tr,null)}function _(e){var n=e.texture;ye(n,"must not double destroy texture");var r=e.unit,a=e.target;r>=0&&(t.activeTexture(ia+r),t.bindTexture(a,null),nt[r]=null),t.deleteTexture(n),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete tt[e.id],i.textureCount--}function k(e,r){function a(t,e){var r=l.texInfo;w.call(r);var i=M();return"number"==typeof t?"number"==typeof e?g(i,0|t,0|e):g(i,0|t,0|t):t?(ye.type(t,"object","invalid arguments to regl.texture"),D(r,t),x(i,t)):g(i,1,1),r.genMipmaps&&(i.mipmask=(i.width<<1)-1),l.mipmask=i.mipmask,f(l,i),ye.texture2D(r,i,n),l.internalformat=i.internalformat,a.width=i.width,a.height=i.height,A(l),y(i,tr),I(r,tr),E(),S(i),o.profile&&(l.stats.size=kt(l.internalformat,l.type,i.width,i.height,r.genMipmaps,!1)),a.format=V[l.internalformat],a.type=W[l.type],a.mag=H[r.magFilter],a.min=G[r.minFilter],a.wrapS=X[r.wrapS],a.wrapT=X[r.wrapT],a}function u(t,e,n,r){ye(!!t,"must specify image data");var i=0|e,o=0|n,u=0|r,s=p();return f(s,l),s.width=0,s.height=0,m(s,t),s.width=s.width||(l.width>>u)-i,s.height=s.height||(l.height>>u)-o,ye(l.type===s.type&&l.format===s.format&&l.internalformat===s.internalformat,"incompatible format for texture.subimage"),ye(i>=0&&o>=0&&i+s.width<=l.width&&o+s.height<=l.height,"texture.subimage write out of bounds"),ye(l.mipmask&1<<u,"missing mipmap data"),ye(s.data||s.element||s.needsCopy,"missing image data"),A(l),h(s,tr,i,o,u),E(),b(s),a}function s(e,n){var r=0|e,i=0|n||r;if(r===l.width&&i===l.height)return a;a.width=l.width=r,a.height=l.height=i,A(l);for(var u=0;l.mipmask>>u;++u)t.texImage2D(tr,u,l.format,r>>u,i>>u,0,l.format,l.type,null);return E(),o.profile&&(l.stats.size=kt(l.internalformat,l.type,r,i,!1,!1)),a}var l=new F(tr);return tt[l.id]=l,i.textureCount++,a(e,r),a.subimage=u,a.resize=s,a._reglType="texture2d",a._texture=l,o.profile&&(a.stats=l.stats),a.destroy=function(){l.decRef()},a}function z(e,r,a,u,l,c){function d(t,e,r,a,i,u){var l,c=k.texInfo;for(w.call(c),l=0;l<6;++l)z[l]=M();if("number"!=typeof t&&t)if("object"==typeof t)if(e)x(z[0],t),x(z[1],e),x(z[2],r),x(z[3],a),x(z[4],i),x(z[5],u);else if(D(c,t),s(k,t),"faces"in t){var m=t.faces;for(ye(Array.isArray(m)&&6===m.length,"cube faces must be a length 6 array"),l=0;l<6;++l)ye("object"==typeof m[l]&&!!m[l],"invalid input for cube map face"),f(z[l],k),x(z[l],m[l])}else for(l=0;l<6;++l)x(z[l],t);else ye.raise("invalid arguments to cube map");else{var h=0|t||1;for(l=0;l<6;++l)g(z[l],h,h)}for(f(k,z[0]),c.genMipmaps?k.mipmask=(z[0].width<<1)-1:k.mipmask=z[0].mipmask,ye.textureCube(k,c,z,n),k.internalformat=z[0].internalformat,d.width=z[0].width,d.height=z[0].height,A(k),l=0;l<6;++l)y(z[l],nr+l);for(I(c,er),E(),o.profile&&(k.stats.size=kt(k.internalformat,k.type,d.width,d.height,c.genMipmaps,!0)),d.format=V[k.internalformat],d.type=W[k.type],d.mag=H[c.magFilter],d.min=G[c.minFilter],d.wrapS=X[c.wrapS],d.wrapT=X[c.wrapT],l=0;l<6;++l)S(z[l]);return d}function v(t,e,n,r,a){ye(!!e,"must specify image data"),ye("number"==typeof t&&t===(0|t)&&t>=0&&t<6,"invalid face");var i=0|n,o=0|r,u=0|a,s=p();return f(s,k),s.width=0,s.height=0,m(s,e),s.width=s.width||(k.width>>u)-i,s.height=s.height||(k.height>>u)-o,ye(k.type===s.type&&k.format===s.format&&k.internalformat===s.internalformat,"incompatible format for texture.subimage"),ye(i>=0&&o>=0&&i+s.width<=k.width&&o+s.height<=k.height,"texture.subimage write out of bounds"),ye(k.mipmask&1<<u,"missing mipmap data"),ye(s.data||s.element||s.needsCopy,"missing image data"),A(k),h(s,nr+t,i,o,u),E(),b(s),d}function _(e){var n=0|e;if(n!==k.width){d.width=k.width=n,d.height=k.height=n,A(k);for(var r=0;r<6;++r)for(var a=0;k.mipmask>>a;++a)t.texImage2D(nr+r,a,k.format,n>>a,n>>a,0,k.format,k.type,null);return E(),o.profile&&(k.stats.size=kt(k.internalformat,k.type,d.width,d.height,!1,!0)),d}}var k=new F(er);tt[k.id]=k,i.cubeCount++;var z=new Array(6);return d(e,r,a,u,l,c),d.subimage=v,d.resize=_,d._reglType="textureCube",d._texture=k,o.profile&&(d.stats=k.stats),d.destroy=function(){k.decRef()},d}function T(){for(var e=0;e<et;++e)t.activeTexture(ia+e),t.bindTexture(tr,null),nt[e]=null;tn(tt).forEach(_),i.cubeCount=0,i.textureCount=0}function O(){tn(tt).forEach(function(e){e.texture=t.createTexture(),t.bindTexture(e.target,e.texture);for(var n=0;n<32;++n)if(0!==(e.mipmask&1<<n))if(e.target===tr)t.texImage2D(tr,n,e.internalformat,e.width>>n,e.height>>n,0,e.internalformat,e.type,null);else for(var r=0;r<6;++r)t.texImage2D(nr+r,n,e.internalformat,e.width>>n,e.height>>n,0,e.internalformat,e.type,null);I(e.texInfo,e.target)})}var L={"don't care":Zr,"dont care":Zr,nice:Kr,fast:$r},P={repeat:Rr,clamp:qr,mirror:Nr},j={nearest:Ur,linear:Vr},C=Jt({mipmap:Xr,"nearest mipmap nearest":Wr,"linear mipmap nearest":Hr,"nearest mipmap linear":Gr,"linear mipmap linear":Xr},j),R={none:0,browser:aa},q={uint8:Tr,rgba4:cr,rgb565:dr,"rgb5 a1":mr},N={alpha:ar,luminance:or,"luminance alpha":ur,rgb:ir,rgba:rr,rgba4:fr,"rgb5 a1":sr,rgb565:lr},B={};e.ext_srgb&&(N.srgb=vr,N.srgba=gr),e.oes_texture_float&&(q.float32=q.float=Pr),e.oes_texture_half_float&&(q.float16=q["half float"]=xr),e.webgl_depth_texture&&(Jt(N,{depth:pr,"depth stencil":br}),Jt(q,{uint16:Or,uint32:Lr,"depth stencil":hr})),e.webgl_compressed_texture_s3tc&&Jt(B,{"rgb s3tc dxt1":yr,"rgba s3tc dxt1":Mr,"rgba s3tc dxt3":Sr,"rgba s3tc dxt5":wr}),e.webgl_compressed_texture_atc&&Jt(B,{"rgb atc":Dr,"rgba atc explicit alpha":Ir,"rgba atc interpolated alpha":Fr}),e.webgl_compressed_texture_pvrtc&&Jt(B,{"rgb pvrtc 4bppv1":Ar,"rgb pvrtc 2bppv1":Er,"rgba pvrtc 4bppv1":_r,"rgba pvrtc 2bppv1":kr}),e.webgl_compressed_texture_etc1&&(B["rgb etc1"]=zr);var Y=Array.prototype.slice.call(t.getParameter(Jn));Object.keys(B).forEach(function(t){var e=B[t];Y.indexOf(e)>=0&&(N[t]=e)});var U=Object.keys(N);n.textureFormats=U;var V=[];Object.keys(N).forEach(function(t){var e=N[t];V[e]=t});var W=[];Object.keys(q).forEach(function(t){var e=q[t];W[e]=t});var H=[];Object.keys(j).forEach(function(t){var e=j[t];H[e]=t});var G=[];Object.keys(C).forEach(function(t){var e=C[t];G[e]=t});var X=[];Object.keys(P).forEach(function(t){var e=P[t];X[e]=t});var Z=U.reduce(function(t,e){var n=N[e];return n===or||n===ar||n===or||n===ur||n===pr||n===br?t[n]=n:n===sr||e.indexOf("rgba")>=0?t[n]=rr:t[n]=ir,t},{}),$=[],K=[],J=0,tt={},et=n.maxTextureUnits,nt=Array(et).map(function(){return null});return Jt(F.prototype,{bind:function(){var e=this;e.bindCount+=1;var n=e.unit;if(n<0){for(var r=0;r<et;++r){var a=nt[r];if(a){if(a.bindCount>0)continue;a.unit=-1}nt[r]=e,n=r;break}n>=et&&ye.raise("insufficient number of texture units"),o.profile&&i.maxTextureUnits<n+1&&(i.maxTextureUnits=n+1),e.unit=n,t.activeTexture(ia+n),t.bindTexture(e.target,e.texture)}return n},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&_(this)}}),o.profile&&(i.getTotalTextureSize=function(){var t=0;return Object.keys(tt).forEach(function(e){t+=tt[e].stats.size}),t}),{create2D:k,createCube:z,clear:T,getTexture:function(t){return null},restore:O}}function Tt(t,e,n){return Aa[t]*e*n}function Ot(t,e,n,r,a,i){function o(t,e,n){this.target=t,this.texture=e,this.renderbuffer=n;var r=0,a=0;e?(r=e.width,a=e.height):n&&(r=n.width,a=n.height),this.width=r,this.height=a}function u(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function f(t,e,n){if(t)if(t.texture){var r=t.texture._texture,a=Math.max(1,r.width),i=Math.max(1,r.height);ye(a===e&&i===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var o=t.renderbuffer._renderbuffer;ye(o.width===e&&o.height===n,"inconsistent width/height for renderbuffer"),o.refCount+=1}}function s(e,n){n&&(n.texture?t.framebufferTexture2D(_a,e,n.target,n.texture._texture.texture,0):t.framebufferRenderbuffer(_a,e,ka,n.renderbuffer._renderbuffer.renderbuffer))}function l(t){var e=za,n=null,r=null,a=t;"object"==typeof t&&(a=t.data,"target"in t&&(e=0|t.target)),ye.type(a,"function","invalid attachment data");var i=a._reglType;return"texture2d"===i?(n=a,ye(e===za)):"textureCube"===i?(n=a,ye(e>=Ta&&e<Ta+6,"invalid cube map target")):"renderbuffer"===i?(r=a,e=ka):ye.raise("invalid regl object for attachment"),new o(e,n,r)}function c(t,e,n,i,u){if(n){var f=r.create2D({width:t,height:e,format:i,type:u});return f._texture.refCount=0,new o(za,f,null)}var s=a.create({width:t,height:e,format:i});return s._renderbuffer.refCount=0,new o(ka,null,s)}function m(t){return t&&(t.texture||t.renderbuffer)}function d(t,e,n){t&&(t.texture?t.texture.resize(e,n):t.renderbuffer&&t.renderbuffer.resize(e,n))}function h(){this.id=I++,F[this.id]=this,this.framebuffer=t.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function p(t){t.colorAttachments.forEach(u),u(t.depthAttachment),u(t.stencilAttachment),u(t.depthStencilAttachment)}function b(e){var n=e.framebuffer;ye(n,"must not double destroy framebuffer"),t.deleteFramebuffer(n),e.framebuffer=null,i.framebufferCount--,delete F[e.id]}function v(e){var r;t.bindFramebuffer(_a,e.framebuffer);var a=e.colorAttachments;for(r=0;r<a.length;++r)s(Oa+r,a[r]);for(r=a.length;r<n.maxColorAttachments;++r)t.framebufferTexture2D(_a,Oa+r,za,null,0);t.framebufferTexture2D(_a,ja,za,null,0),t.framebufferTexture2D(_a,La,za,null,0),t.framebufferTexture2D(_a,Pa,za,null,0),s(La,e.depthAttachment),s(Pa,e.stencilAttachment),s(ja,e.depthStencilAttachment);var i=t.checkFramebufferStatus(_a);i!==Ca&&ye.raise("framebuffer configuration not supported, status = "+ui[i]),t.bindFramebuffer(_a,M.next),M.cur=M.next,t.getError()}function g(t,r){function a(t,r){var i;ye(M.next!==u,"can not update framebuffer which is currently in use");var o=e.webgl_draw_buffers,s=0,d=0,h=!0,b=!0,g=null,x=!0,y="rgba",I="uint8",F=1,A=null,E=null,_=null,k=!1;if("number"==typeof t)s=0|t,d=0|r||s;else if(t){ye.type(t,"object","invalid arguments for framebuffer");var z=t;if("shape"in z){var T=z.shape;ye(Array.isArray(T)&&T.length>=2,"invalid shape for framebuffer"),s=T[0],d=T[1]}else"radius"in z&&(s=d=z.radius),"width"in z&&(s=z.width),"height"in z&&(d=z.height);("color"in z||"colors"in z)&&(g=z.color||z.colors,Array.isArray(g)&&ye(1===g.length||o,"multiple render targets not supported")),g||("colorCount"in z&&(F=0|z.colorCount,ye(F>0,"invalid color buffer count")),"colorTexture"in z&&(x=!!z.colorTexture,y="rgba4"),"colorType"in z&&(I=z.colorType,x?(ye(e.oes_texture_float||!("float"===I||"float32"===I),"you must enable OES_texture_float in order to use floating point framebuffer objects"),ye(e.oes_texture_half_float||!("half float"===I||"float16"===I),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===I||"float16"===I?(ye(e.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),y="rgba16f"):"float"!==I&&"float32"!==I||(ye(e.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),y="rgba32f"),ye.oneOf(I,D,"invalid color type")),"colorFormat"in z&&(y=z.colorFormat,S.indexOf(y)>=0?x=!0:w.indexOf(y)>=0?x=!1:x?ye.oneOf(z.colorFormat,S,"invalid color format for texture"):ye.oneOf(z.colorFormat,w,"invalid color format for renderbuffer"))),("depthTexture"in z||"depthStencilTexture"in z)&&(k=!(!z.depthTexture&&!z.depthStencilTexture),ye(!k||e.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in z&&("boolean"==typeof z.depth?h=z.depth:(A=z.depth,b=!1)),"stencil"in z&&("boolean"==typeof z.stencil?b=z.stencil:(E=z.stencil,h=!1)),"depthStencil"in z&&("boolean"==typeof z.depthStencil?h=b=z.depthStencil:(_=z.depthStencil,h=!1,b=!1))}else s=d=1;var O=null,L=null,P=null,j=null;if(Array.isArray(g))O=g.map(l);else if(g)O=[l(g)];else for(O=new Array(F),i=0;i<F;++i)O[i]=c(s,d,x,y,I);ye(e.webgl_draw_buffers||O.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),ye(O.length<=n.maxColorAttachments,"too many color attachments, not supported"),s=s||O[0].width,d=d||O[0].height,A?L=l(A):h&&!b&&(L=c(s,d,k,"depth","uint32")),E?P=l(E):b&&!h&&(P=c(s,d,!1,"stencil","uint8")),_?j=l(_):!A&&!E&&b&&h&&(j=c(s,d,k,"depth stencil","depth stencil")),ye(!!A+!!E+!!_<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var C=null;for(i=0;i<O.length;++i)if(f(O[i],s,d),ye(!O[i]||O[i].texture&&Ga.indexOf(O[i].texture._texture.format)>=0||O[i].renderbuffer&&oi.indexOf(O[i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+i+" is invalid"),O[i]&&O[i].texture){var R=Xa[O[i].texture._texture.format]*Qa[O[i].texture._texture.type];null===C?C=R:ye(C===R,"all color attachments much have the same number of bits per pixel.")}return f(L,s,d),ye(!L||L.texture&&L.texture._texture.format===Ha||L.renderbuffer&&L.renderbuffer._renderbuffer.format===Ja,"invalid depth attachment for framebuffer object"),f(P,s,d),ye(!P||P.renderbuffer&&P.renderbuffer._renderbuffer.format===ti,"invalid stencil attachment for framebuffer object"),f(j,s,d),ye(!j||j.texture&&j.texture._texture.format===ei||j.renderbuffer&&j.renderbuffer._renderbuffer.format===ei,"invalid depth-stencil attachment for framebuffer object"),p(u),u.width=s,u.height=d,u.colorAttachments=O,u.depthAttachment=L,u.stencilAttachment=P,u.depthStencilAttachment=j,a.color=O.map(m),a.depth=m(L),a.stencil=m(P),a.depthStencil=m(j),a.width=u.width,a.height=u.height,v(u),a}function o(t,e){ye(M.next!==u,"can not resize a framebuffer which is currently in use");var n=0|t,r=0|e||n;if(n===u.width&&r===u.height)return a;for(var i=u.colorAttachments,o=0;o<i.length;++o)d(i[o],n,r);return d(u.depthAttachment,n,r),d(u.stencilAttachment,n,r),d(u.depthStencilAttachment,n,r),u.width=a.width=n,u.height=a.height=r,v(u),a}var u=new h;return i.framebufferCount++,a(t,r),Jt(a,{resize:o,_reglType:"framebuffer",_framebuffer:u,destroy:function(){b(u),p(u)},use:function(t){M.setFBO({framebuffer:a},t)}})}function x(t){function a(t){var n;ye(o.indexOf(M.next)<0,"can not update framebuffer which is currently in use");var i=e.webgl_draw_buffers,u={color:null},f=0,s=null,l="rgba",c="uint8",m=1;if("number"==typeof t)f=0|t;else if(t){ye.type(t,"object","invalid arguments for framebuffer");var d=t;if("shape"in d){var h=d.shape;ye(Array.isArray(h)&&h.length>=2,"invalid shape for framebuffer"),ye(h[0]===h[1],"cube framebuffer must be square"),f=h[0]}else"radius"in d&&(f=0|d.radius),"width"in d?(f=0|d.width,"height"in d&&ye(d.height===f,"must be square")):"height"in d&&(f=0|d.height);("color"in d||"colors"in d)&&(s=d.color||d.colors,Array.isArray(s)&&ye(1===s.length||i,"multiple render targets not supported")),s||("colorCount"in d&&(m=0|d.colorCount,ye(m>0,"invalid color buffer count")),"colorType"in d&&(ye.oneOf(d.colorType,D,"invalid color type"),c=d.colorType),"colorFormat"in d&&(l=d.colorFormat,ye.oneOf(d.colorFormat,S,"invalid color format for texture"))),"depth"in d&&(u.depth=d.depth),"stencil"in d&&(u.stencil=d.stencil),"depthStencil"in d&&(u.depthStencil=d.depthStencil)}else f=1;var p;if(s)if(Array.isArray(s))for(p=[],n=0;n<s.length;++n)p[n]=s[n];else p=[s];else{p=Array(m);var b={radius:f,format:l,type:c};for(n=0;n<m;++n)p[n]=r.createCube(b)}for(u.color=Array(p.length),n=0;n<p.length;++n){var v=p[n];ye("function"==typeof v&&"textureCube"===v._reglType,"invalid cube map"),f=f||v.width,ye(v.width===f&&v.height===f,"invalid cube map shape"),u.color[n]={target:Ta,data:p[n]}}for(n=0;n<6;++n){for(var x=0;x<p.length;++x)u.color[x].target=Ta+n;n>0&&(u.depth=o[0].depth,u.stencil=o[0].stencil,u.depthStencil=o[0].depthStencil),o[n]?o[n](u):o[n]=g(u)}return Jt(a,{width:f,height:f,color:p})}function i(t){var e,r=0|t;if(ye(r>0&&r<=n.maxCubeMapSize,"invalid radius for cube fbo"),r===a.width)return a;var i=a.color;for(e=0;e<i.length;++e)i[e].resize(r);for(e=0;e<6;++e)o[e].resize(r);return a.width=a.height=r,a}var o=Array(6);return a(t),Jt(a,{faces:o,resize:i,_reglType:"framebufferCube",destroy:function(){o.forEach(function(t){t.destroy()})}})}function y(){tn(F).forEach(function(e){e.framebuffer=t.createFramebuffer(),v(e)})}var M={cur:null,next:null,dirty:!1,setFBO:null},S=["rgba"],w=["rgba4","rgb565","rgb5 a1"];e.ext_srgb&&w.push("srgba"),e.ext_color_buffer_half_float&&w.push("rgba16f","rgb16f"),e.webgl_color_buffer_float&&w.push("rgba32f");var D=["uint8"];e.oes_texture_half_float&&D.push("half float","float16"),e.oes_texture_float&&D.push("float","float32");var I=0,F={};return Jt(M,{getFramebuffer:function(t){if("function"==typeof t&&"framebuffer"===t._reglType){var e=t._framebuffer;if(e instanceof h)return e}return null},create:g,createCube:x,clear:function(){tn(F).forEach(b)},restore:y})}function Lt(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=fi,this.offset=0,this.stride=0,this.divisor=0}function Pt(t,e,n,r,a){for(var i=n.maxAttributes,o=new Array(i),u=0;u<i;++u)o[u]=new Lt;return{Record:Lt,scope:{},state:o}}function jt(t,e,n,r){function a(t,e,n,r){this.name=t,this.id=e,this.location=n,this.info=r}function i(t,e){for(var n=0;n<t.length;++n)if(t[n].id===e.id)return void(t[n].location=e.location);t.push(e)}function o(n,r,a){var i=n===si?l:c,o=i[r];if(!o){var u=e.str(r);o=t.createShader(n),t.shaderSource(o,u),t.compileShader(o),ye.shaderError(t,o,u,n,a),i[r]=o}return o}function u(t,e){this.id=h++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function f(n,u){var f,s,l=o(si,n.fragId),c=o(li,n.vertId),m=n.program=t.createProgram();t.attachShader(m,l),t.attachShader(m,c),t.linkProgram(m),ye.linkError(t,m,e.str(n.fragId),e.str(n.vertId),u);var d=t.getProgramParameter(m,ci);r.profile&&(n.stats.uniformsCount=d);var h=n.uniforms;for(f=0;f<d;++f)if(s=t.getActiveUniform(m,f))if(s.size>1)for(var p=0;p<s.size;++p){var b=s.name.replace("[0]","["+p+"]");i(h,new a(b,e.id(b),t.getUniformLocation(m,b),s))}else i(h,new a(s.name,e.id(s.name),t.getUniformLocation(m,s.name),s));var v=t.getProgramParameter(m,mi);r.profile&&(n.stats.attributesCount=v);var g=n.attributes;for(f=0;f<v;++f)s=t.getActiveAttrib(m,f),s&&i(g,new a(s.name,e.id(s.name),t.getAttribLocation(m,s.name),s))}function s(){l={},c={};for(var t=0;t<d.length;++t)f(d[t])}var l={},c={},m={},d=[],h=0;return r.profile&&(n.getMaxUniformsCount=function(){var t=0;return d.forEach(function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)}),t},n.getMaxAttributesCount=function(){var t=0;return d.forEach(function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)}),t}),{clear:function(){var e=t.deleteShader.bind(t);tn(l).forEach(e),l={},tn(c).forEach(e),c={},d.forEach(function(e){t.deleteProgram(e.program)}),d.length=0,m={},n.shaderCount=0},program:function(t,e,r){ye.command(t>=0,"missing vertex shader",r),ye.command(e>=0,"missing fragment shader",r);var a=m[e];a||(a=m[e]={});var i=a[t];return i||(i=new u(e,t),n.shaderCount++,f(i,r),a[t]=i,d.push(i)),i},restore:s,shader:o,frag:-1,vert:-1}}function Ct(t,e,n,r,a,i){function o(o){var u;null===e.next?(ye(a.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),u=hi):(ye(null!==e.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),u=e.next.colorAttachments[0].texture._texture.type,i.oes_texture_float?ye(u===hi||u===bi,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"):ye(u===hi,"Reading from a framebuffer is only allowed for the type 'uint8'"));var f=0,s=0,l=r.framebufferWidth,c=r.framebufferHeight,m=null;Kt(o)?m=o:o&&(ye.type(o,"object","invalid arguments to regl.read()"),f=0|o.x,s=0|o.y,ye(f>=0&&f<r.framebufferWidth,"invalid x offset for regl.read"),ye(s>=0&&s<r.framebufferHeight,"invalid y offset for regl.read"),l=0|(o.width||r.framebufferWidth-f),c=0|(o.height||r.framebufferHeight-s),m=o.data||null),m&&(u===hi?ye(m instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):u===bi&&ye(m instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),ye(l>0&&l+f<=r.framebufferWidth,"invalid width for read pixels"),ye(c>0&&c+s<=r.framebufferHeight,"invalid height for read pixels"),n();var d=l*c*4;return m||(u===hi?m=new Uint8Array(d):u===bi&&(m=m||new Float32Array(d))),ye.isTypedArray(m,"data buffer for regl.read() must be a typedarray"),ye(m.byteLength>=d,"data buffer for regl.read() too small"),t.pixelStorei(pi,4),t.readPixels(f,s,l,c,di,u,m),m}function u(t){var n;return e.setFBO({framebuffer:t.framebuffer},function(){n=o(t)}),n}function f(t){return t&&"framebuffer"in t?u(t):o(t)}return f}function Rt(t){return Array.prototype.slice.call(t)}function qt(t){return Rt(t).join("")}function Nt(){function t(t){for(var e=0;e<f.length;++e)if(f[e]===t)return u[e];var n="g"+o++;return u.push(n),f.push(t),n}function e(){function t(){n.push.apply(n,Rt(arguments))}function e(){var t="v"+o++;return r.push(t),arguments.length>0&&(n.push(t,"="),n.push.apply(n,Rt(arguments)),n.push(";")),t}var n=[],r=[];return Jt(t,{def:e,toString:function(){return qt([r.length>0?"var "+r+";":"",qt(n)])}})}function n(){function t(t,e){r(t,e,"=",n.def(t,e),";")}var n=e(),r=e(),a=n.toString,i=r.toString;return Jt(function(){n.apply(n,Rt(arguments))},{def:n.def,entry:n,exit:r,save:t,set:function(e,r,a){t(e,r),n(e,r,"=",a,";")},toString:function(){return a()+i()}})}function r(){var t=qt(arguments),e=n(),r=n(),a=e.toString,i=r.toString;return Jt(e,{then:function(){return e.apply(e,Rt(arguments)),this},else:function(){return r.apply(r,Rt(arguments)),this},toString:function(){var e=i();return e&&(e="else{"+e+"}"),qt(["if(",t,"){",a(),"}",e])}})}function a(t,e){function r(){var t="a"+a.length;return a.push(t),t}var a=[];e=e||0;for(var i=0;i<e;++i)r();var o=n(),u=o.toString,f=l[t]=Jt(o,{arg:r,toString:function(){return qt(["function(",a.join(),"){",u(),"}"])}});return f}function i(){var t=['"use strict";',s,"return {"];Object.keys(l).forEach(function(e){t.push('"',e,'":',l[e].toString(),",")}),t.push("}");var e=qt(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n"),n=Function.apply(null,u.concat(e));return n.apply(null,f)}var o=0,u=[],f=[],s=e(),l={};return{global:s,link:t,block:e,proc:a,scope:n,cond:r,compile:i}}function Bt(t){return Array.isArray(t)||Kt(t)||Q(t)}function Yt(t){return t.sort(function(t,e){return t===Ki?-1:e===Ki?1:t<e?-1:1})}function Ut(t,e,n,r){this.thisDep=t,this.contextDep=e,this.propDep=n,this.append=r}function Vt(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function Wt(t){return new Ut(!1,!1,!1,t)}function Ht(t,e){var n=t.type;if(n===Mi){var r=t.data.length;return new Ut(!0,r>=1,r>=2,e)}if(n===Ii){var a=t.data;return new Ut(a.thisDep,a.contextDep,a.propDep,e)}return new Ut(n===Di,n===wi,n===Si,e)}function Gt(t,e,n,r,a,i,o,u,f,s,l,c,m,d,h){function p(t){return t.replace(".","_")}function b(t,e,n){var r=p(t);et.push(t),tt[r]=J[r]=!!n,nt[r]=e}function v(t,e,n){var r=p(t);et.push(t),Array.isArray(n)?(J[r]=n.slice(),tt[r]=n.slice()):J[r]=tt[r]=n,rt[r]=e}function g(){var t=Nt(),n=t.link,r=t.global;t.id=ot++,t.batchId="0";var a=n(at),i=t.shared={props:"a0"};Object.keys(at).forEach(function(t){i[t]=r.def(a,".",t)}),ye.optional(function(){t.CHECK=n(ye),t.commandStr=ye.guessCommand(),t.command=n(t.commandStr),t.assert=function(t,e,r){t("if(!(",e,"))",this.CHECK,".commandRaise(",n(r),",",this.command,");")},it.invalidBlendCombinations=du});var o=t.next={},u=t.current={};Object.keys(rt).forEach(function(t){Array.isArray(J[t])&&(o[t]=r.def(i.next,".",t),u[t]=r.def(i.current,".",t))});var f=t.constants={};Object.keys(it).forEach(function(t){f[t]=r.def(JSON.stringify(it[t]));
}),t.invoke=function(e,r){switch(r.type){case Mi:var a=["this",i.context,i.props,t.batchId];return e.def(n(r.data),".call(",a.slice(0,Math.max(r.data.length+1,4)),")");case Si:return e.def(i.props,r.data);case wi:return e.def(i.context,r.data);case Di:return e.def("this",r.data);case Ii:return r.data.append(t,e),r.data.ref}},t.attribCache={};var l={};return t.scopeAttrib=function(t){var r=e.id(t);if(r in l)return l[r];var a=s.scope[r];a||(a=s.scope[r]=new X);var i=l[r]=n(a);return i},t}function x(t){var e,n=t.static,r=t.dynamic;if(Ji in n){var a=!!n[Ji];e=Wt(function(t,e){return a}),e.enable=a}else if(Ji in r){var i=r[Ji];e=Ht(i,function(t,e){return t.invoke(e,i)})}return e}function y(t,e){var n=t.static,r=t.dynamic;if(to in n){var a=n[to];return a?(a=u.getFramebuffer(a),ye.command(a,"invalid framebuffer object"),Wt(function(t,e){var n=t.link(a),r=t.shared;e.set(r.framebuffer,".next",n);var i=r.context;return e.set(i,"."+lo,n+".width"),e.set(i,"."+co,n+".height"),n})):Wt(function(t,e){var n=t.shared;e.set(n.framebuffer,".next","null");var r=n.context;return e.set(r,"."+lo,r+"."+bo),e.set(r,"."+co,r+"."+vo),"null"})}if(to in r){var i=r[to];return Ht(i,function(t,e){var n=t.invoke(e,i),r=t.shared,a=r.framebuffer,o=e.def(a,".getFramebuffer(",n,")");ye.optional(function(){t.assert(e,"!"+n+"||"+o,"invalid framebuffer object")}),e.set(a,".next",o);var u=r.context;return e.set(u,"."+lo,o+"?"+o+".width:"+u+"."+bo),e.set(u,"."+co,o+"?"+o+".height:"+u+"."+vo),o})}return null}function M(t,e,n){function r(t){if(t in a){var r=a[t];ye.commandType(r,"object","invalid "+t,n.commandStr);var o,u,f=!0,s=0|r.x,l=0|r.y;return"width"in r?(o=0|r.width,ye.command(o>=0,"invalid "+t,n.commandStr)):f=!1,"height"in r?(u=0|r.height,ye.command(u>=0,"invalid "+t,n.commandStr)):f=!1,new Ut(!f&&e&&e.thisDep,!f&&e&&e.contextDep,!f&&e&&e.propDep,function(t,e){var n=t.shared.context,a=o;"width"in r||(a=e.def(n,".",lo,"-",s));var i=u;return"height"in r||(i=e.def(n,".",co,"-",l)),[s,l,a,i]})}if(t in i){var c=i[t],m=Ht(c,function(e,n){var r=e.invoke(n,c);ye.optional(function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)});var a=e.shared.context,i=n.def(r,".x|0"),o=n.def(r,".y|0"),u=n.def('"width" in ',r,"?",r,".width|0:","(",a,".",lo,"-",i,")"),f=n.def('"height" in ',r,"?",r,".height|0:","(",a,".",co,"-",o,")");return ye.optional(function(){e.assert(n,u+">=0&&"+f+">=0","invalid "+t)}),[i,o,u,f]});return e&&(m.thisDep=m.thisDep||e.thisDep,m.contextDep=m.contextDep||e.contextDep,m.propDep=m.propDep||e.propDep),m}return e?new Ut(e.thisDep,e.contextDep,e.propDep,function(t,e){var n=t.shared.context;return[0,0,e.def(n,".",lo),e.def(n,".",co)]}):null}var a=t.static,i=t.dynamic,o=r(Ki);if(o){var u=o;o=new Ut(o.thisDep,o.contextDep,o.propDep,function(t,e){var n=u.append(t,e),r=t.shared.context;return e.set(r,"."+mo,n[2]),e.set(r,"."+ho,n[3]),n})}return{viewport:o,scissor_box:r($i)}}function S(t){function n(t){if(t in a){var n=e.id(a[t]);ye.optional(function(){l.shader(bu[t],n,ye.guessCommand())});var r=Wt(function(){return n});return r.id=n,r}if(t in i){var o=i[t];return Ht(o,function(e,n){var r=e.invoke(n,o),a=n.def(e.shared.strings,".id(",r,")");return ye.optional(function(){n(e.shared.shader,".shader(",bu[t],",",a,",",e.command,");")}),a})}return null}var r,a=t.static,i=t.dynamic,o=n(no),u=n(eo),f=null;return Vt(o)&&Vt(u)?(f=l.program(u.id,o.id),r=Wt(function(t,e){return t.link(f)})):r=new Ut(o&&o.thisDep||u&&u.thisDep,o&&o.contextDep||u&&u.contextDep,o&&o.propDep||u&&u.propDep,function(t,e){var n,r=t.shared.shader;n=o?o.append(t,e):e.def(r,".",no);var a;a=u?u.append(t,e):e.def(r,".",eo);var i=r+".program("+a+","+n;return ye.optional(function(){i+=","+t.command}),e.def(i+")")}),{frag:o,vert:u,progVar:r,program:f}}function w(t,e){function n(){if(ro in u){var t=u[ro];Bt(t)?t=i.getElements(i.create(t,!0)):t&&(t=i.getElements(t),ye.command(t,"invalid elements",e.commandStr));var n=Wt(function(e,n){if(t){var r=e.link(t);return e.ELEMENTS=r,r}return e.ELEMENTS=null,null});return n.value=t,n}if(ro in f){var r=f[ro];return Ht(r,function(t,e){var n=t.shared,a=n.isBufferArgs,i=n.elements,o=t.invoke(e,r),u=e.def("null"),f=e.def(a,"(",o,")"),s=t.cond(f).then(u,"=",i,".createStream(",o,");").else(u,"=",i,".getElements(",o,");");return ye.optional(function(){t.assert(s.else,"!"+o+"||"+u,"invalid elements")}),e.entry(s),e.exit(t.cond(f).then(i,".destroyStream(",u,");")),t.ELEMENTS=u,u})}return null}function r(){if(ao in u){var t=u[ao];return ye.commandParameter(t,Cn,"invalid primitve",e.commandStr),Wt(function(e,n){return Cn[t]})}if(ao in f){var n=f[ao];return Ht(n,function(t,e){var r=t.constants.primTypes,a=t.invoke(e,n);return ye.optional(function(){t.assert(e,a+" in "+r,"invalid primitive, must be one of "+Object.keys(Cn))}),e.def(r,"[",a,"]")})}return s?Vt(s)?Wt(s.value?function(t,e){return e.def(t.ELEMENTS,".primType")}:function(){return $o}):new Ut(s.thisDep,s.contextDep,s.propDep,function(t,e){var n=t.ELEMENTS;return e.def(n,"?",n,".primType:",$o)}):null}function a(t,n){if(t in u){var r=0|u[t];return ye.command(!n||r>=0,"invalid "+t,e.commandStr),Wt(function(t,e){return n&&(t.OFFSET=r),r})}if(t in f){var a=f[t];return Ht(a,function(e,r){var i=e.invoke(r,a);return n&&(e.OFFSET=i,ye.optional(function(){e.assert(r,i+">=0","invalid "+t)})),i})}return n&&s?Wt(function(t,e){return t.OFFSET="0",0}):null}function o(){if(io in u){var t=0|u[io];return ye.command("number"==typeof t&&t>=0,"invalid vertex count",e.commandStr),Wt(function(){return t})}if(io in f){var n=f[io];return Ht(n,function(t,e){var r=t.invoke(e,n);return ye.optional(function(){t.assert(e,"typeof "+r+'==="number"&&'+r+">=0&&"+r+"===("+r+"|0)","invalid vertex count")}),r})}if(s){if(Vt(s)){if(s)return l?new Ut(l.thisDep,l.contextDep,l.propDep,function(t,e){var n=e.def(t.ELEMENTS,".vertCount-",t.OFFSET);return ye.optional(function(){t.assert(e,n+">=0","invalid vertex offset/element buffer too small")}),n}):Wt(function(t,e){return e.def(t.ELEMENTS,".vertCount")});var r=Wt(function(){return-1});return ye.optional(function(){r.MISSING=!0}),r}var a=new Ut(s.thisDep||l.thisDep,s.contextDep||l.contextDep,s.propDep||l.propDep,function(t,e){var n=t.ELEMENTS;return t.OFFSET?e.def(n,"?",n,".vertCount-",t.OFFSET,":-1"):e.def(n,"?",n,".vertCount:-1")});return ye.optional(function(){a.DYNAMIC=!0}),a}return null}var u=t.static,f=t.dynamic,s=n(),l=a(oo,!0);return{elements:s,primitive:r(),count:o(),instances:a(uo,!1),offset:l}}function D(t,e){var n=t.static,a=t.dynamic,i={};return et.forEach(function(t){function o(e,r){if(t in n){var o=e(n[t]);i[u]=Wt(function(){return o})}else if(t in a){var f=a[t];i[u]=Ht(f,function(t,e){return r(t,e,t.invoke(e,f))})}}var u=p(t);switch(t){case ji:case Ai:case Fi:case Wi:case zi:case Zi:case Ni:case Yi:case Ui:case Li:return o(function(n){return ye.commandType(n,"boolean",t,e.commandStr),n},function(e,n,r){return ye.optional(function(){e.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+t,e.commandStr)}),r});case Ti:return o(function(n){return ye.commandParameter(n,hu,"invalid "+t,e.commandStr),hu[n]},function(e,n,r){var a=e.constants.compareFuncs;return ye.optional(function(){e.assert(n,r+" in "+a,"invalid "+t+", must be one of "+Object.keys(hu))}),n.def(a,"[",r,"]")});case Oi:return o(function(t){return ye.command(pt(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&t[0]<=t[1],"depth range is 2d array",e.commandStr),t},function(t,e,n){ye.optional(function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")});var r=e.def("+",n,"[0]"),a=e.def("+",n,"[1]");return[r,a]});case ki:return o(function(t){ye.commandType(t,"object","blend.func",e.commandStr);var n="srcRGB"in t?t.srcRGB:t.src,r="srcAlpha"in t?t.srcAlpha:t.src,a="dstRGB"in t?t.dstRGB:t.dst,i="dstAlpha"in t?t.dstAlpha:t.dst;return ye.commandParameter(n,mu,u+".srcRGB",e.commandStr),ye.commandParameter(r,mu,u+".srcAlpha",e.commandStr),ye.commandParameter(a,mu,u+".dstRGB",e.commandStr),ye.commandParameter(i,mu,u+".dstAlpha",e.commandStr),ye.command(du.indexOf(n+", "+a)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+a+")",e.commandStr),[mu[n],mu[a],mu[r],mu[i]]},function(e,n,r){function a(a,o){var u=n.def('"',a,o,'" in ',r,"?",r,".",a,o,":",r,".",a);return ye.optional(function(){e.assert(n,u+" in "+i,"invalid "+t+"."+a+o+", must be one of "+Object.keys(mu))}),u}var i=e.constants.blendFuncs;ye.optional(function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")});var o=a("src","RGB"),u=a("dst","RGB");ye.optional(function(){var t=e.constants.invalidBlendCombinations;e.assert(n,t+".indexOf("+o+'+", "+'+u+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var f=n.def(i,"[",o,"]"),s=n.def(i,"[",a("src","Alpha"),"]"),l=n.def(i,"[",u,"]"),c=n.def(i,"[",a("dst","Alpha"),"]");return[f,l,s,c]});case _i:return o(function(n){return"string"==typeof n?(ye.commandParameter(n,Q,"invalid "+t,e.commandStr),[Q[n],Q[n]]):"object"==typeof n?(ye.commandParameter(n.rgb,Q,t+".rgb",e.commandStr),ye.commandParameter(n.alpha,Q,t+".alpha",e.commandStr),[Q[n.rgb],Q[n.alpha]]):void ye.commandRaise("invalid blend.equation",e.commandStr)},function(e,n,r){var a=e.constants.blendEquations,i=n.def(),o=n.def(),u=e.cond("typeof ",r,'==="string"');return ye.optional(function(){function n(t,n,r){e.assert(t,r+" in "+a,"invalid "+n+", must be one of "+Object.keys(Q))}n(u.then,t,r),e.assert(u.else,r+"&&typeof "+r+'==="object"',"invalid "+t),n(u.else,t+".rgb",r+".rgb"),n(u.else,t+".alpha",r+".alpha")}),u.then(i,"=",o,"=",a,"[",r,"];"),u.else(i,"=",a,"[",r,".rgb];",o,"=",a,"[",r,".alpha];"),n(u),[i,o]});case Ei:return o(function(t){return ye.command(pt(t)&&4===t.length,"blend.color must be a 4d array",e.commandStr),Z(4,function(e){return+t[e]})},function(t,e,n){return ye.optional(function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")}),Z(4,function(t){return e.def("+",n,"[",t,"]")})});case Hi:return o(function(t){return ye.commandType(t,"number",u,e.commandStr),0|t},function(t,e,n){return ye.optional(function(){t.assert(e,"typeof "+n+'==="number"',"invalid stencil.mask")}),e.def(n,"|0")});case Gi:return o(function(n){ye.commandType(n,"object",u,e.commandStr);var r=n.cmp||"keep",a=n.ref||0,i="mask"in n?n.mask:-1;return ye.commandParameter(r,hu,t+".cmp",e.commandStr),ye.commandType(a,"number",t+".ref",e.commandStr),ye.commandType(i,"number",t+".mask",e.commandStr),[hu[r],a,i]},function(t,e,n){var r=t.constants.compareFuncs;ye.optional(function(){function a(){t.assert(e,Array.prototype.join.call(arguments,""),"invalid stencil.func")}a(n+"&&typeof ",n,'==="object"'),a('!("cmp" in ',n,")||(",n,".cmp in ",r,")")});var a=e.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",iu),i=e.def(n,".ref|0"),o=e.def('"mask" in ',n,"?",n,".mask|0:-1");return[a,i,o]});case Xi:case Qi:return o(function(n){ye.commandType(n,"object",u,e.commandStr);var r=n.fail||"keep",a=n.zfail||"keep",i=n.zpass||"keep";return ye.commandParameter(r,pu,t+".fail",e.commandStr),ye.commandParameter(a,pu,t+".zfail",e.commandStr),ye.commandParameter(i,pu,t+".zpass",e.commandStr),[t===Qi?Jo:Ko,pu[r],pu[a],pu[i]]},function(e,n,r){function a(a){return ye.optional(function(){e.assert(n,'!("'+a+'" in '+r+")||("+r+"."+a+" in "+i+")","invalid "+t+"."+a+", must be one of "+Object.keys(pu))}),n.def('"',a,'" in ',r,"?",i,"[",r,".",a,"]:",iu)}var i=e.constants.stencilOps;return ye.optional(function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)}),[t===Qi?Jo:Ko,a("fail"),a("zfail"),a("zpass")]});case Bi:return o(function(t){ye.commandType(t,"object",u,e.commandStr);var n=0|t.factor,r=0|t.units;return ye.commandType(n,"number",u+".factor",e.commandStr),ye.commandType(r,"number",u+".units",e.commandStr),[n,r]},function(e,n,r){ye.optional(function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)});var a=n.def(r,".factor|0"),i=n.def(r,".units|0");return[a,i]});case Ci:return o(function(t){var n=0;return"front"===t?n=Ko:"back"===t&&(n=Jo),ye.command(!!n,u,e.commandStr),n},function(t,e,n){return ye.optional(function(){t.assert(e,n+'==="front"||'+n+'==="back"',"invalid cull.face")}),e.def(n,'==="front"?',Ko,":",Jo)});case qi:return o(function(t){return ye.command("number"==typeof t&&t>=r.lineWidthDims[0]&&t<=r.lineWidthDims[1],"invalid line width, must positive number between "+r.lineWidthDims[0]+" and "+r.lineWidthDims[1],e.commandStr),t},function(t,e,n){return ye.optional(function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">="+r.lineWidthDims[0]+"&&"+n+"<="+r.lineWidthDims[1],"invalid line width")}),n});case Ri:return o(function(t){return ye.commandParameter(t,vu,u,e.commandStr),vu[t]},function(t,e,n){return ye.optional(function(){t.assert(e,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),e.def(n+'==="cw"?'+tu+":"+eu)});case Pi:return o(function(t){return ye.command(pt(t)&&4===t.length,"color.mask must be length 4 array",e.commandStr),t.map(function(t){return!!t})},function(t,e,n){return ye.optional(function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")}),Z(4,function(t){return"!!"+n+"["+t+"]"})});case Vi:return o(function(t){ye.command("object"==typeof t&&t,u,e.commandStr);var n="value"in t?t.value:1,r=!!t.invert;return ye.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",e.commandStr),[n,r]},function(t,e,n){ye.optional(function(){t.assert(e,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")});var r=e.def('"value" in ',n,"?+",n,".value:1"),a=e.def("!!",n,".invert");return[r,a]})}}),i}function I(t,e){var n=t.static,r=t.dynamic,a={};return Object.keys(n).forEach(function(t){var r,i=n[t];if("number"==typeof i||"boolean"==typeof i)r=Wt(function(){return i});else if("function"==typeof i){var o=i._reglType;"texture2d"===o||"textureCube"===o?r=Wt(function(t){return t.link(i)}):"framebuffer"===o||"framebufferCube"===o?(ye.command(i.color.length>0,'missing color attachment for framebuffer sent to uniform "'+t+'"',e.commandStr),r=Wt(function(t){return t.link(i.color[0])})):ye.commandRaise('invalid data for uniform "'+t+'"',e.commandStr)}else pt(i)?r=Wt(function(e){var n=e.global.def("[",Z(i.length,function(n){return ye.command("number"==typeof i[n]||"boolean"==typeof i[n],"invalid uniform "+t,e.commandStr),i[n]}),"]");return n}):ye.commandRaise('invalid or missing data for uniform "'+t+'"',e.commandStr);r.value=i,a[t]=r}),Object.keys(r).forEach(function(t){var e=r[t];a[t]=Ht(e,function(t,n){return t.invoke(n,e)})}),a}function F(t,n){var r=t.static,i=t.dynamic,o={};return Object.keys(r).forEach(function(t){var i=r[t],u=e.id(t),f=new X;if(Bt(i))f.state=xi,f.buffer=a.getBuffer(a.create(i,xo,!1,!0)),f.type=0;else{var s=a.getBuffer(i);if(s)f.state=xi,f.buffer=s,f.type=0;else if(ye.command("object"==typeof i&&i,"invalid data for attribute "+t,n.commandStr),i.constant){var l=i.constant;f.buffer="null",f.state=yi,"number"==typeof l?f.x=l:(ye.command(pt(l)&&l.length>0&&l.length<=4,"invalid constant for attribute "+t,n.commandStr),vi.forEach(function(t,e){e<l.length&&(f[t]=l[e])}))}else{s=Bt(i.buffer)?a.getBuffer(a.create(i.buffer,xo,!1,!0)):a.getBuffer(i.buffer),ye.command(!!s,'missing buffer for attribute "'+t+'"',n.commandStr);var c=0|i.offset;ye.command(c>=0,'invalid offset for attribute "'+t+'"',n.commandStr);var m=0|i.stride;ye.command(m>=0&&m<256,'invalid stride for attribute "'+t+'", must be integer betweeen [0, 255]',n.commandStr);var d=0|i.size;ye.command(!("size"in i)||d>0&&d<=4,'invalid size for attribute "'+t+'", must be 1,2,3,4',n.commandStr);var h=!!i.normalized,p=0;"type"in i&&(ye.commandParameter(i.type,yn,"invalid type for attribute "+t,n.commandStr),p=yn[i.type]);var b=0|i.divisor;"divisor"in i&&(ye.command(0===b||$,'cannot specify divisor for attribute "'+t+'", instancing not supported',n.commandStr),ye.command(b>=0,'invalid divisor for attribute "'+t+'"',n.commandStr)),ye.optional(function(){var e=n.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(i).forEach(function(n){ye.command(r.indexOf(n)>=0,'unknown parameter "'+n+'" for attribute pointer "'+t+'" (valid parameters are '+r+")",e)})}),f.buffer=s,f.state=xi,f.size=d,f.normalized=h,f.type=p||s.dtype,f.offset=c,f.stride=m,f.divisor=b}}o[t]=Wt(function(t,e){var n=t.attribCache;if(u in n)return n[u];var r={isStream:!1};return Object.keys(f).forEach(function(t){r[t]=f[t]}),f.buffer&&(r.buffer=t.link(f.buffer),r.type=r.type||r.buffer+".dtype"),n[u]=r,r})}),Object.keys(i).forEach(function(t){function e(e,r){function a(t){r(s[t],"=",i,".",t,"|0;")}var i=e.invoke(r,n),o=e.shared,u=o.isBufferArgs,f=o.buffer;ye.optional(function(){e.assert(r,i+"&&(typeof "+i+'==="object"||typeof '+i+'==="function")&&('+u+"("+i+")||"+f+".getBuffer("+i+")||"+f+".getBuffer("+i+".buffer)||"+u+"("+i+'.buffer)||("constant" in '+i+"&&(typeof "+i+'.constant==="number"||'+o.isArrayLike+"("+i+".constant))))",'invalid dynamic attribute "'+t+'"')});var s={isStream:r.def(!1)},l=new X;l.state=xi,Object.keys(l).forEach(function(t){s[t]=r.def(""+l[t])});var c=s.buffer,m=s.type;return r("if(",u,"(",i,")){",s.isStream,"=true;",c,"=",f,".createStream(",xo,",",i,");",m,"=",c,".dtype;","}else{",c,"=",f,".getBuffer(",i,");","if(",c,"){",m,"=",c,".dtype;",'}else if("constant" in ',i,"){",s.state,"=",yi,";","if(typeof "+i+'.constant === "number"){',s[vi[0]],"=",i,".constant;",vi.slice(1).map(function(t){return s[t]}).join("="),"=0;","}else{",vi.map(function(t,e){return s[t]+"="+i+".constant.length>="+e+"?"+i+".constant["+e+"]:0;"}).join(""),"}}else{","if(",u,"(",i,".buffer)){",c,"=",f,".createStream(",xo,",",i,".buffer);","}else{",c,"=",f,".getBuffer(",i,".buffer);","}",m,'="type" in ',i,"?",o.glTypes,"[",i,".type]:",c,".dtype;",s.normalized,"=!!",i,".normalized;"),a("size"),a("offset"),a("stride"),a("divisor"),r("}}"),r.exit("if(",s.isStream,"){",f,".destroyStream(",c,");","}"),s}var n=i[t];o[t]=Ht(n,e)}),o}function A(t){var e=t.static,n=t.dynamic,r={};return Object.keys(e).forEach(function(t){var n=e[t];r[t]=Wt(function(t,e){return"number"==typeof n||"boolean"==typeof n?""+n:t.link(n)})}),Object.keys(n).forEach(function(t){var e=n[t];r[t]=Ht(e,function(t,n){return t.invoke(n,e)})}),r}function E(t,e,n,r,a){function i(t){var e=s[t];e&&(c[t]=e)}var o=t.static,u=t.dynamic;ye.optional(function(){function t(t){Object.keys(t).forEach(function(t){ye.command(e.indexOf(t)>=0,'unknown parameter "'+t+'"',a.commandStr)})}var e=[to,eo,no,ro,ao,oo,io,uo,Ji].concat(et);t(o),t(u)});var f=y(t,a),s=M(t,f,a),l=w(t,a),c=D(t,a),m=S(t,a);i(Ki),i(p($i));var d=Object.keys(c).length>0,h={framebuffer:f,draw:l,shader:m,state:c,dirty:d};return h.profile=x(t,a),h.uniforms=I(n,a),h.attributes=F(e,a),h.context=A(r,a),h}function _(t,e,n){var r=t.shared,a=r.context,i=t.scope();Object.keys(n).forEach(function(r){e.save(a,"."+r);var o=n[r];i(a,".",r,"=",o.append(t,e),";")}),e(i)}function k(t,e,n,r){var a,i=t.shared,o=i.gl,u=i.framebuffer;K&&(a=e.def(i.extensions,".webgl_draw_buffers"));var f,s=t.constants,l=s.drawBuffer,c=s.backBuffer;f=n?n.append(t,e):e.def(u,".next"),r||e("if(",f,"!==",u,".cur){"),e("if(",f,"){",o,".bindFramebuffer(",lu,",",f,".framebuffer);"),K&&e(a,".drawBuffersWEBGL(",l,"[",f,".colorAttachments.length]);"),e("}else{",o,".bindFramebuffer(",lu,",null);"),K&&e(a,".drawBuffersWEBGL(",c,");"),e("}",u,".cur=",f,";"),r||e("}")}function z(t,e,n){var r=t.shared,a=r.gl,i=t.current,o=t.next,u=r.current,f=r.next,s=t.cond(u,".dirty");et.forEach(function(e){var r=p(e);if(!(r in n.state)){var l,c;if(r in o){l=o[r],c=i[r];var m=Z(J[r].length,function(t){return s.def(l,"[",t,"]")});s(t.cond(m.map(function(t,e){return t+"!=="+c+"["+e+"]"}).join("||")).then(a,".",rt[r],"(",m,");",m.map(function(t,e){return c+"["+e+"]="+t}).join(";"),";"))}else{l=s.def(f,".",r);var d=t.cond(l,"!==",u,".",r);s(d),r in nt?d(t.cond(l).then(a,".enable(",nt[r],");").else(a,".disable(",nt[r],");"),u,".",r,"=",l,";"):d(a,".",rt[r],"(",l,");",u,".",r,"=",l,";")}}}),0===Object.keys(n.state).length&&s(u,".dirty=false;"),e(s)}function T(t,e,n,r){var a=t.shared,i=t.current,o=a.current,u=a.gl;Yt(Object.keys(n)).forEach(function(a){var f=n[a];if(!r||r(f)){var s=f.append(t,e);if(nt[a]){var l=nt[a];Vt(f)?s?e(u,".enable(",l,");"):e(u,".disable(",l,");"):e(t.cond(s).then(u,".enable(",l,");").else(u,".disable(",l,");")),e(o,".",a,"=",s,";")}else if(pt(s)){var c=i[a];e(u,".",rt[a],"(",s,");",s.map(function(t,e){return c+"["+e+"]="+t}).join(";"),";")}else e(u,".",rt[a],"(",s,");",o,".",a,"=",s,";")}})}function O(t,e){$&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function L(t,e,n,r,a){function i(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function o(t){s=e.def(),t(s,"=",i(),";"),"string"==typeof a?t(h,".count+=",a,";"):t(h,".count++;"),d&&(r?(l=e.def(),t(l,"=",b,".getNumPendingQueries();")):t(b,".beginQuery(",h,");"))}function u(t){t(h,".cpuTime+=",i(),"-",s,";"),d&&(r?t(b,".pushScopeStats(",l,",",b,".getNumPendingQueries(),",h,");"):t(b,".endQuery();"))}function f(t){var n=e.def(p,".profile");e(p,".profile=",t,";"),e.exit(p,".profile=",n,";")}var s,l,c,m=t.shared,h=t.stats,p=m.current,b=m.timer,v=n.profile;if(v){if(Vt(v))return void(v.enable?(o(e),u(e.exit),f("true")):f("false"));c=v.append(t,e),f(c)}else c=e.def(p,".profile");var g=t.block();o(g),e("if(",c,"){",g,"}");var x=t.block();u(x),e.exit("if(",c,"){",x,"}")}function P(t,e,n,r,a){function i(t){switch(t){case Po:case qo:case Uo:return 2;case jo:case No:case Vo:return 3;case Co:case Bo:case Wo:return 4;default:return 1}}function o(n,r,a){function i(){e("if(!",l,".buffer){",f,".enableVertexAttribArray(",s,");}");var n,i=a.type;if(n=a.size?e.def(a.size,"||",r):r,e("if(",l,".type!==",i,"||",l,".size!==",n,"||",h.map(function(t){return l+"."+t+"!=="+a[t]}).join("||"),"){",f,".bindBuffer(",xo,",",m,".buffer);",f,".vertexAttribPointer(",[s,n,i,a.normalized,a.stride,a.offset],");",l,".type=",i,";",l,".size=",n,";",h.map(function(t){return l+"."+t+"="+a[t]+";"}).join(""),"}"),$){var o=a.divisor;e("if(",l,".divisor!==",o,"){",t.instancing,".vertexAttribDivisorANGLE(",[s,o],");",l,".divisor=",o,";}")}}function o(){e("if(",l,".buffer){",f,".disableVertexAttribArray(",s,");","}if(",vi.map(function(t,e){return l+"."+t+"!=="+d[e]}).join("||"),"){",f,".vertexAttrib4f(",s,",",d,");",vi.map(function(t,e){return l+"."+t+"="+d[e]+";"}).join(""),"}")}var f=u.gl,s=e.def(n,".location"),l=e.def(u.attributes,"[",s,"]"),c=a.state,m=a.buffer,d=[a.x,a.y,a.z,a.w],h=["buffer","normalized","offset","stride"];c===xi?i():c===yi?o():(e("if(",c,"===",xi,"){"),i(),e("}else{"),o(),e("}"))}var u=t.shared;r.forEach(function(r){var u,f=r.name,s=n.attributes[f];if(s){if(!a(s))return;u=s.append(t,e)}else{if(!a(gu))return;var l=t.scopeAttrib(f);ye.optional(function(){t.assert(e,l+".state","missing attribute "+f)}),u={},Object.keys(new X).forEach(function(t){u[t]=e.def(l,".",t)})}o(t.link(r),i(r.info.type),u)})}function j(t,n,r,a,i){for(var o,u=t.shared,f=u.gl,s=0;s<a.length;++s){var l,c=a[s],m=c.name,d=c.info.type,h=r.uniforms[m],p=t.link(c),b=p+".location";if(h){if(!i(h))continue;if(Vt(h)){var v=h.value;if(ye.command(null!==v&&"undefined"!=typeof v,'missing uniform "'+m+'"',t.commandStr),d===Qo||d===Zo){ye.command("function"==typeof v&&(d===Qo&&("texture2d"===v._reglType||"framebuffer"===v._reglType)||d===Zo&&("textureCube"===v._reglType||"framebufferCube"===v._reglType)),"invalid texture for uniform "+m,t.commandStr);var g=t.link(v._texture||v.color[0]._texture);n(f,".uniform1i(",b,",",g+".bind());"),n.exit(g,".unbind();")}else if(d===Ho||d===Go||d===Xo){ye.optional(function(){ye.command(pt(v),"invalid matrix for uniform "+m,t.commandStr),ye.command(d===Ho&&4===v.length||d===Go&&9===v.length||d===Xo&&16===v.length,"invalid length for matrix uniform "+m,t.commandStr)});var x=t.global.def("new Float32Array(["+Array.prototype.slice.call(v)+"])"),y=2;d===Go?y=3:d===Xo&&(y=4),n(f,".uniformMatrix",y,"fv(",b,",false,",x,");")}else{switch(d){case Lo:ye.commandType(v,"number","uniform "+m,t.commandStr),o="1f";break;case Po:ye.command(pt(v)&&2===v.length,"uniform "+m,t.commandStr),o="2f";break;case jo:ye.command(pt(v)&&3===v.length,"uniform "+m,t.commandStr),o="3f";break;case Co:ye.command(pt(v)&&4===v.length,"uniform "+m,t.commandStr),o="4f";break;case Yo:ye.commandType(v,"boolean","uniform "+m,t.commandStr),o="1i";break;case Ro:ye.commandType(v,"number","uniform "+m,t.commandStr),o="1i";break;case Uo:ye.command(pt(v)&&2===v.length,"uniform "+m,t.commandStr),o="2i";break;case qo:ye.command(pt(v)&&2===v.length,"uniform "+m,t.commandStr),o="2i";break;case Vo:ye.command(pt(v)&&3===v.length,"uniform "+m,t.commandStr),o="3i";break;case No:ye.command(pt(v)&&3===v.length,"uniform "+m,t.commandStr),o="3i";break;case Wo:ye.command(pt(v)&&4===v.length,"uniform "+m,t.commandStr),o="4i";break;case Bo:ye.command(pt(v)&&4===v.length,"uniform "+m,t.commandStr),o="4i"}n(f,".uniform",o,"(",b,",",pt(v)?Array.prototype.slice.call(v):v,");")}continue}l=h.append(t,n)}else{if(!i(gu))continue;l=n.def(u.uniforms,"[",e.id(m),"]")}d===Qo?n("if(",l,"&&",l,'._reglType==="framebuffer"){',l,"=",l,".color[0];","}"):d===Zo&&n("if(",l,"&&",l,'._reglType==="framebufferCube"){',l,"=",l,".color[0];","}"),ye.optional(function(){function e(e,r){t.assert(n,e,'bad data or missing for uniform "'+m+'".  '+r)}function r(t){e("typeof "+l+'==="'+t+'"',"invalid type, expected "+t)}function a(n,r){e(u.isArrayLike+"("+l+")&&"+l+".length==="+n,"invalid vector, should have length "+n,t.commandStr)}function i(n){e("typeof "+l+'==="function"&&'+l+'._reglType==="texture'+(n===wo?"2d":"Cube")+'"',"invalid texture type",t.commandStr)}switch(d){case Ro:r("number");break;case qo:a(2,"number");break;case No:a(3,"number");break;case Bo:a(4,"number");break;case Lo:r("number");break;case Po:a(2,"number");break;case jo:a(3,"number");break;case Co:a(4,"number");break;case Yo:r("boolean");break;case Uo:a(2,"boolean");break;case Vo:a(3,"boolean");break;case Wo:a(4,"boolean");break;case Ho:a(4,"number");break;case Go:a(9,"number");break;case Xo:a(16,"number");break;case Qo:i(wo);break;case Zo:i(Do)}});var M=1;switch(d){case Qo:case Zo:var S=n.def(l,"._texture");n(f,".uniform1i(",b,",",S,".bind());"),n.exit(S,".unbind();");continue;case Ro:case Yo:o="1i";break;case qo:case Uo:o="2i",M=2;break;case No:case Vo:o="3i",M=3;break;case Bo:case Wo:o="4i",M=4;break;case Lo:o="1f";break;case Po:o="2f",M=2;break;case jo:o="3f",M=3;break;case Co:o="4f",M=4;break;case Ho:o="Matrix2fv";break;case Go:o="Matrix3fv";break;case Xo:o="Matrix4fv"}if(n(f,".uniform",o,"(",b,","),"M"===o.charAt(0)){var w=Math.pow(d-Ho+2,2),D=t.global.def("new Float32Array(",w,")");n("false,(Array.isArray(",l,")||",l," instanceof Float32Array)?",l,":(",Z(w,function(t){return D+"["+t+"]="+l+"["+t+"]"}),",",D,")")}else n(M>1?Z(M,function(t){return l+"["+t+"]"}):l);n(");")}}function C(t,e,n,r){function a(){var a,i=m.elements,o=e;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(o=n),a=i.append(t,o)):a=o.def(c,".",ro),a&&o("if("+a+")"+l+".bindBuffer("+yo+","+a+".buffer.buffer);"),a}function i(){var a,i=m.count,o=e;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(o=n),a=i.append(t,o),ye.optional(function(){i.MISSING&&t.assert(e,"false","missing vertex count"),i.DYNAMIC&&t.assert(o,a+">=0","missing vertex count")})):(a=o.def(c,".",io),ye.optional(function(){t.assert(o,a+">=0","missing vertex count")})),a}function o(a){var i=m[a];return i?i.contextDep&&r.contextDynamic||i.propDep?i.append(t,n):i.append(t,e):e.def(c,".",a)}function u(){function t(){n(g,".drawElementsInstancedANGLE(",[h,b,x,p+"<<(("+x+"-"+gi+")>>1)",v],");")}function e(){n(g,".drawArraysInstancedANGLE(",[h,p,b,v],");")}d?y?t():(n("if(",d,"){"),t(),n("}else{"),e(),n("}")):e()}function f(){function t(){n(l+".drawElements("+[h,b,x,p+"<<(("+x+"-"+gi+")>>1)"]+");")}function e(){n(l+".drawArrays("+[h,p,b]+");")}d?y?t():(n("if(",d,"){"),t(),n("}else{"),e(),n("}")):e()}var s=t.shared,l=s.gl,c=s.draw,m=r.draw,d=a(),h=o(ao),p=o(oo),b=i();if("number"==typeof b){if(0===b)return}else n("if(",b,"){"),n.exit("}");var v,g;$&&(v=o(uo),g=t.instancing);var x=d+".type",y=m.elements&&Vt(m.elements);$&&("number"!=typeof v||v>=0)?"string"==typeof v?(n("if(",v,">0){"),u(),n("}else if(",v,"<0){"),f(),n("}")):u():f()}function R(t,e,n,r,a){var i=g(),o=i.proc("body",a);return ye.optional(function(){i.commandStr=e.commandStr,i.command=i.link(e.commandStr)}),$&&(i.instancing=o.def(i.shared.extensions,".angle_instanced_arrays")),t(i,o,n,r),i.compile().body}function q(t,e,n,r){O(t,e),P(t,e,n,r.attributes,function(){return!0}),j(t,e,n,r.uniforms,function(){return!0}),C(t,e,e,n)}function N(t,e){var n=t.proc("draw",1);O(t,n),_(t,n,e.context),k(t,n,e.framebuffer),z(t,n,e),T(t,n,e.state),L(t,n,e,!1,!0);var r=e.shader.progVar.append(t,n);if(n(t.shared.gl,".useProgram(",r,".program);"),e.shader.program)q(t,n,e,e.shader.program);else{var a=t.global.def("{}"),i=n.def(r,".id"),o=n.def(a,"[",i,"]");n(t.cond(o).then(o,".call(this,a0);").else(o,"=",a,"[",i,"]=",t.link(function(n){return R(q,t,e,n,1)}),"(",r,");",o,".call(this,a0);"))}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;")}function B(t,e,n,r){function a(){return!0}t.batchId="a1",O(t,e),P(t,e,n,r.attributes,a),j(t,e,n,r.uniforms,a),C(t,e,e,n)}function Y(t,e,n,r){function a(t){return t.contextDep&&o||t.propDep}function i(t){return!a(t)}O(t,e);var o=n.contextDep,u=e.def(),f="a0",s="a1",l=e.def();t.shared.props=l,t.batchId=u;var c=t.scope(),m=t.scope();if(e(c.entry,"for(",u,"=0;",u,"<",s,";++",u,"){",l,"=",f,"[",u,"];",m,"}",c.exit),n.needsContext&&_(t,m,n.context),n.needsFramebuffer&&k(t,m,n.framebuffer),T(t,m,n.state,a),n.profile&&a(n.profile)&&L(t,m,n,!1,!0),r)P(t,c,n,r.attributes,i),P(t,m,n,r.attributes,a),j(t,c,n,r.uniforms,i),j(t,m,n,r.uniforms,a),C(t,c,m,n);else{var d=t.global.def("{}"),h=n.shader.progVar.append(t,m),p=m.def(h,".id"),b=m.def(d,"[",p,"]");m(t.shared.gl,".useProgram(",h,".program);","if(!",b,"){",b,"=",d,"[",p,"]=",t.link(function(e){return R(B,t,n,e,2)}),"(",h,");}",b,".call(this,a0[",u,"],",u,");")}}function U(t,e){function n(t){return t.contextDep&&a||t.propDep}var r=t.proc("batch",2);t.batchId="0",O(t,r);var a=!1,i=!0;Object.keys(e.context).forEach(function(t){a=a||e.context[t].propDep}),a||(_(t,r,e.context),i=!1);var o=e.framebuffer,u=!1;o?(o.propDep?a=u=!0:o.contextDep&&a&&(u=!0),u||k(t,r,o)):k(t,r,null),e.state.viewport&&e.state.viewport.propDep&&(a=!0),z(t,r,e),T(t,r,e.state,function(t){return!n(t)}),e.profile&&n(e.profile)||L(t,r,e,!1,"a1"),e.contextDep=a,e.needsContext=i,e.needsFramebuffer=u;var f=e.shader.progVar;if(f.contextDep&&a||f.propDep)Y(t,r,e,null);else{var s=f.append(t,r);if(r(t.shared.gl,".useProgram(",s,".program);"),e.shader.program)Y(t,r,e,e.shader.program);else{var l=t.global.def("{}"),c=r.def(s,".id"),m=r.def(l,"[",c,"]");r(t.cond(m).then(m,".call(this,a0,a1);").else(m,"=",l,"[",c,"]=",t.link(function(n){return R(Y,t,e,n,2)}),"(",s,");",m,".call(this,a0,a1);"))}}Object.keys(e.state).length>0&&r(t.shared.current,".dirty=true;")}function V(t,n){function r(e){var r=n.shader[e];r&&a.set(i.shader,"."+e,r.append(t,a))}var a=t.proc("scope",3);t.batchId="a2";var i=t.shared,o=i.current;_(t,a,n.context),n.framebuffer&&n.framebuffer.append(t,a),Yt(Object.keys(n.state)).forEach(function(e){var r=n.state[e],o=r.append(t,a);pt(o)?o.forEach(function(n,r){a.set(t.next[e],"["+r+"]",n)}):a.set(i.next,"."+e,o)}),L(t,a,n,!0,!0),[ro,oo,io,uo,ao].forEach(function(e){var r=n.draw[e];r&&a.set(i.draw,"."+e,""+r.append(t,a))}),Object.keys(n.uniforms).forEach(function(r){a.set(i.uniforms,"["+e.id(r)+"]",n.uniforms[r].append(t,a))}),Object.keys(n.attributes).forEach(function(e){var r=n.attributes[e].append(t,a),i=t.scopeAttrib(e);Object.keys(new X).forEach(function(t){a.set(i,"."+t,r[t])})}),r(eo),r(no),Object.keys(n.state).length>0&&(a(o,".dirty=true;"),a.exit(o,".dirty=true;")),
a("a1(",t.shared.context,",a0,",t.batchId,");")}function W(t){if("object"==typeof t&&!pt(t)){for(var e=Object.keys(t),n=0;n<e.length;++n)if(we.isDynamic(t[e[n]]))return!0;return!1}}function H(t,e,n){function r(t,e){o.forEach(function(n){var r=a[n];if(we.isDynamic(r)){var i=t.invoke(e,r);e(l,".",n,"=",i,";")}})}var a=e.static[n];if(a&&W(a)){var i=t.global,o=Object.keys(a),u=!1,f=!1,s=!1,l=t.global.def("{}");o.forEach(function(e){var n=a[e];if(we.isDynamic(n)){"function"==typeof n&&(n=a[e]=we.unbox(n));var r=Ht(n,null);u=u||r.thisDep,s=s||r.propDep,f=f||r.contextDep}else{switch(i(l,".",e,"="),typeof n){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(t.link(n))}i(";")}}),e.dynamic[n]=new we.DynamicVariable(Ii,{thisDep:u,contextDep:f,propDep:s,ref:l,append:r}),delete e.static[n]}}function G(t,e,n,r,a){var i=g();i.stats=i.link(a),Object.keys(e.static).forEach(function(t){H(i,e,t)}),go.forEach(function(e){H(i,t,e)});var o=E(t,e,n,r,i);return N(i,o),V(i,o),U(i,o),i.compile()}var X=s.Record,Q={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(Q.min=nu,Q.max=ru);var $=n.angle_instanced_arrays,K=n.webgl_draw_buffers,J={dirty:!0,profile:h.profile},tt={},et=[],nt={},rt={};b(Fi,Ao),b(Ai,Fo),v(Ei,"blendColor",[0,0,0,0]),v(_i,"blendEquationSeparate",[fu,fu]),v(ki,"blendFuncSeparate",[uu,ou,uu,ou]),b(zi,_o,!0),v(Ti,"depthFunc",su),v(Oi,"depthRange",[0,1]),v(Li,"depthMask",!0),v(Pi,Pi,[!0,!0,!0,!0]),b(ji,Io),v(Ci,"cullFace",Jo),v(Ri,Ri,eu),v(qi,qi,1),b(Ni,zo),v(Bi,"polygonOffset",[0,0]),b(Yi,To),b(Ui,Oo),v(Vi,"sampleCoverage",[1,!1]),b(Wi,Eo),v(Hi,"stencilMask",-1),v(Gi,"stencilFunc",[au,0,-1]),v(Xi,"stencilOpSeparate",[Ko,iu,iu,iu]),v(Qi,"stencilOpSeparate",[Jo,iu,iu,iu]),b(Zi,ko),v($i,"scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),v(Ki,Ki,[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var at={gl:t,context:m,strings:e,next:tt,current:J,draw:c,elements:i,buffer:a,shader:l,attributes:s.state,uniforms:f,framebuffer:u,extensions:n,timer:d,isBufferArgs:Bt},it={primTypes:Cn,compareFuncs:hu,blendFuncs:mu,blendEquations:Q,stencilOps:pu,glTypes:yn,orientationType:vu};ye.optional(function(){at.isArrayLike=pt}),K&&(it.backBuffer=[Jo],it.drawBuffer=Z(r.maxDrawbuffers,function(t){return 0===t?[0]:Z(t,function(t){return cu+t})}));var ot=0;return{next:tt,current:J,procs:function(){var e=g(),n=e.proc("poll"),a=e.proc("refresh"),i=e.block();n(i),a(i);var o=e.shared,u=o.gl,f=o.next,s=o.current;i(s,".dirty=false;"),k(e,n),k(e,a,null,!0);var l,c=t.getExtension("angle_instanced_arrays");c&&(l=e.link(c));for(var m=0;m<r.maxAttributes;++m){var d=a.def(o.attributes,"[",m,"]"),h=e.cond(d,".buffer");h.then(u,".enableVertexAttribArray(",m,");",u,".bindBuffer(",xo,",",d,".buffer.buffer);",u,".vertexAttribPointer(",m,",",d,".size,",d,".type,",d,".normalized,",d,".stride,",d,".offset);").else(u,".disableVertexAttribArray(",m,");",u,".vertexAttrib4f(",m,",",d,".x,",d,".y,",d,".z,",d,".w);",d,".buffer=null;"),a(h),c&&a(l,".vertexAttribDivisorANGLE(",m,",",d,".divisor);")}return Object.keys(nt).forEach(function(t){var r=nt[t],o=i.def(f,".",t),l=e.block();l("if(",o,"){",u,".enable(",r,")}else{",u,".disable(",r,")}",s,".",t,"=",o,";"),a(l),n("if(",o,"!==",s,".",t,"){",l,"}")}),Object.keys(rt).forEach(function(t){var r,o,l=rt[t],c=J[t],m=e.block();if(m(u,".",l,"("),pt(c)){var d=c.length;r=e.global.def(f,".",t),o=e.global.def(s,".",t),m(Z(d,function(t){return r+"["+t+"]"}),");",Z(d,function(t){return o+"["+t+"]="+r+"["+t+"];"}).join("")),n("if(",Z(d,function(t){return r+"["+t+"]!=="+o+"["+t+"]"}).join("||"),"){",m,"}")}else r=i.def(f,".",t),o=i.def(s,".",t),m(r,");",s,".",t,"=",r,";"),n("if(",r,"!==",o,"){",m,"}");a(m)}),e.compile()}(),compile:G}}function Xt(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}function Qt(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}function Zt(t){function e(){if(0===V.length)return D&&D.update(),void(Z=null);Z=De.next(e),m();for(var t=V.length-1;t>=0;--t){var n=V[t];n&&n(E,null,0)}v.flush(),D&&D.update()}function n(){!Z&&V.length>0&&(Z=De.next(e))}function r(){Z&&(De.cancel(e),Z=null)}function a(t){t.preventDefault(),x=!0,r(),W.forEach(function(t){t()})}function i(t){v.getError(),x=!1,y.restore(),P.restore(),T.restore(),j.restore(),C.restore(),R.restore(),D&&D.restore(),q.procs.refresh(),n(),H.forEach(function(t){t()})}function o(){V.length=0,r(),U&&(U.removeEventListener(Au,a),U.removeEventListener(Eu,i)),P.clear(),R.clear(),C.clear(),j.clear(),O.clear(),T.clear(),D&&D.clear(),Q.forEach(function(t){t()})}function u(t){function e(t){function e(t){if(t in n){var e=n[t];delete n[t],Object.keys(e).forEach(function(r){n[t+"."+r]=e[r]})}}var n=Jt({},t);return delete n.uniforms,delete n.attributes,delete n.context,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),e("blend"),e("depth"),e("cull"),e("stencil"),e("polygonOffset"),e("scissor"),e("sample"),n}function n(t){var e={},n={};return Object.keys(t).forEach(function(r){var a=t[r];we.isDynamic(a)?n[r]=we.unbox(a,r):e[r]=a}),{dynamic:n,static:e}}function r(t){for(;h.length<t;)h.push(null);return h}function a(t,e){var n;if(x&&ye.raise("context lost"),"function"==typeof t)return d.call(this,null,t,0);if("function"==typeof e){if("number"==typeof t){for(n=0;n<t;++n)d.call(this,null,e,n);return}if(Array.isArray(t)){for(n=0;n<t.length;++n)d.call(this,t[n],e,n);return}return d.call(this,t,e,0)}if("number"==typeof t){if(t>0)return m.call(this,r(0|t),0|t)}else{if(!Array.isArray(t))return c.call(this,t);if(t.length)return m.call(this,t,t.length)}}ye(!!t,"invalid args to regl({...})"),ye.type(t,"object","invalid args to regl({...})");var i=n(t.context||{}),o=n(t.uniforms||{}),u=n(t.attributes||{}),f=n(e(t)),s={gpuTime:0,cpuTime:0,count:0},l=q.compile(f,u,o,i,s),c=l.draw,m=l.batch,d=l.scope,h=[];return Jt(a,{stats:s})}function f(t,e){var n=0;q.procs.poll();var r=e.color;r&&(v.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=wu),"depth"in e&&(v.clearDepth(+e.depth),n|=Du),"stencil"in e&&(v.clearStencil(0|e.stencil),n|=Iu),ye(!!n,"called regl.clear with no buffer specified"),v.clear(n)}function s(t){if(ye("object"==typeof t&&t,"regl.clear() takes an object as input"),"framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var e=0;e<6;++e)$(Jt({framebuffer:t.framebuffer.faces[e]},t),f);else $(t,f);else f(null,t)}function l(t){function e(){function e(){var t=Qt(V,e);V[t]=V[V.length-1],V.length-=1,V.length<=0&&r()}var n=Qt(V,t);ye(n>=0,"cannot cancel a frame twice"),V[n]=e}return ye.type(t,"function","regl.frame() callback must be a function"),V.push(t),n(),{cancel:e}}function c(){var t=Y.viewport,e=Y.scissor_box;t[0]=t[1]=e[0]=e[1]=0,E.viewportWidth=E.framebufferWidth=E.drawingBufferWidth=t[2]=e[2]=v.drawingBufferWidth,E.viewportHeight=E.framebufferHeight=E.drawingBufferHeight=t[3]=e[3]=v.drawingBufferHeight}function m(){E.tick+=1,E.time=h(),c(),q.procs.poll()}function d(){c(),q.procs.refresh(),D&&D.update()}function h(){return(Ie()-I)/1e3}function p(t,e){ye.type(e,"function","listener callback must be a function");var n;switch(t){case"frame":return l(e);case"lost":n=W;break;case"restore":n=H;break;case"destroy":n=Q;break;default:ye.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(e),{cancel:function(){for(var t=0;t<n.length;++t)if(n[t]===e)return n[t]=n[n.length-1],void n.pop()}}}var b=G(t);if(!b)return null;var v=b.gl,g=v.getContextAttributes(),x=v.isContextLost(),y=X(v,b);if(!y)return null;var M=N(),S=Xt(),w=y.extensions,D=Su(v,w),I=Ie(),F=v.drawingBufferWidth,A=v.drawingBufferHeight,E={tick:0,time:0,viewportWidth:F,viewportHeight:A,framebufferWidth:F,framebufferHeight:A,drawingBufferWidth:F,drawingBufferHeight:A,pixelRatio:b.pixelRatio},_={},k={elements:null,primitive:4,count:-1,offset:0,instances:-1},z=Je(v,w),T=mt(v,S,b),O=dt(v,w,T,S),L=Pt(v,w,z,T,M),P=jt(v,M,S,b),j=zt(v,w,z,function(){q.procs.poll()},E,S,b),C=Ea(v,w,z,S,b),R=Ot(v,w,z,j,C,S),q=Gt(v,M,w,z,T,O,j,R,_,L,P,k,E,D,b),B=Ct(v,R,q.procs.poll,E,g,w),Y=q.next,U=v.canvas,V=[],W=[],H=[],Q=[b.onDestroy],Z=null;U&&(U.addEventListener(Au,a,!1),U.addEventListener(Eu,i,!1));var $=R.setFBO=u({framebuffer:we.define.call(null,_u,"framebuffer")});d();var K=Jt(u,{clear:s,prop:we.define.bind(null,_u),context:we.define.bind(null,ku),this:we.define.bind(null,zu),draw:u({}),buffer:function(t){return T.create(t,Fu,!1,!1)},elements:function(t){return O.create(t,!1)},texture:j.create2D,cube:j.createCube,renderbuffer:C.create,framebuffer:R.create,framebufferCube:R.createCube,attributes:g,frame:l,on:p,limits:z,hasExtension:function(t){return z.extensions.indexOf(t.toLowerCase())>=0},read:B,destroy:o,_gl:v,_refresh:d,poll:function(){m(),D&&D.update()},now:h,stats:S});return b.onDone(null,K),K}var $t={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Kt=function(t){return Object.prototype.toString.call(t)in $t},Jt=function(t,e){for(var n=Object.keys(e),r=0;r<n.length;++r)t[n[r]]=e[n[r]];return t},te=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"],ee=33071,ne=9728,re=9984,ae=9985,ie=9986,oe=9987,ue=5120,fe=5121,se=5122,le=5123,ce=5124,me=5125,de=5126,he=32819,pe=32820,be=33635,ve=34042,ge=36193,xe={};xe[ue]=xe[fe]=1,xe[se]=xe[le]=xe[ge]=xe[be]=xe[he]=xe[pe]=2,xe[ce]=xe[me]=xe[de]=xe[ve]=4;var ye=Jt(n,{optional:A,raise:e,commandRaise:w,command:D,parameter:a,commandParameter:I,constructor:s,type:o,commandType:F,isTypedArray:i,nni:u,oneOf:f,shaderError:x,linkError:y,callSite:p,saveCommandRef:M,saveDrawInfo:S,framebufferFormat:E,guessCommand:h,texture2D:z,textureCube:T}),Me=0,Se=0,we={DynamicVariable:O,define:C,isDynamic:R,unbox:q,accessor:j},De={next:"function"==typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"==typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},Ie="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},Fe=3408,Ae=3410,Ee=3411,_e=3412,ke=3413,ze=3414,Te=3415,Oe=33901,Le=33902,Pe=3379,je=3386,Ce=34921,Re=36347,qe=36348,Ne=35661,Be=35660,Ye=34930,Ue=36349,Ve=34076,We=34024,He=7936,Ge=7937,Xe=7938,Qe=35724,Ze=34047,$e=36063,Ke=34852,Je=function(t,e){var n=1;e.ext_texture_filter_anisotropic&&(n=t.getParameter(Ze));var r=1,a=1;return e.webgl_draw_buffers&&(r=t.getParameter(Ke),a=t.getParameter($e)),{colorBits:[t.getParameter(Ae),t.getParameter(Ee),t.getParameter(_e),t.getParameter(ke)],depthBits:t.getParameter(ze),stencilBits:t.getParameter(Te),subpixelBits:t.getParameter(Fe),extensions:Object.keys(e).filter(function(t){return!!e[t]}),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:a,pointSizeDims:t.getParameter(Oe),lineWidthDims:t.getParameter(Le),maxViewportDims:t.getParameter(je),maxCombinedTextureUnits:t.getParameter(Ne),maxCubeMapSize:t.getParameter(Ve),maxRenderbufferSize:t.getParameter(We),maxTextureUnits:t.getParameter(Ye),maxTextureSize:t.getParameter(Pe),maxAttributes:t.getParameter(Ce),maxVertexUniforms:t.getParameter(Re),maxVertexTextureUnits:t.getParameter(Be),maxVaryingVectors:t.getParameter(qe),maxFragmentUniforms:t.getParameter(Ue),glsl:t.getParameter(Qe),renderer:t.getParameter(Ge),vendor:t.getParameter(He),version:t.getParameter(Xe)}},tn=function(t){return Object.keys(t).map(function(e){return t[e]})},en=5120,nn=5121,rn=5122,an=5123,on=5124,un=5125,fn=5126,sn=Z(8,function(){return[]}),ln={alloc:J,free:tt,allocType:et,freeType:nt},cn={shape:ft,flatten:ut},mn=5120,dn=5122,hn=5124,pn=5121,bn=5123,vn=5125,gn=5126,xn=5126,yn={int8:mn,int16:dn,int32:hn,uint8:pn,uint16:bn,uint32:vn,float:gn,float32:xn},Mn=35048,Sn=35040,wn={dynamic:Mn,stream:Sn,static:35044},Dn=cn.flatten,In=cn.shape,Fn=35044,An=35040,En=5121,_n=5126,kn=[];kn[5120]=1,kn[5122]=2,kn[5124]=4,kn[5121]=1,kn[5123]=2,kn[5125]=4,kn[5126]=4;var zn=0,Tn=0,On=1,Ln=1,Pn=4,jn=4,Cn={points:zn,point:Tn,lines:On,line:Ln,triangles:Pn,triangle:jn,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Rn=0,qn=1,Nn=4,Bn=5120,Yn=5121,Un=5122,Vn=5123,Wn=5124,Hn=5125,Gn=34963,Xn=35040,Qn=35044,Zn=new Float32Array(1),$n=new Uint32Array(Zn.buffer),Kn=5123,Jn=34467,tr=3553,er=34067,nr=34069,rr=6408,ar=6406,ir=6407,or=6409,ur=6410,fr=32854,sr=32855,lr=36194,cr=32819,mr=32820,dr=33635,hr=34042,pr=6402,br=34041,vr=35904,gr=35906,xr=36193,yr=33776,Mr=33777,Sr=33778,wr=33779,Dr=35986,Ir=35987,Fr=34798,Ar=35840,Er=35841,_r=35842,kr=35843,zr=36196,Tr=5121,Or=5123,Lr=5125,Pr=5126,jr=10242,Cr=10243,Rr=10497,qr=33071,Nr=33648,Br=10240,Yr=10241,Ur=9728,Vr=9729,Wr=9984,Hr=9985,Gr=9986,Xr=9987,Qr=33170,Zr=4352,$r=4353,Kr=4354,Jr=34046,ta=3317,ea=37440,na=37441,ra=37443,aa=37444,ia=33984,oa=[Wr,Gr,Hr,Xr],ua=[0,or,ur,ir,rr],fa={};fa[or]=fa[ar]=fa[pr]=1,fa[br]=fa[ur]=2,fa[ir]=fa[vr]=3,fa[rr]=fa[gr]=4;var sa=bt("HTMLCanvasElement"),la=bt("CanvasRenderingContext2D"),ca=bt("HTMLImageElement"),ma=bt("HTMLVideoElement"),da=Object.keys($t).concat([sa,la,ca,ma]),ha=[];ha[Tr]=1,ha[Pr]=4,ha[xr]=2,ha[Or]=2,ha[Lr]=4;var pa=[];pa[fr]=2,pa[sr]=2,pa[lr]=2,pa[br]=4,pa[yr]=.5,pa[Mr]=.5,pa[Sr]=1,pa[wr]=1,pa[Dr]=.5,pa[Ir]=1,pa[Fr]=1,pa[Ar]=.5,pa[Er]=.25,pa[_r]=.5,pa[kr]=.25,pa[zr]=.5;var ba=36161,va=32854,ga=32855,xa=36194,ya=33189,Ma=36168,Sa=34041,wa=35907,Da=34836,Ia=34842,Fa=34843,Aa=[];Aa[va]=2,Aa[ga]=2,Aa[xa]=2,Aa[ya]=2,Aa[Ma]=1,Aa[Sa]=4,Aa[wa]=4,Aa[Da]=16,Aa[Ia]=8,Aa[Fa]=6;var Ea=function(t,e,n,r,a){function i(t){this.id=c++,this.refCount=1,this.renderbuffer=t,this.format=va,this.width=0,this.height=0,a.profile&&(this.stats={size:0})}function o(e){var n=e.renderbuffer;ye(n,"must not double destroy renderbuffer"),t.bindRenderbuffer(ba,null),t.deleteRenderbuffer(n),e.renderbuffer=null,e.refCount=0,delete m[e.id],r.renderbufferCount--}function u(e,o){function u(e,r){var i=0,o=0,f=va;if("object"==typeof e&&e){var m=e;if("shape"in m){var d=m.shape;ye(Array.isArray(d)&&d.length>=2,"invalid renderbuffer shape"),i=0|d[0],o=0|d[1]}else"radius"in m&&(i=o=0|m.radius),"width"in m&&(i=0|m.width),"height"in m&&(o=0|m.height);"format"in m&&(ye.parameter(m.format,s,"invalid renderbuffer format"),f=s[m.format])}else"number"==typeof e?(i=0|e,o="number"==typeof r?0|r:i):e?ye.raise("invalid arguments to renderbuffer constructor"):i=o=1;if(ye(i>0&&o>0&&i<=n.maxRenderbufferSize&&o<=n.maxRenderbufferSize,"invalid renderbuffer size"),i!==c.width||o!==c.height||f!==c.format)return u.width=c.width=i,u.height=c.height=o,c.format=f,t.bindRenderbuffer(ba,c.renderbuffer),t.renderbufferStorage(ba,f,i,o),a.profile&&(c.stats.size=Tt(c.format,c.width,c.height)),u.format=l[c.format],u}function f(e,r){var i=0|e,o=0|r||i;return i===c.width&&o===c.height?u:(ye(i>0&&o>0&&i<=n.maxRenderbufferSize&&o<=n.maxRenderbufferSize,"invalid renderbuffer size"),u.width=c.width=i,u.height=c.height=o,t.bindRenderbuffer(ba,c.renderbuffer),t.renderbufferStorage(ba,c.format,i,o),a.profile&&(c.stats.size=Tt(c.format,c.width,c.height)),u)}var c=new i(t.createRenderbuffer());return m[c.id]=c,r.renderbufferCount++,u(e,o),u.resize=f,u._reglType="renderbuffer",u._renderbuffer=c,a.profile&&(u.stats=c.stats),u.destroy=function(){c.decRef()},u}function f(){tn(m).forEach(function(e){e.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(ba,e.renderbuffer),t.renderbufferStorage(ba,e.format,e.width,e.height)}),t.bindRenderbuffer(ba,null)}var s={rgba4:va,rgb565:xa,"rgb5 a1":ga,depth:ya,stencil:Ma,"depth stencil":Sa};e.ext_srgb&&(s.srgba=wa),e.ext_color_buffer_half_float&&(s.rgba16f=Ia,s.rgb16f=Fa),e.webgl_color_buffer_float&&(s.rgba32f=Da);var l=[];Object.keys(s).forEach(function(t){var e=s[t];l[e]=t});var c=0,m={};return i.prototype.decRef=function(){--this.refCount<=0&&o(this)},a.profile&&(r.getTotalRenderbufferSize=function(){var t=0;return Object.keys(m).forEach(function(e){t+=m[e].stats.size}),t}),{create:u,clear:function(){tn(m).forEach(o)},restore:f}},_a=36160,ka=36161,za=3553,Ta=34069,Oa=36064,La=36096,Pa=36128,ja=33306,Ca=36053,Ra=36054,qa=36055,Na=36057,Ba=36061,Ya=36193,Ua=5121,Va=5126,Wa=6408,Ha=6402,Ga=[Wa],Xa=[];Xa[Wa]=4;var Qa=[];Qa[Ua]=1,Qa[Va]=4,Qa[Ya]=2;var Za=32854,$a=32855,Ka=36194,Ja=33189,ti=36168,ei=34041,ni=35907,ri=34836,ai=34842,ii=34843,oi=[Za,$a,Ka,ni,ai,ii,ri],ui={};ui[Ca]="complete",ui[Ra]="incomplete attachment",ui[Na]="incomplete dimensions",ui[qa]="incomplete, missing attachment",ui[Ba]="unsupported";var fi=5126,si=35632,li=35633,ci=35718,mi=35721,di=6408,hi=5121,pi=3333,bi=5126,vi="xyzw".split(""),gi=5121,xi=1,yi=2,Mi=0,Si=1,wi=2,Di=3,Ii=4,Fi="dither",Ai="blend.enable",Ei="blend.color",_i="blend.equation",ki="blend.func",zi="depth.enable",Ti="depth.func",Oi="depth.range",Li="depth.mask",Pi="colorMask",ji="cull.enable",Ci="cull.face",Ri="frontFace",qi="lineWidth",Ni="polygonOffset.enable",Bi="polygonOffset.offset",Yi="sample.alpha",Ui="sample.enable",Vi="sample.coverage",Wi="stencil.enable",Hi="stencil.mask",Gi="stencil.func",Xi="stencil.opFront",Qi="stencil.opBack",Zi="scissor.enable",$i="scissor.box",Ki="viewport",Ji="profile",to="framebuffer",eo="vert",no="frag",ro="elements",ao="primitive",io="count",oo="offset",uo="instances",fo="Width",so="Height",lo=to+fo,co=to+so,mo=Ki+fo,ho=Ki+so,po="drawingBuffer",bo=po+fo,vo=po+so,go=[ki,_i,Gi,Xi,Qi,Vi,Ki,$i,Bi],xo=34962,yo=34963,Mo=35632,So=35633,wo=3553,Do=34067,Io=2884,Fo=3042,Ao=3024,Eo=2960,_o=2929,ko=3089,zo=32823,To=32926,Oo=32928,Lo=5126,Po=35664,jo=35665,Co=35666,Ro=5124,qo=35667,No=35668,Bo=35669,Yo=35670,Uo=35671,Vo=35672,Wo=35673,Ho=35674,Go=35675,Xo=35676,Qo=35678,Zo=35680,$o=4,Ko=1028,Jo=1029,tu=2304,eu=2305,nu=32775,ru=32776,au=519,iu=7680,ou=0,uu=1,fu=32774,su=513,lu=36160,cu=36064,mu={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},du=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],hu={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},pu={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},bu={frag:Mo,vert:So},vu={cw:tu,ccw:eu},gu=new Ut(!1,!1,!1,function(){}),xu=34918,yu=34919,Mu=35007,Su=function(t,e){function n(){return m.pop()||c.createQueryEXT()}function r(t){m.push(t)}function a(t){var e=n();c.beginQueryEXT(Mu,e),d.push(e),s(d.length-1,d.length,t)}function i(){c.endQueryEXT(Mu)}function o(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}function u(){return h.pop()||new o}function f(t){h.push(t)}function s(t,e,n){var r=u();r.startQueryIndex=t,r.endQueryIndex=e,r.sum=0,r.stats=n,p.push(r)}function l(){var t,e,n=d.length;if(0!==n){v.length=Math.max(v.length,n+1),b.length=Math.max(b.length,n+1),b[0]=0,v[0]=0;var a=0;for(t=0,e=0;e<d.length;++e){var i=d[e];c.getQueryObjectEXT(i,yu)?(a+=c.getQueryObjectEXT(i,xu),r(i)):d[t++]=i,b[e+1]=a,v[e+1]=t}for(d.length=t,t=0,e=0;e<p.length;++e){var o=p[e],u=o.startQueryIndex,s=o.endQueryIndex;o.sum+=b[s]-b[u];var l=v[u],m=v[s];m===l?(o.stats.gpuTime+=o.sum/1e6,f(o)):(o.startQueryIndex=l,o.endQueryIndex=m,p[t++]=o)}p.length=t}}var c=e.ext_disjoint_timer_query;if(!c)return null;var m=[],d=[],h=[],p=[],b=[],v=[];return{beginQuery:a,endQuery:i,pushScopeStats:s,update:l,getNumPendingQueries:function(){return d.length},clear:function(){m.push.apply(m,d);for(var t=0;t<m.length;t++)c.deleteQueryEXT(m[t]);d.length=0,m.length=0},restore:function(){d.length=0,m.length=0}}},wu=16384,Du=256,Iu=1024,Fu=34962,Au="webglcontextlost",Eu="webglcontextrestored",_u=1,ku=2,zu=3;return Zt})},{}],51:[function(t,e,n){function r(t,e){function n(){o[0]=o[1]=o[2]=0}function r(t){var n=1===t.deltaMode?12:1;o[0]+=n*(t.deltaX||0),o[1]+=n*(t.deltaY||0),o[2]+=n*(t.deltaZ||0),o.emit("scroll",o),e&&t.preventDefault&&(t.preventDefault(),t.stopPropagation&&t.stopPropagation())}var o=new a;return o.flush=n,n(),"undefined"==typeof window?o:(t=t||window,i(t,r,!1),o)}var a=t(5),i=t(53);e.exports=r},{5:5,53:53}],52:[function(t,e,n){var r,a="undefined"!=typeof window?window.navigator.userAgent:"",i=/OS X/.test(a),o=/Opera/.test(a),u=!/like Gecko/.test(a)&&!o,f=e.exports={0:i?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",27:"<escape>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:i?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num-->",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:i&&u?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:o?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(r=58;r<65;++r)f[r]=String.fromCharCode(r);for(r=48;r<58;++r)f[r]=r-48+"";for(r=65;r<91;++r)f[r]=String.fromCharCode(r);for(r=96;r<106;++r)f[r]="<num-"+(r-96)+">";for(r=112;r<136;++r)f[r]="F"+(r-111)},{}],53:[function(t,e,n){function r(t,e,n){a(t,o,e,n),"DOMMouseScroll"==o&&a(t,"MozMousePixelScroll",e,n)}function a(t,e,n,r){t[i](u+e,"wheel"==o?n:function(t){!t&&(t=window.event);var e={originalEvent:t,target:t.target||t.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==t.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){t.preventDefault?t.preventDefault():t.returnValue=!1}};return"mousewheel"==o?(e.deltaY=-.025*t.wheelDelta,t.wheelDeltaX&&(e.deltaX=-.025*t.wheelDeltaX)):e.deltaY=t.detail,n(e)},r||!1)}e.exports=r;var i,o,u="";window.addEventListener?i="addEventListener":(i="attachEvent",u="on"),o="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"},{}],54:[function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function a(){var t=h(Math.random()*(M[1]-M[0])+M[0]|0).map(function(){var t=Math.random()*Math.PI*2,e=Math.acos(2*Math.random()-1),n=Math.pow(Math.random(),-.1)/2;return[Math.cos(t)*Math.sin(e)*n,Math.sin(t)*Math.sin(e)*n,Math.cos(e)*n]});t.unshift(t[0].map(function(t){return t+1})),t.push(t[t.length-1].map(function(t){return t+1}));var e=20*Math.random()+50,n=Math.random();return l(t,{samples:Math.min(10*t.length,100)}).map(function(t,a,i){return t=[].concat(r(t.map(function(t){return t*e}))),{position:t,randSeed:n,size:Math.random()+1,color:[(t[0]/e/2+.5)/2+.5,(t[1]/e/2+.5)/2+.5,t[2]/i.length/2+.5]}})}function i(t){return D[t]?D[t]:(D[t]=x({attributes:{position:S[t].map(function(t){return t.position}),color:S[t].map(function(t){return t.color}),randSeed:S[t].map(function(t){return t.randSeed}),pointSize:S[t].map(function(t){return t.size})},count:S[t].length}),D[t])}function o(){for(var t=0;t<S.length;t++)D[t]=i(t)}function u(){var t=x.frame(function(t){t.time;x.clear({color:[1,1,1,1],depth:1}),g.tick(),w(function(){for(var t=0;t<S.length;t+=1)i(t)()})});I=t.cancel}var f=t(50),s=t(43),l=t(3),c=t(1),m=t(15),d=t(2),h=t(47),p=s(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 color;\nattribute float randSeed;\nattribute float pointSize;\n\nvarying vec3 fragColor;\n\nuniform mat4 projection;\nuniform mat4 view;\n\n// uniform float pointSize;\nuniform float tick;\n\nvoid main() {\n  vec3 newPosition = vec3(position.xy, sin((randSeed * 10000.0 + tick) / 200.0) * 10.0);\n  // vec3 newPosition = position.xyz;\n  fragColor = color;\n  gl_PointSize = pointSize;\n  gl_Position = projection * view * vec4(newPosition, 1.0);\n}\n"]),b=s(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec3 fragColor;\nvarying float distanceFromCamera;\n\nvoid main() {\n  gl_FragColor = vec4(fragColor, 1.0);\n}\n"]),v=document.createElement("canvas"),g=d(v),x=f(v),y=100,M=[15,15],S=h(y).map(function(){return a()});console.log("points",S[0].length*y);var w=x({vert:p,frag:b,uniforms:{projection:function(t){var e=t.viewportWidth,n=t.viewportHeight;return m.perspective([],Math.PI/2,e/n,.01,1e3)},model:m.identity([]),view:function(){return g.view()},aspect:function(t){var e=t.viewportWidth,n=t.viewportHeight;return e/n},tick:x.context("tick")},primitive:"point"}),D={};o();var I=void 0;window.addEventListener("resize",c(v),!1),document.body.appendChild(v),u(),document.body.addEventListener("keyup",function(t){32===t.which&&(I?(I(),I=null):u())})},{1:1,15:15,2:2,3:3,43:43,47:47,50:50}]},{},[54]);