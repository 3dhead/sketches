!function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[a]={exports:{}};t[a][0].call(f.exports,function(e){var n=t[a][1][e];return i(n?n:e)},f,f.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){"use strict";function r(e,t){function n(t,n,r,o){var a=1/e.clientHeight,s=a*(n-m),u=a*(r-v),f=p.flipX?1:-1,d=p.flipY?1:-1,h=Math.PI*p.rotateSpeed,b=i();if(1&t)o.shift?c.rotate(b,0,0,-s*h):c.rotate(b,f*h*s,-d*h*u,0);else if(2&t)c.pan(b,-p.translateSpeed*s*l,p.translateSpeed*u*l,0);else if(4&t){var y=p.zoomSpeed*u/window.innerHeight*(b-c.lastT())*50;c.pan(b,0,0,l*(Math.exp(y)-1))}m=n,v=r,g=o}e=e||document.body,t=t||{};var r=[.01,1/0];"distanceLimits"in t&&(r[0]=t.distanceLimits[0],r[1]=t.distanceLimits[1]),"zoomMin"in t&&(r[0]=t.zoomMin),"zoomMax"in t&&(r[1]=t.zoomMax);var c=o({center:t.center||[0,0,0],up:t.up||[0,1,0],eye:t.eye||[0,0,10],mode:t.mode||"orbit",distanceLimits:r}),f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=0,d=e.clientWidth,h=e.clientHeight,p={view:c,element:e,delay:t.delay||16,rotateSpeed:t.rotateSpeed||1,zoomSpeed:t.zoomSpeed||1,translateSpeed:t.translateSpeed||1,flipX:!!t.flipX,flipY:!!t.flipY,modes:c.modes,tick:function(){var t=i(),n=this.delay;c.idle(t-n),c.flush(t-(100+2*n));var r=t-2*n;c.recalcMatrix(r);for(var o=!0,a=c.computedMatrix,s=0;s<16;++s)o=o&&f[s]===a[s],f[s]=a[s];var u=e.clientWidth===d&&e.clientHeight===h;return d=e.clientWidth,h=e.clientHeight,o?!u:(l=Math.exp(c.computedRadius[0]),!0)},lookAt:function(e,t,n){c.lookAt(c.lastT(),e,t,n)},rotate:function(e,t,n){c.rotate(c.lastT(),e,t,n)},pan:function(e,t,n){c.pan(c.lastT(),e,t,n)},translate:function(e,t,n){c.translate(c.lastT(),e,t,n)}};Object.defineProperties(p,{matrix:{get:function(){return c.computedMatrix},set:function(e){return c.setMatrix(c.lastT(),e),c.computedMatrix},enumerable:!0},mode:{get:function(){return c.getMode()},set:function(e){return c.setMode(e),c.getMode()},enumerable:!0},center:{get:function(){return c.computedCenter},set:function(e){return c.lookAt(c.lastT(),e),c.computedCenter},enumerable:!0},eye:{get:function(){return c.computedEye},set:function(e){return c.lookAt(c.lastT(),null,e),c.computedEye},enumerable:!0},up:{get:function(){return c.computedUp},set:function(e){return c.lookAt(c.lastT(),null,null,e),c.computedUp},enumerable:!0},distance:{get:function(){return l},set:function(e){return c.setDistance(c.lastT(),e),e},enumerable:!0},distanceLimits:{get:function(){return c.getDistanceLimits(r)},set:function(e){return c.setDistanceLimits(e),e},enumerable:!0}}),e.addEventListener("contextmenu",function(e){return e.preventDefault(),!1});var m=0,v=0,g={shift:!1,control:!1,alt:!1,meta:!1};return a(e,n),e.addEventListener("touchstart",function(t){var r=u(t.changedTouches[0],e);n(0,r[0],r[1],g),n(1,r[0],r[1],g)}),e.addEventListener("touchmove",function(t){var r=u(t.changedTouches[0],e);n(1,r[0],r[1],g)}),e.addEventListener("touchend",function(t){u(t.changedTouches[0],e);n(0,m,v,g)}),s(e,function(e,t,n){var r=p.flipX?1:-1,o=p.flipY?1:-1,a=i();if(Math.abs(e)>Math.abs(t))c.rotate(a,0,0,-e*r*Math.PI*p.rotateSpeed/window.innerWidth);else{var s=p.zoomSpeed*o*t/window.innerHeight*(a-c.lastT())/100;c.pan(a,0,0,l*(Math.exp(s)-1))}},!0),p}t.exports=r;var i=e(91),o=e(2),a=e(80),s=e(83),u=e(81)},{2:2,80:80,81:81,83:83,91:91}],2:[function(e,t,n){"use strict";function r(e,t){this._controllerNames=Object.keys(e),this._controllerList=this._controllerNames.map(function(t){return e[t]}),this._mode=t,this._active=e[t],this._active||(this._mode="turntable",this._active=e.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}function i(e){e=e||{};var t=e.eye||[0,0,1],n=e.center||[0,0,0],i=e.up||[0,1,0],u=e.distanceLimits||[0,1/0],c=e.mode||"turntable",f=o(),l=a(),d=s();return f.setDistanceLimits(u[0],u[1]),f.lookAt(0,t,n,i),l.setDistanceLimits(u[0],u[1]),l.lookAt(0,t,n,i),d.setDistanceLimits(u[0],u[1]),d.lookAt(0,t,n,i),new r({turntable:f,orbit:l,matrix:d},c)}t.exports=i;var o=e(97),a=e(86),s=e(79),u=r.prototype,c=[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]];c.forEach(function(e){for(var t=e[0],n=[],r=0;r<e[1];++r)n.push("a"+r);var i="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+e[0]+"("+n.join()+")}";u[t]=Function.apply(null,n.concat(i))}),u.recalcMatrix=function(e){this._active.recalcMatrix(e)},u.getDistance=function(e){return this._active.getDistance(e)},u.getDistanceLimits=function(e){return this._active.getDistanceLimits(e)},u.lastT=function(){return this._active.lastT()},u.setMode=function(e){if(e!==this._mode){var t=this._controllerNames.indexOf(e);if(!(t<0)){var n=this._active,r=this._controllerList[t],i=Math.max(n.lastT(),r.lastT());n.recalcMatrix(i),r.setMatrix(i,n.computedMatrix),this._active=r,this._mode=e,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},u.getMode=function(){return this._mode}},{79:79,86:86,97:97}],3:[function(e,t,n){var r={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0};t.exports=function(e,t){return"number"!=typeof t||r[e]?t:t+"px"}},{}],4:[function(e,t,n){!function(e,r){"object"==typeof n?t.exports=r():"function"==typeof define&&define.amd?define(r):e.Alea=r()}(this,function(){"use strict";function e(){return function(e){var n=0,r=0,i=0,o=1;0==e.length&&(e=[+new Date]);var a=t();n=a(" "),r=a(" "),i=a(" ");for(var s=0;s<e.length;s++)n-=a(e[s]),n<0&&(n+=1),r-=a(e[s]),r<0&&(r+=1),i-=a(e[s]),i<0&&(i+=1);a=null;var u=function(){var e=2091639*n+2.3283064365386963e-10*o;return n=r,r=i,i=e-(o=0|e)};return u.uint32=function(){return 4294967296*u()},u.fract53=function(){return u()+1.1102230246251565e-16*(2097152*u()|0)},u.version="Alea 0.9",u.args=e,u.exportState=function(){return[n,r,i,o]},u.importState=function(e){n=+e[0]||0,r=+e[1]||0,i=+e[2]||0,o=+e[3]||0},u}(Array.prototype.slice.call(arguments))}function t(){var e=4022871197,t=function(t){t=t.toString();for(var n=0;n<t.length;n++){e+=t.charCodeAt(n);var r=.02519603282416938*e;e=r>>>0,r-=e,r*=e,e=r>>>0,r-=e,e+=4294967296*r}return 2.3283064365386963e-10*(e>>>0)};return t.version="Mash 0.9",t}return e.importState=function(t){var n=new e;return n.importState(t),n},e})},{}],5:[function(e,t,n){"use strict";function r(e,t,n,r,i,o){var a=["function ",e,"(a,l,h,",r.join(","),"){",o?"":"var i=",n?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",i?".get(m)":"[m]"];return o?t.indexOf("c")<0?a.push(";if(x===y){return m}else if(x<=y){"):a.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):a.push(";if(",t,"){i=m;"),n?a.push("l=m+1}else{h=m-1}"):a.push("h=m-1}else{l=m+1}"),a.push("}"),o?a.push("return -1};"):a.push("return i};"),a.join("")}function i(e,t,n,i){var o=new Function([r("A","x"+e+"y",t,["y"],!1,i),r("B","x"+e+"y",t,["y"],!0,i),r("P","c(x,y)"+e+"0",t,["y","c"],!1,i),r("Q","c(x,y)"+e+"0",t,["y","c"],!0,i),"function dispatchBsearch",n,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",n].join(""));return o()}t.exports={ge:i(">=",!1,"GE"),gt:i(">",!1,"GT"),lt:i("<",!0,"LT"),le:i("<=",!0,"LE"),eq:i("-",!0,"EQ",!0)}},{}],6:[function(e,t,n){function r(e,t,n){function r(){var t=r.parent||e.parentNode;if("function"==typeof t)var n=t(o)||o,s=n[0],u=n[1];else if(t&&t!==document.body)var c=i(t),s=0|c[0],u=0|c[1];else var s=window.innerWidth,u=window.innerHeight;return a?(e.setAttribute("width",s*r.scale+"px"),e.setAttribute("height",u*r.scale+"px")):(e.width=s*r.scale,e.height=u*r.scale),e.style.width=s+"px",e.style.height=u+"px",r}var a="SVG"===e.nodeName.toUpperCase();return e.style.position=e.style.position||"absolute",e.style.top=0,e.style.left=0,r.scale=parseFloat(n||1),r.parent=t,r()}var i=e(13);t.exports=r;var o=new Float32Array(2)},{13:13}],7:[function(e,t,n){"use strict";function r(e,t,n,r,i,o){var a=6*i*i-6*i,s=3*i*i-4*i+1,u=-6*i*i+6*i,c=3*i*i-2*i;if(e.length){o||(o=new Array(e.length));for(var f=e.length-1;f>=0;--f)o[f]=a*e[f]+s*t[f]+u*n[f]+c*r[f];return o}return a*e+s*t+u*n[f]+c*r}function i(e,t,n,r,i,o){var a=i-1,s=i*i,u=a*a,c=(1+2*i)*u,f=i*u,l=s*(3-2*i),d=s*a;if(e.length){o||(o=new Array(e.length));for(var h=e.length-1;h>=0;--h)o[h]=c*e[h]+f*t[h]+l*n[h]+d*r[h];return o}return c*e+f*t+l*n+d*r}t.exports=i,t.exports.derivative=r},{}],8:[function(e,t,n){t.exports=e(10),t.exports.color=e(9)},{10:10,9:9}],9:[function(e,t,n){var r=t.exports=r||{};r.color=r.color||{},r.utils=r.utils||{},r.utils.common=function(){var e=Array.prototype.forEach,t=Array.prototype.slice;return{BREAK:{},extend:function(e){return this.each(t.call(arguments,1),function(t){for(var n in t)this.isUndefined(t[n])||(e[n]=t[n])},this),e},defaults:function(e){return this.each(t.call(arguments,1),function(t){for(var n in t)this.isUndefined(e[n])&&(e[n]=t[n])},this),e},compose:function(){var e=t.call(arguments);return function(){for(var n=t.call(arguments),r=e.length-1;r>=0;r--)n=[e[r].apply(this,n)];return n[0]}},each:function(t,n,r){if(e&&t.forEach===e)t.forEach(n,r);else if(t.length===t.length+0){for(var i=0,o=t.length;i<o;i++)if(i in t&&n.call(r,t[i],i)===this.BREAK)return}else for(var i in t)if(n.call(r,t[i],i)===this.BREAK)return},defer:function(e){setTimeout(e,0)},toArray:function(e){return e.toArray?e.toArray():t.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){return e!==e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}}}(),r.color.toString=function(e){return function(t){if(1==t.a||e.isUndefined(t.a)){for(var n=t.hex.toString(16);n.length<6;)n="0"+n;return"#"+n}return"rgba("+Math.round(t.r)+","+Math.round(t.g)+","+Math.round(t.b)+","+t.a+")"}}(r.utils.common),r.Color=r.color.Color=function(e,t,n,r){function i(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(a(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(a(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function o(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(s(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(s(this),this.__state.space="HSV"),this.__state[t]=e}})}function a(e,n,i){if("HEX"===e.__state.space)e.__state[n]=t.component_from_hex(e.__state.hex,i);else{if("HSV"!==e.__state.space)throw"Corrupted color state";r.extend(e.__state,t.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}}function s(e){var n=t.rgb_to_hsv(e.r,e.g,e.b);r.extend(e.__state,{s:n.s,v:n.v}),r.isNaN(n.h)?r.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=n.h}var u=function(){if(this.__state=e.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return u.COMPONENTS=["r","g","b","h","s","v","hex","a"],r.extend(u.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),i(u.prototype,"r",2),i(u.prototype,"g",1),i(u.prototype,"b",0),o(u.prototype,"h"),o(u.prototype,"s"),o(u.prototype,"v"),Object.defineProperty(u.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(u.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=t.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}}),u}(r.color.interpret=function(e,t){var n,r,i=function(){r=!1;var e=arguments.length>1?t.toArray(arguments):arguments[0];return t.each(o,function(i){if(i.litmus(e))return t.each(i.conversions,function(i,o){if(n=i.read(e),r===!1&&n!==!1)return r=n,n.conversionName=o,n.conversion=i,t.BREAK}),t.BREAK}),r},o=[{litmus:t.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString())}},write:e},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString())}},write:e},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:e},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:e}}},{litmus:t.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:t.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:t.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)&&t.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)&&t.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}];return i}(r.color.toString,r.utils.common),r.color.math=function(){var e;return{hsv_to_rgb:function(e,t,n){var r=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),o=n*(1-t),a=n*(1-i*t),s=n*(1-(1-i)*t),u=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(e,t,n){var r,i,o=Math.min(e,t,n),a=Math.max(e,t,n),s=a-o;return 0==a?{h:NaN,s:0,v:0}:(i=s/a,r=e==a?(t-n)/s:t==a?2+(n-e)/s:4+(e-t)/s,r/=6,r<0&&(r+=1),{h:360*r,s:i,v:a/255})},rgb_to_hex:function(e,t,n){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),r=this.hex_with_component(r,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(t,n,r){return r<<(e=8*n)|t&~(255<<e)}}}(),r.color.toString,r.utils.common)},{}],10:[function(e,t,n){var r=t.exports=r||{};r.gui=r.gui||{},r.utils=r.utils||{},r.controllers=r.controllers||{},r.dom=r.dom||{},r.color=r.color||{},r.utils.css=function(){return{load:function(e,t){t=t||document;var n=t.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)},inject:function(e,t){t=t||document;var n=document.createElement("style");n.type="text/css",n.innerHTML=e,t.getElementsByTagName("head")[0].appendChild(n)}}}(),r.utils.common=function(){var e=Array.prototype.forEach,t=Array.prototype.slice;return{BREAK:{},extend:function(e){return this.each(t.call(arguments,1),function(t){for(var n in t)this.isUndefined(t[n])||(e[n]=t[n])},this),e},defaults:function(e){return this.each(t.call(arguments,1),function(t){for(var n in t)this.isUndefined(e[n])&&(e[n]=t[n])},this),e},compose:function(){var e=t.call(arguments);return function(){for(var n=t.call(arguments),r=e.length-1;r>=0;r--)n=[e[r].apply(this,n)];return n[0]}},each:function(t,n,r){if(e&&t.forEach===e)t.forEach(n,r);else if(t.length===t.length+0){for(var i=0,o=t.length;i<o;i++)if(i in t&&n.call(r,t[i],i)===this.BREAK)return}else for(var i in t)if(n.call(r,t[i],i)===this.BREAK)return},defer:function(e){setTimeout(e,0)},toArray:function(e){return e.toArray?e.toArray():t.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){return e!==e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}}}(),r.controllers.Controller=function(e){var t=function(e,t){this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0};return e.extend(t.prototype,{onChange:function(e){return this.__onChange=e,this},onFinishChange:function(e){return this.__onFinishChange=e,this},setValue:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),t}(r.utils.common),r.dom.dom=function(e){function t(t){if("0"===t||e.isUndefined(t))return 0;var n=t.match(i);return e.isNull(n)?0:parseFloat(n[1])}var n={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},r={};e.each(n,function(t,n){e.each(t,function(e){r[e]=n})});var i=/(\d+(\.\d+)?)px/,o={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(t,n,r){e.isUndefined(n)&&(n=!0),e.isUndefined(r)&&(r=!0),t.style.position="absolute",n&&(t.style.left=0,t.style.right=0),r&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,n,i,o){i=i||{};var a=r[n];if(!a)throw new Error("Event type "+n+" not supported.");var s=document.createEvent(a);switch(a){case"MouseEvents":var u=i.x||i.clientX||0,c=i.y||i.clientY||0;s.initMouseEvent(n,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,u,c,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var f=s.initKeyboardEvent||s.initKeyEvent;e.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),f(n,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:s.initEvent(n,i.bubbles||!1,i.cancelable||!0)}e.defaults(s,o),t.dispatchEvent(s)},bind:function(e,t,n,r){return r=r||!1,e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on"+t,n),o},unbind:function(e,t,n,r){return r=r||!1,e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on"+t,n),o},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);n.indexOf(t)==-1&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return o},removeClass:function(e,t){if(t)if(void 0===e.className);else if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),r=n.indexOf(t);r!=-1&&(n.splice(r,1),e.className=n.join(" "))}else e.className=void 0;return o},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var n=getComputedStyle(e);return t(n["border-left-width"])+t(n["border-right-width"])+t(n["padding-left"])+t(n["padding-right"])+t(n.width)},getHeight:function(e){var n=getComputedStyle(e);return t(n["border-top-width"])+t(n["border-bottom-width"])+t(n["padding-top"])+t(n["padding-bottom"])+t(n.height)},getOffset:function(e){var t={left:0,top:0};if(e.offsetParent)do t.left+=e.offsetLeft,t.top+=e.offsetTop;while(e=e.offsetParent);return t},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}};return o}(r.utils.common),r.controllers.OptionController=function(e,t,n){var r=function(e,i,o){r.superclass.call(this,e,i);var a=this;if(this.__select=document.createElement("select"),n.isArray(o)){var s={};n.each(o,function(e){s[e]=e}),o=s}n.each(o,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),a.__select.appendChild(n)}),this.updateDisplay(),t.bind(this.__select,"change",function(){var e=this.options[this.selectedIndex].value;a.setValue(e)}),this.domElement.appendChild(this.__select)};return r.superclass=e,n.extend(r.prototype,e.prototype,{setValue:function(e){var t=r.superclass.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),t},updateDisplay:function(){return this.__select.value=this.getValue(),r.superclass.prototype.updateDisplay.call(this)}}),r}(r.controllers.Controller,r.dom.dom,r.utils.common),r.controllers.NumberController=function(e,t){function n(e){return e=e.toString(),e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var r=function(e,i,o){r.superclass.call(this,e,i),o=o||{},this.__min=o.min,this.__max=o.max,this.__step=o.step,t.isUndefined(this.__step)?0==this.initialValue?this.__impliedStep=1:this.__impliedStep=Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__impliedStep=this.__step,this.__precision=n(this.__impliedStep)};return r.superclass=e,t.extend(r.prototype,e.prototype,{setValue:function(e){return void 0!==this.__min&&e<this.__min?e=this.__min:void 0!==this.__max&&e>this.__max&&(e=this.__max),void 0!==this.__step&&e%this.__step!=0&&(e=Math.round(e/this.__step)*this.__step),r.superclass.prototype.setValue.call(this,e)},min:function(e){return this.__min=e,this},max:function(e){return this.__max=e,this},step:function(e){return this.__step=e,this}}),r}(r.controllers.Controller,r.utils.common),r.controllers.NumberControllerBox=function(e,t,n){function r(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}var i=function(e,r,o){function a(){var e=parseFloat(d.__input.value);n.isNaN(e)||d.setValue(e)}function s(){a(),d.__onFinishChange&&d.__onFinishChange.call(d,d.getValue())}function u(e){t.bind(window,"mousemove",c),t.bind(window,"mouseup",f),l=e.clientY}function c(e){var t=l-e.clientY;d.setValue(d.getValue()+t*d.__impliedStep),l=e.clientY}function f(){t.unbind(window,"mousemove",c),t.unbind(window,"mouseup",f)}this.__truncationSuspended=!1,i.superclass.call(this,e,r,o);var l,d=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),t.bind(this.__input,"change",a),t.bind(this.__input,"blur",s),t.bind(this.__input,"mousedown",u),t.bind(this.__input,"keydown",function(e){13===e.keyCode&&(d.__truncationSuspended=!0,this.blur(),d.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return i.superclass=e,n.extend(i.prototype,e.prototype,{updateDisplay:function(){return this.__input.value=this.__truncationSuspended?this.getValue():r(this.getValue(),this.__precision),i.superclass.prototype.updateDisplay.call(this)}}),i}(r.controllers.NumberController,r.dom.dom,r.utils.common),r.controllers.NumberControllerSlider=function(e,t,n,r,i){function o(e,t,n,r,i){return r+(i-r)*((e-t)/(n-t))}var a=function(e,n,r,i,s){function u(e){t.bind(window,"mousemove",c),t.bind(window,"mouseup",f),c(e)}function c(e){e.preventDefault();var n=t.getOffset(l.__background),r=t.getWidth(l.__background);return l.setValue(o(e.clientX,n.left,n.left+r,l.__min,l.__max)),!1}function f(){t.unbind(window,"mousemove",c),t.unbind(window,"mouseup",f),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}a.superclass.call(this,e,n,{min:r,max:i,step:s});var l=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),t.bind(this.__background,"mousedown",u),t.addClass(this.__background,"slider"),t.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return a.superclass=e,a.useDefaultStyles=function(){n.inject(i)},r.extend(a.prototype,e.prototype,{updateDisplay:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",a.superclass.prototype.updateDisplay.call(this)}}),a}(r.controllers.NumberController,r.dom.dom,r.utils.css,r.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"),r.controllers.FunctionController=function(e,t,n){var r=function(e,n,i){r.superclass.call(this,e,n);var o=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===i?"Fire":i,t.bind(this.__button,"click",function(e){return e.preventDefault(),o.fire(),!1}),t.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return r.superclass=e,n.extend(r.prototype,e.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),r}(r.controllers.Controller,r.dom.dom,r.utils.common),r.controllers.BooleanController=function(e,t,n){var r=function(e,n){function i(){o.setValue(!o.__prev)}r.superclass.call(this,e,n);var o=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),t.bind(this.__checkbox,"change",i,!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return r.superclass=e,n.extend(r.prototype,e.prototype,{setValue:function(e){var t=r.superclass.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),t},updateDisplay:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,r.superclass.prototype.updateDisplay.call(this)}}),r}(r.controllers.Controller,r.dom.dom,r.utils.common),r.color.toString=function(e){return function(t){if(1==t.a||e.isUndefined(t.a)){for(var n=t.hex.toString(16);n.length<6;)n="0"+n;return"#"+n}return"rgba("+Math.round(t.r)+","+Math.round(t.g)+","+Math.round(t.b)+","+t.a+")"}}(r.utils.common),r.color.interpret=function(e,t){var n,r,i=function(){r=!1;var e=arguments.length>1?t.toArray(arguments):arguments[0];return t.each(o,function(i){if(i.litmus(e))return t.each(i.conversions,function(i,o){if(n=i.read(e),r===!1&&n!==!1)return r=n,n.conversionName=o,n.conversion=i,t.BREAK}),t.BREAK}),r},o=[{litmus:t.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString())}},write:e},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString())}},write:e},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:e},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:e}}},{litmus:t.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:t.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:t.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)&&t.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)&&t.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}];return i}(r.color.toString,r.utils.common),r.GUI=r.gui.GUI=function(e,t,n,r,i,o,a,s,u,c,f,l,d,h,p){function m(e,t,n,o){if(void 0===t[n])throw new Error("Object "+t+' has no property "'+n+'"');var a;if(o.color)a=new f(t,n);else{var s=[t,n].concat(o.factoryArgs);a=r.apply(e,s)}o.before instanceof i&&(o.before=o.before.__li),b(e,a),h.addClass(a.domElement,"c");var u=document.createElement("span");h.addClass(u,"property-name"),u.innerHTML=a.property;var c=document.createElement("div");c.appendChild(u),c.appendChild(a.domElement);var l=v(e,c,o.before);return h.addClass(l,P.CLASS_CONTROLLER_ROW),h.addClass(l,typeof a.getValue()),g(e,l,a),e.__controllers.push(a),a}function v(e,t,n){var r=document.createElement("li");return t&&r.appendChild(t),n?e.__ul.insertBefore(r,params.before):e.__ul.appendChild(r),e.onResize(),r}function g(e,t,n){if(n.__li=t,n.__gui=e,p.extend(n,{options:function(t){return arguments.length>1?(n.remove(),m(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[p.toArray(arguments)]})):p.isArray(t)||p.isObject(t)?(n.remove(),m(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[t]})):void 0},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof u){var r=new s(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});p.each(["updateDisplay","onChange","onFinishChange"],function(e){var t=n[e],i=r[e];n[e]=r[e]=function(){var e=Array.prototype.slice.call(arguments);return t.apply(n,e),i.apply(r,e)}}),h.addClass(t,"has-slider"),n.domElement.insertBefore(r.domElement,n.domElement.firstElementChild)}else if(n instanceof s){var i=function(t){return p.isNumber(n.__min)&&p.isNumber(n.__max)?(n.remove(),m(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]
})):t};n.min=p.compose(i,n.min),n.max=p.compose(i,n.max)}else n instanceof o?(h.bind(t,"click",function(){h.fakeEvent(n.__checkbox,"click")}),h.bind(n.__checkbox,"click",function(e){e.stopPropagation()})):n instanceof a?(h.bind(t,"click",function(){h.fakeEvent(n.__button,"click")}),h.bind(t,"mouseover",function(){h.addClass(n.__button,"hover")}),h.bind(t,"mouseout",function(){h.removeClass(n.__button,"hover")})):n instanceof f&&(h.addClass(t,"color"),n.updateDisplay=p.compose(function(e){return t.style.borderLeftColor=n.__color.toString(),e},n.updateDisplay),n.updateDisplay());n.setValue=p.compose(function(t){return e.getRoot().__preset_select&&n.isModified()&&S(e.getRoot(),!0),t},n.setValue)}function b(e,t){var n=e.getRoot(),r=n.__rememberedObjects.indexOf(t.object);if(r!=-1){var i=n.__rememberedObjectIndecesToControllers[r];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[r]=i),i[t.property]=t,n.load&&n.load.remembered){var o,a=n.load.remembered;if(a[e.preset])o=a[e.preset];else{if(!a[j])return;o=a[j]}if(o[r]&&void 0!==o[r][t.property]){var s=o[r][t.property];t.initialValue=s,t.setValue(s)}}}}function y(e,t){return document.location.href+"."+t}function _(e){function t(){c.style.display=e.useLocalStorage?"block":"none"}var n=e.__save_row=document.createElement("li");h.addClass(e.domElement,"has-save"),e.__ul.insertBefore(n,e.__ul.firstChild),h.addClass(n,"save-row");var r=document.createElement("span");r.innerHTML="&nbsp;",h.addClass(r,"button gears");var i=document.createElement("span");i.innerHTML="Save",h.addClass(i,"button"),h.addClass(i,"save");var o=document.createElement("span");o.innerHTML="New",h.addClass(o,"button"),h.addClass(o,"save-as");var a=document.createElement("span");a.innerHTML="Revert",h.addClass(a,"button"),h.addClass(a,"revert");var s=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?p.each(e.load.remembered,function(t,n){E(e,n,n==e.preset)}):E(e,j,!1),h.bind(s,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),n.appendChild(s),n.appendChild(r),n.appendChild(i),n.appendChild(o),n.appendChild(a),R){var u=document.getElementById("dg-save-locally"),c=document.getElementById("dg-local-explain");u.style.display="block";var f=document.getElementById("dg-local-storage");"true"===localStorage.getItem(y(e,"isLocal"))&&f.setAttribute("checked","checked"),t(),h.bind(f,"change",function(){e.useLocalStorage=!e.useLocalStorage,t()})}var l=document.getElementById("dg-new-constructor");h.bind(l,"keydown",function(e){!e.metaKey||67!==e.which&&67!=e.keyCode||C.hide()}),h.bind(r,"click",function(){l.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),C.show(),l.focus(),l.select()}),h.bind(i,"click",function(){e.save()}),h.bind(o,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),h.bind(a,"click",function(){e.revert()})}function x(e){function t(t){return t.preventDefault(),i=t.clientX,h.addClass(e.__closeButton,P.CLASS_DRAG),h.bind(window,"mousemove",n),h.bind(window,"mouseup",r),!1}function n(t){return t.preventDefault(),e.width+=i-t.clientX,e.onResize(),i=t.clientX,!1}function r(){h.removeClass(e.__closeButton,P.CLASS_DRAG),h.unbind(window,"mousemove",n),h.unbind(window,"mouseup",r)}e.__resize_handle=document.createElement("div"),p.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var i;h.bind(e.__resize_handle,"mousedown",t),h.bind(e.__closeButton,"mousedown",t),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function w(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function A(e,t){var n={};return p.each(e.__rememberedObjects,function(r,i){var o={},a=e.__rememberedObjectIndecesToControllers[i];p.each(a,function(e,n){o[n]=t?e.initialValue:e.getValue()}),n[i]=o}),n}function E(e,t,n){var r=document.createElement("option");r.innerHTML=t,r.value=t,e.__preset_select.appendChild(r),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function k(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value==e.preset&&(e.__preset_select.selectedIndex=t)}function S(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];t?n.innerHTML=n.value+"*":n.innerHTML=n.value}function M(e){0!=e.length&&l(function(){M(e)}),p.each(e,function(e){e.updateDisplay()})}e.inject(n);var C,T,O="dg",D=72,L=20,j="Default",R=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}(),z=!0,F=!1,B=[],P=function(e){function t(){localStorage.setItem(y(r,"gui"),JSON.stringify(r.getSaveObject()))}function n(){var e=r.getRoot();e.width+=1,p.defer(function(){e.width-=1})}var r=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),h.addClass(this.domElement,O),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],e=e||{},e=p.defaults(e,{autoPlace:!0,width:P.DEFAULT_WIDTH}),e=p.defaults(e,{resizable:e.autoPlace,hideable:e.autoPlace}),p.isUndefined(e.load)?e.load={preset:j}:e.preset&&(e.load.preset=e.preset),p.isUndefined(e.parent)&&e.hideable&&B.push(this),e.resizable=p.isUndefined(e.parent)&&e.resizable,e.autoPlace&&p.isUndefined(e.scrollable)&&(e.scrollable=!0);var i=R&&"true"===localStorage.getItem(y(this,"isLocal"));if(Object.defineProperties(this,{parent:{get:function(){return e.parent}},scrollable:{get:function(){return e.scrollable}},autoPlace:{get:function(){return e.autoPlace}},preset:{get:function(){return r.parent?r.getRoot().preset:e.load.preset},set:function(t){r.parent?r.getRoot().preset=t:e.load.preset=t,k(this),r.revert()}},width:{get:function(){return e.width},set:function(t){e.width=t,w(r,t)}},name:{get:function(){return e.name},set:function(t){e.name=t,a&&(a.innerHTML=e.name)}},closed:{get:function(){return e.closed},set:function(t){e.closed=t,e.closed?h.addClass(r.__ul,P.CLASS_CLOSED):h.removeClass(r.__ul,P.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=t?P.TEXT_OPEN:P.TEXT_CLOSED)}},load:{get:function(){return e.load}},useLocalStorage:{get:function(){return i},set:function(e){R&&(i=e,e?h.bind(window,"unload",t):h.unbind(window,"unload",t),localStorage.setItem(y(r,"isLocal"),e))}}}),p.isUndefined(e.parent)){if(e.closed=!1,h.addClass(this.domElement,P.CLASS_MAIN),h.makeSelectable(this.domElement,!1),R&&i){r.useLocalStorage=!0;var o=localStorage.getItem(y(this,"gui"));o&&(e.load=JSON.parse(o))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=P.TEXT_CLOSED,h.addClass(this.__closeButton,P.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),h.bind(this.__closeButton,"click",function(){r.closed=!r.closed})}else{void 0===e.closed&&(e.closed=!0);var a=document.createTextNode(e.name);h.addClass(a,"controller-name");var s=v(r,a),u=function(e){return e.preventDefault(),r.closed=!r.closed,!1};h.addClass(this.__ul,P.CLASS_CLOSED),h.addClass(s,"title"),h.bind(s,"click",u),e.closed||(this.closed=!1)}e.autoPlace&&(p.isUndefined(e.parent)&&(z&&(T=document.createElement("div"),h.addClass(T,O),h.addClass(T,P.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(T),z=!1),T.appendChild(this.domElement),h.addClass(this.domElement,P.CLASS_AUTO_PLACE)),this.parent||w(r,e.width)),h.bind(window,"resize",function(){r.onResize()}),h.bind(this.__ul,"webkitTransitionEnd",function(){r.onResize()}),h.bind(this.__ul,"transitionend",function(){r.onResize()}),h.bind(this.__ul,"oTransitionEnd",function(){r.onResize()}),this.onResize(),e.resizable&&x(this);r.getRoot();e.parent||n()};return P.toggleHide=function(){F=!F,p.each(B,function(e){e.domElement.style.zIndex=F?-999:999,e.domElement.style.opacity=F?0:1})},P.CLASS_AUTO_PLACE="a",P.CLASS_AUTO_PLACE_CONTAINER="ac",P.CLASS_MAIN="main",P.CLASS_CONTROLLER_ROW="cr",P.CLASS_TOO_TALL="taller-than-window",P.CLASS_CLOSED="closed",P.CLASS_CLOSE_BUTTON="close-button",P.CLASS_DRAG="drag",P.DEFAULT_WIDTH=245,P.TEXT_CLOSED="Close Controls",P.TEXT_OPEN="Open Controls",h.bind(window,"keydown",function(e){"text"===document.activeElement.type||e.which!==D&&e.keyCode!=D||P.toggleHide()},!1),p.extend(P.prototype,{add:function(e,t){return m(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return m(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.slice(this.__controllers.indexOf(e),1);var t=this;p.defer(function(){t.onResize()})},destroy:function(){this.autoPlace&&T.removeChild(this.domElement)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new P(t);this.__folders[e]=n;var r=v(this,n.domElement);return h.addClass(r,"folder"),n},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=h.getOffset(e.__ul).top,n=0;p.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(n+=h.getHeight(t))}),window.innerHeight-t-L<n?(h.addClass(e.domElement,P.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-L+"px"):(h.removeClass(e.domElement,P.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&p.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},remember:function(){if(p.isUndefined(C)&&(C=new d,C.domElement.innerHTML=t),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;p.each(Array.prototype.slice.call(arguments),function(t){0==e.__rememberedObjects.length&&_(e),e.__rememberedObjects.indexOf(t)==-1&&e.__rememberedObjects.push(t)}),this.autoPlace&&w(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=A(this)),e.folders={},p.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=A(this),S(this,!1)},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[j]=A(this,!0)),this.load.remembered[e]=A(this),this.preset=e,E(this,e,!0)},revert:function(e){p.each(this.__controllers,function(t){this.getRoot().load.remembered?b(e||this.getRoot(),t):t.setValue(t.initialValue)},this),p.each(this.__folders,function(e){e.revert(e)}),e||S(this.getRoot(),!1)},listen:function(e){var t=0==this.__listening.length;this.__listening.push(e),t&&M(this.__listening)}}),P}(r.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",r.controllers.factory=function(e,t,n,r,i,o,a){return function(s,u){var c=s[u];return a.isArray(arguments[2])||a.isObject(arguments[2])?new e(s,u,arguments[2]):a.isNumber(c)?a.isNumber(arguments[2])&&a.isNumber(arguments[3])?new n(s,u,arguments[2],arguments[3]):new t(s,u,{min:arguments[2],max:arguments[3]}):a.isString(c)?new r(s,u):a.isFunction(c)?new i(s,u,""):a.isBoolean(c)?new o(s,u):void 0}}(r.controllers.OptionController,r.controllers.NumberControllerBox,r.controllers.NumberControllerSlider,r.controllers.StringController=function(e,t,n){var r=function(e,n){function i(){a.setValue(a.__input.value)}function o(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}r.superclass.call(this,e,n);var a=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),t.bind(this.__input,"keyup",i),t.bind(this.__input,"change",i),t.bind(this.__input,"blur",o),t.bind(this.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return r.superclass=e,n.extend(r.prototype,e.prototype,{updateDisplay:function(){return t.isActive(this.__input)||(this.__input.value=this.getValue()),r.superclass.prototype.updateDisplay.call(this)}}),r}(r.controllers.Controller,r.dom.dom,r.utils.common),r.controllers.FunctionController,r.controllers.BooleanController,r.utils.common),r.controllers.Controller,r.controllers.BooleanController,r.controllers.FunctionController,r.controllers.NumberControllerBox,r.controllers.NumberControllerSlider,r.controllers.OptionController,r.controllers.ColorController=function(e,t,n,r,i){function o(e,t,n,r){e.style.background="",i.each(u,function(i){e.style.cssText+="background: "+i+"linear-gradient("+t+", "+n+" 0%, "+r+" 100%); "})}function a(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var s=function(e,u){function c(e){h(e),t.bind(window,"mousemove",h),t.bind(window,"mouseup",f)}function f(){t.unbind(window,"mousemove",h),t.unbind(window,"mouseup",f)}function l(){var e=r(this.value);e!==!1?(m.__color.__state=e,m.setValue(m.__color.toOriginal())):this.value=m.__color.toString()}function d(){t.unbind(window,"mousemove",p),t.unbind(window,"mouseup",d)}function h(e){e.preventDefault();var n=t.getWidth(m.__saturation_field),r=t.getOffset(m.__saturation_field),i=(e.clientX-r.left+document.body.scrollLeft)/n,o=1-(e.clientY-r.top+document.body.scrollTop)/n;return o>1?o=1:o<0&&(o=0),i>1?i=1:i<0&&(i=0),m.__color.v=o,m.__color.s=i,m.setValue(m.__color.toOriginal()),!1}function p(e){e.preventDefault();var n=t.getHeight(m.__hue_field),r=t.getOffset(m.__hue_field),i=1-(e.clientY-r.top+document.body.scrollTop)/n;return i>1?i=1:i<0&&(i=0),m.__color.h=360*i,m.setValue(m.__color.toOriginal()),!1}s.superclass.call(this,e,u),this.__color=new n(this.getValue()),this.__temp=new n(0);var m=this;this.domElement=document.createElement("div"),t.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",t.bind(this.__input,"keydown",function(e){13===e.keyCode&&l.call(this)}),t.bind(this.__input,"blur",l),t.bind(this.__selector,"mousedown",function(e){t.addClass(this,"drag").bind(window,"mouseup",function(e){t.removeClass(m.__selector,"drag")})});var v=document.createElement("div");i.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),i.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),i.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),i.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),i.extend(v.style,{width:"100%",height:"100%",background:"none"}),o(v,"top","rgba(0,0,0,0)","#000"),i.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),a(this.__hue_field),i.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),t.bind(this.__saturation_field,"mousedown",c),t.bind(this.__field_knob,"mousedown",c),t.bind(this.__hue_field,"mousedown",function(e){p(e),t.bind(window,"mousemove",p),t.bind(window,"mouseup",d)}),this.__saturation_field.appendChild(v),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};s.superclass=e,i.extend(s.prototype,e.prototype,{updateDisplay:function(){var e=r(this.getValue());if(e!==!1){var t=!1;i.each(n.COMPONENTS,function(n){if(!i.isUndefined(e[n])&&!i.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}},this),t&&i.extend(this.__color.__state,e)}i.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var a=this.__color.v<.5||this.__color.s>.5?255:0,s=255-a;i.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+a+","+a+","+a+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,o(this.__saturation_field,"left","#fff",this.__temp.toString()),i.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+a+","+a+","+a+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}});var u=["-moz-","-o-","-webkit-","-ms-",""];return s}(r.controllers.Controller,r.dom.dom,r.color.Color=function(e,t,n,r){function i(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(a(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(a(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function o(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(s(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(s(this),this.__state.space="HSV"),this.__state[t]=e}})}function a(e,n,i){if("HEX"===e.__state.space)e.__state[n]=t.component_from_hex(e.__state.hex,i);else{if("HSV"!==e.__state.space)throw"Corrupted color state";r.extend(e.__state,t.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}}function s(e){var n=t.rgb_to_hsv(e.r,e.g,e.b);r.extend(e.__state,{s:n.s,v:n.v}),r.isNaN(n.h)?r.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=n.h}var u=function(){if(this.__state=e.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return u.COMPONENTS=["r","g","b","h","s","v","hex","a"],r.extend(u.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),i(u.prototype,"r",2),i(u.prototype,"g",1),i(u.prototype,"b",0),o(u.prototype,"h"),o(u.prototype,"s"),o(u.prototype,"v"),Object.defineProperty(u.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(u.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=t.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}}),u}(r.color.interpret,r.color.math=function(){var e;return{hsv_to_rgb:function(e,t,n){var r=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),o=n*(1-t),a=n*(1-i*t),s=n*(1-(1-i)*t),u=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(e,t,n){var r,i,o=Math.min(e,t,n),a=Math.max(e,t,n),s=a-o;return 0==a?{h:NaN,s:0,v:0}:(i=s/a,r=e==a?(t-n)/s:t==a?2+(n-e)/s:4+(e-t)/s,r/=6,r<0&&(r+=1),{h:360*r,s:i,v:a/255})},rgb_to_hex:function(e,t,n){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),r=this.hex_with_component(r,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(t,n,r){return r<<(e=8*n)|t&~(255<<e)}}}(),r.color.toString,r.utils.common),r.color.interpret,r.utils.common),r.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}(),r.dom.CenteredDiv=function(e,t){var n=function(){this.backgroundElement=document.createElement("div"),t.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),e.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),t.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var n=this;e.bind(this.backgroundElement,"click",function(){n.hide()})};return n.prototype.show=function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),t.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})},n.prototype.hide=function(){var t=this,n=function(){t.domElement.style.display="none",t.backgroundElement.style.display="none",e.unbind(t.domElement,"webkitTransitionEnd",n),e.unbind(t.domElement,"transitionend",n),e.unbind(t.domElement,"oTransitionEnd",n)};e.bind(this.domElement,"webkitTransitionEnd",n),e.bind(this.domElement,"transitionend",n),e.bind(this.domElement,"oTransitionEnd",n),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},n.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-e.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-e.getHeight(this.domElement)/2+"px"},n}(r.dom.dom,r.utils.common),r.dom.dom,r.utils.common)},{}],11:[function(e,t,n){"use strict";function r(e,t,n){t||(t=p),n||(n=m);for(var r=1/0,a=1/0,d=-(1/0),h=-(1/0),v=this.coords=[],g=this.ids=new Uint32Array(e.length),b=0;b<e.length;b++){var y=e[b],_=t(y),x=n(y);g[b]=b,v[2*b]=_,v[2*b+1]=x,_<r&&(r=_),x<a&&(a=x),_>d&&(d=_),x>h&&(h=x)}var w,A,E,k=(r+d)/2,S=(a+h)/2,M=1/0;for(b=0;b<e.length;b++){var C=i(k,S,v[2*b],v[2*b+1]);C<M&&(w=b,M=C)}for(M=1/0,b=0;b<e.length;b++)b!==w&&(C=i(v[2*w],v[2*w+1],v[2*b],v[2*b+1]),C<M&&C>0&&(A=b,M=C));var T=1/0;for(b=0;b<e.length;b++)if(b!==w&&b!==A){var O=s(v[2*w],v[2*w+1],v[2*A],v[2*A+1],v[2*b],v[2*b+1]);O<T&&(E=b,T=O)}if(T===1/0)throw new Error("No Delaunay triangulation exists for this input.");if(o(v[2*w],v[2*w+1],v[2*A],v[2*A+1],v[2*E],v[2*E+1])<0){var D=A;A=E,E=D}var L=v[2*w],j=v[2*w+1],R=v[2*A],z=v[2*A+1],F=v[2*E],B=v[2*E+1],P=u(L,j,R,z,F,B);for(this._cx=P.x,this._cy=P.y,l(g,v,0,g.length-1,P.x,P.y),this._hashSize=Math.ceil(Math.sqrt(e.length)),this._hash=[],b=0;b<this._hashSize;b++)this._hash[b]=null;var N=this.hull=c(v,w);this._hashEdge(N),N.t=0,N=c(v,A,N),this._hashEdge(N),N.t=1,N=c(v,E,N),this._hashEdge(N),N.t=2;var I=2*e.length-5,H=this.triangles=new Uint32Array(3*I),U=this.halfedges=new Int32Array(3*I);this.trianglesLen=0,this._addTriangle(w,A,E,-1,-1,-1);for(var V,G,W=0;W<g.length;W++)if(b=g[W],_=v[2*b],x=v[2*b+1],!(_===V&&x===G||(V=_,G=x,_===L&&x===j||_===R&&x===z||_===F&&x===B))){var q,X=this._hashKey(_,x),Y=X;do q=this._hash[Y],Y=(Y+1)%this._hashSize;while((!q||q.removed)&&Y!==X);for(N=q;o(_,x,N.x,N.y,N.next.x,N.next.y)>=0;)if(N=N.next,N===q)throw new Error("Something is wrong with the input points.");var K=N===q,Q=this._addTriangle(N.i,b,N.next.i,-1,-1,N.t);N.t=Q,N=c(v,b,N),N.t=this._legalize(Q+2),N.prev.prev.t===U[Q+1]&&(N.prev.prev.t=Q+2);for(var J=N.next;o(_,x,J.x,J.y,J.next.x,J.next.y)<0;)Q=this._addTriangle(J.i,b,J.next.i,J.prev.t,-1,J.t),J.prev.t=this._legalize(Q+2),this.hull=f(J),J=J.next;if(K)for(J=N.prev;o(_,x,J.prev.x,J.prev.y,J.x,J.y)<0;)Q=this._addTriangle(J.prev.i,b,J.i,-1,J.t,J.prev.t),this._legalize(Q+2),J.prev.t=Q,this.hull=f(J),J=J.prev;this._hashEdge(N),this._hashEdge(N.prev)}this.triangles=H.subarray(0,this.trianglesLen),this.halfedges=U.subarray(0,this.trianglesLen)}function i(e,t,n,r){var i=e-n,o=t-r;return i*i+o*o}function o(e,t,n,r,i,o){return(r-t)*(i-n)-(n-e)*(o-r)}function a(e,t,n,r,i,o,a,s){e-=a,t-=s,n-=a,r-=s,i-=a,o-=s;var u=e*e+t*t,c=n*n+r*r,f=i*i+o*o;return e*(r*f-c*o)-t*(n*f-c*i)+u*(n*o-r*i)<0}function s(e,t,n,r,i,o){n-=e,r-=t,i-=e,o-=t;var a=n*n+r*r,s=i*i+o*o;if(0===a||0===s)return 1/0;var u=n*o-r*i;if(0===u)return 1/0;var c=.5*(o*a-r*s)/u,f=.5*(n*s-i*a)/u;return c*c+f*f}function u(e,t,n,r,i,o){n-=e,r-=t,i-=e,o-=t;var a=n*n+r*r,s=i*i+o*o,u=n*o-r*i,c=.5*(o*a-r*s)/u,f=.5*(n*s-i*a)/u;return{x:e+c,y:t+f}}function c(e,t,n){var r={i:t,x:e[2*t],y:e[2*t+1],t:0,prev:null,next:null,removed:!1};return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function f(e){return e.prev.next=e.next,e.next.prev=e.prev,e.removed=!0,e.prev}function l(e,t,n,r,i,o){var a,s,u;if(r-n<=20)for(a=n+1;a<=r;a++){for(u=e[a],s=a-1;s>=n&&d(t,e[s],u,i,o)>0;)e[s+1]=e[s--];e[s+1]=u}else{var c=n+r>>1;for(a=n+1,s=r,h(e,c,a),d(t,e[n],e[r],i,o)>0&&h(e,n,r),
d(t,e[a],e[r],i,o)>0&&h(e,a,r),d(t,e[n],e[a],i,o)>0&&h(e,n,a),u=e[a];;){do a++;while(d(t,e[a],u,i,o)<0);do s--;while(d(t,e[s],u,i,o)>0);if(s<a)break;h(e,a,s)}e[n+1]=e[s],e[s]=u,r-a+1>=s-n?(l(e,t,a,r,i,o),l(e,t,n,s-1,i,o)):(l(e,t,n,s-1,i,o),l(e,t,a,r,i,o))}}function d(e,t,n,r,o){var a=i(e[2*t],e[2*t+1],r,o),s=i(e[2*n],e[2*n+1],r,o);return a-s||e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]}function h(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function p(e){return e[0]}function m(e){return e[1]}t.exports=r,r.prototype={_hashEdge:function(e){this._hash[this._hashKey(e.x,e.y)]=e},_hashKey:function(e,t){var n=e-this._cx,r=t-this._cy,i=1-n/(Math.abs(n)+Math.abs(r));return Math.floor((2+(r<0?-i:i))/4*this._hashSize)},_legalize:function(e){var t=this.triangles,n=this.coords,r=this.halfedges,i=r[e],o=e-e%3,s=i-i%3,u=o+(e+1)%3,c=o+(e+2)%3,f=s+(i+1)%3,l=s+(i+2)%3,d=t[c],h=t[e],p=t[u],m=t[l],v=a(n[2*d],n[2*d+1],n[2*h],n[2*h+1],n[2*p],n[2*p+1],n[2*m],n[2*m+1]);return v?(t[e]=m,t[i]=d,this._link(e,r[l]),this._link(i,r[c]),this._link(c,l),this._legalize(e),this._legalize(f)):c},_link:function(e,t){this.halfedges[e]=t,t!==-1&&(this.halfedges[t]=e)},_addTriangle:function(e,t,n,r,i,o){var a=this.trianglesLen;return this.triangles[a]=e,this.triangles[a+1]=t,this.triangles[a+2]=n,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}},{}],12:[function(e,t,n){function r(e,t,n){var r=c[t];if("undefined"==typeof r&&(r=o(t)),r){if(void 0===n)return e.style[r];e.style[r]=f(r,n)}}function i(e,t){for(var n in t)t.hasOwnProperty(n)&&r(e,n,t[n])}function o(e){var t=u(e),n=s(t);return c[t]=c[e]=c[n]=n,n}function a(){2===arguments.length?"string"==typeof arguments[1]?arguments[0].style.cssText=arguments[1]:i(arguments[0],arguments[1]):r(arguments[0],arguments[1],arguments[2])}var s=e(88),u=e(93),c={float:"cssFloat"},f=e(3);t.exports=a,t.exports.set=a,t.exports.get=function(e,t){return Array.isArray(t)?t.reduce(function(t,n){return t[n]=r(e,n||""),t},{}):r(e,t||"")}},{3:3,88:88,93:93}],13:[function(e,t,n){function r(e){if(e===window||e===document.body)return[window.innerWidth,window.innerHeight];if(!e.parentNode){var t=!0;document.body.appendChild(e)}var n=e.getBoundingClientRect(),r=getComputedStyle(e),o=(0|n.height)+i(r.getPropertyValue("margin-top"))+i(r.getPropertyValue("margin-bottom")),a=(0|n.width)+i(r.getPropertyValue("margin-left"))+i(r.getPropertyValue("margin-right"));return t&&document.body.removeChild(e),[a,o]}function i(e){return parseFloat(e)||0}t.exports=r},{}],14:[function(e,t,n){"use strict";function r(e,t,n){return Math.min(t,Math.max(e,n))}function i(e,t,n){this.dimension=e.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var r=0;r<this.dimension;++r)this.bounds[0][r]=-(1/0),this.bounds[1][r]=1/0;this._state=e.slice().reverse(),this._velocity=t.slice().reverse(),this._time=[n],this._scratch=[e.slice(),e.slice(),e.slice(),e.slice(),e.slice()]}function o(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function a(e,t,n){switch(arguments.length){case 0:return new i([0],[0],0);case 1:if("number"==typeof e){var r=o(e);return new i(r,r,0)}return new i(e,o(e.length),0);case 2:if("number"==typeof t){var r=o(e.length);return new i(e,r,+t)}n=0;case 3:if(e.length!==t.length)throw new Error("state and velocity lengths must match");return new i(e,t,n)}}t.exports=a;var s=e(7),u=e(5),c=i.prototype;c.flush=function(e){var t=u.gt(this._time,e)-1;t<=0||(this._time.splice(0,t),this._state.splice(0,t*this.dimension),this._velocity.splice(0,t*this.dimension))},c.curve=function(e){var t=this._time,n=t.length,i=u.le(t,e),o=this._scratch[0],a=this._state,c=this._velocity,f=this.dimension,l=this.bounds;if(i<0)for(var d=f-1,h=0;h<f;++h,--d)o[h]=a[d];else if(i>=n-1)for(var d=a.length-1,p=e-t[n-1],h=0;h<f;++h,--d)o[h]=a[d]+p*c[d];else{for(var d=f*(i+1)-1,m=t[i],v=t[i+1],g=v-m||1,b=this._scratch[1],y=this._scratch[2],_=this._scratch[3],x=this._scratch[4],w=!0,h=0;h<f;++h,--d)b[h]=a[d],_[h]=c[d]*g,y[h]=a[d+f],x[h]=c[d+f]*g,w=w&&b[h]===y[h]&&_[h]===x[h]&&0===_[h];if(w)for(var h=0;h<f;++h)o[h]=b[h];else s(b,_,y,x,(e-m)/g,o)}for(var A=l[0],E=l[1],h=0;h<f;++h)o[h]=r(A[h],E[h],o[h]);return o},c.dcurve=function(e){var t=this._time,n=t.length,r=u.le(t,e),i=this._scratch[0],o=this._state,a=this._velocity,c=this.dimension;if(r>=n-1)for(var f=o.length-1,l=(e-t[n-1],0);l<c;++l,--f)i[l]=a[f];else{for(var f=c*(r+1)-1,d=t[r],h=t[r+1],p=h-d||1,m=this._scratch[1],v=this._scratch[2],g=this._scratch[3],b=this._scratch[4],y=!0,l=0;l<c;++l,--f)m[l]=o[f],g[l]=a[f]*p,v[l]=o[f+c],b[l]=a[f+c]*p,y=y&&m[l]===v[l]&&g[l]===b[l]&&0===g[l];if(y)for(var l=0;l<c;++l)i[l]=0;else{s.derivative(m,g,v,b,(e-d)/p,i);for(var l=0;l<c;++l)i[l]/=p}}return i},c.lastT=function(){var e=this._time;return e[e.length-1]},c.stable=function(){for(var e=this._velocity,t=e.length,n=this.dimension-1;n>=0;--n)if(e[--t])return!1;return!0},c.jump=function(e){var t=this.lastT(),n=this.dimension;if(!(e<t||arguments.length!==n+1)){var i=this._state,o=this._velocity,a=i.length-this.dimension,s=this.bounds,u=s[0],c=s[1];this._time.push(t,e);for(var f=0;f<2;++f)for(var l=0;l<n;++l)i.push(i[a++]),o.push(0);this._time.push(e);for(var l=n;l>0;--l)i.push(r(u[l-1],c[l-1],arguments[l])),o.push(0)}},c.push=function(e){var t=this.lastT(),n=this.dimension;if(!(e<t||arguments.length!==n+1)){var i=this._state,o=this._velocity,a=i.length-this.dimension,s=e-t,u=this.bounds,c=u[0],f=u[1],l=s>1e-6?1/s:0;this._time.push(e);for(var d=n;d>0;--d){var h=r(c[d-1],f[d-1],arguments[d]);i.push(h),o.push((h-i[a++])*l)}}},c.set=function(e){var t=this.dimension;if(!(e<this.lastT()||arguments.length!==t+1)){var n=this._state,i=this._velocity,o=this.bounds,a=o[0],s=o[1];this._time.push(e);for(var u=t;u>0;--u)n.push(r(a[u-1],s[u-1],arguments[u])),i.push(0)}},c.move=function(e){var t=this.lastT(),n=this.dimension;if(!(e<=t||arguments.length!==n+1)){var i=this._state,o=this._velocity,a=i.length-this.dimension,s=this.bounds,u=s[0],c=s[1],f=e-t,l=f>1e-6?1/f:0;this._time.push(e);for(var d=n;d>0;--d){var h=arguments[d];i.push(r(u[d-1],c[d-1],i[a++]+h)),o.push(h*l)}}},c.idle=function(e){var t=this.lastT();if(!(e<t)){var n=this.dimension,i=this._state,o=this._velocity,a=i.length-n,s=this.bounds,u=s[0],c=s[1],f=e-t;this._time.push(e);for(var l=n-1;l>=0;--l)i.push(r(u[l],c[l],i[a]+f*o[a])),o.push(0),a+=1}}},{5:5,7:7}],15:[function(e,t,n){function r(e,t,n,r){return o(e,t,n),o(s,n,r),a(e,e,s),i(e,e)}var i=e(60),o=e(70),a=e(46),s=[0,0,0];t.exports=r},{46:46,60:60,70:70}],16:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],f=t[8],l=t[9],d=t[10],h=t[11],p=t[12],m=t[13],v=t[14],g=t[15];return e[0]=s*(d*g-h*v)-l*(u*g-c*v)+m*(u*h-c*d),e[1]=-(r*(d*g-h*v)-l*(i*g-o*v)+m*(i*h-o*d)),e[2]=r*(u*g-c*v)-s*(i*g-o*v)+m*(i*c-o*u),e[3]=-(r*(u*h-c*d)-s*(i*h-o*d)+l*(i*c-o*u)),e[4]=-(a*(d*g-h*v)-f*(u*g-c*v)+p*(u*h-c*d)),e[5]=n*(d*g-h*v)-f*(i*g-o*v)+p*(i*h-o*d),e[6]=-(n*(u*g-c*v)-a*(i*g-o*v)+p*(i*c-o*u)),e[7]=n*(u*h-c*d)-a*(i*h-o*d)+f*(i*c-o*u),e[8]=a*(l*g-h*m)-f*(s*g-c*m)+p*(s*h-c*l),e[9]=-(n*(l*g-h*m)-f*(r*g-o*m)+p*(r*h-o*l)),e[10]=n*(s*g-c*m)-a*(r*g-o*m)+p*(r*c-o*s),e[11]=-(n*(s*h-c*l)-a*(r*h-o*l)+f*(r*c-o*s)),e[12]=-(a*(l*v-d*m)-f*(s*v-u*m)+p*(s*d-u*l)),e[13]=n*(l*v-d*m)-f*(r*v-i*m)+p*(r*d-i*l),e[14]=-(n*(s*v-u*m)-a*(r*v-i*m)+p*(r*u-i*s)),e[15]=n*(s*d-u*l)-a*(r*d-i*l)+f*(r*u-i*s),e}t.exports=r},{}],17:[function(e,t,n){function r(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}t.exports=r},{}],18:[function(e,t,n){function r(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}t.exports=r},{}],19:[function(e,t,n){function r(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],20:[function(e,t,n){function r(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],f=e[9],l=e[10],d=e[11],h=e[12],p=e[13],m=e[14],v=e[15],g=t*a-n*o,b=t*s-r*o,y=t*u-i*o,_=n*s-r*a,x=n*u-i*a,w=r*u-i*s,A=c*p-f*h,E=c*m-l*h,k=c*v-d*h,S=f*m-l*p,M=f*v-d*p,C=l*v-d*m;return g*C-b*M+y*S+_*k-x*E+w*A}t.exports=r},{}],21:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,c=n*a,f=r*a,l=r*s,d=i*a,h=i*s,p=i*u,m=o*a,v=o*s,g=o*u;return e[0]=1-l-p,e[1]=f+g,e[2]=d-v,e[3]=0,e[4]=f-g,e[5]=1-c-p,e[6]=h+m,e[7]=0,e[8]=d+v,e[9]=h-m,e[10]=1-c-l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],22:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,u=i+i,c=o+o,f=r*s,l=r*u,d=r*c,h=i*u,p=i*c,m=o*c,v=a*s,g=a*u,b=a*c;return e[0]=1-(h+m),e[1]=l+b,e[2]=d-g,e[3]=0,e[4]=l-b,e[5]=1-(f+m),e[6]=p+v,e[7]=0,e[8]=d+g,e[9]=p-v,e[10]=1-(f+h),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}t.exports=r},{}],23:[function(e,t,n){function r(e,t,n,r,i,o,a){var s=1/(n-t),u=1/(i-r),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*u,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e}t.exports=r},{}],24:[function(e,t,n){function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],25:[function(e,t,n){t.exports={create:e(19),clone:e(17),copy:e(18),identity:e(24),transpose:e(39),invert:e(26),adjoint:e(16),determinant:e(20),multiply:e(28),translate:e(38),scale:e(36),rotate:e(32),rotateX:e(33),rotateY:e(34),rotateZ:e(35),fromRotationTranslation:e(22),fromQuat:e(21),frustum:e(23),perspective:e(30),perspectiveFromFieldOfView:e(31),ortho:e(29),lookAt:e(27),str:e(37)}},{16:16,17:17,18:18,19:19,20:20,21:21,22:22,23:23,24:24,26:26,27:27,28:28,29:29,30:30,31:31,32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39}],26:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],f=t[8],l=t[9],d=t[10],h=t[11],p=t[12],m=t[13],v=t[14],g=t[15],b=n*s-r*a,y=n*u-i*a,_=n*c-o*a,x=r*u-i*s,w=r*c-o*s,A=i*c-o*u,E=f*m-l*p,k=f*v-d*p,S=f*g-h*p,M=l*v-d*m,C=l*g-h*m,T=d*g-h*v,O=b*T-y*C+_*M+x*S-w*k+A*E;return O?(O=1/O,e[0]=(s*T-u*C+c*M)*O,e[1]=(i*C-r*T-o*M)*O,e[2]=(m*A-v*w+g*x)*O,e[3]=(d*w-l*A-h*x)*O,e[4]=(u*S-a*T-c*k)*O,e[5]=(n*T-i*S+o*k)*O,e[6]=(v*_-p*A-g*y)*O,e[7]=(f*A-d*_+h*y)*O,e[8]=(a*C-s*S+c*E)*O,e[9]=(r*S-n*C-o*E)*O,e[10]=(p*w-m*_+g*b)*O,e[11]=(l*_-f*w-h*b)*O,e[12]=(s*k-a*M-u*E)*O,e[13]=(n*M-r*k+i*E)*O,e[14]=(m*y-p*x-v*b)*O,e[15]=(f*x-l*y+d*b)*O,e):null}t.exports=r},{}],27:[function(e,t,n){function r(e,t,n,r){var o,a,s,u,c,f,l,d,h,p,m=t[0],v=t[1],g=t[2],b=r[0],y=r[1],_=r[2],x=n[0],w=n[1],A=n[2];return Math.abs(m-x)<1e-6&&Math.abs(v-w)<1e-6&&Math.abs(g-A)<1e-6?i(e):(l=m-x,d=v-w,h=g-A,p=1/Math.sqrt(l*l+d*d+h*h),l*=p,d*=p,h*=p,o=y*h-_*d,a=_*l-b*h,s=b*d-y*l,p=Math.sqrt(o*o+a*a+s*s),p?(p=1/p,o*=p,a*=p,s*=p):(o=0,a=0,s=0),u=d*s-h*a,c=h*o-l*s,f=l*a-d*o,p=Math.sqrt(u*u+c*c+f*f),p?(p=1/p,u*=p,c*=p,f*=p):(u=0,c=0,f=0),e[0]=o,e[1]=u,e[2]=l,e[3]=0,e[4]=a,e[5]=c,e[6]=d,e[7]=0,e[8]=s,e[9]=f,e[10]=h,e[11]=0,e[12]=-(o*m+a*v+s*g),e[13]=-(u*m+c*v+f*g),e[14]=-(l*m+d*v+h*g),e[15]=1,e)}var i=e(24);t.exports=r},{24:24}],28:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=t[8],d=t[9],h=t[10],p=t[11],m=t[12],v=t[13],g=t[14],b=t[15],y=n[0],_=n[1],x=n[2],w=n[3];return e[0]=y*r+_*s+x*l+w*m,e[1]=y*i+_*u+x*d+w*v,e[2]=y*o+_*c+x*h+w*g,e[3]=y*a+_*f+x*p+w*b,y=n[4],_=n[5],x=n[6],w=n[7],e[4]=y*r+_*s+x*l+w*m,e[5]=y*i+_*u+x*d+w*v,e[6]=y*o+_*c+x*h+w*g,e[7]=y*a+_*f+x*p+w*b,y=n[8],_=n[9],x=n[10],w=n[11],e[8]=y*r+_*s+x*l+w*m,e[9]=y*i+_*u+x*d+w*v,e[10]=y*o+_*c+x*h+w*g,e[11]=y*a+_*f+x*p+w*b,y=n[12],_=n[13],x=n[14],w=n[15],e[12]=y*r+_*s+x*l+w*m,e[13]=y*i+_*u+x*d+w*v,e[14]=y*o+_*c+x*h+w*g,e[15]=y*a+_*f+x*p+w*b,e}t.exports=r},{}],29:[function(e,t,n){function r(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(a+o)*c,e[15]=1,e}t.exports=r},{}],30:[function(e,t,n){function r(e,t,n,r,i){var o=1/Math.tan(t/2),a=1/(r-i);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*a,e[15]=0,e}t.exports=r},{}],31:[function(e,t,n){function r(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-((a-s)*u*.5),e[9]=(i-o)*c*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}t.exports=r},{}],32:[function(e,t,n){function r(e,t,n,r){var i,o,a,s,u,c,f,l,d,h,p,m,v,g,b,y,_,x,w,A,E,k,S,M,C=r[0],T=r[1],O=r[2],D=Math.sqrt(C*C+T*T+O*O);return Math.abs(D)<1e-6?null:(D=1/D,C*=D,T*=D,O*=D,i=Math.sin(n),o=Math.cos(n),a=1-o,s=t[0],u=t[1],c=t[2],f=t[3],l=t[4],d=t[5],h=t[6],p=t[7],m=t[8],v=t[9],g=t[10],b=t[11],y=C*C*a+o,_=T*C*a+O*i,x=O*C*a-T*i,w=C*T*a-O*i,A=T*T*a+o,E=O*T*a+C*i,k=C*O*a+T*i,S=T*O*a-C*i,M=O*O*a+o,e[0]=s*y+l*_+m*x,e[1]=u*y+d*_+v*x,e[2]=c*y+h*_+g*x,e[3]=f*y+p*_+b*x,e[4]=s*w+l*A+m*E,e[5]=u*w+d*A+v*E,e[6]=c*w+h*A+g*E,e[7]=f*w+p*A+b*E,e[8]=s*k+l*S+m*M,e[9]=u*k+d*S+v*M,e[10]=c*k+h*S+g*M,e[11]=f*k+p*S+b*M,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}t.exports=r},{}],33:[function(e,t,n){function r(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],f=t[9],l=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=a*i+f*r,e[6]=s*i+l*r,e[7]=u*i+d*r,e[8]=c*i-o*r,e[9]=f*i-a*r,e[10]=l*i-s*r,e[11]=d*i-u*r,e}t.exports=r},{}],34:[function(e,t,n){function r(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],f=t[9],l=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*r,e[1]=a*i-f*r,e[2]=s*i-l*r,e[3]=u*i-d*r,e[8]=o*r+c*i,e[9]=a*r+f*i,e[10]=s*r+l*i,e[11]=u*r+d*i,e}t.exports=r},{}],35:[function(e,t,n){function r(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[4],f=t[5],l=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*r,e[1]=a*i+f*r,e[2]=s*i+l*r,e[3]=u*i+d*r,e[4]=c*i-o*r,e[5]=f*i-a*r,e[6]=l*i-s*r,e[7]=d*i-u*r,e}t.exports=r},{}],36:[function(e,t,n){function r(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}t.exports=r},{}],37:[function(e,t,n){function r(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}t.exports=r},{}],38:[function(e,t,n){function r(e,t,n){var r,i,o,a,s,u,c,f,l,d,h,p,m=n[0],v=n[1],g=n[2];return t===e?(e[12]=t[0]*m+t[4]*v+t[8]*g+t[12],e[13]=t[1]*m+t[5]*v+t[9]*g+t[13],e[14]=t[2]*m+t[6]*v+t[10]*g+t[14],e[15]=t[3]*m+t[7]*v+t[11]*g+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=t[8],d=t[9],h=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=f,e[8]=l,e[9]=d,e[10]=h,e[11]=p,e[12]=r*m+s*v+l*g+t[12],e[13]=i*m+u*v+d*g+t[13],e[14]=o*m+c*v+h*g+t[14],e[15]=a*m+f*v+p*g+t[15]),e}t.exports=r},{}],39:[function(e,t,n){function r(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}t.exports=r},{}],40:[function(e,t,n){function r(e,t,n,r){var i,o,a,s,u,c=t[0],f=t[1],l=t[2],d=t[3],h=n[0],p=n[1],m=n[2],v=n[3];return o=c*h+f*p+l*m+d*v,o<0&&(o=-o,h=-h,p=-p,m=-m,v=-v),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),e[0]=s*c+u*h,e[1]=s*f+u*p,e[2]=s*l+u*m,e[3]=s*d+u*v,e}t.exports=r},{}],41:[function(e,t,n){function r(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}t.exports=r},{}],42:[function(e,t,n){function r(e,t){var n=i(e[0],e[1],e[2]),r=i(t[0],t[1],t[2]);o(n,n),o(r,r);var s=a(n,r);return s>1?0:Math.acos(s)}t.exports=r;var i=e(51),o=e(60),a=e(49)},{49:49,51:51,60:60}],43:[function(e,t,n){function r(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}t.exports=r},{}],44:[function(e,t,n){function r(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}t.exports=r},{}],45:[function(e,t,n){function r(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}t.exports=r},{}],46:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2];return e[0]=i*u-o*s,e[1]=o*a-r*u,e[2]=r*s-i*a,e}t.exports=r},{}],47:[function(e,t,n){function r(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}t.exports=r},{}],48:[function(e,t,n){function r(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}t.exports=r},{}],49:[function(e,t,n){function r(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}t.exports=r},{}],50:[function(e,t,n){function r(e,t,n,r,o,a){var s,u;for(t||(t=3),n||(n=0),u=r?Math.min(r*t+n,e.length):e.length,s=n;s<u;s+=t)i[0]=e[s],i[1]=e[s+1],i[2]=e[s+2],o(i,i,a),e[s]=i[0],e[s+1]=i[1],e[s+2]=i[2];return e}t.exports=r;var i=e(45)()},{45:45}],51:[function(e,t,n){function r(e,t,n){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=n,r}t.exports=r},{}],52:[function(e,t,n){t.exports={create:e(45),clone:e(43),angle:e(42),fromValues:e(51),copy:e(44),set:e(67),add:e(41),subtract:e(70),multiply:e(58),divide:e(48),min:e(57),max:e(56),scale:e(65),scaleAndAdd:e(66),distance:e(47),squaredDistance:e(68),length:e(54),squaredLength:e(69),negate:e(59),inverse:e(53),normalize:e(60),dot:e(49),cross:e(46),lerp:e(55),random:e(61),transformMat4:e(72),transformMat3:e(71),transformQuat:e(73),rotateX:e(62),rotateY:e(63),rotateZ:e(64),forEach:e(50)}},{41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73}],53:[function(e,t,n){function r(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}t.exports=r},{}],54:[function(e,t,n){function r(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}t.exports=r},{}],55:[function(e,t,n){function r(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e}t.exports=r},{}],56:[function(e,t,n){function r(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}t.exports=r},{}],57:[function(e,t,n){function r(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}t.exports=r},{}],58:[function(e,t,n){function r(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}t.exports=r},{}],59:[function(e,t,n){function r(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}t.exports=r},{}],60:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e}t.exports=r},{}],61:[function(e,t,n){function r(e,t){t=t||1;var n=2*Math.random()*Math.PI,r=2*Math.random()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}t.exports=r},{}],62:[function(e,t,n){function r(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}t.exports=r},{}],63:[function(e,t,n){function r(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}t.exports=r},{}],64:[function(e,t,n){function r(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}t.exports=r},{}],65:[function(e,t,n){function r(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}t.exports=r},{}],66:[function(e,t,n){function r(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}t.exports=r},{}],67:[function(e,t,n){function r(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}t.exports=r},{}],68:[function(e,t,n){function r(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}t.exports=r},{}],69:[function(e,t,n){function r(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}t.exports=r},{}],70:[function(e,t,n){function r(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}t.exports=r},{}],71:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e}t.exports=r},{}],72:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,e}t.exports=r},{}],73:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],c=n[3],f=c*r+s*o-u*i,l=c*i+u*r-a*o,d=c*o+a*i-s*r,h=-a*r-s*i-u*o;return e[0]=f*c+h*-a+l*-u-d*-s,e[1]=l*c+h*-s+d*-a-f*-u,e[2]=d*c+h*-u+f*-s-l*-a,e}t.exports=r},{}],74:[function(e,t,n){t.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],t[r]||"");return n.push(e[r]),n.join("")}},{}],75:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,e}function i(e,t){e[0][0]=t[0],e[0][1]=t[1],e[0][2]=t[2],e[1][0]=t[4],e[1][1]=t[5],e[1][2]=t[6],e[2][0]=t[8],e[2][1]=t[9],e[2][2]=t[10]}function o(e,t,n,r,i){e[0]=t[0]*r+n[0]*i,e[1]=t[1]*r+n[1]*i,e[2]=t[2]*r+n[2]*i}var a=e(76),s=e(19),u=e(17),c=e(20),f=e(26),l=e(39),d={length:e(54),normalize:e(60),dot:e(49),cross:e(46)},h=s(),p=s(),m=[0,0,0,0],v=[[0,0,0],[0,0,0],[0,0,0]],g=[0,0,0];t.exports=function(e,t,n,s,b,y){if(t||(t=[0,0,0]),n||(n=[0,0,0]),s||(s=[0,0,0]),b||(b=[0,0,0,1]),y||(y=[0,0,0,1]),!a(h,e))return!1;if(u(p,h),p[3]=0,p[7]=0,p[11]=0,p[15]=1,Math.abs(c(p)<1e-8))return!1;var _=h[3],x=h[7],w=h[11],A=h[12],E=h[13],k=h[14],S=h[15];if(0!==_||0!==x||0!==w){m[0]=_,m[1]=x,m[2]=w,m[3]=S;var M=f(p,p);if(!M)return!1;l(p,p),r(b,m,p)}else b[0]=b[1]=b[2]=0,b[3]=1;if(t[0]=A,t[1]=E,t[2]=k,i(v,h),n[0]=d.length(v[0]),d.normalize(v[0],v[0]),s[0]=d.dot(v[0],v[1]),o(v[1],v[1],v[0],1,-s[0]),n[1]=d.length(v[1]),d.normalize(v[1],v[1]),s[0]/=n[1],s[1]=d.dot(v[0],v[2]),o(v[2],v[2],v[0],1,-s[1]),s[2]=d.dot(v[1],v[2]),o(v[2],v[2],v[1],1,-s[2]),n[2]=d.length(v[2]),d.normalize(v[2],v[2]),s[1]/=n[2],s[2]/=n[2],d.cross(g,v[1],v[2]),d.dot(v[0],g)<0)for(var C=0;C<3;C++)n[C]*=-1,v[C][0]*=-1,v[C][1]*=-1,v[C][2]*=-1;return y[0]=.5*Math.sqrt(Math.max(1+v[0][0]-v[1][1]-v[2][2],0)),y[1]=.5*Math.sqrt(Math.max(1-v[0][0]+v[1][1]-v[2][2],0)),y[2]=.5*Math.sqrt(Math.max(1-v[0][0]-v[1][1]+v[2][2],0)),y[3]=.5*Math.sqrt(Math.max(1+v[0][0]+v[1][1]+v[2][2],0)),v[2][1]>v[1][2]&&(y[0]=-y[0]),v[0][2]>v[2][0]&&(y[1]=-y[1]),v[1][0]>v[0][1]&&(y[2]=-y[2]),!0}},{17:17,19:19,20:20,26:26,39:39,46:46,49:49,54:54,60:60,76:76}],76:[function(e,t,n){t.exports=function(e,t){var n=t[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)e[i]=t[i]*r;return!0}},{}],77:[function(e,t,n){function r(e,t,n,r){if(0===f(t)||0===f(n))return!1;var i=c(t,d.translate,d.scale,d.skew,d.perspective,d.quaternion),o=c(n,h.translate,h.scale,h.skew,h.perspective,h.quaternion);return!(!i||!o)&&(s(p.translate,d.translate,h.translate,r),s(p.skew,d.skew,h.skew,r),s(p.scale,d.scale,h.scale,r),s(p.perspective,d.perspective,h.perspective,r),l(p.quaternion,d.quaternion,h.quaternion,r),u(e,p.translate,p.scale,p.skew,p.perspective,p.quaternion),!0)}function i(){return{translate:o(),scale:o(1),skew:o(),perspective:a(),quaternion:a()}}function o(e){return[e||0,e||0,e||0]}function a(){return[0,0,0,1]}var s=e(55),u=e(78),c=e(75),f=e(20),l=e(89),d=i(),h=i(),p=i();t.exports=r},{20:20,55:55,75:75,78:78,89:89}],78:[function(e,t,n){var r={identity:e(24),translate:e(38),multiply:e(28),create:e(19),scale:e(36),fromRotationTranslation:e(22)},i=(r.create(),r.create());t.exports=function(e,t,n,o,a,s){return r.identity(e),r.fromRotationTranslation(e,s,t),e[3]=a[0],e[7]=a[1],e[11]=a[2],e[15]=a[3],r.identity(i),0!==o[2]&&(i[9]=o[2],r.multiply(e,e,i)),0!==o[1]&&(i[9]=0,i[8]=o[1],r.multiply(e,e,i)),0!==o[0]&&(i[8]=0,i[4]=o[0],r.multiply(e,e,i)),r.scale(e,e,n),e}},{19:19,22:22,24:24,28:28,36:36,38:38}],79:[function(e,t,n){"use strict";function r(e){this._components=e.slice(),this._time=[0],this.prevMatrix=e.slice(),this.nextMatrix=e.slice(),this.computedMatrix=e.slice(),this.computedInverse=e.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-(1/0),1/0]}function i(e){e=e||{};var t=e.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new r(t)}var o=e(5),a=e(77),s=e(26),u=e(33),c=e(34),f=e(35),l=e(27),d=e(38),h=(e(36),e(60)),p=[0,0,0];t.exports=i;var m=r.prototype;m.recalcMatrix=function(e){var t=this._time,n=o.le(t,e),r=this.computedMatrix;if(!(n<0)){var i=this._components;if(n===t.length-1)for(var u=16*n,c=0;c<16;++c)r[c]=i[u++];else{for(var f=t[n+1]-t[n],u=16*n,l=this.prevMatrix,d=!0,c=0;c<16;++c)l[c]=i[u++];for(var p=this.nextMatrix,c=0;c<16;++c)p[c]=i[u++],d=d&&l[c]===p[c];if(f<1e-6||d)for(var c=0;c<16;++c)r[c]=l[c];else a(r,l,p,(e-t[n])/f)}var m=this.computedUp;m[0]=r[1],m[1]=r[5],m[2]=r[9],h(m,m);var v=this.computedInverse;s(v,r);var g=this.computedEye,b=v[15];g[0]=v[12]/b,g[1]=v[13]/b,g[2]=v[14]/b;for(var y=this.computedCenter,_=Math.exp(this.computedRadius[0]),c=0;c<3;++c)y[c]=g[c]-r[2+4*c]*_}},m.idle=function(e){if(!(e<this.lastT())){for(var t=this._components,n=t.length-16,r=0;r<16;++r)t.push(t[n++]);this._time.push(e)}},m.flush=function(e){var t=o.gt(this._time,e)-2;t<0||(this._time.splice(0,t),this._components.splice(0,16*t))},m.lastT=function(){return this._time[this._time.length-1]},m.lookAt=function(e,t,n,r){this.recalcMatrix(e),t=t||this.computedEye,n=n||p,r=r||this.computedUp,this.setMatrix(e,l(this.computedMatrix,t,n,r));for(var i=0,o=0;o<3;++o)i+=Math.pow(n[o]-t[o],2);i=Math.log(Math.sqrt(i)),this.computedRadius[0]=i},m.rotate=function(e,t,n,r){this.recalcMatrix(e);var i=this.computedInverse;t&&c(i,i,t),n&&u(i,i,n),r&&f(i,i,r),this.setMatrix(e,s(this.computedMatrix,i))};var v=[0,0,0];m.pan=function(e,t,n,r){v[0]=-(t||0),v[1]=-(n||0),v[2]=-(r||0),this.recalcMatrix(e);var i=this.computedInverse;d(i,i,v),this.setMatrix(e,s(i,i))},m.translate=function(e,t,n,r){v[0]=t||0,v[1]=n||0,v[2]=r||0,this.recalcMatrix(e);var i=this.computedMatrix;d(i,i,v),this.setMatrix(e,i)},m.setMatrix=function(e,t){if(!(e<this.lastT())){this._time.push(e);for(var n=0;n<16;++n)this._components.push(t[n])}},m.setDistance=function(e,t){this.computedRadius[0]=t},m.setDistanceLimits=function(e,t){var n=this._limits;n[0]=e,n[1]=t},m.getDistanceLimits=function(e){var t=this._limits;return e?(e[0]=t[0],e[1]=t[1],e):t}},{26:26,27:27,33:33,34:34,35:35,36:36,38:38,5:5,60:60,77:77}],80:[function(e,t,n){"use strict";function r(e,t){function n(e){var t=!1;return"altKey"in e&&(t=t||e.altKey!==v.alt,v.alt=!!e.altKey),"shiftKey"in e&&(t=t||e.shiftKey!==v.shift,v.shift=!!e.shiftKey),"ctrlKey"in e&&(t=t||e.ctrlKey!==v.control,v.control=!!e.ctrlKey),"metaKey"in e&&(t=t||e.metaKey!==v.meta,v.meta=!!e.metaKey),t}function r(e,r){var o=i.x(r),a=i.y(r);"buttons"in r&&(e=0|r.buttons),(e!==h||o!==p||a!==m||n(r))&&(h=0|e,p=o||0,m=a||0,t&&t(h,p,m,v))}function o(e){r(0,e)}function a(){(h||p||m||v.shift||v.alt||v.meta||v.control)&&(p=m=0,h=0,v.shift=v.alt=v.control=v.meta=!1,t&&t(0,0,0,v))}function s(e){n(e)&&t&&t(h,p,m,v)}function u(e){0===i.buttons(e)?r(0,e):r(h,e)}function c(e){r(h|i.buttons(e),e)}function f(e){r(h&~i.buttons(e),e)}function l(){g||(g=!0,e.addEventListener("mousemove",u),e.addEventListener("mousedown",c),e.addEventListener("mouseup",f),e.addEventListener("mouseleave",o),e.addEventListener("mouseenter",o),e.addEventListener("mouseout",o),e.addEventListener("mouseover",o),e.addEventListener("blur",a),e.addEventListener("keyup",s),e.addEventListener("keydown",s),e.addEventListener("keypress",s),e!==window&&(window.addEventListener("blur",a),window.addEventListener("keyup",s),window.addEventListener("keydown",s),window.addEventListener("keypress",s)))}function d(){g&&(g=!1,e.removeEventListener("mousemove",u),e.removeEventListener("mousedown",c),e.removeEventListener("mouseup",f),e.removeEventListener("mouseleave",o),e.removeEventListener("mouseenter",o),e.removeEventListener("mouseout",o),e.removeEventListener("mouseover",o),e.removeEventListener("blur",a),e.removeEventListener("keyup",s),e.removeEventListener("keydown",s),e.removeEventListener("keypress",s),e!==window&&(window.removeEventListener("blur",a),window.removeEventListener("keyup",s),window.removeEventListener("keydown",s),window.removeEventListener("keypress",s)))}t||(t=e,e=window);var h=0,p=0,m=0,v={shift:!1,alt:!1,control:!1,meta:!1},g=!1;l();var b={element:e};return Object.defineProperties(b,{enabled:{get:function(){return g},set:function(e){e?l():d()},enumerable:!0},buttons:{get:function(){return h},enumerable:!0},x:{get:function(){return p},enumerable:!0},y:{get:function(){return m},enumerable:!0},mods:{get:function(){return v},enumerable:!0}}),b}t.exports=r;var i=e(82)},{82:82}],81:[function(e,t,n){function r(e,t,n){t=t||e.currentTarget||e.srcElement,Array.isArray(n)||(n=[0,0]);var r=e.clientX||0,o=e.clientY||0,a=i(t);return n[0]=r-a.left,n[1]=o-a.top,n}function i(e){return e===window||e===document||e===document.body?o:e.getBoundingClientRect()}var o={left:0,top:0};t.exports=r},{}],82:[function(e,t,n){"use strict";function r(e){if("object"==typeof e){if("buttons"in e)return e.buttons;if("which"in e){var t=e.which;if(2===t)return 4;if(3===t)return 2;if(t>0)return 1<<t-1}else if("button"in e){var t=e.button;if(1===t)return 4;if(2===t)return 2;if(t>=0)return 1<<t}}return 0}function i(e){return e.target||e.srcElement||window}function o(e){if("object"==typeof e){if("offsetX"in e)return e.offsetX;var t=i(e),n=t.getBoundingClientRect();return e.clientX-n.left}return 0}function a(e){if("object"==typeof e){if("offsetY"in e)return e.offsetY;var t=i(e),n=t.getBoundingClientRect();return e.clientY-n.top}return 0}n.buttons=r,n.element=i,n.x=o,n.y=a},{}],83:[function(e,t,n){"use strict";function r(e,t,n){"function"==typeof e&&(n=!!t,t=e,e=window);var r=i("ex",e),o=function(e){n&&e.preventDefault();var i=e.deltaX||0,o=e.deltaY||0,a=e.deltaZ||0,s=e.deltaMode,u=1;switch(s){case 1:u=r;break;case 2:u=window.innerHeight}if(i*=u,o*=u,a*=u,i||o||a)return t(i,o,a,e)};return e.addEventListener("wheel",o),o}var i=e(95);t.exports=r},{95:95}],84:[function(e,t,n){function r(e,t){e=e||0;for(var n=new Array(e),r=0;r<e;r++)n[r]=t;return n}t.exports=r},{}],85:[function(e,t,n){"use strict";function r(e,t,n,r,i,o,a,s,u,c){var f=t+o+c;if(l>0){var l=Math.sqrt(f+1);e[0]=.5*(a-u)/l,e[1]=.5*(s-r)/l,e[2]=.5*(n-o)/l,e[3]=.5*l}else{var d=Math.max(t,o,c),l=Math.sqrt(2*d-f+1);t>=d?(e[0]=.5*l,e[1]=.5*(i+n)/l,e[2]=.5*(s+r)/l,e[3]=.5*(a-u)/l):o>=d?(e[0]=.5*(n+i)/l,e[1]=.5*l,e[2]=.5*(u+a)/l,e[3]=.5*(s-r)/l):(e[0]=.5*(r+s)/l,e[1]=.5*(a+u)/l,e[2]=.5*l,e[3]=.5*(n-i)/l)}return e}t.exports=r},{}],86:[function(e,t,n){"use strict";function r(e,t,n){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(n,2))}function i(e,t,n,r){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(n,2)+Math.pow(r,2));
}function o(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],s=i(n,r,o,a);s>1e-6?(e[0]=n/s,e[1]=r/s,e[2]=o/s,e[3]=a/s):(e[0]=e[1]=e[2]=0,e[3]=1)}function a(e,t,n){this.radius=u([n]),this.center=u(t),this.rotation=u(e),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}function s(e){e=e||{};var t=e.center||[0,0,0],n=e.rotation||[0,0,0,1],r=e.radius||1;t=[].slice.call(t,0,3),n=[].slice.call(n,0,4),o(n,n);var i=new a(n,t,Math.log(r));return i.setDistanceLimits(e.zoomMin,e.zoomMax),("eye"in e||"up"in e)&&i.lookAt(0,e.eye,e.center,e.up),i}t.exports=s;var u=e(14),c=e(27),f=e(21),l=e(26),d=e(85),h=a.prototype;h.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},h.recalcMatrix=function(e){this.radius.curve(e),this.center.curve(e),this.rotation.curve(e);var t=this.computedRotation;o(t,t);var n=this.computedMatrix;f(n,t);var r=this.computedCenter,i=this.computedEye,a=this.computedUp,s=Math.exp(this.computedRadius[0]);i[0]=r[0]+s*n[2],i[1]=r[1]+s*n[6],i[2]=r[2]+s*n[10],a[0]=n[1],a[1]=n[5],a[2]=n[9];for(var u=0;u<3;++u){for(var c=0,l=0;l<3;++l)c+=n[u+4*l]*i[l];n[12+u]=-c}},h.getMatrix=function(e,t){this.recalcMatrix(e);var n=this.computedMatrix;if(t){for(var r=0;r<16;++r)t[r]=n[r];return t}return n},h.idle=function(e){this.center.idle(e),this.radius.idle(e),this.rotation.idle(e)},h.flush=function(e){this.center.flush(e),this.radius.flush(e),this.rotation.flush(e)},h.pan=function(e,t,n,i){t=t||0,n=n||0,i=i||0,this.recalcMatrix(e);var o=this.computedMatrix,a=o[1],s=o[5],u=o[9],c=r(a,s,u);a/=c,s/=c,u/=c;var f=o[0],l=o[4],d=o[8],h=f*a+l*s+d*u;f-=a*h,l-=s*h,d-=u*h;var p=r(f,l,d);f/=p,l/=p,d/=p;var m=o[2],v=o[6],g=o[10],b=m*a+v*s+g*u,y=m*f+v*l+g*d;m-=b*a+y*f,v-=b*s+y*l,g-=b*u+y*d;var _=r(m,v,g);m/=_,v/=_,g/=_;var x=f*t+a*n,w=l*t+s*n,A=d*t+u*n;this.center.move(e,x,w,A);var E=Math.exp(this.computedRadius[0]);E=Math.max(1e-4,E+i),this.radius.set(e,Math.log(E))},h.rotate=function(e,t,n,o){this.recalcMatrix(e),t=t||0,n=n||0;var a=this.computedMatrix,s=a[0],u=a[4],c=a[8],f=a[1],l=a[5],d=a[9],h=a[2],p=a[6],m=a[10],v=t*s+n*f,g=t*u+n*l,b=t*c+n*d,y=-(p*b-m*g),_=-(m*v-h*b),x=-(h*g-p*v),w=Math.sqrt(Math.max(0,1-Math.pow(y,2)-Math.pow(_,2)-Math.pow(x,2))),A=i(y,_,x,w);A>1e-6?(y/=A,_/=A,x/=A,w/=A):(y=_=x=0,w=1);var E=this.computedRotation,k=E[0],S=E[1],M=E[2],C=E[3],T=k*w+C*y+S*x-M*_,O=S*w+C*_+M*y-k*x,D=M*w+C*x+k*_-S*y,L=C*w-k*y-S*_-M*x;if(o){y=h,_=p,x=m;var j=Math.sin(o)/r(y,_,x);y*=j,_*=j,x*=j,w=Math.cos(t),T=T*w+L*y+O*x-D*_,O=O*w+L*_+D*y-T*x,D=D*w+L*x+T*_-O*y,L=L*w-T*y-O*_-D*x}var R=i(T,O,D,L);R>1e-6?(T/=R,O/=R,D/=R,L/=R):(T=O=D=0,L=1),this.rotation.set(e,T,O,D,L)},h.lookAt=function(e,t,n,r){this.recalcMatrix(e),n=n||this.computedCenter,t=t||this.computedEye,r=r||this.computedUp;var i=this.computedMatrix;c(i,t,n,r);var a=this.computedRotation;d(a,i[0],i[1],i[2],i[4],i[5],i[6],i[8],i[9],i[10]),o(a,a),this.rotation.set(e,a[0],a[1],a[2],a[3]);for(var s=0,u=0;u<3;++u)s+=Math.pow(n[u]-t[u],2);this.radius.set(e,.5*Math.log(Math.max(s,1e-6))),this.center.set(e,n[0],n[1],n[2])},h.translate=function(e,t,n,r){this.center.move(e,t||0,n||0,r||0)},h.setMatrix=function(e,t){var n=this.computedRotation;d(n,t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]),o(n,n),this.rotation.set(e,n[0],n[1],n[2],n[3]);var r=this.computedMatrix;l(r,t);var i=r[15];if(Math.abs(i)>1e-6){var a=r[12]/i,s=r[13]/i,u=r[14]/i;this.recalcMatrix(e);var c=Math.exp(this.computedRadius[0]);this.center.set(e,a-r[2]*c,s-r[6]*c,u-r[10]*c),this.radius.idle(e)}else this.center.idle(e),this.radius.idle(e)},h.setDistance=function(e,t){t>0&&this.radius.set(e,Math.log(t))},h.setDistanceLimits=function(e,t){e=e>0?Math.log(e):-(1/0),t=t>0?Math.log(t):1/0,t=Math.max(t,e),this.radius.bounds[0][0]=e,this.radius.bounds[1][0]=t},h.getDistanceLimits=function(e){var t=this.radius.bounds;return e?(e[0]=Math.exp(t[0][0]),e[1]=Math.exp(t[1][0]),e):[Math.exp(t[0][0]),Math.exp(t[1][0])]},h.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},h.fromJSON=function(e){var t=this.lastT(),n=e.center;n&&this.center.set(t,n[0],n[1],n[2]);var r=e.rotation;r&&this.rotation.set(t,r[0],r[1],r[2],r[3]);var i=e.distance;i&&i>0&&this.radius.set(t,Math.log(i)),this.setDistanceLimits(e.zoomMin,e.zoomMax)}},{14:14,21:21,26:26,27:27,85:85}],87:[function(e,t,n){t.exports=function(e,t){t||(t=[0,""]),e=String(e);var n=parseFloat(e,10);return t[0]=n,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t}},{}],88:[function(e,t,n){var r=null,i=["Webkit","Moz","O","ms"];t.exports=function(e){r||(r=document.createElement("div"));var t=r.style;if(e in t)return e;for(var n=e.charAt(0).toUpperCase()+e.slice(1),o=i.length;o>=0;o--){var a=i[o]+n;if(a in t)return a}return!1}},{}],89:[function(e,t,n){t.exports=e(40)},{40:40}],90:[function(e,t,n){!function(e,r){"object"==typeof n&&"undefined"!=typeof t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.createREGL=r()}(this,function(){"use strict";function e(e){return"undefined"!=typeof btoa?btoa(e):"base64:"+e}function t(e){var t=new Error("(regl) "+e);throw console.error(t),t}function n(e,n){e||t(n)}function r(e){return e?": "+e:""}function i(e,n,i){e in n||t("unknown parameter ("+e+")"+r(i)+". possible values: "+Object.keys(n).join())}function o(e,n){Ze(e)||t("invalid parameter type"+r(n)+". must be a typed array")}function a(e,n,i){typeof e!==n&&t("invalid parameter type"+r(i)+". expected "+n+", got "+typeof e)}function s(e,n){e>=0&&(0|e)===e||t("invalid parameter type, ("+e+")"+r(n)+". must be a nonnegative integer")}function u(e,n,i){n.indexOf(e)<0&&t("invalid value"+r(i)+". must be one of: "+n)}function c(e){Object.keys(e).forEach(function(e){et.indexOf(e)<0&&t('invalid regl constructor argument "'+e+'". must be one of '+et)})}function f(e,t){for(e+="";e.length<t;)e=" "+e;return e}function l(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function d(e,t){this.number=e,this.line=t,this.errors=[]}function h(e,t,n){this.file=e,this.line=t,this.message=n}function p(){var e=new Error,t=(e.stack||e).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return r?r[1]:"unknown"}function m(){var e=new Error,t=(e.stack||e).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return r?r[1]:"unknown"}function v(t,n){var r=t.split("\n"),i=1,o=0,a={unknown:new l,0:new l};a.unknown.name=a[0].name=n||p(),a.unknown.lines.push(new d(0,""));for(var s=0;s<r.length;++s){var u=r[s],c=/^\s*\#\s*(\w+)\s+(.+)\s*$/.exec(u);if(c)switch(c[1]){case"line":var f=/(\d+)(\s+\d+)?/.exec(c[2]);f&&(i=0|f[1],f[2]&&(o=0|f[2],o in a||(a[o]=new l)));break;case"define":var h=/SHADER_NAME(_B64)?\s+(.*)$/.exec(c[2]);h&&(a[o].name=h[1]?e(h[2]):h[2])}a[o].lines.push(new d(i++,u))}return Object.keys(a).forEach(function(e){var t=a[e];t.lines.forEach(function(e){t.index[e.number]=e})}),a}function g(e){var t=[];return e.split("\n").forEach(function(e){if(!(e.length<5)){var n=/^ERROR\:\s+(\d+)\:(\d+)\:\s*(.*)$/.exec(e);n?t.push(new h(0|n[1],0|n[2],n[3].trim())):e.length>0&&t.push(new h("unknown",0,e))}}),t}function b(e,t){t.forEach(function(t){var n=e[t.file];if(n){var r=n.index[t.line];if(r)return r.errors.push(t),void(n.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)})}function y(e,t,r,i,o){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var a=e.getShaderInfoLog(t),s=i===e.FRAGMENT_SHADER?"fragment":"vertex";S(r,"string",s+" shader source must be a string",o);var u=v(r,o),c=g(a);b(u,c),Object.keys(u).forEach(function(e){function t(e,t){r.push(e),i.push(t||"")}var n=u[e];if(n.hasErrors){var r=[""],i=[""];t("file number "+e+": "+n.name+"\n","color:red;text-decoration:underline;font-weight:bold"),n.lines.forEach(function(e){if(e.errors.length>0){t(f(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),t(e.line+"\n","color:red; background-color:yellow; font-weight:bold");var n=0;e.errors.forEach(function(r){var i=r.message,o=/^\s*\'(.*)\'\s*\:\s*(.*)$/.exec(i);if(o){var a=o[1];switch(i=o[2],a){case"assign":a="="}n=Math.max(e.line.indexOf(a,n),0)}else n=0;t(f("| ",6)),t(f("^^^",n+3)+"\n","font-weight:bold"),t(f("| ",6)),t(i+"\n","font-weight:bold")}),t(f("| ",6)+"\n")}else t(f(e.number,4)+"|  "),t(e.line+"\n","color:red")}),"undefined"!=typeof document?(i[0]=r.join("%c"),console.log.apply(console,i)):console.log(r.join(""))}}),n.raise("Error compiling "+s+" shader, "+u[0].name)}}function _(e,t,r,i,o){if(!e.getProgramParameter(t,e.LINK_STATUS)){var a=e.getProgramInfoLog(t),s=v(r,o),u=v(i,o),c='Error linking program with vertex shader, "'+u[0].name+'", and fragment shader "'+s[0].name+'"';"undefined"!=typeof document?console.log("%c"+c+"\n%c"+a,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(c+"\n"+a),n.raise(c)}}function x(e){e._commandRef=p()}function w(e,t,n,r){function i(e){return e?r.id(e):0}function o(e,t){Object.keys(t).forEach(function(t){e[r.id(t)]=!0})}x(e),e._fragId=i(e.static.frag),e._vertId=i(e.static.vert);var a=e._uniformSet={};o(a,t.static),o(a,t.dynamic);var s=e._attributeSet={};o(s,n.static),o(s,n.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic}function A(e,n){var r=m();t(e+" in command "+(n||p())+("unknown"===r?"":" called from "+r))}function E(e,t,n){e||A(t,n||p())}function k(e,t,n,i){e in t||A("unknown parameter ("+e+")"+r(n)+". possible values: "+Object.keys(t).join(),i||p())}function S(e,t,n,i){typeof e!==t&&A("invalid parameter type"+r(n)+". expected "+t+", got "+typeof e,i||p())}function M(e){e()}function C(e,t,n){e.texture?u(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):u(e.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")}function T(e,t){return e===mt||e===pt||e===vt?2:e===gt?4:yt[e]*t}function O(e){return!(e&e-1||!e)}function D(e,t,r){var i,o=t.width,a=t.height,s=t.channels;n(o>0&&o<=r.maxTextureSize&&a>0&&a<=r.maxTextureSize,"invalid texture shape"),e.wrapS===tt&&e.wrapT===tt||n(O(o)&&O(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==o&&1!==a&&n(e.minFilter!==rt&&e.minFilter!==ot&&e.minFilter!==it&&e.minFilter!==at,"min filter requires mipmap"):(n(O(o)&&O(a),"texture must be a square power of 2 to support mipmapping"),n(t.mipmask===(o<<1)-1,"missing or incomplete mipmap data")),t.type===ht&&(r.extensions.indexOf("oes_texture_float_linear")<0&&n(e.minFilter===nt&&e.magFilter===nt,"filter not supported, must enable oes_texture_float_linear"),n(!e.genMipmaps,"mipmap generation not supported with float textures"));var u=t.images;for(i=0;i<16;++i)if(u[i]){var c=o>>i,f=a>>i;n(t.mipmask&1<<i,"missing mipmap data");var l=u[i];if(n(l.width===c&&l.height===f,"invalid shape for mip images"),n(l.format===t.format&&l.internalformat===t.internalformat&&l.type===t.type,"incompatible type for mip image"),l.compressed);else if(l.data){var d=Math.ceil(T(l.type,s)*c/l.unpackAlignment)*l.unpackAlignment;n(l.data.byteLength===d*f,"invalid data for image, buffer size is inconsistent with image format")}else l.element||l.copy}else e.genMipmaps||n(0===(t.mipmask&1<<i),"extra mipmap data");t.compressed&&n(!e.genMipmaps,"mipmap generation for compressed images not supported")}function L(e,t,r,i){var o=e.width,a=e.height,s=e.channels;n(o>0&&o<=i.maxTextureSize&&a>0&&a<=i.maxTextureSize,"invalid texture shape"),n(o===a,"cube map must be square"),n(t.wrapS===tt&&t.wrapT===tt,"wrap mode not supported by cube map");for(var u=0;u<r.length;++u){var c=r[u];n(c.width===o&&c.height===a,"inconsistent cube map face shape"),t.genMipmaps&&(n(!c.compressed,"can not generate mipmap for compressed textures"),n(1===c.mipmask,"can not specify mipmaps and generate mipmaps"));for(var f=c.images,l=0;l<16;++l){var d=f[l];if(d){var h=o>>l,p=a>>l;n(c.mipmask&1<<l,"missing mipmap data"),n(d.width===h&&d.height===p,"invalid shape for mip images"),n(d.format===e.format&&d.internalformat===e.internalformat&&d.type===e.type,"incompatible type for mip image"),d.compressed||(d.data?n(d.data.byteLength===h*p*Math.max(T(d.type,s),d.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):d.element||d.copy)}}}}function j(e,t){this.id=xt++,this.type=e,this.data=t}function R(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function z(e){if(0===e.length)return[];var t=e.charAt(0),n=e.charAt(e.length-1);if(e.length>1&&t===n&&('"'===t||"'"===t))return['"'+R(e.substr(1,e.length-2))+'"'];var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(r)return z(e.substr(0,r.index)).concat(z(r[1])).concat(z(e.substr(r.index+r[0].length)));var i=e.split(".");if(1===i.length)return['"'+R(e)+'"'];for(var o=[],a=0;a<i.length;++a)o=o.concat(z(i[a]));return o}function F(e){return"["+z(e).join("][")+"]"}function B(e,t){return new j(e,F(t+""))}function P(e){return"function"==typeof e&&!e._reglType||e instanceof j}function N(e,t){return"function"==typeof e?new j(wt,e):e}function I(){var e={"":0},t=[""];return{id:function(n){var r=e[n];return r?r:(r=e[n]=t.length,t.push(n),r)},str:function(e){return t[e]}}}function H(e,t,n){function r(){var t=window.innerWidth,r=window.innerHeight;if(e!==document.body){var i=e.getBoundingClientRect();t=i.right-i.left,r=i.bottom-i.top}o.width=n*t,o.height=n*r,$e(o.style,{width:t+"px",height:r+"px"})}function i(){window.removeEventListener("resize",r),e.removeChild(o)}var o=document.createElement("canvas");return $e(o.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(o),e===document.body&&(o.style.position="absolute",$e(e.style,{margin:0,padding:0})),window.addEventListener("resize",r,!1),r(),{canvas:o,onDestroy:i}}function U(e,t){function n(n){try{return e.getContext(n,t)}catch(e){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function V(e){return"string"==typeof e.nodeName&&"function"==typeof e.appendChild&&"function"==typeof e.getBoundingClientRect}function G(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}function W(e){return"string"==typeof e?e.split():(_t(Array.isArray(e),"invalid extension array"),e)}function q(e){return"string"==typeof e?(_t("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(e)):e}function X(e){var t,n,r,i,o=e||{},a={},s=[],u=[],c="undefined"==typeof window?1:window.devicePixelRatio,f=!1,l=function(e){e&&_t.raise(e)},d=function(){};if("string"==typeof o?(_t("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),t=document.querySelector(o),_t(t,"invalid query string for element")):"object"==typeof o?V(o)?t=o:G(o)?(i=o,r=i.canvas):(_t.constructor(o),"gl"in o?i=o.gl:"canvas"in o?r=q(o.canvas):"container"in o&&(n=q(o.container)),"attributes"in o&&(a=o.attributes,_t.type(a,"object","invalid context attributes")),"extensions"in o&&(s=W(o.extensions)),"optionalExtensions"in o&&(u=W(o.optionalExtensions)),"onDone"in o&&(_t.type(o.onDone,"function","invalid or missing onDone callback"),l=o.onDone),"profile"in o&&(f=!!o.profile),"pixelRatio"in o&&(c=+o.pixelRatio,_t(c>0,"invalid pixel ratio"))):_t.raise("invalid arguments to regl"),t&&("canvas"===t.nodeName.toLowerCase()?r=t:n=t),!i){if(!r){_t("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var h=H(n||document.body,l,c);if(!h)return null;r=h.canvas,d=h.onDestroy}i=U(r,a)}return i?{gl:i,canvas:r,container:n,extensions:s,optionalExtensions:u,pixelRatio:c,profile:f,onDone:l,onDestroy:d}:(d(),l("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Y(e,t){function n(t){_t.type(t,"string","extension name must be string");var n,i=t.toLowerCase();try{n=r[i]=e.getExtension(i)}catch(e){}return!!n}for(var r={},i=0;i<t.extensions.length;++i){var o=t.extensions[i];if(!n(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach(function(e){if(!n(e))throw new Error("(regl): error restoring extension "+e)})}}}function K(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||Ze(e.data))}function Q(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}function J(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}function Z(e){var t,n;return t=(e>65535)<<4,e>>>=t,n=(e>255)<<3,e>>>=n,t|=n,n=(e>15)<<2,e>>>=n,t|=n,n=(e>3)<<1,e>>>=n,t|=n,t|e>>1}function $(e){var t=J(e),n=cn[Z(t)>>2];return n.length>0?n.pop():new ArrayBuffer(t)}function ee(e){cn[Z(e.byteLength)>>2].push(e)}function te(e,t){var n=null;switch(e){case tn:n=new Int8Array($(t),0,t);break;case nn:n=new Uint8Array($(t),0,t);break;case rn:n=new Int16Array($(2*t),0,t);break;case on:n=new Uint16Array($(2*t),0,t);break;case an:n=new Int32Array($(4*t),0,t);break;case sn:n=new Uint32Array($(4*t),0,t);break;case un:n=new Float32Array($(4*t),0,t);break;default:return null}return n.length!==t?n.subarray(0,t):n}function ne(e){ee(e.buffer)}function re(e,t,n){for(var r=0;r<t;++r)n[r]=e[r]}function ie(e,t,n,r){for(var i=0,o=0;o<t;++o)for(var a=e[o],s=0;s<n;++s)r[i++]=a[s]}function oe(e,t,n,r,i,o){for(var a=o,s=0;s<t;++s)for(var u=e[s],c=0;c<n;++c)for(var f=u[c],l=0;l<r;++l)i[a++]=f[l]}function ae(e,t,n,r,i){for(var o=1,a=n+1;a<t.length;++a)o*=t[a];var s=t[n];if(t.length-n===4){var u=t[n+1],c=t[n+2],f=t[n+3];for(a=0;a<s;++a)oe(e[a],u,c,f,r,i),i+=o}else for(a=0;a<s;++a)ae(e[a],t,n+1,r,i),i+=o}function se(e,t,n,r){var i=1;if(t.length)for(var o=0;o<t.length;++o)i*=t[o];else i=0;var a=r||fn.allocType(n,i);switch(t.length){case 0:break;case 1:re(e,t[0],a);break;case 2:ie(e,t[0],t[1],a);break;case 3:oe(e,t[0],t[1],t[2],a,0);break;default:ae(e,t,0,a,0)}return a}function ue(e){for(var t=[],n=e;n.length;n=n[0])t.push(n.length);return t}function ce(e){return 0|Je[Object.prototype.toString.call(e)]}function fe(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function le(e,t,n,r,i,o,a){for(var s=0,u=0;u<n;++u)for(var c=0;c<r;++c)e[s++]=t[i*u+o*c+a]}function de(e,t,n){function r(t){this.id=l++,this.buffer=e.createBuffer(),this.type=t,this.usage=Sn,this.byteLength=0,this.dimension=1,this.dtype=Cn,this.persistentData=null,n.profile&&(this.stats={size:0})}function i(e,t){var n=h.pop();return n||(n=new r(e)),n.bind(),s(n,t,Mn,0,1,!1),n}function o(e){h.push(e)}function a(t,n,r){t.byteLength=n.byteLength,e.bufferData(t.type,n,r)}function s(e,t,n,r,i,o){var s;if(e.usage=n,Array.isArray(t)){if(e.dtype=r||Tn,t.length>0){var u;if(Array.isArray(t[0])){s=kn(t);for(var c=1,f=1;f<s.length;++f)c*=s[f];e.dimension=c,u=En(t,s,e.dtype),a(e,u,n),o?e.persistentData=u:fn.freeType(u)}else if("number"==typeof t[0]){e.dimension=i;var l=fn.allocType(e.dtype,t.length);fe(l,t),a(e,l,n),o?e.persistentData=l:fn.freeType(l)}else Ze(t[0])?(e.dimension=t[0].length,e.dtype=r||ce(t[0])||Tn,u=En(t,[t.length,t[0].length],e.dtype),a(e,u,n),o?e.persistentData=u:fn.freeType(u)):_t.raise("invalid buffer data")}}else if(Ze(t))e.dtype=r||ce(t),e.dimension=i,a(e,t,n),o&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(K(t)){s=t.shape;var d=t.stride,h=t.offset,p=0,m=0,v=0,g=0;1===s.length?(p=s[0],m=1,v=d[0],g=0):2===s.length?(p=s[0],m=s[1],v=d[0],g=d[1]):_t.raise("invalid shape"),e.dtype=r||ce(t.data)||Tn,e.dimension=m;var b=fn.allocType(e.dtype,p*m);le(b,t.data,p,m,v,g,h),a(e,b,n),o?e.persistentData=b:fn.freeType(b)}else _t.raise("invalid buffer data")}function u(n){t.bufferCount--;var r=n.buffer;_t(r,"buffer must not be deleted already"),e.deleteBuffer(r),n.buffer=null,delete d[n.id]}function c(i,o,a,c){function f(t){var r=Sn,i=null,o=0,a=0,u=1;return Array.isArray(t)||Ze(t)||K(t)?i=t:"number"==typeof t?o=0|t:t&&(_t.type(t,"object","buffer arguments must be an object, a number or an array"),"data"in t&&(_t(null===i||Array.isArray(i)||Ze(i)||K(i),"invalid data for buffer"),i=t.data),"usage"in t&&(_t.parameter(t.usage,An,"invalid buffer usage"),r=An[t.usage]),"type"in t&&(_t.parameter(t.type,_n,"invalid buffer type"),a=_n[t.type]),"dimension"in t&&(_t.type(t.dimension,"number","invalid dimension"),u=0|t.dimension),"length"in t&&(_t.nni(o,"buffer length must be a nonnegative integer"),o=0|t.length)),p.bind(),i?s(p,i,r,a,u,c):(e.bufferData(p.type,o,r),p.dtype=a||Cn,p.usage=r,p.dimension=u,p.byteLength=o),n.profile&&(p.stats.size=p.byteLength*On[p.dtype]),f}function l(t,n){_t(n+t.byteLength<=p.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+n+" to a buffer of size "+p.byteLength),e.bufferSubData(p.type,n,t)}function h(e,t){var n,r=0|(t||0);if(p.bind(),Array.isArray(e)){if(e.length>0)if("number"==typeof e[0]){var i=fn.allocType(p.dtype,e.length);fe(i,e),l(i,r),fn.freeType(i)}else if(Array.isArray(e[0])||Ze(e[0])){n=kn(e);var o=En(e,n,p.dtype);l(o,r),fn.freeType(o)}else _t.raise("invalid buffer data")}else if(Ze(e))l(e,r);else if(K(e)){n=e.shape;var a=e.stride,s=0,u=0,c=0,d=0;1===n.length?(s=n[0],u=1,c=a[0],d=0):2===n.length?(s=n[0],u=n[1],c=a[0],d=a[1]):_t.raise("invalid shape");var h=Array.isArray(e.data)?p.dtype:ce(e.data),m=fn.allocType(h,s*u);le(m,e.data,s,u,c,d,e.offset),l(m,r),fn.freeType(m)}else _t.raise("invalid data for buffer subdata");return f}t.bufferCount++;var p=new r(o);return d[p.id]=p,a||f(i),f._reglType="buffer",f._buffer=p,f.subdata=h,n.profile&&(f.stats=p.stats),f.destroy=function(){u(p)},f}function f(){en(d).forEach(function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)})}var l=0,d={};r.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},r.prototype.destroy=function(){u(this)};var h=[];return n.profile&&(t.getTotalBufferSize=function(){var e=0;return Object.keys(d).forEach(function(t){e+=d[t].stats.size}),e}),{create:c,createStream:i,destroyStream:o,clear:function(){en(d).forEach(u),h.forEach(u)},getBuffer:function(e){return e&&e._buffer instanceof r?e._buffer:null},restore:f,_initBuffer:s}}function he(e,t,n,r){function i(e){this.id=l++,f[this.id]=this,this.buffer=e,this.primType=In,this.vertCount=0,this.type=0}function o(e){var t=h.pop();return t||(t=new i(n.create(null,Xn,!0,!1)._buffer)),s(t,e,Yn,-1,-1,0,0),t}function a(e){h.push(e)}function s(r,i,o,a,s,u,c){if(r.buffer.bind(),i){var f=c;c||Ze(i)&&(!K(i)||Ze(i.data))||(f=t.oes_element_index_uint?qn:Gn),n._initBuffer(r.buffer,i,o,f,3)}else e.bufferData(Xn,u,o),r.buffer.dtype=l||Un,r.buffer.usage=o,r.buffer.dimension=3,r.buffer.byteLength=u;var l=c;if(!c){switch(r.buffer.dtype){case Un:case Hn:l=Un;break;case Gn:case Vn:l=Gn;break;case qn:case Wn:l=qn;break;default:_t.raise("unsupported type for element array")}r.buffer.dtype=l}r.type=l,_t(l!==qn||!!t.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var d=s;d<0&&(d=r.buffer.byteLength,l===Gn?d>>=1:l===qn&&(d>>=2)),r.vertCount=d;var h=a;if(a<0){h=In;var p=r.buffer.dimension;1===p&&(h=Pn),2===p&&(h=Nn),3===p&&(h=In)}r.primType=h}function u(e){r.elementsCount--,_t(null!==e.buffer,"must not double destroy elements"),delete f[e.id],e.buffer.destroy(),e.buffer=null}function c(e,t){function o(e){if(e)if("number"==typeof e)a(e),c.primType=In,c.vertCount=0|e,c.type=Un;else{var t=null,n=Kn,r=-1,i=-1,u=0,f=0;Array.isArray(e)||Ze(e)||K(e)?t=e:(_t.type(e,"object","invalid arguments for elements"),"data"in e&&(t=e.data,_t(Array.isArray(t)||Ze(t)||K(t),"invalid data for element buffer")),"usage"in e&&(_t.parameter(e.usage,An,"invalid element buffer usage"),n=An[e.usage]),"primitive"in e&&(_t.parameter(e.primitive,Bn,"invalid element buffer primitive"),r=Bn[e.primitive]),"count"in e&&(_t("number"==typeof e.count&&e.count>=0,"invalid vertex count for elements"),i=0|e.count),"type"in e&&(_t.parameter(e.type,d,"invalid buffer type"),f=d[e.type]),"length"in e?u=0|e.length:(u=i,f===Gn||f===Vn?u*=2:f!==qn&&f!==Wn||(u*=4))),s(c,t,n,r,i,u,f)}else a(),c.primType=In,c.vertCount=0,c.type=Un;return o}var a=n.create(null,Xn,!0),c=new i(a._buffer);return r.elementsCount++,o(e),o._reglType="elements",o._elements=c,o.subdata=function(e,t){return a.subdata(e,t),o},o.destroy=function(){u(c)},o}var f={},l=0,d={uint8:Un,uint16:Gn};t.oes_element_index_uint&&(d.uint32=qn),i.prototype.bind=function(){this.buffer.bind()};var h=[];return{create:c,createStream:o,destroyStream:a,getElements:function(e){return"function"==typeof e&&e._elements instanceof i?e._elements:null},clear:function(){en(f).forEach(u)}}}function pe(e){for(var t=fn.allocType(Zn,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(e[n]===1/0)t[n]=31744;else if(e[n]===-(1/0))t[n]=64512;else{Qn[0]=e[n];var r=Jn[0],i=r>>>31<<15,o=(r<<1>>>24)-127,a=r>>13&1023;if(o<-24)t[n]=i;else if(o<-14){var s=-14-o;t[n]=i+(a+1024>>s)}else o>15?t[n]=i+31744:t[n]=i+(o+15<<10)+a}return t}function me(e){return Array.isArray(e)||Ze(e)}function ve(e){return"[object "+e+"]"}function ge(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function be(e){if(!Array.isArray(e))return!1;var t=e.length;return!(0===t||!me(e[0]))}function ye(e){return Object.prototype.toString.call(e)}function _e(e){return ye(e)===ci}function xe(e){return ye(e)===fi}function we(e){return ye(e)===li}function Ae(e){return ye(e)===di}function Ee(e){if(!e)return!1;var t=ye(e);return hi.indexOf(t)>=0||(ge(e)||be(e)||K(e))}function ke(e){return 0|Je[Object.prototype.toString.call(e)]}function Se(e,t){var n=t.length;switch(e.type){case Lr:case jr:case Rr:case zr:var r=fn.allocType(e.type,n);r.set(t),e.data=r;break;case yr:e.data=pe(t);break;default:_t.raise("unsupported texture type, must specify a typed array")}}function Me(e,t){return fn.allocType(e.type===yr?zr:e.type,t)}function Ce(e,t){e.type===yr?(e.data=pe(t),fn.freeType(t)):e.data=t}function Te(e,t,n,r,i,o){for(var a=e.width,s=e.height,u=e.channels,c=a*s*u,f=Me(e,c),l=0,d=0;d<s;++d)for(var h=0;h<a;++h)for(var p=0;p<u;++p)f[l++]=t[n*h+r*d+i*p+o];Ce(e,f)}function Oe(e,t,n,r,i,o){var a;if(a="undefined"!=typeof mi[e]?mi[e]:ui[e]*pi[t],o&&(a*=6),i){for(var s=0,u=n;u>=1;)s+=a*u*u,u/=2;return s}return a*n*r}function De(e,t,n,r,i,o,a){function s(){this.internalformat=rr,this.format=rr,this.type=Lr,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=0,this.width=0,this.height=0,this.channels=0}function u(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function c(e,r){if("object"==typeof r&&r){if("premultiplyAlpha"in r&&(_t.type(r.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=r.premultiplyAlpha),"flipY"in r&&(_t.type(r.flipY,"boolean","invalid texture flip"),e.flipY=r.flipY),"alignment"in r&&(_t.oneOf(r.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=r.alignment),"colorSpace"in r&&(_t.parameter(r.colorSpace,P,"invalid colorSpace"),e.colorSpace=P[r.colorSpace]),"type"in r){var i=r.type;_t(t.oes_texture_float||!("float"===i||"float32"===i),"you must enable the OES_texture_float extension in order to use floating point textures."),_t(t.oes_texture_half_float||!("half float"===i||"float16"===i),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),_t(t.webgl_depth_texture||!("uint16"===i||"uint32"===i||"depth stencil"===i),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),_t.parameter(i,N,"invalid texture type"),e.type=N[i]}var o=e.width,a=e.height,s=e.channels,u=!1;"shape"in r?(_t(Array.isArray(r.shape)&&r.shape.length>=2,"shape must be an array"),o=r.shape[0],a=r.shape[1],3===r.shape.length&&(s=r.shape[2],_t(s>0&&s<=4,"invalid number of channels"),u=!0),_t(o>=0&&o<=n.maxTextureSize,"invalid width"),_t(a>=0&&a<=n.maxTextureSize,"invalid height")):("radius"in r&&(o=a=r.radius,_t(o>=0&&o<=n.maxTextureSize,"invalid radius")),"width"in r&&(o=r.width,_t(o>=0&&o<=n.maxTextureSize,"invalid width")),"height"in r&&(a=r.height,_t(a>=0&&a<=n.maxTextureSize,"invalid height")),"channels"in r&&(s=r.channels,_t(s>0&&s<=4,"invalid number of channels"),u=!0)),e.width=0|o,e.height=0|a,e.channels=0|s;var c=!1;if("format"in r){var f=r.format;_t(t.webgl_depth_texture||!("depth"===f||"depth stencil"===f),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),_t.parameter(f,I,"invalid texture format");var l=e.internalformat=I[f];e.format=Q[l],f in N&&("type"in r||(e.type=N[f])),f in H&&(e.compressed=!0),c=!0}!u&&c?e.channels=ui[e.format]:u&&!c?e.channels!==si[e.format]&&(e.format=e.internalformat=si[e.channels]):c&&u&&_t(e.channels===ui[e.format],"number of channels inconsistent with specified format")}}function f(t){e.pixelStorei(ti,t.flipY),e.pixelStorei(ni,t.premultiplyAlpha),e.pixelStorei(ri,t.colorSpace),e.pixelStorei(ei,t.unpackAlignment)}function l(){s.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function d(e,t){var r=null;if(Ee(t)?r=t:t&&(_t.type(t,"object","invalid pixel data type"),c(e,t),"x"in t&&(e.xOffset=0|t.x),"y"in t&&(e.yOffset=0|t.y),Ee(t.data)&&(r=t.data)),_t(!e.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),t.copy){_t(!r,"can not specify copy and data field for the same texture");var o=i.viewportWidth,a=i.viewportHeight;e.width=e.width||o-e.xOffset,e.height=e.height||a-e.yOffset,e.needsCopy=!0,_t(e.xOffset>=0&&e.xOffset<o&&e.yOffset>=0&&e.yOffset<a&&e.width>0&&e.width<=o&&e.height>0&&e.height<=a,"copy texture read out of bounds")}else if(r){if(Ze(r))e.channels=e.channels||4,e.data=r,"type"in t||e.type!==Lr||(e.type=ke(r));else if(ge(r))e.channels=e.channels||4,Se(e,r),e.alignment=1,e.needsFree=!0;else if(K(r)){var s=r.data;Array.isArray(s)||e.type!==Lr||(e.type=ke(s));var u,f,l,d,h,p,m=r.shape,v=r.stride;3===m.length?(l=m[2],p=v[2]):(_t(2===m.length,"invalid ndarray pixel data, must be 2 or 3D"),l=1,p=1),u=m[0],f=m[1],d=v[0],h=v[1],e.alignment=1,e.width=u,e.height=f,e.channels=l,e.format=e.internalformat=si[l],e.needsFree=!0,Te(e,s,d,h,p,r.offset)}else if(_e(r)||xe(r))_e(r)?e.element=r:e.element=r.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(we(r))e.element=r,e.width=r.naturalWidth,e.height=r.naturalHeight,e.channels=4;else if(Ae(r))e.element=r,e.width=r.videoWidth,e.height=r.videoHeight,e.channels=4;else if(be(r)){var g=e.width||r[0].length,b=e.height||r.length,y=e.channels;y=me(r[0][0])?y||r[0][0].length:y||1;for(var _=ln.shape(r),x=1,w=0;w<_.length;++w)x*=_[w];var A=Me(e,x);ln.flatten(r,_,"",A),Ce(e,A),e.alignment=1,e.width=g,e.height=b,e.channels=y,e.format=e.internalformat=si[y],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===zr?_t(n.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===yr&&_t(n.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function h(t,n,i){var o=t.element,a=t.data,s=t.internalformat,u=t.format,c=t.type,l=t.width,d=t.height;f(t),o?e.texImage2D(n,i,u,u,c,o):t.compressed?e.compressedTexImage2D(n,i,s,l,d,0,a):t.needsCopy?(r(),e.copyTexImage2D(n,i,u,t.xOffset,t.yOffset,l,d,0)):e.texImage2D(n,i,u,l,d,0,u,c,a);
}function p(t,n,i,o,a){var s=t.element,u=t.data,c=t.internalformat,l=t.format,d=t.type,h=t.width,p=t.height;f(t),s?e.texSubImage2D(n,a,i,o,l,d,s):t.compressed?e.compressedTexSubImage2D(n,a,i,o,c,h,p,u):t.needsCopy?(r(),e.copyTexSubImage2D(n,a,i,o,t.xOffset,t.yOffset,h,p)):e.texSubImage2D(n,a,i,o,h,p,l,d,u)}function m(){return J.pop()||new l}function v(e){e.needsFree&&fn.freeType(e.data),l.call(e),J.push(e)}function g(){s.call(this),this.genMipmaps=!1,this.mipmapHint=Qr,this.mipmask=0,this.images=Array(16)}function b(e,t,n){var r=e.images[0]=m();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function y(e,t){var n=null;if(Ee(t))n=e.images[0]=m(),u(n,e),d(n,t),e.mipmask=1;else if(c(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,i=0;i<r.length;++i)n=e.images[i]=m(),u(n,e),n.width>>=i,n.height>>=i,d(n,r[i]),e.mipmask|=1<<i;else n=e.images[0]=m(),u(n,e),d(n,t),e.mipmask=1;u(e,e.images[0]),(e.compressed&&e.internalformat===_r||e.internalformat===xr||e.internalformat===wr||e.internalformat===Ar)&&_t(e.width%4===0&&e.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function _(e,t){for(var n=e.images,r=0;r<n.length;++r){if(!n[r])return;h(n[r],t,r)}}function x(){var e=Z.pop()||new g;s.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function w(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&v(t[n]),t[n]=null;Z.push(e)}function A(){this.minFilter=Vr,this.magFilter=Vr,this.wrapS=Nr,this.wrapT=Nr,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Qr}function E(e,t){if("min"in t){var r=t.min;_t.parameter(r,B),e.minFilter=B[r],ai.indexOf(e.minFilter)>=0&&(e.genMipmaps=!0)}if("mag"in t){var i=t.mag;_t.parameter(i,F),e.magFilter=F[i]}var o=e.wrapS,a=e.wrapT;if("wrap"in t){var s=t.wrap;"string"==typeof s?(_t.parameter(s,z),o=a=z[s]):Array.isArray(s)&&(_t.parameter(s[0],z),_t.parameter(s[1],z),o=z[s[0]],a=z[s[1]])}else{if("wrapS"in t){var u=t.wrapS;_t.parameter(u,z),o=z[u]}if("wrapT"in t){var c=t.wrapT;_t.parameter(c,z),a=z[c]}}if(e.wrapS=o,e.wrapT=a,"anisotropic"in t){var f=t.anisotropic;_t("number"==typeof f&&f>=1&&f<=n.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var l=!1;switch(typeof t.mipmap){case"string":_t.parameter(t.mipmap,R,"invalid mipmap hint"),e.mipmapHint=R[t.mipmap],e.genMipmaps=!0,l=!0;break;case"boolean":l=e.genMipmaps=t.mipmap;break;case"object":_t(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,l=!0;break;default:_t.raise("invalid mipmap type")}!l||"min"in t||(e.minFilter=Wr)}}function k(n,r){e.texParameteri(r,Ur,n.minFilter),e.texParameteri(r,Hr,n.magFilter),e.texParameteri(r,Fr,n.wrapS),e.texParameteri(r,Br,n.wrapT),t.ext_texture_filter_anisotropic&&e.texParameteri(r,$r,n.anisotropic),n.genMipmaps&&(e.hint(Kr,n.mipmapHint),e.generateMipmap(r))}function S(t){s.call(this),this.mipmask=0,this.internalformat=rr,this.id=$++,this.refCount=1,this.target=t,this.texture=e.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new A,a.profile&&(this.stats={size:0})}function M(t){e.activeTexture(oi),e.bindTexture(t.target,t.texture)}function C(){var t=ne[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(er,null)}function T(t){var n=t.texture;_t(n,"must not double destroy texture");var r=t.unit,i=t.target;r>=0&&(e.activeTexture(oi+r),e.bindTexture(i,null),ne[r]=null),e.deleteTexture(n),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete ee[t.id],o.textureCount--}function O(t,r){function i(e,t){var r=f.texInfo;A.call(r);var o=x();return"number"==typeof e?"number"==typeof t?b(o,0|e,0|t):b(o,0|e,0|e):e?(_t.type(e,"object","invalid arguments to regl.texture"),E(r,e),y(o,e)):b(o,1,1),r.genMipmaps&&(o.mipmask=(o.width<<1)-1),f.mipmask=o.mipmask,u(f,o),_t.texture2D(r,o,n),f.internalformat=o.internalformat,i.width=o.width,i.height=o.height,M(f),_(o,er),k(r,er),C(),w(o),a.profile&&(f.stats.size=Oe(f.internalformat,f.type,o.width,o.height,r.genMipmaps,!1)),i.format=G[f.internalformat],i.type=W[f.type],i.mag=q[r.magFilter],i.min=X[r.minFilter],i.wrapS=Y[r.wrapS],i.wrapT=Y[r.wrapT],i}function s(e,t,n,r){_t(!!e,"must specify image data");var o=0|t,a=0|n,s=0|r,c=m();return u(c,f),c.width=0,c.height=0,d(c,e),c.width=c.width||(f.width>>s)-o,c.height=c.height||(f.height>>s)-a,_t(f.type===c.type&&f.format===c.format&&f.internalformat===c.internalformat,"incompatible format for texture.subimage"),_t(o>=0&&a>=0&&o+c.width<=f.width&&a+c.height<=f.height,"texture.subimage write out of bounds"),_t(f.mipmask&1<<s,"missing mipmap data"),_t(c.data||c.element||c.needsCopy,"missing image data"),M(f),p(c,er,o,a,s),C(),v(c),i}function c(t,n){var r=0|t,o=0|n||r;if(r===f.width&&o===f.height)return i;i.width=f.width=r,i.height=f.height=o,M(f);for(var s=0;f.mipmask>>s;++s)e.texImage2D(er,s,f.format,r>>s,o>>s,0,f.format,f.type,null);return C(),a.profile&&(f.stats.size=Oe(f.internalformat,f.type,r,o,!1,!1)),i}var f=new S(er);return ee[f.id]=f,o.textureCount++,i(t,r),i.subimage=s,i.resize=c,i._reglType="texture2d",i._texture=f,a.profile&&(i.stats=f.stats),i.destroy=function(){f.decRef()},i}function D(t,r,i,s,f,l){function h(e,t,r,i,o,s){var f,l=O.texInfo;for(A.call(l),f=0;f<6;++f)D[f]=x();if("number"!=typeof e&&e)if("object"==typeof e)if(t)y(D[0],e),y(D[1],t),y(D[2],r),y(D[3],i),y(D[4],o),y(D[5],s);else if(E(l,e),c(O,e),"faces"in e){var d=e.faces;for(_t(Array.isArray(d)&&6===d.length,"cube faces must be a length 6 array"),f=0;f<6;++f)_t("object"==typeof d[f]&&!!d[f],"invalid input for cube map face"),u(D[f],O),y(D[f],d[f])}else for(f=0;f<6;++f)y(D[f],e);else _t.raise("invalid arguments to cube map");else{var p=0|e||1;for(f=0;f<6;++f)b(D[f],p,p)}for(u(O,D[0]),l.genMipmaps?O.mipmask=(D[0].width<<1)-1:O.mipmask=D[0].mipmask,_t.textureCube(O,l,D,n),O.internalformat=D[0].internalformat,h.width=D[0].width,h.height=D[0].height,M(O),f=0;f<6;++f)_(D[f],nr+f);for(k(l,tr),C(),a.profile&&(O.stats.size=Oe(O.internalformat,O.type,h.width,h.height,l.genMipmaps,!0)),h.format=G[O.internalformat],h.type=W[O.type],h.mag=q[l.magFilter],h.min=X[l.minFilter],h.wrapS=Y[l.wrapS],h.wrapT=Y[l.wrapT],f=0;f<6;++f)w(D[f]);return h}function g(e,t,n,r,i){_t(!!t,"must specify image data"),_t("number"==typeof e&&e===(0|e)&&e>=0&&e<6,"invalid face");var o=0|n,a=0|r,s=0|i,c=m();return u(c,O),c.width=0,c.height=0,d(c,t),c.width=c.width||(O.width>>s)-o,c.height=c.height||(O.height>>s)-a,_t(O.type===c.type&&O.format===c.format&&O.internalformat===c.internalformat,"incompatible format for texture.subimage"),_t(o>=0&&a>=0&&o+c.width<=O.width&&a+c.height<=O.height,"texture.subimage write out of bounds"),_t(O.mipmask&1<<s,"missing mipmap data"),_t(c.data||c.element||c.needsCopy,"missing image data"),M(O),p(c,nr+e,o,a,s),C(),v(c),h}function T(t){var n=0|t;if(n!==O.width){h.width=O.width=n,h.height=O.height=n,M(O);for(var r=0;r<6;++r)for(var i=0;O.mipmask>>i;++i)e.texImage2D(nr+r,i,O.format,n>>i,n>>i,0,O.format,O.type,null);return C(),a.profile&&(O.stats.size=Oe(O.internalformat,O.type,h.width,h.height,!1,!0)),h}}var O=new S(tr);ee[O.id]=O,o.cubeCount++;var D=new Array(6);return h(t,r,i,s,f,l),h.subimage=g,h.resize=T,h._reglType="textureCube",h._texture=O,a.profile&&(h.stats=O.stats),h.destroy=function(){O.decRef()},h}function L(){for(var t=0;t<te;++t)e.activeTexture(oi+t),e.bindTexture(er,null),ne[t]=null;en(ee).forEach(T),o.cubeCount=0,o.textureCount=0}function j(){en(ee).forEach(function(t){t.texture=e.createTexture(),e.bindTexture(t.target,t.texture);for(var n=0;n<32;++n)if(0!==(t.mipmask&1<<n))if(t.target===er)e.texImage2D(er,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);else for(var r=0;r<6;++r)e.texImage2D(nr+r,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);k(t.texInfo,t.target)})}var R={"don't care":Qr,"dont care":Qr,nice:Zr,fast:Jr},z={repeat:Pr,clamp:Nr,mirror:Ir},F={nearest:Vr,linear:Gr},B=$e({mipmap:Yr,"nearest mipmap nearest":Wr,"linear mipmap nearest":qr,"nearest mipmap linear":Xr,"linear mipmap linear":Yr},F),P={none:0,browser:ii},N={uint8:Lr,rgba4:lr,rgb565:hr,"rgb5 a1":dr},I={alpha:ir,luminance:ar,"luminance alpha":sr,rgb:or,rgba:rr,rgba4:ur,"rgb5 a1":cr,rgb565:fr},H={};t.ext_srgb&&(I.srgb=gr,I.srgba=br),t.oes_texture_float&&(N.float32=N.float=zr),t.oes_texture_half_float&&(N.float16=N["half float"]=yr),t.webgl_depth_texture&&($e(I,{depth:mr,"depth stencil":vr}),$e(N,{uint16:jr,uint32:Rr,"depth stencil":pr})),t.webgl_compressed_texture_s3tc&&$e(H,{"rgb s3tc dxt1":_r,"rgba s3tc dxt1":xr,"rgba s3tc dxt3":wr,"rgba s3tc dxt5":Ar}),t.webgl_compressed_texture_atc&&$e(H,{"rgb atc":Er,"rgba atc explicit alpha":kr,"rgba atc interpolated alpha":Sr}),t.webgl_compressed_texture_pvrtc&&$e(H,{"rgb pvrtc 4bppv1":Mr,"rgb pvrtc 2bppv1":Cr,"rgba pvrtc 4bppv1":Tr,"rgba pvrtc 2bppv1":Or}),t.webgl_compressed_texture_etc1&&(H["rgb etc1"]=Dr);var U=Array.prototype.slice.call(e.getParameter($n));Object.keys(H).forEach(function(e){var t=H[e];U.indexOf(t)>=0&&(I[e]=t)});var V=Object.keys(I);n.textureFormats=V;var G=[];Object.keys(I).forEach(function(e){var t=I[e];G[t]=e});var W=[];Object.keys(N).forEach(function(e){var t=N[e];W[t]=e});var q=[];Object.keys(F).forEach(function(e){var t=F[e];q[t]=e});var X=[];Object.keys(B).forEach(function(e){var t=B[e];X[t]=e});var Y=[];Object.keys(z).forEach(function(e){var t=z[e];Y[t]=e});var Q=V.reduce(function(e,t){var n=I[t];return n===ar||n===ir||n===ar||n===sr||n===mr||n===vr?e[n]=n:n===cr||t.indexOf("rgba")>=0?e[n]=rr:e[n]=or,e},{}),J=[],Z=[],$=0,ee={},te=n.maxTextureUnits,ne=Array(te).map(function(){return null});return $e(S.prototype,{bind:function(){var t=this;t.bindCount+=1;var n=t.unit;if(n<0){for(var r=0;r<te;++r){var i=ne[r];if(i){if(i.bindCount>0)continue;i.unit=-1}ne[r]=t,n=r;break}n>=te&&_t.raise("insufficient number of texture units"),a.profile&&o.maxTextureUnits<n+1&&(o.maxTextureUnits=n+1),t.unit=n,e.activeTexture(oi+n),e.bindTexture(t.target,t.texture)}return n},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&T(this)}}),a.profile&&(o.getTotalTextureSize=function(){var e=0;return Object.keys(ee).forEach(function(t){e+=ee[t].stats.size}),e}),{create2D:O,createCube:D,clear:L,getTexture:function(e){return null},restore:j}}function Le(e,t,n){return Mi[e]*t*n}function je(e,t,n,r,i,o){function a(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=0,i=0;t?(r=t.width,i=t.height):n&&(r=n.width,i=n.height),this.width=r,this.height=i}function s(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function u(e,t,n){if(e)if(e.texture){var r=e.texture._texture,i=Math.max(1,r.width),o=Math.max(1,r.height);_t(i===t&&o===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var a=e.renderbuffer._renderbuffer;_t(a.width===t&&a.height===n,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function c(t,n){n&&(n.texture?e.framebufferTexture2D(Ti,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(Ti,t,Oi,n.renderbuffer._renderbuffer.renderbuffer))}function f(e){var t=Di,n=null,r=null,i=e;"object"==typeof e&&(i=e.data,"target"in e&&(t=0|e.target)),_t.type(i,"function","invalid attachment data");var o=i._reglType;return"texture2d"===o?(n=i,_t(t===Di)):"textureCube"===o?(n=i,_t(t>=Li&&t<Li+6,"invalid cube map target")):"renderbuffer"===o?(r=i,t=Oi):_t.raise("invalid regl object for attachment"),new a(t,n,r)}function l(e,t,n,o,s){if(n){var u=r.create2D({width:e,height:t,format:o,type:s});return u._texture.refCount=0,new a(Di,u,null)}var c=i.create({width:e,height:t,format:o});return c._renderbuffer.refCount=0,new a(Oi,null,c)}function d(e){return e&&(e.texture||e.renderbuffer)}function h(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n))}function p(){this.id=k++,S[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function m(e){e.colorAttachments.forEach(s),s(e.depthAttachment),s(e.stencilAttachment),s(e.depthStencilAttachment)}function v(t){var n=t.framebuffer;_t(n,"must not double destroy framebuffer"),e.deleteFramebuffer(n),t.framebuffer=null,o.framebufferCount--,delete S[t.id]}function g(t){var r;e.bindFramebuffer(Ti,t.framebuffer);var i=t.colorAttachments;for(r=0;r<i.length;++r)c(ji+r,i[r]);for(r=i.length;r<n.maxColorAttachments;++r)e.framebufferTexture2D(Ti,ji+r,Di,null,0);e.framebufferTexture2D(Ti,Fi,Di,null,0),e.framebufferTexture2D(Ti,Ri,Di,null,0),e.framebufferTexture2D(Ti,zi,Di,null,0),c(Ri,t.depthAttachment),c(zi,t.stencilAttachment),c(Fi,t.depthStencilAttachment);var o=e.checkFramebufferStatus(Ti);o!==Bi&&_t.raise("framebuffer configuration not supported, status = "+so[o]),e.bindFramebuffer(Ti,x.next),x.cur=x.next,e.getError()}function b(e,r){function i(e,r){var o;_t(x.next!==s,"can not update framebuffer which is currently in use");var a=t.webgl_draw_buffers,c=0,h=0,p=!0,v=!0,b=null,y=!0,_="rgba",k="uint8",S=1,M=null,C=null,T=null,O=!1;if("number"==typeof e)c=0|e,h=0|r||c;else if(e){_t.type(e,"object","invalid arguments for framebuffer");var D=e;if("shape"in D){var L=D.shape;_t(Array.isArray(L)&&L.length>=2,"invalid shape for framebuffer"),c=L[0],h=L[1]}else"radius"in D&&(c=h=D.radius),"width"in D&&(c=D.width),"height"in D&&(h=D.height);("color"in D||"colors"in D)&&(b=D.color||D.colors,Array.isArray(b)&&_t(1===b.length||a,"multiple render targets not supported")),b||("colorCount"in D&&(S=0|D.colorCount,_t(S>0,"invalid color buffer count")),"colorTexture"in D&&(y=!!D.colorTexture,_="rgba4"),"colorType"in D&&(k=D.colorType,y?(_t(t.oes_texture_float||!("float"===k||"float32"===k),"you must enable OES_texture_float in order to use floating point framebuffer objects"),_t(t.oes_texture_half_float||!("half float"===k||"float16"===k),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===k||"float16"===k?(_t(t.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),_="rgba16f"):"float"!==k&&"float32"!==k||(_t(t.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),_="rgba32f"),_t.oneOf(k,E,"invalid color type")),"colorFormat"in D&&(_=D.colorFormat,w.indexOf(_)>=0?y=!0:A.indexOf(_)>=0?y=!1:y?_t.oneOf(D.colorFormat,w,"invalid color format for texture"):_t.oneOf(D.colorFormat,A,"invalid color format for renderbuffer"))),("depthTexture"in D||"depthStencilTexture"in D)&&(O=!(!D.depthTexture&&!D.depthStencilTexture),_t(!O||t.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in D&&("boolean"==typeof D.depth?p=D.depth:(M=D.depth,v=!1)),"stencil"in D&&("boolean"==typeof D.stencil?v=D.stencil:(C=D.stencil,p=!1)),"depthStencil"in D&&("boolean"==typeof D.depthStencil?p=v=D.depthStencil:(T=D.depthStencil,p=!1,v=!1))}else c=h=1;var j=null,R=null,z=null,F=null;if(Array.isArray(b))j=b.map(f);else if(b)j=[f(b)];else for(j=new Array(S),o=0;o<S;++o)j[o]=l(c,h,y,_,k);_t(t.webgl_draw_buffers||j.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),_t(j.length<=n.maxColorAttachments,"too many color attachments, not supported"),c=c||j[0].width,h=h||j[0].height,M?R=f(M):p&&!v&&(R=l(c,h,O,"depth","uint32")),C?z=f(C):v&&!p&&(z=l(c,h,!1,"stencil","uint8")),T?F=f(T):!M&&!C&&v&&p&&(F=l(c,h,O,"depth stencil","depth stencil")),_t(!!M+!!C+!!T<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var B=null;for(o=0;o<j.length;++o)if(u(j[o],c,h),_t(!j[o]||j[o].texture&&Xi.indexOf(j[o].texture._texture.format)>=0||j[o].renderbuffer&&ao.indexOf(j[o].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+o+" is invalid"),j[o]&&j[o].texture){var P=Yi[j[o].texture._texture.format]*Ki[j[o].texture._texture.type];null===B?B=P:_t(B===P,"all color attachments much have the same number of bits per pixel.")}return u(R,c,h),_t(!R||R.texture&&R.texture._texture.format===qi||R.renderbuffer&&R.renderbuffer._renderbuffer.format===$i,"invalid depth attachment for framebuffer object"),u(z,c,h),_t(!z||z.renderbuffer&&z.renderbuffer._renderbuffer.format===eo,"invalid stencil attachment for framebuffer object"),u(F,c,h),_t(!F||F.texture&&F.texture._texture.format===to||F.renderbuffer&&F.renderbuffer._renderbuffer.format===to,"invalid depth-stencil attachment for framebuffer object"),m(s),s.width=c,s.height=h,s.colorAttachments=j,s.depthAttachment=R,s.stencilAttachment=z,s.depthStencilAttachment=F,i.color=j.map(d),i.depth=d(R),i.stencil=d(z),i.depthStencil=d(F),i.width=s.width,i.height=s.height,g(s),i}function a(e,t){_t(x.next!==s,"can not resize a framebuffer which is currently in use");var n=0|e,r=0|t||n;if(n===s.width&&r===s.height)return i;for(var o=s.colorAttachments,a=0;a<o.length;++a)h(o[a],n,r);return h(s.depthAttachment,n,r),h(s.stencilAttachment,n,r),h(s.depthStencilAttachment,n,r),s.width=i.width=n,s.height=i.height=r,g(s),i}var s=new p;return o.framebufferCount++,i(e,r),$e(i,{resize:a,_reglType:"framebuffer",_framebuffer:s,destroy:function(){v(s),m(s)},use:function(e){x.setFBO({framebuffer:i},e)}})}function y(e){function i(e){var n;_t(a.indexOf(x.next)<0,"can not update framebuffer which is currently in use");var o=t.webgl_draw_buffers,s={color:null},u=0,c=null,f="rgba",l="uint8",d=1;if("number"==typeof e)u=0|e;else if(e){_t.type(e,"object","invalid arguments for framebuffer");var h=e;if("shape"in h){var p=h.shape;_t(Array.isArray(p)&&p.length>=2,"invalid shape for framebuffer"),_t(p[0]===p[1],"cube framebuffer must be square"),u=p[0]}else"radius"in h&&(u=0|h.radius),"width"in h?(u=0|h.width,"height"in h&&_t(h.height===u,"must be square")):"height"in h&&(u=0|h.height);("color"in h||"colors"in h)&&(c=h.color||h.colors,Array.isArray(c)&&_t(1===c.length||o,"multiple render targets not supported")),c||("colorCount"in h&&(d=0|h.colorCount,_t(d>0,"invalid color buffer count")),"colorType"in h&&(_t.oneOf(h.colorType,E,"invalid color type"),l=h.colorType),"colorFormat"in h&&(f=h.colorFormat,_t.oneOf(h.colorFormat,w,"invalid color format for texture"))),"depth"in h&&(s.depth=h.depth),"stencil"in h&&(s.stencil=h.stencil),"depthStencil"in h&&(s.depthStencil=h.depthStencil)}else u=1;var m;if(c)if(Array.isArray(c))for(m=[],n=0;n<c.length;++n)m[n]=c[n];else m=[c];else{m=Array(d);var v={radius:u,format:f,type:l};for(n=0;n<d;++n)m[n]=r.createCube(v)}for(s.color=Array(m.length),n=0;n<m.length;++n){var g=m[n];_t("function"==typeof g&&"textureCube"===g._reglType,"invalid cube map"),u=u||g.width,_t(g.width===u&&g.height===u,"invalid cube map shape"),s.color[n]={target:Li,data:m[n]}}for(n=0;n<6;++n){for(var y=0;y<m.length;++y)s.color[y].target=Li+n;n>0&&(s.depth=a[0].depth,s.stencil=a[0].stencil,s.depthStencil=a[0].depthStencil),a[n]?a[n](s):a[n]=b(s)}return $e(i,{width:u,height:u,color:m})}function o(e){var t,r=0|e;if(_t(r>0&&r<=n.maxCubeMapSize,"invalid radius for cube fbo"),r===i.width)return i;var o=i.color;for(t=0;t<o.length;++t)o[t].resize(r);for(t=0;t<6;++t)a[t].resize(r);return i.width=i.height=r,i}var a=Array(6);return i(e),$e(i,{faces:a,resize:o,_reglType:"framebufferCube",destroy:function(){a.forEach(function(e){e.destroy()})}})}function _(){en(S).forEach(function(t){t.framebuffer=e.createFramebuffer(),g(t)})}var x={cur:null,next:null,dirty:!1,setFBO:null},w=["rgba"],A=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&A.push("srgba"),t.ext_color_buffer_half_float&&A.push("rgba16f","rgb16f"),t.webgl_color_buffer_float&&A.push("rgba32f");var E=["uint8"];t.oes_texture_half_float&&E.push("half float","float16"),t.oes_texture_float&&E.push("float","float32");var k=0,S={};return $e(x,{getFramebuffer:function(e){if("function"==typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof p)return t}return null},create:b,createCube:y,clear:function(){en(S).forEach(v)},restore:_})}function Re(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=uo,this.offset=0,this.stride=0,this.divisor=0}function ze(e,t,n,r,i){for(var o=n.maxAttributes,a=new Array(o),s=0;s<o;++s)a[s]=new Re;return{Record:Re,scope:{},state:a}}function Fe(e,t,n,r){function i(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function o(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function a(n,r,i){var o=n===co?f:l,a=o[r];if(!a){var s=t.str(r);a=e.createShader(n),e.shaderSource(a,s),e.compileShader(a),_t.shaderError(e,a,s,n,i),o[r]=a}return a}function s(e,t){this.id=p++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function u(n,s){var u,c,f=a(co,n.fragId),l=a(fo,n.vertId),d=n.program=e.createProgram();e.attachShader(d,f),e.attachShader(d,l),e.linkProgram(d),_t.linkError(e,d,t.str(n.fragId),t.str(n.vertId),s);var h=e.getProgramParameter(d,lo);r.profile&&(n.stats.uniformsCount=h);var p=n.uniforms;for(u=0;u<h;++u)if(c=e.getActiveUniform(d,u))if(c.size>1)for(var m=0;m<c.size;++m){var v=c.name.replace("[0]","["+m+"]");o(p,new i(v,t.id(v),e.getUniformLocation(d,v),c))}else o(p,new i(c.name,t.id(c.name),e.getUniformLocation(d,c.name),c));var g=e.getProgramParameter(d,ho);r.profile&&(n.stats.attributesCount=g);var b=n.attributes;for(u=0;u<g;++u)c=e.getActiveAttrib(d,u),c&&o(b,new i(c.name,t.id(c.name),e.getAttribLocation(d,c.name),c))}function c(){f={},l={};for(var e=0;e<h.length;++e)u(h[e])}var f={},l={},d={},h=[],p=0;return r.profile&&(n.getMaxUniformsCount=function(){var e=0;return h.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},n.getMaxAttributesCount=function(){var e=0;return h.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var t=e.deleteShader.bind(e);en(f).forEach(t),f={},en(l).forEach(t),l={},h.forEach(function(t){e.deleteProgram(t.program)}),h.length=0,d={},n.shaderCount=0},program:function(e,t,r){_t.command(e>=0,"missing vertex shader",r),_t.command(t>=0,"missing fragment shader",r);var i=d[t];i||(i=d[t]={});var o=i[e];return o||(o=new s(t,e),n.shaderCount++,u(o,r),i[e]=o,h.push(o)),o},restore:c,shader:a,frag:-1,vert:-1}}function Be(e,t,n,r,i,o){function a(a){var s;null===t.next?(_t(i.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),s=mo):(_t(null!==t.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),s=t.next.colorAttachments[0].texture._texture.type,o.oes_texture_float?_t(s===mo||s===go,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"):_t(s===mo,"Reading from a framebuffer is only allowed for the type 'uint8'"));var u=0,c=0,f=r.framebufferWidth,l=r.framebufferHeight,d=null;Ze(a)?d=a:a&&(_t.type(a,"object","invalid arguments to regl.read()"),u=0|a.x,c=0|a.y,_t(u>=0&&u<r.framebufferWidth,"invalid x offset for regl.read"),_t(c>=0&&c<r.framebufferHeight,"invalid y offset for regl.read"),f=0|(a.width||r.framebufferWidth-u),l=0|(a.height||r.framebufferHeight-c),d=a.data||null),d&&(s===mo?_t(d instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):s===go&&_t(d instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),_t(f>0&&f+u<=r.framebufferWidth,"invalid width for read pixels"),_t(l>0&&l+c<=r.framebufferHeight,"invalid height for read pixels"),n();var h=f*l*4;return d||(s===mo?d=new Uint8Array(h):s===go&&(d=d||new Float32Array(h))),_t.isTypedArray(d,"data buffer for regl.read() must be a typedarray"),_t(d.byteLength>=h,"data buffer for regl.read() too small"),e.pixelStorei(vo,4),e.readPixels(u,c,f,l,po,s,d),d}function s(e){var n;return t.setFBO({framebuffer:e.framebuffer},function(){n=a(e)}),n}function u(e){return e&&"framebuffer"in e?s(e):a(e)}return u}function Pe(e){return Array.prototype.slice.call(e)}function Ne(e){return Pe(e).join("")}function Ie(){function e(e){for(var t=0;t<u.length;++t)if(u[t]===e)return s[t];var n="g"+a++;return s.push(n),u.push(e),n}function t(){function e(){n.push.apply(n,Pe(arguments))}function t(){var e="v"+a++;return r.push(e),arguments.length>0&&(n.push(e,"="),n.push.apply(n,Pe(arguments)),n.push(";")),e}var n=[],r=[];return $e(e,{def:t,toString:function(){return Ne([r.length>0?"var "+r+";":"",Ne(n)])}})}function n(){function e(e,t){r(e,t,"=",n.def(e,t),";")}var n=t(),r=t(),i=n.toString,o=r.toString;return $e(function(){n.apply(n,Pe(arguments))},{def:n.def,entry:n,exit:r,save:e,set:function(t,r,i){e(t,r),n(t,r,"=",i,";")},toString:function(){return i()+o()}})}function r(){var e=Ne(arguments),t=n(),r=n(),i=t.toString,o=r.toString;return $e(t,{then:function(){return t.apply(t,Pe(arguments)),this},else:function(){return r.apply(r,Pe(arguments)),this},toString:function(){var t=o();return t&&(t="else{"+t+"}"),Ne(["if(",e,"){",i(),"}",t])}})}function i(e,t){function r(){var e="a"+i.length;return i.push(e),e}var i=[];t=t||0;for(var o=0;o<t;++o)r();var a=n(),s=a.toString,u=f[e]=$e(a,{arg:r,toString:function(){return Ne(["function(",i.join(),"){",s(),"}"])}});return u}function o(){var e=['"use strict";',c,"return {"];Object.keys(f).forEach(function(t){e.push('"',t,'":',f[t].toString(),",")}),e.push("}");var t=Ne(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n"),n=Function.apply(null,s.concat(t));return n.apply(null,u)}var a=0,s=[],u=[],c=t(),f={};return{global:c,link:e,block:t,proc:i,scope:n,cond:r,compile:o}}function He(e){return Array.isArray(e)||Ze(e)||K(e)}function Ue(e){return e.sort(function(e,t){return e===$o?-1:t===$o?1:e<t?-1:1})}function Ve(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function Ge(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function We(e){return new Ve(!1,!1,!1,e)}function qe(e,t){var n=e.type;if(n===wo){var r=e.data.length;return new Ve(!0,r>=1,r>=2,t)}if(n===So){var i=e.data;return new Ve(i.thisDep,i.contextDep,i.propDep,t)}return new Ve(n===ko,n===Eo,n===Ao,t)}function Xe(e,t,n,r,i,o,a,s,u,c,f,l,d,h,p){function m(e){return e.replace(".","_")}function v(e,t,n){var r=m(e);te.push(e),ee[r]=$[r]=!!n,ne[r]=t}function g(e,t,n){var r=m(e);te.push(e),Array.isArray(n)?($[r]=n.slice(),ee[r]=n.slice()):$[r]=ee[r]=n,re[r]=t}function b(){var e=Ie(),n=e.link,r=e.global;e.id=ae++,e.batchId="0";var i=n(ie),o=e.shared={props:"a0"};Object.keys(ie).forEach(function(e){o[e]=r.def(i,".",e)}),_t.optional(function(){e.CHECK=n(_t),e.commandStr=_t.guessCommand(),e.command=n(e.commandStr),e.assert=function(e,t,r){e("if(!(",t,"))",this.CHECK,".commandRaise(",n(r),",",this.command,");")},oe.invalidBlendCombinations=hs});var a=e.next={},s=e.current={};Object.keys(re).forEach(function(e){Array.isArray($[e])&&(a[e]=r.def(o.next,".",e),s[e]=r.def(o.current,".",e))});var u=e.constants={};Object.keys(oe).forEach(function(e){u[e]=r.def(JSON.stringify(oe[e]))}),e.invoke=function(t,r){switch(r.type){case wo:var i=["this",o.context,o.props,e.batchId];return t.def(n(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case Ao:return t.def(o.props,r.data);case Eo:return t.def(o.context,r.data);case ko:return t.def("this",r.data);case So:return r.data.append(e,t),r.data.ref}},e.attribCache={};var f={};return e.scopeAttrib=function(e){var r=t.id(e);if(r in f)return f[r];var i=c.scope[r];i||(i=c.scope[r]=new Y);var o=f[r]=n(i);return o},e}function y(e){var t,n=e.static,r=e.dynamic;if(ea in n){var i=!!n[ea];t=We(function(e,t){return i}),t.enable=i}else if(ea in r){var o=r[ea];t=qe(o,function(e,t){return e.invoke(t,o)})}return t}function _(e,t){var n=e.static,r=e.dynamic;if(ta in n){var i=n[ta];return i?(i=s.getFramebuffer(i),_t.command(i,"invalid framebuffer object"),We(function(e,t){var n=e.link(i),r=e.shared;t.set(r.framebuffer,".next",n);var o=r.context;return t.set(o,"."+la,n+".width"),t.set(o,"."+da,n+".height"),n})):We(function(e,t){var n=e.shared;t.set(n.framebuffer,".next","null");var r=n.context;return t.set(r,"."+la,r+"."+va),t.set(r,"."+da,r+"."+ga),"null"})}if(ta in r){var o=r[ta];return qe(o,function(e,t){var n=e.invoke(t,o),r=e.shared,i=r.framebuffer,a=t.def(i,".getFramebuffer(",n,")");_t.optional(function(){e.assert(t,"!"+n+"||"+a,"invalid framebuffer object")}),t.set(i,".next",a);var s=r.context;return t.set(s,"."+la,a+"?"+a+".width:"+s+"."+va),t.set(s,"."+da,a+"?"+a+".height:"+s+"."+ga),a})}return null}function x(e,t,n){function r(e){if(e in i){var r=i[e];_t.commandType(r,"object","invalid "+e,n.commandStr);var a,s,u=!0,c=0|r.x,f=0|r.y;return"width"in r?(a=0|r.width,_t.command(a>=0,"invalid "+e,n.commandStr)):u=!1,"height"in r?(s=0|r.height,_t.command(s>=0,"invalid "+e,n.commandStr)):u=!1,new Ve(!u&&t&&t.thisDep,!u&&t&&t.contextDep,!u&&t&&t.propDep,function(e,t){var n=e.shared.context,i=a;"width"in r||(i=t.def(n,".",la,"-",c));var o=s;return"height"in r||(o=t.def(n,".",da,"-",f)),[c,f,i,o]})}if(e in o){var l=o[e],d=qe(l,function(t,n){var r=t.invoke(n,l);_t.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)});var i=t.shared.context,o=n.def(r,".x|0"),a=n.def(r,".y|0"),s=n.def('"width" in ',r,"?",r,".width|0:","(",i,".",la,"-",o,")"),u=n.def('"height" in ',r,"?",r,".height|0:","(",i,".",da,"-",a,")");return _t.optional(function(){t.assert(n,s+">=0&&"+u+">=0","invalid "+e)}),[o,a,s,u]});return t&&(d.thisDep=d.thisDep||t.thisDep,d.contextDep=d.contextDep||t.contextDep,d.propDep=d.propDep||t.propDep),d}return t?new Ve(t.thisDep,t.contextDep,t.propDep,function(e,t){var n=e.shared.context;return[0,0,t.def(n,".",la),t.def(n,".",da)]}):null}var i=e.static,o=e.dynamic,a=r($o);if(a){var s=a;a=new Ve(a.thisDep,a.contextDep,a.propDep,function(e,t){var n=s.append(e,t),r=e.shared.context;return t.set(r,"."+ha,n[2]),t.set(r,"."+pa,n[3]),n})}return{viewport:a,scissor_box:r(Zo)}}function w(e){function n(e){if(e in i){var n=t.id(i[e]);_t.optional(function(){f.shader(vs[e],n,_t.guessCommand())});var r=We(function(){return n});return r.id=n,r}if(e in o){var a=o[e];return qe(a,function(t,n){var r=t.invoke(n,a),i=n.def(t.shared.strings,".id(",r,")");return _t.optional(function(){n(t.shared.shader,".shader(",vs[e],",",i,",",t.command,");")}),i})}return null}var r,i=e.static,o=e.dynamic,a=n(ra),s=n(na),u=null;return Ge(a)&&Ge(s)?(u=f.program(s.id,a.id),r=We(function(e,t){return e.link(u)})):r=new Ve(a&&a.thisDep||s&&s.thisDep,a&&a.contextDep||s&&s.contextDep,a&&a.propDep||s&&s.propDep,function(e,t){var n,r=e.shared.shader;n=a?a.append(e,t):t.def(r,".",ra);var i;i=s?s.append(e,t):t.def(r,".",na);var o=r+".program("+i+","+n;return _t.optional(function(){o+=","+e.command}),t.def(o+")")}),{frag:a,vert:s,progVar:r,program:u}}function A(e,t){function n(){if(ia in s){var e=s[ia];He(e)?e=o.getElements(o.create(e,!0)):e&&(e=o.getElements(e),_t.command(e,"invalid elements",t.commandStr));var n=We(function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r,r}return t.ELEMENTS=null,null});return n.value=e,n}if(ia in u){var r=u[ia];return qe(r,function(e,t){var n=e.shared,i=n.isBufferArgs,o=n.elements,a=e.invoke(t,r),s=t.def("null"),u=t.def(i,"(",a,")"),c=e.cond(u).then(s,"=",o,".createStream(",a,");").else(s,"=",o,".getElements(",a,");");return _t.optional(function(){e.assert(c.else,"!"+a+"||"+s,"invalid elements")}),t.entry(c),t.exit(e.cond(u).then(o,".destroyStream(",s,");")),e.ELEMENTS=s,s})}return null}function r(){if(oa in s){var e=s[oa];return _t.commandParameter(e,Bn,"invalid primitve",t.commandStr),We(function(t,n){return Bn[e]})}if(oa in u){var n=u[oa];return qe(n,function(e,t){var r=e.constants.primTypes,i=e.invoke(t,n);return _t.optional(function(){e.assert(t,i+" in "+r,"invalid primitive, must be one of "+Object.keys(Bn))}),t.def(r,"[",i,"]")})}return c?Ge(c)?We(c.value?function(e,t){return t.def(e.ELEMENTS,".primType")}:function(){return Ja}):new Ve(c.thisDep,c.contextDep,c.propDep,function(e,t){
var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",Ja)}):null}function i(e,n){if(e in s){var r=0|s[e];return _t.command(!n||r>=0,"invalid "+e,t.commandStr),We(function(e,t){return n&&(e.OFFSET=r),r})}if(e in u){var i=u[e];return qe(i,function(t,r){var o=t.invoke(r,i);return n&&(t.OFFSET=o,_t.optional(function(){t.assert(r,o+">=0","invalid "+e)})),o})}return n&&c?We(function(e,t){return e.OFFSET="0",0}):null}function a(){if(aa in s){var e=0|s[aa];return _t.command("number"==typeof e&&e>=0,"invalid vertex count",t.commandStr),We(function(){return e})}if(aa in u){var n=u[aa];return qe(n,function(e,t){var r=e.invoke(t,n);return _t.optional(function(){e.assert(t,"typeof "+r+'==="number"&&'+r+">=0&&"+r+"===("+r+"|0)","invalid vertex count")}),r})}if(c){if(Ge(c)){if(c)return f?new Ve(f.thisDep,f.contextDep,f.propDep,function(e,t){var n=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return _t.optional(function(){e.assert(t,n+">=0","invalid vertex offset/element buffer too small")}),n}):We(function(e,t){return t.def(e.ELEMENTS,".vertCount")});var r=We(function(){return-1});return _t.optional(function(){r.MISSING=!0}),r}var i=new Ve(c.thisDep||f.thisDep,c.contextDep||f.contextDep,c.propDep||f.propDep,function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")});return _t.optional(function(){i.DYNAMIC=!0}),i}return null}var s=e.static,u=e.dynamic,c=n(),f=i(sa,!0);return{elements:c,primitive:r(),count:a(),instances:i(ua,!1),offset:f}}function E(e,t){var n=e.static,i=e.dynamic,o={};return te.forEach(function(e){function a(t,r){if(e in n){var a=t(n[e]);o[s]=We(function(){return a})}else if(e in i){var u=i[e];o[s]=qe(u,function(e,t){return r(e,t,e.invoke(t,u))})}}var s=m(e);switch(e){case Bo:case Co:case Mo:case qo:case Lo:case Jo:case Ho:case Vo:case Go:case zo:return a(function(n){return _t.commandType(n,"boolean",e,t.commandStr),n},function(t,n,r){return _t.optional(function(){t.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+e,t.commandStr)}),r});case jo:return a(function(n){return _t.commandParameter(n,ps,"invalid "+e,t.commandStr),ps[n]},function(t,n,r){var i=t.constants.compareFuncs;return _t.optional(function(){t.assert(n,r+" in "+i,"invalid "+e+", must be one of "+Object.keys(ps))}),n.def(i,"[",r,"]")});case Ro:return a(function(e){return _t.command(me(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<=e[1],"depth range is 2d array",t.commandStr),e},function(e,t,n){_t.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")});var r=t.def("+",n,"[0]"),i=t.def("+",n,"[1]");return[r,i]});case Do:return a(function(e){_t.commandType(e,"object","blend.func",t.commandStr);var n="srcRGB"in e?e.srcRGB:e.src,r="srcAlpha"in e?e.srcAlpha:e.src,i="dstRGB"in e?e.dstRGB:e.dst,o="dstAlpha"in e?e.dstAlpha:e.dst;return _t.commandParameter(n,ds,s+".srcRGB",t.commandStr),_t.commandParameter(r,ds,s+".srcAlpha",t.commandStr),_t.commandParameter(i,ds,s+".dstRGB",t.commandStr),_t.commandParameter(o,ds,s+".dstAlpha",t.commandStr),_t.command(hs.indexOf(n+", "+i)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+i+")",t.commandStr),[ds[n],ds[i],ds[r],ds[o]]},function(t,n,r){function i(i,a){var s=n.def('"',i,a,'" in ',r,"?",r,".",i,a,":",r,".",i);return _t.optional(function(){t.assert(n,s+" in "+o,"invalid "+e+"."+i+a+", must be one of "+Object.keys(ds))}),s}var o=t.constants.blendFuncs;_t.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")});var a=i("src","RGB"),s=i("dst","RGB");_t.optional(function(){var e=t.constants.invalidBlendCombinations;t.assert(n,e+".indexOf("+a+'+", "+'+s+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var u=n.def(o,"[",a,"]"),c=n.def(o,"[",i("src","Alpha"),"]"),f=n.def(o,"[",s,"]"),l=n.def(o,"[",i("dst","Alpha"),"]");return[u,f,c,l]});case Oo:return a(function(n){return"string"==typeof n?(_t.commandParameter(n,K,"invalid "+e,t.commandStr),[K[n],K[n]]):"object"==typeof n?(_t.commandParameter(n.rgb,K,e+".rgb",t.commandStr),_t.commandParameter(n.alpha,K,e+".alpha",t.commandStr),[K[n.rgb],K[n.alpha]]):void _t.commandRaise("invalid blend.equation",t.commandStr)},function(t,n,r){var i=t.constants.blendEquations,o=n.def(),a=n.def(),s=t.cond("typeof ",r,'==="string"');return _t.optional(function(){function n(e,n,r){t.assert(e,r+" in "+i,"invalid "+n+", must be one of "+Object.keys(K))}n(s.then,e,r),t.assert(s.else,r+"&&typeof "+r+'==="object"',"invalid "+e),n(s.else,e+".rgb",r+".rgb"),n(s.else,e+".alpha",r+".alpha")}),s.then(o,"=",a,"=",i,"[",r,"];"),s.else(o,"=",i,"[",r,".rgb];",a,"=",i,"[",r,".alpha];"),n(s),[o,a]});case To:return a(function(e){return _t.command(me(e)&&4===e.length,"blend.color must be a 4d array",t.commandStr),Q(4,function(t){return+e[t]})},function(e,t,n){return _t.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")}),Q(4,function(e){return t.def("+",n,"[",e,"]")})});case Xo:return a(function(e){return _t.commandType(e,"number",s,t.commandStr),0|e},function(e,t,n){return _t.optional(function(){e.assert(t,"typeof "+n+'==="number"',"invalid stencil.mask")}),t.def(n,"|0")});case Yo:return a(function(n){_t.commandType(n,"object",s,t.commandStr);var r=n.cmp||"keep",i=n.ref||0,o="mask"in n?n.mask:-1;return _t.commandParameter(r,ps,e+".cmp",t.commandStr),_t.commandType(i,"number",e+".ref",t.commandStr),_t.commandType(o,"number",e+".mask",t.commandStr),[ps[r],i,o]},function(e,t,n){var r=e.constants.compareFuncs;_t.optional(function(){function i(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}i(n+"&&typeof ",n,'==="object"'),i('!("cmp" in ',n,")||(",n,".cmp in ",r,")")});var i=t.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",os),o=t.def(n,".ref|0"),a=t.def('"mask" in ',n,"?",n,".mask|0:-1");return[i,o,a]});case Ko:case Qo:return a(function(n){_t.commandType(n,"object",s,t.commandStr);var r=n.fail||"keep",i=n.zfail||"keep",o=n.zpass||"keep";return _t.commandParameter(r,ms,e+".fail",t.commandStr),_t.commandParameter(i,ms,e+".zfail",t.commandStr),_t.commandParameter(o,ms,e+".zpass",t.commandStr),[e===Qo?$a:Za,ms[r],ms[i],ms[o]]},function(t,n,r){function i(i){return _t.optional(function(){t.assert(n,'!("'+i+'" in '+r+")||("+r+"."+i+" in "+o+")","invalid "+e+"."+i+", must be one of "+Object.keys(ms))}),n.def('"',i,'" in ',r,"?",o,"[",r,".",i,"]:",os)}var o=t.constants.stencilOps;return _t.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)}),[e===Qo?$a:Za,i("fail"),i("zfail"),i("zpass")]});case Uo:return a(function(e){_t.commandType(e,"object",s,t.commandStr);var n=0|e.factor,r=0|e.units;return _t.commandType(n,"number",s+".factor",t.commandStr),_t.commandType(r,"number",s+".units",t.commandStr),[n,r]},function(t,n,r){_t.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)});var i=n.def(r,".factor|0"),o=n.def(r,".units|0");return[i,o]});case Po:return a(function(e){var n=0;return"front"===e?n=Za:"back"===e&&(n=$a),_t.command(!!n,s,t.commandStr),n},function(e,t,n){return _t.optional(function(){e.assert(t,n+'==="front"||'+n+'==="back"',"invalid cull.face")}),t.def(n,'==="front"?',Za,":",$a)});case Io:return a(function(e){return _t.command("number"==typeof e&&e>=r.lineWidthDims[0]&&e<=r.lineWidthDims[1],"invalid line width, must positive number between "+r.lineWidthDims[0]+" and "+r.lineWidthDims[1],t.commandStr),e},function(e,t,n){return _t.optional(function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">="+r.lineWidthDims[0]+"&&"+n+"<="+r.lineWidthDims[1],"invalid line width")}),n});case No:return a(function(e){return _t.commandParameter(e,gs,s,t.commandStr),gs[e]},function(e,t,n){return _t.optional(function(){e.assert(t,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),t.def(n+'==="cw"?'+es+":"+ts)});case Fo:return a(function(e){return _t.command(me(e)&&4===e.length,"color.mask must be length 4 array",t.commandStr),e.map(function(e){return!!e})},function(e,t,n){return _t.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")}),Q(4,function(e){return"!!"+n+"["+e+"]"})});case Wo:return a(function(e){_t.command("object"==typeof e&&e,s,t.commandStr);var n="value"in e?e.value:1,r=!!e.invert;return _t.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",t.commandStr),[n,r]},function(e,t,n){_t.optional(function(){e.assert(t,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")});var r=t.def('"value" in ',n,"?+",n,".value:1"),i=t.def("!!",n,".invert");return[r,i]})}}),o}function k(e,t){var n=e.static,r=e.dynamic,i={};return Object.keys(n).forEach(function(e){var r,o=n[e];if("number"==typeof o||"boolean"==typeof o)r=We(function(){return o});else if("function"==typeof o){var a=o._reglType;"texture2d"===a||"textureCube"===a?r=We(function(e){return e.link(o)}):"framebuffer"===a||"framebufferCube"===a?(_t.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+e+'"',t.commandStr),r=We(function(e){return e.link(o.color[0])})):_t.commandRaise('invalid data for uniform "'+e+'"',t.commandStr)}else me(o)?r=We(function(t){var n=t.global.def("[",Q(o.length,function(n){return _t.command("number"==typeof o[n]||"boolean"==typeof o[n],"invalid uniform "+e,t.commandStr),o[n]}),"]");return n}):_t.commandRaise('invalid or missing data for uniform "'+e+'"',t.commandStr);r.value=o,i[e]=r}),Object.keys(r).forEach(function(e){var t=r[e];i[e]=qe(t,function(e,n){return e.invoke(n,t)})}),i}function S(e,n){var r=e.static,o=e.dynamic,a={};return Object.keys(r).forEach(function(e){var o=r[e],s=t.id(e),u=new Y;if(He(o))u.state=_o,u.buffer=i.getBuffer(i.create(o,ya,!1,!0)),u.type=0;else{var c=i.getBuffer(o);if(c)u.state=_o,u.buffer=c,u.type=0;else if(_t.command("object"==typeof o&&o,"invalid data for attribute "+e,n.commandStr),o.constant){var f=o.constant;u.buffer="null",u.state=xo,"number"==typeof f?u.x=f:(_t.command(me(f)&&f.length>0&&f.length<=4,"invalid constant for attribute "+e,n.commandStr),bo.forEach(function(e,t){t<f.length&&(u[e]=f[t])}))}else{c=He(o.buffer)?i.getBuffer(i.create(o.buffer,ya,!1,!0)):i.getBuffer(o.buffer),_t.command(!!c,'missing buffer for attribute "'+e+'"',n.commandStr);var l=0|o.offset;_t.command(l>=0,'invalid offset for attribute "'+e+'"',n.commandStr);var d=0|o.stride;_t.command(d>=0&&d<256,'invalid stride for attribute "'+e+'", must be integer betweeen [0, 255]',n.commandStr);var h=0|o.size;_t.command(!("size"in o)||h>0&&h<=4,'invalid size for attribute "'+e+'", must be 1,2,3,4',n.commandStr);var p=!!o.normalized,m=0;"type"in o&&(_t.commandParameter(o.type,_n,"invalid type for attribute "+e,n.commandStr),m=_n[o.type]);var v=0|o.divisor;"divisor"in o&&(_t.command(0===v||J,'cannot specify divisor for attribute "'+e+'", instancing not supported',n.commandStr),_t.command(v>=0,'invalid divisor for attribute "'+e+'"',n.commandStr)),_t.optional(function(){var t=n.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(o).forEach(function(n){_t.command(r.indexOf(n)>=0,'unknown parameter "'+n+'" for attribute pointer "'+e+'" (valid parameters are '+r+")",t)})}),u.buffer=c,u.state=_o,u.size=h,u.normalized=p,u.type=m||c.dtype,u.offset=l,u.stride=d,u.divisor=v}}a[e]=We(function(e,t){var n=e.attribCache;if(s in n)return n[s];var r={isStream:!1};return Object.keys(u).forEach(function(e){r[e]=u[e]}),u.buffer&&(r.buffer=e.link(u.buffer),r.type=r.type||r.buffer+".dtype"),n[s]=r,r})}),Object.keys(o).forEach(function(e){function t(t,r){function i(e){r(c[e],"=",o,".",e,"|0;")}var o=t.invoke(r,n),a=t.shared,s=a.isBufferArgs,u=a.buffer;_t.optional(function(){t.assert(r,o+"&&(typeof "+o+'==="object"||typeof '+o+'==="function")&&('+s+"("+o+")||"+u+".getBuffer("+o+")||"+u+".getBuffer("+o+".buffer)||"+s+"("+o+'.buffer)||("constant" in '+o+"&&(typeof "+o+'.constant==="number"||'+a.isArrayLike+"("+o+".constant))))",'invalid dynamic attribute "'+e+'"')});var c={isStream:r.def(!1)},f=new Y;f.state=_o,Object.keys(f).forEach(function(e){c[e]=r.def(""+f[e])});var l=c.buffer,d=c.type;return r("if(",s,"(",o,")){",c.isStream,"=true;",l,"=",u,".createStream(",ya,",",o,");",d,"=",l,".dtype;","}else{",l,"=",u,".getBuffer(",o,");","if(",l,"){",d,"=",l,".dtype;",'}else if("constant" in ',o,"){",c.state,"=",xo,";","if(typeof "+o+'.constant === "number"){',c[bo[0]],"=",o,".constant;",bo.slice(1).map(function(e){return c[e]}).join("="),"=0;","}else{",bo.map(function(e,t){return c[e]+"="+o+".constant.length>="+t+"?"+o+".constant["+t+"]:0;"}).join(""),"}}else{","if(",s,"(",o,".buffer)){",l,"=",u,".createStream(",ya,",",o,".buffer);","}else{",l,"=",u,".getBuffer(",o,".buffer);","}",d,'="type" in ',o,"?",a.glTypes,"[",o,".type]:",l,".dtype;",c.normalized,"=!!",o,".normalized;"),i("size"),i("offset"),i("stride"),i("divisor"),r("}}"),r.exit("if(",c.isStream,"){",u,".destroyStream(",l,");","}"),c}var n=o[e];a[e]=qe(n,t)}),a}function M(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach(function(e){var n=t[e];r[e]=We(function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)})}),Object.keys(n).forEach(function(e){var t=n[e];r[e]=qe(t,function(e,n){return e.invoke(n,t)})}),r}function C(e,t,n,r,i){function o(e){var t=c[e];t&&(l[e]=t)}var a=e.static,s=e.dynamic;_t.optional(function(){function e(e){Object.keys(e).forEach(function(e){_t.command(t.indexOf(e)>=0,'unknown parameter "'+e+'"',i.commandStr)})}var t=[ta,na,ra,ia,oa,sa,aa,ua,ea].concat(te);e(a),e(s)});var u=_(e,i),c=x(e,u,i),f=A(e,i),l=E(e,i),d=w(e,i);o($o),o(m(Zo));var h=Object.keys(l).length>0,p={framebuffer:u,draw:f,shader:d,state:l,dirty:h};return p.profile=y(e,i),p.uniforms=k(n,i),p.attributes=S(t,i),p.context=M(r,i),p}function T(e,t,n){var r=e.shared,i=r.context,o=e.scope();Object.keys(n).forEach(function(r){t.save(i,"."+r);var a=n[r];o(i,".",r,"=",a.append(e,t),";")}),t(o)}function O(e,t,n,r){var i,o=e.shared,a=o.gl,s=o.framebuffer;Z&&(i=t.def(o.extensions,".webgl_draw_buffers"));var u,c=e.constants,f=c.drawBuffer,l=c.backBuffer;u=n?n.append(e,t):t.def(s,".next"),r||t("if(",u,"!==",s,".cur){"),t("if(",u,"){",a,".bindFramebuffer(",fs,",",u,".framebuffer);"),Z&&t(i,".drawBuffersWEBGL(",f,"[",u,".colorAttachments.length]);"),t("}else{",a,".bindFramebuffer(",fs,",null);"),Z&&t(i,".drawBuffersWEBGL(",l,");"),t("}",s,".cur=",u,";"),r||t("}")}function D(e,t,n){var r=e.shared,i=r.gl,o=e.current,a=e.next,s=r.current,u=r.next,c=e.cond(s,".dirty");te.forEach(function(t){var r=m(t);if(!(r in n.state)){var f,l;if(r in a){f=a[r],l=o[r];var d=Q($[r].length,function(e){return c.def(f,"[",e,"]")});c(e.cond(d.map(function(e,t){return e+"!=="+l+"["+t+"]"}).join("||")).then(i,".",re[r],"(",d,");",d.map(function(e,t){return l+"["+t+"]="+e}).join(";"),";"))}else{f=c.def(u,".",r);var h=e.cond(f,"!==",s,".",r);c(h),r in ne?h(e.cond(f).then(i,".enable(",ne[r],");").else(i,".disable(",ne[r],");"),s,".",r,"=",f,";"):h(i,".",re[r],"(",f,");",s,".",r,"=",f,";")}}}),0===Object.keys(n.state).length&&c(s,".dirty=false;"),t(c)}function L(e,t,n,r){var i=e.shared,o=e.current,a=i.current,s=i.gl;Ue(Object.keys(n)).forEach(function(i){var u=n[i];if(!r||r(u)){var c=u.append(e,t);if(ne[i]){var f=ne[i];Ge(u)?c?t(s,".enable(",f,");"):t(s,".disable(",f,");"):t(e.cond(c).then(s,".enable(",f,");").else(s,".disable(",f,");")),t(a,".",i,"=",c,";")}else if(me(c)){var l=o[i];t(s,".",re[i],"(",c,");",c.map(function(e,t){return l+"["+t+"]="+e}).join(";"),";")}else t(s,".",re[i],"(",c,");",a,".",i,"=",c,";")}})}function j(e,t){J&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function R(e,t,n,r,i){function o(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function a(e){c=t.def(),e(c,"=",o(),";"),"string"==typeof i?e(p,".count+=",i,";"):e(p,".count++;"),h&&(r?(f=t.def(),e(f,"=",v,".getNumPendingQueries();")):e(v,".beginQuery(",p,");"))}function s(e){e(p,".cpuTime+=",o(),"-",c,";"),h&&(r?e(v,".pushScopeStats(",f,",",v,".getNumPendingQueries(),",p,");"):e(v,".endQuery();"))}function u(e){var n=t.def(m,".profile");t(m,".profile=",e,";"),t.exit(m,".profile=",n,";")}var c,f,l,d=e.shared,p=e.stats,m=d.current,v=d.timer,g=n.profile;if(g){if(Ge(g))return void(g.enable?(a(t),s(t.exit),u("true")):u("false"));l=g.append(e,t),u(l)}else l=t.def(m,".profile");var b=e.block();a(b),t("if(",l,"){",b,"}");var y=e.block();s(y),t.exit("if(",l,"){",y,"}")}function z(e,t,n,r,i){function o(e){switch(e){case za:case Na:case Va:return 2;case Fa:case Ia:case Ga:return 3;case Ba:case Ha:case Wa:return 4;default:return 1}}function a(n,r,i){function o(){t("if(!",f,".buffer){",u,".enableVertexAttribArray(",c,");}");var n,o=i.type;if(n=i.size?t.def(i.size,"||",r):r,t("if(",f,".type!==",o,"||",f,".size!==",n,"||",p.map(function(e){return f+"."+e+"!=="+i[e]}).join("||"),"){",u,".bindBuffer(",ya,",",d,".buffer);",u,".vertexAttribPointer(",[c,n,o,i.normalized,i.stride,i.offset],");",f,".type=",o,";",f,".size=",n,";",p.map(function(e){return f+"."+e+"="+i[e]+";"}).join(""),"}"),J){var a=i.divisor;t("if(",f,".divisor!==",a,"){",e.instancing,".vertexAttribDivisorANGLE(",[c,a],");",f,".divisor=",a,";}")}}function a(){t("if(",f,".buffer){",u,".disableVertexAttribArray(",c,");","}if(",bo.map(function(e,t){return f+"."+e+"!=="+h[t]}).join("||"),"){",u,".vertexAttrib4f(",c,",",h,");",bo.map(function(e,t){return f+"."+e+"="+h[t]+";"}).join(""),"}")}var u=s.gl,c=t.def(n,".location"),f=t.def(s.attributes,"[",c,"]"),l=i.state,d=i.buffer,h=[i.x,i.y,i.z,i.w],p=["buffer","normalized","offset","stride"];l===_o?o():l===xo?a():(t("if(",l,"===",_o,"){"),o(),t("}else{"),a(),t("}"))}var s=e.shared;r.forEach(function(r){var s,u=r.name,c=n.attributes[u];if(c){if(!i(c))return;s=c.append(e,t)}else{if(!i(bs))return;var f=e.scopeAttrib(u);_t.optional(function(){e.assert(t,f+".state","missing attribute "+u)}),s={},Object.keys(new Y).forEach(function(e){s[e]=t.def(f,".",e)})}a(e.link(r),o(r.info.type),s)})}function F(e,n,r,i,o){for(var a,s=e.shared,u=s.gl,c=0;c<i.length;++c){var f,l=i[c],d=l.name,h=l.info.type,p=r.uniforms[d],m=e.link(l),v=m+".location";if(p){if(!o(p))continue;if(Ge(p)){var g=p.value;if(_t.command(null!==g&&"undefined"!=typeof g,'missing uniform "'+d+'"',e.commandStr),h===Ka||h===Qa){_t.command("function"==typeof g&&(h===Ka&&("texture2d"===g._reglType||"framebuffer"===g._reglType)||h===Qa&&("textureCube"===g._reglType||"framebufferCube"===g._reglType)),"invalid texture for uniform "+d,e.commandStr);var b=e.link(g._texture||g.color[0]._texture);n(u,".uniform1i(",v,",",b+".bind());"),n.exit(b,".unbind();")}else if(h===qa||h===Xa||h===Ya){_t.optional(function(){_t.command(me(g),"invalid matrix for uniform "+d,e.commandStr),_t.command(h===qa&&4===g.length||h===Xa&&9===g.length||h===Ya&&16===g.length,"invalid length for matrix uniform "+d,e.commandStr)});var y=e.global.def("new Float32Array(["+Array.prototype.slice.call(g)+"])"),_=2;h===Xa?_=3:h===Ya&&(_=4),n(u,".uniformMatrix",_,"fv(",v,",false,",y,");")}else{switch(h){case Ra:_t.commandType(g,"number","uniform "+d,e.commandStr),a="1f";break;case za:_t.command(me(g)&&2===g.length,"uniform "+d,e.commandStr),a="2f";break;case Fa:_t.command(me(g)&&3===g.length,"uniform "+d,e.commandStr),a="3f";break;case Ba:_t.command(me(g)&&4===g.length,"uniform "+d,e.commandStr),a="4f";break;case Ua:_t.commandType(g,"boolean","uniform "+d,e.commandStr),a="1i";break;case Pa:_t.commandType(g,"number","uniform "+d,e.commandStr),a="1i";break;case Va:_t.command(me(g)&&2===g.length,"uniform "+d,e.commandStr),a="2i";break;case Na:_t.command(me(g)&&2===g.length,"uniform "+d,e.commandStr),a="2i";break;case Ga:_t.command(me(g)&&3===g.length,"uniform "+d,e.commandStr),a="3i";break;case Ia:_t.command(me(g)&&3===g.length,"uniform "+d,e.commandStr),a="3i";break;case Wa:_t.command(me(g)&&4===g.length,"uniform "+d,e.commandStr),a="4i";break;case Ha:_t.command(me(g)&&4===g.length,"uniform "+d,e.commandStr),a="4i"}n(u,".uniform",a,"(",v,",",me(g)?Array.prototype.slice.call(g):g,");")}continue}f=p.append(e,n)}else{if(!o(bs))continue;f=n.def(s.uniforms,"[",t.id(d),"]")}h===Ka?n("if(",f,"&&",f,'._reglType==="framebuffer"){',f,"=",f,".color[0];","}"):h===Qa&&n("if(",f,"&&",f,'._reglType==="framebufferCube"){',f,"=",f,".color[0];","}"),_t.optional(function(){function t(t,r){e.assert(n,t,'bad data or missing for uniform "'+d+'".  '+r)}function r(e){t("typeof "+f+'==="'+e+'"',"invalid type, expected "+e)}function i(n,r){t(s.isArrayLike+"("+f+")&&"+f+".length==="+n,"invalid vector, should have length "+n,e.commandStr)}function o(n){t("typeof "+f+'==="function"&&'+f+'._reglType==="texture'+(n===Aa?"2d":"Cube")+'"',"invalid texture type",e.commandStr)}switch(h){case Pa:r("number");break;case Na:i(2,"number");break;case Ia:i(3,"number");break;case Ha:i(4,"number");break;case Ra:r("number");break;case za:i(2,"number");break;case Fa:i(3,"number");break;case Ba:i(4,"number");break;case Ua:r("boolean");break;case Va:i(2,"boolean");break;case Ga:i(3,"boolean");break;case Wa:i(4,"boolean");break;case qa:i(4,"number");break;case Xa:i(9,"number");break;case Ya:i(16,"number");break;case Ka:o(Aa);break;case Qa:o(Ea)}});var x=1;switch(h){case Ka:case Qa:var w=n.def(f,"._texture");n(u,".uniform1i(",v,",",w,".bind());"),n.exit(w,".unbind();");continue;case Pa:case Ua:a="1i";break;case Na:case Va:a="2i",x=2;break;case Ia:case Ga:a="3i",x=3;break;case Ha:case Wa:a="4i",x=4;break;case Ra:a="1f";break;case za:a="2f",x=2;break;case Fa:a="3f",x=3;break;case Ba:a="4f",x=4;break;case qa:a="Matrix2fv";break;case Xa:a="Matrix3fv";break;case Ya:a="Matrix4fv"}if(n(u,".uniform",a,"(",v,","),"M"===a.charAt(0)){var A=Math.pow(h-qa+2,2),E=e.global.def("new Float32Array(",A,")");n("false,(Array.isArray(",f,")||",f," instanceof Float32Array)?",f,":(",Q(A,function(e){return E+"["+e+"]="+f+"["+e+"]"}),",",E,")")}else n(x>1?Q(x,function(e){return f+"["+e+"]"}):f);n(");")}}function B(e,t,n,r){function i(){var i,o=d.elements,a=t;return o?((o.contextDep&&r.contextDynamic||o.propDep)&&(a=n),i=o.append(e,a)):i=a.def(l,".",ia),i&&a("if("+i+")"+f+".bindBuffer("+_a+","+i+".buffer.buffer);"),i}function o(){var i,o=d.count,a=t;return o?((o.contextDep&&r.contextDynamic||o.propDep)&&(a=n),i=o.append(e,a),_t.optional(function(){o.MISSING&&e.assert(t,"false","missing vertex count"),o.DYNAMIC&&e.assert(a,i+">=0","missing vertex count")})):(i=a.def(l,".",aa),_t.optional(function(){e.assert(a,i+">=0","missing vertex count")})),i}function a(i){var o=d[i];return o?o.contextDep&&r.contextDynamic||o.propDep?o.append(e,n):o.append(e,t):t.def(l,".",i)}function s(){function e(){n(b,".drawElementsInstancedANGLE(",[p,v,y,m+"<<(("+y+"-"+yo+")>>1)",g],");")}function t(){n(b,".drawArraysInstancedANGLE(",[p,m,v,g],");")}h?_?e():(n("if(",h,"){"),e(),n("}else{"),t(),n("}")):t()}function u(){function e(){n(f+".drawElements("+[p,v,y,m+"<<(("+y+"-"+yo+")>>1)"]+");")}function t(){n(f+".drawArrays("+[p,m,v]+");")}h?_?e():(n("if(",h,"){"),e(),n("}else{"),t(),n("}")):t()}var c=e.shared,f=c.gl,l=c.draw,d=r.draw,h=i(),p=a(oa),m=a(sa),v=o();if("number"==typeof v){if(0===v)return}else n("if(",v,"){"),n.exit("}");var g,b;J&&(g=a(ua),b=e.instancing);var y=h+".type",_=d.elements&&Ge(d.elements);J&&("number"!=typeof g||g>=0)?"string"==typeof g?(n("if(",g,">0){"),s(),n("}else if(",g,"<0){"),u(),n("}")):s():u()}function P(e,t,n,r,i){var o=b(),a=o.proc("body",i);return _t.optional(function(){o.commandStr=t.commandStr,o.command=o.link(t.commandStr)}),J&&(o.instancing=a.def(o.shared.extensions,".angle_instanced_arrays")),e(o,a,n,r),o.compile().body}function N(e,t,n,r){j(e,t),z(e,t,n,r.attributes,function(){return!0}),F(e,t,n,r.uniforms,function(){return!0}),B(e,t,t,n)}function I(e,t){var n=e.proc("draw",1);j(e,n),T(e,n,t.context),O(e,n,t.framebuffer),D(e,n,t),L(e,n,t.state),R(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)N(e,n,t,t.shader.program);else{var i=e.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(e.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",e.link(function(n){return P(N,e,t,n,1)}),"(",r,");",a,".call(this,a0);"))}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}function H(e,t,n,r){function i(){return!0}e.batchId="a1",j(e,t),z(e,t,n,r.attributes,i),F(e,t,n,r.uniforms,i),B(e,t,t,n)}function U(e,t,n,r){function i(e){return e.contextDep&&a||e.propDep}function o(e){return!i(e)}j(e,t);var a=n.contextDep,s=t.def(),u="a0",c="a1",f=t.def();e.shared.props=f,e.batchId=s;var l=e.scope(),d=e.scope();if(t(l.entry,"for(",s,"=0;",s,"<",c,";++",s,"){",f,"=",u,"[",s,"];",d,"}",l.exit),n.needsContext&&T(e,d,n.context),n.needsFramebuffer&&O(e,d,n.framebuffer),L(e,d,n.state,i),n.profile&&i(n.profile)&&R(e,d,n,!1,!0),r)z(e,l,n,r.attributes,o),z(e,d,n,r.attributes,i),F(e,l,n,r.uniforms,o),F(e,d,n,r.uniforms,i),B(e,l,d,n);else{var h=e.global.def("{}"),p=n.shader.progVar.append(e,d),m=d.def(p,".id"),v=d.def(h,"[",m,"]");d(e.shared.gl,".useProgram(",p,".program);","if(!",v,"){",v,"=",h,"[",m,"]=",e.link(function(t){return P(H,e,n,t,2)}),"(",p,");}",v,".call(this,a0[",s,"],",s,");")}}function V(e,t){function n(e){return e.contextDep&&i||e.propDep}var r=e.proc("batch",2);e.batchId="0",j(e,r);var i=!1,o=!0;Object.keys(t.context).forEach(function(e){i=i||t.context[e].propDep}),i||(T(e,r,t.context),o=!1);var a=t.framebuffer,s=!1;a?(a.propDep?i=s=!0:a.contextDep&&i&&(s=!0),s||O(e,r,a)):O(e,r,null),t.state.viewport&&t.state.viewport.propDep&&(i=!0),D(e,r,t),L(e,r,t.state,function(e){return!n(e)}),t.profile&&n(t.profile)||R(e,r,t,!1,"a1"),t.contextDep=i,t.needsContext=o,t.needsFramebuffer=s;var u=t.shader.progVar;if(u.contextDep&&i||u.propDep)U(e,r,t,null);else{var c=u.append(e,r);if(r(e.shared.gl,".useProgram(",c,".program);"),t.shader.program)U(e,r,t,t.shader.program);else{var f=e.global.def("{}"),l=r.def(c,".id"),d=r.def(f,"[",l,"]");r(e.cond(d).then(d,".call(this,a0,a1);").else(d,"=",f,"[",l,"]=",e.link(function(n){return P(U,e,t,n,2)}),"(",c,");",d,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&r(e.shared.current,".dirty=true;")}function G(e,n){function r(t){var r=n.shader[t];r&&i.set(o.shader,"."+t,r.append(e,i))}var i=e.proc("scope",3);e.batchId="a2";var o=e.shared,a=o.current;T(e,i,n.context),n.framebuffer&&n.framebuffer.append(e,i),Ue(Object.keys(n.state)).forEach(function(t){var r=n.state[t],a=r.append(e,i);me(a)?a.forEach(function(n,r){i.set(e.next[t],"["+r+"]",n)}):i.set(o.next,"."+t,a)}),R(e,i,n,!0,!0),[ia,sa,aa,ua,oa].forEach(function(t){var r=n.draw[t];r&&i.set(o.draw,"."+t,""+r.append(e,i))}),Object.keys(n.uniforms).forEach(function(r){i.set(o.uniforms,"["+t.id(r)+"]",n.uniforms[r].append(e,i))}),Object.keys(n.attributes).forEach(function(t){var r=n.attributes[t].append(e,i),o=e.scopeAttrib(t);Object.keys(new Y).forEach(function(e){i.set(o,"."+e,r[e])})}),r(na),r(ra),Object.keys(n.state).length>0&&(i(a,".dirty=true;"),i.exit(a,".dirty=true;")),i("a1(",e.shared.context,",a0,",e.batchId,");")}function W(e){if("object"==typeof e&&!me(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(At.isDynamic(e[t[n]]))return!0;return!1}}function q(e,t,n){function r(e,t){a.forEach(function(n){var r=i[n];if(At.isDynamic(r)){var o=e.invoke(t,r);t(f,".",n,"=",o,";")}})}var i=t.static[n];if(i&&W(i)){var o=e.global,a=Object.keys(i),s=!1,u=!1,c=!1,f=e.global.def("{}");a.forEach(function(t){var n=i[t];if(At.isDynamic(n)){"function"==typeof n&&(n=i[t]=At.unbox(n));var r=qe(n,null);s=s||r.thisDep,c=c||r.propDep,u=u||r.contextDep}else{switch(o(f,".",t,"="),typeof n){case"number":o(n);break;case"string":o('"',n,'"');break;case"object":Array.isArray(n)&&o("[",n.join(),"]");break;default:o(e.link(n))}o(";")}}),t.dynamic[n]=new At.DynamicVariable(So,{thisDep:s,contextDep:u,propDep:c,ref:f,append:r}),delete t.static[n]}}function X(e,t,n,r,i){var o=b();o.stats=o.link(i),Object.keys(t.static).forEach(function(e){q(o,t,e)}),ba.forEach(function(t){q(o,e,t)});var a=C(e,t,n,r,o);return I(o,a),G(o,a),V(o,a),o.compile()}var Y=c.Record,K={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(K.min=ns,K.max=rs);var J=n.angle_instanced_arrays,Z=n.webgl_draw_buffers,$={dirty:!0,profile:p.profile},ee={},te=[],ne={},re={};v(Mo,Ma),v(Co,Sa),g(To,"blendColor",[0,0,0,0]),g(Oo,"blendEquationSeparate",[us,us]),g(Do,"blendFuncSeparate",[ss,as,ss,as]),v(Lo,Ta,!0),g(jo,"depthFunc",cs),g(Ro,"depthRange",[0,1]),g(zo,"depthMask",!0),g(Fo,Fo,[!0,!0,!0,!0]),v(Bo,ka),g(Po,"cullFace",$a),g(No,No,ts),g(Io,Io,1),v(Ho,Da),g(Uo,"polygonOffset",[0,0]),v(Vo,La),v(Go,ja),g(Wo,"sampleCoverage",[1,!1]),v(qo,Ca),g(Xo,"stencilMask",-1),g(Yo,"stencilFunc",[is,0,-1]),g(Ko,"stencilOpSeparate",[Za,os,os,os]),g(Qo,"stencilOpSeparate",[$a,os,os,os]),v(Jo,Oa),g(Zo,"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),g($o,$o,[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var ie={gl:e,context:d,strings:t,next:ee,current:$,draw:l,elements:o,buffer:i,shader:f,attributes:c.state,uniforms:u,framebuffer:s,extensions:n,timer:h,isBufferArgs:He},oe={primTypes:Bn,compareFuncs:ps,blendFuncs:ds,blendEquations:K,stencilOps:ms,glTypes:_n,orientationType:gs};_t.optional(function(){ie.isArrayLike=me}),Z&&(oe.backBuffer=[$a],oe.drawBuffer=Q(r.maxDrawbuffers,function(e){return 0===e?[0]:Q(e,function(e){return ls+e})}));var ae=0;return{next:ee,current:$,procs:function(){var t=b(),n=t.proc("poll"),i=t.proc("refresh"),o=t.block();n(o),i(o);var a=t.shared,s=a.gl,u=a.next,c=a.current;o(c,".dirty=false;"),O(t,n),O(t,i,null,!0);var f,l=e.getExtension("angle_instanced_arrays");l&&(f=t.link(l));for(var d=0;d<r.maxAttributes;++d){var h=i.def(a.attributes,"[",d,"]"),p=t.cond(h,".buffer");p.then(s,".enableVertexAttribArray(",d,");",s,".bindBuffer(",ya,",",h,".buffer.buffer);",s,".vertexAttribPointer(",d,",",h,".size,",h,".type,",h,".normalized,",h,".stride,",h,".offset);").else(s,".disableVertexAttribArray(",d,");",s,".vertexAttrib4f(",d,",",h,".x,",h,".y,",h,".z,",h,".w);",h,".buffer=null;"),i(p),l&&i(f,".vertexAttribDivisorANGLE(",d,",",h,".divisor);")}return Object.keys(ne).forEach(function(e){var r=ne[e],a=o.def(u,".",e),f=t.block();f("if(",a,"){",s,".enable(",r,")}else{",s,".disable(",r,")}",c,".",e,"=",a,";"),i(f),n("if(",a,"!==",c,".",e,"){",f,"}")}),Object.keys(re).forEach(function(e){var r,a,f=re[e],l=$[e],d=t.block();if(d(s,".",f,"("),me(l)){var h=l.length;r=t.global.def(u,".",e),a=t.global.def(c,".",e),d(Q(h,function(e){return r+"["+e+"]"}),");",Q(h,function(e){return a+"["+e+"]="+r+"["+e+"];"}).join("")),n("if(",Q(h,function(e){return r+"["+e+"]!=="+a+"["+e+"]"}).join("||"),"){",d,"}")}else r=o.def(u,".",e),a=o.def(c,".",e),d(r,");",c,".",e,"=",r,";"),n("if(",r,"!==",a,"){",d,"}");i(d)}),t.compile()}(),compile:X}}function Ye(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}function Ke(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}function Qe(e){function t(){if(0===G.length)return E&&E.update(),void(Q=null);Q=Et.next(t),d();for(var e=G.length-1;e>=0;--e){var n=G[e];n&&n(C,null,0)}g.flush(),E&&E.update()}function n(){!Q&&G.length>0&&(Q=Et.next(t))}function r(){Q&&(Et.cancel(t),Q=null)}function i(e){e.preventDefault(),y=!0,r(),W.forEach(function(e){e()})}function o(e){g.getError(),y=!1,_.restore(),z.restore(),L.restore(),F.restore(),B.restore(),P.restore(),E&&E.restore(),N.procs.refresh(),n(),q.forEach(function(e){e()})}function a(){G.length=0,r(),V&&(V.removeEventListener(Ms,i),V.removeEventListener(Cs,o)),z.clear(),P.clear(),B.clear(),F.clear(),j.clear(),L.clear(),E&&E.clear(),K.forEach(function(e){e()})}function s(e){function t(e){function t(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach(function(r){n[e+"."+r]=t[r]})}}var n=$e({},e);return delete n.uniforms,delete n.attributes,delete n.context,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,
delete n.stencil.op),t("blend"),t("depth"),t("cull"),t("stencil"),t("polygonOffset"),t("scissor"),t("sample"),n}function n(e){var t={},n={};return Object.keys(e).forEach(function(r){var i=e[r];At.isDynamic(i)?n[r]=At.unbox(i,r):t[r]=i}),{dynamic:n,static:t}}function r(e){for(;p.length<e;)p.push(null);return p}function i(e,t){var n;if(y&&_t.raise("context lost"),"function"==typeof e)return h.call(this,null,e,0);if("function"==typeof t){if("number"==typeof e){for(n=0;n<e;++n)h.call(this,null,t,n);return}if(Array.isArray(e)){for(n=0;n<e.length;++n)h.call(this,e[n],t,n);return}return h.call(this,e,t,0)}if("number"==typeof e){if(e>0)return d.call(this,r(0|e),0|e)}else{if(!Array.isArray(e))return l.call(this,e);if(e.length)return d.call(this,e,e.length)}}_t(!!e,"invalid args to regl({...})"),_t.type(e,"object","invalid args to regl({...})");var o=n(e.context||{}),a=n(e.uniforms||{}),s=n(e.attributes||{}),u=n(t(e)),c={gpuTime:0,cpuTime:0,count:0},f=N.compile(u,s,a,o,c),l=f.draw,d=f.batch,h=f.scope,p=[];return $e(i,{stats:c})}function u(e,t){var n=0;N.procs.poll();var r=t.color;r&&(g.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=As),"depth"in t&&(g.clearDepth(+t.depth),n|=Es),"stencil"in t&&(g.clearStencil(0|t.stencil),n|=ks),_t(!!n,"called regl.clear with no buffer specified"),g.clear(n)}function c(e){if(_t("object"==typeof e&&e,"regl.clear() takes an object as input"),"framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;t<6;++t)J($e({framebuffer:e.framebuffer.faces[t]},e),u);else J(e,u);else u(null,e)}function f(e){function t(){function t(){var e=Ke(G,t);G[e]=G[G.length-1],G.length-=1,G.length<=0&&r()}var n=Ke(G,e);_t(n>=0,"cannot cancel a frame twice"),G[n]=t}return _t.type(e,"function","regl.frame() callback must be a function"),G.push(e),n(),{cancel:t}}function l(){var e=U.viewport,t=U.scissor_box;e[0]=e[1]=t[0]=t[1]=0,C.viewportWidth=C.framebufferWidth=C.drawingBufferWidth=e[2]=t[2]=g.drawingBufferWidth,C.viewportHeight=C.framebufferHeight=C.drawingBufferHeight=e[3]=t[3]=g.drawingBufferHeight}function d(){C.tick+=1,C.time=p(),l(),N.procs.poll()}function h(){l(),N.procs.refresh(),E&&E.update()}function p(){return(kt()-k)/1e3}function m(e,t){_t.type(t,"function","listener callback must be a function");var n;switch(e){case"frame":return f(t);case"lost":n=W;break;case"restore":n=q;break;case"destroy":n=K;break;default:_t.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t)return n[e]=n[n.length-1],void n.pop()}}}var v=X(e);if(!v)return null;var g=v.gl,b=g.getContextAttributes(),y=g.isContextLost(),_=Y(g,v);if(!_)return null;var x=I(),w=Ye(),A=_.extensions,E=ws(g,A),k=kt(),S=g.drawingBufferWidth,M=g.drawingBufferHeight,C={tick:0,time:0,viewportWidth:S,viewportHeight:M,framebufferWidth:S,framebufferHeight:M,drawingBufferWidth:S,drawingBufferHeight:M,pixelRatio:v.pixelRatio},T={},O={elements:null,primitive:4,count:-1,offset:0,instances:-1},D=$t(g,A),L=de(g,w,v),j=he(g,A,L,w),R=ze(g,A,D,L,x),z=Fe(g,x,w,v),F=De(g,A,D,function(){N.procs.poll()},C,w,v),B=Ci(g,A,D,w,v),P=je(g,A,D,F,B,w),N=Xe(g,x,A,D,L,j,F,P,T,R,z,O,C,E,v),H=Be(g,P,N.procs.poll,C,b,A),U=N.next,V=g.canvas,G=[],W=[],q=[],K=[v.onDestroy],Q=null;V&&(V.addEventListener(Ms,i,!1),V.addEventListener(Cs,o,!1));var J=P.setFBO=s({framebuffer:At.define.call(null,Ts,"framebuffer")});h();var Z=$e(s,{clear:c,prop:At.define.bind(null,Ts),context:At.define.bind(null,Os),this:At.define.bind(null,Ds),draw:s({}),buffer:function(e){return L.create(e,Ss,!1,!1)},elements:function(e){return j.create(e,!1)},texture:F.create2D,cube:F.createCube,renderbuffer:B.create,framebuffer:P.create,framebufferCube:P.createCube,attributes:b,frame:f,on:m,limits:D,hasExtension:function(e){return D.extensions.indexOf(e.toLowerCase())>=0},read:H,destroy:a,_gl:g,_refresh:h,poll:function(){d(),E&&E.update()},now:p,stats:w});return v.onDone(null,Z),Z}var Je={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Ze=function(e){return Object.prototype.toString.call(e)in Je},$e=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},et=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"],tt=33071,nt=9728,rt=9984,it=9985,ot=9986,at=9987,st=5120,ut=5121,ct=5122,ft=5123,lt=5124,dt=5125,ht=5126,pt=32819,mt=32820,vt=33635,gt=34042,bt=36193,yt={};yt[st]=yt[ut]=1,yt[ct]=yt[ft]=yt[bt]=yt[vt]=yt[pt]=yt[mt]=2,yt[lt]=yt[dt]=yt[ht]=yt[gt]=4;var _t=$e(n,{optional:M,raise:t,commandRaise:A,command:E,parameter:i,commandParameter:k,constructor:c,type:a,commandType:S,isTypedArray:o,nni:s,oneOf:u,shaderError:y,linkError:_,callSite:m,saveCommandRef:x,saveDrawInfo:w,framebufferFormat:C,guessCommand:p,texture2D:D,textureCube:L}),xt=0,wt=0,At={DynamicVariable:j,define:B,isDynamic:P,unbox:N,accessor:F},Et={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},kt="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},St=3408,Mt=3410,Ct=3411,Tt=3412,Ot=3413,Dt=3414,Lt=3415,jt=33901,Rt=33902,zt=3379,Ft=3386,Bt=34921,Pt=36347,Nt=36348,It=35661,Ht=35660,Ut=34930,Vt=36349,Gt=34076,Wt=34024,qt=7936,Xt=7937,Yt=7938,Kt=35724,Qt=34047,Jt=36063,Zt=34852,$t=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(Qt));var r=1,i=1;return t.webgl_draw_buffers&&(r=e.getParameter(Zt),i=e.getParameter(Jt)),{colorBits:[e.getParameter(Mt),e.getParameter(Ct),e.getParameter(Tt),e.getParameter(Ot)],depthBits:e.getParameter(Dt),stencilBits:e.getParameter(Lt),subpixelBits:e.getParameter(St),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:e.getParameter(jt),lineWidthDims:e.getParameter(Rt),maxViewportDims:e.getParameter(Ft),maxCombinedTextureUnits:e.getParameter(It),maxCubeMapSize:e.getParameter(Gt),maxRenderbufferSize:e.getParameter(Wt),maxTextureUnits:e.getParameter(Ut),maxTextureSize:e.getParameter(zt),maxAttributes:e.getParameter(Bt),maxVertexUniforms:e.getParameter(Pt),maxVertexTextureUnits:e.getParameter(Ht),maxVaryingVectors:e.getParameter(Nt),maxFragmentUniforms:e.getParameter(Vt),glsl:e.getParameter(Kt),renderer:e.getParameter(Xt),vendor:e.getParameter(qt),version:e.getParameter(Yt)}},en=function(e){return Object.keys(e).map(function(t){return e[t]})},tn=5120,nn=5121,rn=5122,on=5123,an=5124,sn=5125,un=5126,cn=Q(8,function(){return[]}),fn={alloc:$,free:ee,allocType:te,freeType:ne},ln={shape:ue,flatten:se},dn=5120,hn=5122,pn=5124,mn=5121,vn=5123,gn=5125,bn=5126,yn=5126,_n={int8:dn,int16:hn,int32:pn,uint8:mn,uint16:vn,uint32:gn,float:bn,float32:yn},xn=35048,wn=35040,An={dynamic:xn,stream:wn,static:35044},En=ln.flatten,kn=ln.shape,Sn=35044,Mn=35040,Cn=5121,Tn=5126,On=[];On[5120]=1,On[5122]=2,On[5124]=4,On[5121]=1,On[5123]=2,On[5125]=4,On[5126]=4;var Dn=0,Ln=0,jn=1,Rn=1,zn=4,Fn=4,Bn={points:Dn,point:Ln,lines:jn,line:Rn,triangles:zn,triangle:Fn,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Pn=0,Nn=1,In=4,Hn=5120,Un=5121,Vn=5122,Gn=5123,Wn=5124,qn=5125,Xn=34963,Yn=35040,Kn=35044,Qn=new Float32Array(1),Jn=new Uint32Array(Qn.buffer),Zn=5123,$n=34467,er=3553,tr=34067,nr=34069,rr=6408,ir=6406,or=6407,ar=6409,sr=6410,ur=32854,cr=32855,fr=36194,lr=32819,dr=32820,hr=33635,pr=34042,mr=6402,vr=34041,gr=35904,br=35906,yr=36193,_r=33776,xr=33777,wr=33778,Ar=33779,Er=35986,kr=35987,Sr=34798,Mr=35840,Cr=35841,Tr=35842,Or=35843,Dr=36196,Lr=5121,jr=5123,Rr=5125,zr=5126,Fr=10242,Br=10243,Pr=10497,Nr=33071,Ir=33648,Hr=10240,Ur=10241,Vr=9728,Gr=9729,Wr=9984,qr=9985,Xr=9986,Yr=9987,Kr=33170,Qr=4352,Jr=4353,Zr=4354,$r=34046,ei=3317,ti=37440,ni=37441,ri=37443,ii=37444,oi=33984,ai=[Wr,Xr,qr,Yr],si=[0,ar,sr,or,rr],ui={};ui[ar]=ui[ir]=ui[mr]=1,ui[vr]=ui[sr]=2,ui[or]=ui[gr]=3,ui[rr]=ui[br]=4;var ci=ve("HTMLCanvasElement"),fi=ve("CanvasRenderingContext2D"),li=ve("HTMLImageElement"),di=ve("HTMLVideoElement"),hi=Object.keys(Je).concat([ci,fi,li,di]),pi=[];pi[Lr]=1,pi[zr]=4,pi[yr]=2,pi[jr]=2,pi[Rr]=4;var mi=[];mi[ur]=2,mi[cr]=2,mi[fr]=2,mi[vr]=4,mi[_r]=.5,mi[xr]=.5,mi[wr]=1,mi[Ar]=1,mi[Er]=.5,mi[kr]=1,mi[Sr]=1,mi[Mr]=.5,mi[Cr]=.25,mi[Tr]=.5,mi[Or]=.25,mi[Dr]=.5;var vi=36161,gi=32854,bi=32855,yi=36194,_i=33189,xi=36168,wi=34041,Ai=35907,Ei=34836,ki=34842,Si=34843,Mi=[];Mi[gi]=2,Mi[bi]=2,Mi[yi]=2,Mi[_i]=2,Mi[xi]=1,Mi[wi]=4,Mi[Ai]=4,Mi[Ei]=16,Mi[ki]=8,Mi[Si]=6;var Ci=function(e,t,n,r,i){function o(e){this.id=l++,this.refCount=1,this.renderbuffer=e,this.format=gi,this.width=0,this.height=0,i.profile&&(this.stats={size:0})}function a(t){var n=t.renderbuffer;_t(n,"must not double destroy renderbuffer"),e.bindRenderbuffer(vi,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete d[t.id],r.renderbufferCount--}function s(t,a){function s(t,r){var o=0,a=0,u=gi;if("object"==typeof t&&t){var d=t;if("shape"in d){var h=d.shape;_t(Array.isArray(h)&&h.length>=2,"invalid renderbuffer shape"),o=0|h[0],a=0|h[1]}else"radius"in d&&(o=a=0|d.radius),"width"in d&&(o=0|d.width),"height"in d&&(a=0|d.height);"format"in d&&(_t.parameter(d.format,c,"invalid renderbuffer format"),u=c[d.format])}else"number"==typeof t?(o=0|t,a="number"==typeof r?0|r:o):t?_t.raise("invalid arguments to renderbuffer constructor"):o=a=1;if(_t(o>0&&a>0&&o<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),o!==l.width||a!==l.height||u!==l.format)return s.width=l.width=o,s.height=l.height=a,l.format=u,e.bindRenderbuffer(vi,l.renderbuffer),e.renderbufferStorage(vi,u,o,a),i.profile&&(l.stats.size=Le(l.format,l.width,l.height)),s.format=f[l.format],s}function u(t,r){var o=0|t,a=0|r||o;return o===l.width&&a===l.height?s:(_t(o>0&&a>0&&o<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),s.width=l.width=o,s.height=l.height=a,e.bindRenderbuffer(vi,l.renderbuffer),e.renderbufferStorage(vi,l.format,o,a),i.profile&&(l.stats.size=Le(l.format,l.width,l.height)),s)}var l=new o(e.createRenderbuffer());return d[l.id]=l,r.renderbufferCount++,s(t,a),s.resize=u,s._reglType="renderbuffer",s._renderbuffer=l,i.profile&&(s.stats=l.stats),s.destroy=function(){l.decRef()},s}function u(){en(d).forEach(function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(vi,t.renderbuffer),e.renderbufferStorage(vi,t.format,t.width,t.height)}),e.bindRenderbuffer(vi,null)}var c={rgba4:gi,rgb565:yi,"rgb5 a1":bi,depth:_i,stencil:xi,"depth stencil":wi};t.ext_srgb&&(c.srgba=Ai),t.ext_color_buffer_half_float&&(c.rgba16f=ki,c.rgb16f=Si),t.webgl_color_buffer_float&&(c.rgba32f=Ei);var f=[];Object.keys(c).forEach(function(e){var t=c[e];f[t]=e});var l=0,d={};return o.prototype.decRef=function(){--this.refCount<=0&&a(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var e=0;return Object.keys(d).forEach(function(t){e+=d[t].stats.size}),e}),{create:s,clear:function(){en(d).forEach(a)},restore:u}},Ti=36160,Oi=36161,Di=3553,Li=34069,ji=36064,Ri=36096,zi=36128,Fi=33306,Bi=36053,Pi=36054,Ni=36055,Ii=36057,Hi=36061,Ui=36193,Vi=5121,Gi=5126,Wi=6408,qi=6402,Xi=[Wi],Yi=[];Yi[Wi]=4;var Ki=[];Ki[Vi]=1,Ki[Gi]=4,Ki[Ui]=2;var Qi=32854,Ji=32855,Zi=36194,$i=33189,eo=36168,to=34041,no=35907,ro=34836,io=34842,oo=34843,ao=[Qi,Ji,Zi,no,io,oo,ro],so={};so[Bi]="complete",so[Pi]="incomplete attachment",so[Ii]="incomplete dimensions",so[Ni]="incomplete, missing attachment",so[Hi]="unsupported";var uo=5126,co=35632,fo=35633,lo=35718,ho=35721,po=6408,mo=5121,vo=3333,go=5126,bo="xyzw".split(""),yo=5121,_o=1,xo=2,wo=0,Ao=1,Eo=2,ko=3,So=4,Mo="dither",Co="blend.enable",To="blend.color",Oo="blend.equation",Do="blend.func",Lo="depth.enable",jo="depth.func",Ro="depth.range",zo="depth.mask",Fo="colorMask",Bo="cull.enable",Po="cull.face",No="frontFace",Io="lineWidth",Ho="polygonOffset.enable",Uo="polygonOffset.offset",Vo="sample.alpha",Go="sample.enable",Wo="sample.coverage",qo="stencil.enable",Xo="stencil.mask",Yo="stencil.func",Ko="stencil.opFront",Qo="stencil.opBack",Jo="scissor.enable",Zo="scissor.box",$o="viewport",ea="profile",ta="framebuffer",na="vert",ra="frag",ia="elements",oa="primitive",aa="count",sa="offset",ua="instances",ca="Width",fa="Height",la=ta+ca,da=ta+fa,ha=$o+ca,pa=$o+fa,ma="drawingBuffer",va=ma+ca,ga=ma+fa,ba=[Do,Oo,Yo,Ko,Qo,Wo,$o,Zo,Uo],ya=34962,_a=34963,xa=35632,wa=35633,Aa=3553,Ea=34067,ka=2884,Sa=3042,Ma=3024,Ca=2960,Ta=2929,Oa=3089,Da=32823,La=32926,ja=32928,Ra=5126,za=35664,Fa=35665,Ba=35666,Pa=5124,Na=35667,Ia=35668,Ha=35669,Ua=35670,Va=35671,Ga=35672,Wa=35673,qa=35674,Xa=35675,Ya=35676,Ka=35678,Qa=35680,Ja=4,Za=1028,$a=1029,es=2304,ts=2305,ns=32775,rs=32776,is=519,os=7680,as=0,ss=1,us=32774,cs=513,fs=36160,ls=36064,ds={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},hs=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],ps={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ms={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},vs={frag:xa,vert:wa},gs={cw:es,ccw:ts},bs=new Ve(!1,!1,!1,function(){}),ys=34918,_s=34919,xs=35007,ws=function(e,t){function n(){return d.pop()||l.createQueryEXT()}function r(e){d.push(e)}function i(e){var t=n();l.beginQueryEXT(xs,t),h.push(t),c(h.length-1,h.length,e)}function o(){l.endQueryEXT(xs)}function a(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}function s(){return p.pop()||new a}function u(e){p.push(e)}function c(e,t,n){var r=s();r.startQueryIndex=e,r.endQueryIndex=t,r.sum=0,r.stats=n,m.push(r)}function f(){var e,t,n=h.length;if(0!==n){g.length=Math.max(g.length,n+1),v.length=Math.max(v.length,n+1),v[0]=0,g[0]=0;var i=0;for(e=0,t=0;t<h.length;++t){var o=h[t];l.getQueryObjectEXT(o,_s)?(i+=l.getQueryObjectEXT(o,ys),r(o)):h[e++]=o,v[t+1]=i,g[t+1]=e}for(h.length=e,e=0,t=0;t<m.length;++t){var a=m[t],s=a.startQueryIndex,c=a.endQueryIndex;a.sum+=v[c]-v[s];var f=g[s],d=g[c];d===f?(a.stats.gpuTime+=a.sum/1e6,u(a)):(a.startQueryIndex=f,a.endQueryIndex=d,m[e++]=a)}m.length=e}}var l=t.ext_disjoint_timer_query;if(!l)return null;var d=[],h=[],p=[],m=[],v=[],g=[];return{beginQuery:i,endQuery:o,pushScopeStats:c,update:f,getNumPendingQueries:function(){return h.length},clear:function(){d.push.apply(d,h);for(var e=0;e<d.length;e++)l.deleteQueryEXT(d[e]);h.length=0,d.length=0},restore:function(){h.length=0,d.length=0}}},As=16384,Es=256,ks=1024,Ss=34962,Ms="webglcontextlost",Cs="webglcontextrestored",Ts=1,Os=2,Ds=3;return Qe})},{}],91:[function(e,t,n){(function(e){t.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],92:[function(e,t,n){!function(){"use strict";function e(e){e||(e=Math.random),this.p=r(e),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(var t=0;t<512;t++)this.perm[t]=this.p[255&t],this.permMod12[t]=this.perm[t]%12}function r(e){var t,n=new Uint8Array(256);for(t=0;t<256;t++)n[t]=t;for(t=0;t<255;t++){var r=t+1+~~(e()*(255-t)),i=n[t];n[t]=n[r],n[r]=i}return n}var i=.5*(Math.sqrt(3)-1),o=(3-Math.sqrt(3))/6,a=1/3,s=1/6,u=(Math.sqrt(5)-1)/4,c=(5-Math.sqrt(5))/20;e.prototype={grad3:new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),grad4:new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]),noise2D:function(e,t){var n,r,a=this.permMod12,s=this.perm,u=this.grad3,c=0,f=0,l=0,d=(e+t)*i,h=Math.floor(e+d),p=Math.floor(t+d),m=(h+p)*o,v=h-m,g=p-m,b=e-v,y=t-g;b>y?(n=1,r=0):(n=0,r=1);var _=b-n+o,x=y-r+o,w=b-1+2*o,A=y-1+2*o,E=255&h,k=255&p,S=.5-b*b-y*y;if(S>=0){var M=3*a[E+s[k]];S*=S,c=S*S*(u[M]*b+u[M+1]*y)}var C=.5-_*_-x*x;if(C>=0){var T=3*a[E+n+s[k+r]];C*=C,f=C*C*(u[T]*_+u[T+1]*x)}var O=.5-w*w-A*A;if(O>=0){var D=3*a[E+1+s[k+1]];O*=O,l=O*O*(u[D]*w+u[D+1]*A)}return 70*(c+f+l)},noise3D:function(e,t,n){var r,i,o,u,c,f,l,d,h,p,m=this.permMod12,v=this.perm,g=this.grad3,b=(e+t+n)*a,y=Math.floor(e+b),_=Math.floor(t+b),x=Math.floor(n+b),w=(y+_+x)*s,A=y-w,E=_-w,k=x-w,S=e-A,M=t-E,C=n-k;S>=M?M>=C?(c=1,f=0,l=0,d=1,h=1,p=0):S>=C?(c=1,f=0,l=0,d=1,h=0,p=1):(c=0,f=0,l=1,d=1,h=0,p=1):M<C?(c=0,f=0,l=1,d=0,h=1,p=1):S<C?(c=0,f=1,l=0,d=0,h=1,p=1):(c=0,f=1,l=0,d=1,h=1,p=0);var T=S-c+s,O=M-f+s,D=C-l+s,L=S-d+2*s,j=M-h+2*s,R=C-p+2*s,z=S-1+3*s,F=M-1+3*s,B=C-1+3*s,P=255&y,N=255&_,I=255&x,H=.6-S*S-M*M-C*C;if(H<0)r=0;else{var U=3*m[P+v[N+v[I]]];H*=H,r=H*H*(g[U]*S+g[U+1]*M+g[U+2]*C)}var V=.6-T*T-O*O-D*D;if(V<0)i=0;else{var G=3*m[P+c+v[N+f+v[I+l]]];V*=V,i=V*V*(g[G]*T+g[G+1]*O+g[G+2]*D)}var W=.6-L*L-j*j-R*R;if(W<0)o=0;else{var q=3*m[P+d+v[N+h+v[I+p]]];W*=W,o=W*W*(g[q]*L+g[q+1]*j+g[q+2]*R)}var X=.6-z*z-F*F-B*B;if(X<0)u=0;else{var Y=3*m[P+1+v[N+1+v[I+1]]];X*=X,u=X*X*(g[Y]*z+g[Y+1]*F+g[Y+2]*B)}return 32*(r+i+o+u)},noise4D:function(e,t,n,r){var i,o,a,s,f,l=(this.permMod12,this.perm),d=this.grad4,h=(e+t+n+r)*u,p=Math.floor(e+h),m=Math.floor(t+h),v=Math.floor(n+h),g=Math.floor(r+h),b=(p+m+v+g)*c,y=p-b,_=m-b,x=v-b,w=g-b,A=e-y,E=t-_,k=n-x,S=r-w,M=0,C=0,T=0,O=0;A>E?M++:C++,A>k?M++:T++,A>S?M++:O++,E>k?C++:T++,E>S?C++:O++,k>S?T++:O++;var D,L,j,R,z,F,B,P,N,I,H,U;D=M>=3?1:0,L=C>=3?1:0,j=T>=3?1:0,R=O>=3?1:0,z=M>=2?1:0,F=C>=2?1:0,B=T>=2?1:0,P=O>=2?1:0,N=M>=1?1:0,I=C>=1?1:0,H=T>=1?1:0,U=O>=1?1:0;var V=A-D+c,G=E-L+c,W=k-j+c,q=S-R+c,X=A-z+2*c,Y=E-F+2*c,K=k-B+2*c,Q=S-P+2*c,J=A-N+3*c,Z=E-I+3*c,$=k-H+3*c,ee=S-U+3*c,te=A-1+4*c,ne=E-1+4*c,re=k-1+4*c,ie=S-1+4*c,oe=255&p,ae=255&m,se=255&v,ue=255&g,ce=.6-A*A-E*E-k*k-S*S;if(ce<0)i=0;else{var fe=l[oe+l[ae+l[se+l[ue]]]]%32*4;ce*=ce,i=ce*ce*(d[fe]*A+d[fe+1]*E+d[fe+2]*k+d[fe+3]*S)}var le=.6-V*V-G*G-W*W-q*q;if(le<0)o=0;else{var de=l[oe+D+l[ae+L+l[se+j+l[ue+R]]]]%32*4;le*=le,o=le*le*(d[de]*V+d[de+1]*G+d[de+2]*W+d[de+3]*q)}var he=.6-X*X-Y*Y-K*K-Q*Q;if(he<0)a=0;else{var pe=l[oe+z+l[ae+F+l[se+B+l[ue+P]]]]%32*4;he*=he,a=he*he*(d[pe]*X+d[pe+1]*Y+d[pe+2]*K+d[pe+3]*Q)}var me=.6-J*J-Z*Z-$*$-ee*ee;if(me<0)s=0;else{var ve=l[oe+N+l[ae+I+l[se+H+l[ue+U]]]]%32*4;me*=me,s=me*me*(d[ve]*J+d[ve+1]*Z+d[ve+2]*$+d[ve+3]*ee)}var ge=.6-te*te-ne*ne-re*re-ie*ie;if(ge<0)f=0;else{var be=l[oe+1+l[ae+1+l[se+1+l[ue+1]]]]%32*4;ge*=ge,f=ge*ge*(d[be]*te+d[be+1]*ne+d[be+2]*re+d[be+3]*ie)}return 27*(i+o+a+s+f)}},e._buildPermutationTable=r,"undefined"!=typeof define&&define.amd&&define(function(){return e}),"undefined"!=typeof n?n.SimplexNoise=e:"undefined"!=typeof window&&(window.SimplexNoise=e),"undefined"!=typeof t&&(t.exports=e)}()},{}],93:[function(e,t,n){function r(e){return i(e).replace(/\s(\w)/g,function(e,t){return t.toUpperCase()})}var i=e(96);t.exports=r},{96:96}],94:[function(e,t,n){function r(e){return a.test(e)?e.toLowerCase():s.test(e)?(i(e)||e).toLowerCase():u.test(e)?o(e).toLowerCase():e.toLowerCase()}function i(e){return e.replace(c,function(e,t){return t?" "+t:""})}function o(e){return e.replace(f,function(e,t,n){return t+" "+n.toLowerCase().split("").join(" ")})}t.exports=r;var a=/\s/,s=/(_|-|\.|:)/,u=/([a-z][A-Z]|[A-Z][a-z])/,c=/[\W_]+(.|$)/g,f=/(.)([A-Z]+)/g},{}],95:[function(e,t,n){"use strict";function r(e,t){var n=a(getComputedStyle(e).getPropertyValue(t));return n[0]*o(n[1],e)}function i(e,t){var n=document.createElement("div");n.style["font-size"]="128"+e,t.appendChild(n);var i=r(n,"font-size")/128;return t.removeChild(n),i}function o(e,t){switch(t=t||document.body,e=(e||"px").trim().toLowerCase(),t!==window&&t!==document||(t=document.body),e){case"%":return t.clientHeight/100;case"ch":case"ex":return i(e,t);case"em":return r(t,"font-size");case"rem":return r(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return s;case"cm":return s/2.54;case"mm":return s/25.4;case"pt":return s/72;case"pc":return s/6}return 1}var a=e(87);t.exports=o;var s=96},{87:87}],96:[function(e,t,n){function r(e){return i(e).replace(/[\W_]+(.|$)/g,function(e,t){return t?" "+t:""}).trim()}var i=e(94);t.exports=r},{94:94}],97:[function(e,t,n){"use strict";function r(e,t,n){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(n,2))}function i(e){return Math.min(1,Math.max(-1,e))}function o(e){var t=Math.abs(e[0]),n=Math.abs(e[1]),r=Math.abs(e[2]),i=[0,0,0];t>Math.max(n,r)?i[2]=1:n>Math.max(t,r)?i[0]=1:i[1]=1;for(var o=0,a=0,s=0;s<3;++s)o+=e[s]*e[s],a+=i[s]*e[s];for(var s=0;s<3;++s)i[s]-=a/o*e[s];return d(i,i),i}function a(e,t,n,r,i,o,a,s){this.center=u(n),this.up=u(r),this.right=u(i),this.radius=u([o]),this.angle=u([a,s]),this.angle.bounds=[[-(1/0),-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(e,t),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var c=0;c<16;++c)this.computedMatrix[c]=.5;this.recalcMatrix(0)}function s(e){e=e||{};var t=e.center||[0,0,0],n=e.up||[0,1,0],i=e.right||o(n),s=e.radius||1,u=e.theta||0,c=e.phi||0;if(t=[].slice.call(t,0,3),n=[].slice.call(n,0,3),d(n,n),i=[].slice.call(i,0,3),d(i,i),"eye"in e){var f=e.eye,p=[f[0]-t[0],f[1]-t[1],f[2]-t[2]];l(i,p,n),r(i[0],i[1],i[2])<1e-6?i=o(n):d(i,i),s=r(p[0],p[1],p[2]);var m=h(n,p)/s,v=h(i,p)/s;c=Math.acos(m),u=Math.acos(v)}return s=Math.log(s),new a(e.zoomMin,e.zoomMax,t,n,i,s,u,c)}t.exports=s;var u=e(14),c=e(26),f=e(32),l=e(46),d=e(60),h=e(49),p=a.prototype;p.setDistanceLimits=function(e,t){e=e>0?Math.log(e):-(1/0),t=t>0?Math.log(t):1/0,t=Math.max(t,e),this.radius.bounds[0][0]=e,this.radius.bounds[1][0]=t},p.getDistanceLimits=function(e){var t=this.radius.bounds[0];return e?(e[0]=Math.exp(t[0][0]),e[1]=Math.exp(t[1][0]),e):[Math.exp(t[0][0]),Math.exp(t[1][0])]},p.recalcMatrix=function(e){this.center.curve(e),this.up.curve(e),this.right.curve(e),this.radius.curve(e),this.angle.curve(e);for(var t=this.computedUp,n=this.computedRight,i=0,o=0,a=0;a<3;++a)o+=t[a]*n[a],i+=t[a]*t[a];for(var s=Math.sqrt(i),u=0,a=0;a<3;++a)n[a]-=t[a]*o/i,u+=n[a]*n[a],t[a]/=s;for(var c=Math.sqrt(u),a=0;a<3;++a)n[a]/=c;var f=this.computedToward;l(f,t,n),d(f,f);for(var h=Math.exp(this.computedRadius[0]),p=this.computedAngle[0],m=this.computedAngle[1],v=Math.cos(p),g=Math.sin(p),b=Math.cos(m),y=Math.sin(m),_=this.computedCenter,x=v*b,w=g*b,A=y,E=-v*y,k=-g*y,S=b,M=this.computedEye,C=this.computedMatrix,a=0;a<3;++a){var T=x*n[a]+w*f[a]+A*t[a];C[4*a+1]=E*n[a]+k*f[a]+S*t[a],C[4*a+2]=T,C[4*a+3]=0}var O=C[1],D=C[5],L=C[9],j=C[2],R=C[6],z=C[10],F=D*z-L*R,B=L*j-O*z,P=O*R-D*j,N=r(F,B,P);F/=N,B/=N,P/=N,C[0]=F,C[4]=B,C[8]=P;for(var a=0;a<3;++a)M[a]=_[a]+C[2+4*a]*h;for(var a=0;a<3;++a){for(var u=0,I=0;I<3;++I)u+=C[a+4*I]*M[I];C[12+a]=-u}C[15]=1},p.getMatrix=function(e,t){this.recalcMatrix(e);var n=this.computedMatrix;if(t){for(var r=0;r<16;++r)t[r]=n[r];return t}return n};var m=[0,0,0];p.rotate=function(e,t,n,r){if(this.angle.move(e,t,n),r){this.recalcMatrix(e);var i=this.computedMatrix;m[0]=i[2],m[1]=i[6],m[2]=i[10];for(var o=this.computedUp,a=this.computedRight,s=this.computedToward,u=0;u<3;++u)i[4*u]=o[u],i[4*u+1]=a[u],i[4*u+2]=s[u];f(i,i,r,m);for(var u=0;u<3;++u)o[u]=i[4*u],a[u]=i[4*u+1];this.up.set(e,o[0],o[1],o[2]),this.right.set(e,a[0],a[1],a[2])}},p.pan=function(e,t,n,i){t=t||0,n=n||0,i=i||0,this.recalcMatrix(e);var o=this.computedMatrix,a=(Math.exp(this.computedRadius[0]),o[1]),s=o[5],u=o[9],c=r(a,s,u);a/=c,s/=c,u/=c;var f=o[0],l=o[4],d=o[8],h=f*a+l*s+d*u;f-=a*h,l-=s*h,d-=u*h;var p=r(f,l,d);f/=p,l/=p,d/=p;var m=f*t+a*n,v=l*t+s*n,g=d*t+u*n;this.center.move(e,m,v,g);var b=Math.exp(this.computedRadius[0]);b=Math.max(1e-4,b+i),this.radius.set(e,Math.log(b))},p.translate=function(e,t,n,r){this.center.move(e,t||0,n||0,r||0)},p.setMatrix=function(e,t,n,o){var a=1;"number"==typeof n&&(a=0|n),(a<0||a>3)&&(a=1);var s=(a+2)%3;t||(this.recalcMatrix(e),t=this.computedMatrix);var u=t[a],f=t[a+4],l=t[a+8];if(o){var d=Math.abs(u),h=Math.abs(f),p=Math.abs(l),m=Math.max(d,h,p);d===m?(u=u<0?-1:1,f=l=0):p===m?(l=l<0?-1:1,u=f=0):(f=f<0?-1:1,u=l=0)}else{var v=r(u,f,l);u/=v,f/=v,l/=v}var g=t[s],b=t[s+4],y=t[s+8],_=g*u+b*f+y*l;g-=u*_,b-=f*_,y-=l*_;var x=r(g,b,y);g/=x,b/=x,y/=x;var w=f*y-l*b,A=l*g-u*y,E=u*b-f*g,k=r(w,A,E);w/=k,A/=k,E/=k,this.center.jump(e,G,W,q),this.radius.idle(e),this.up.jump(e,u,f,l),this.right.jump(e,g,b,y);var S,M;if(2===a){var C=t[1],T=t[5],O=t[9],D=C*g+T*b+O*y,L=C*w+T*A+O*E;S=F<0?-Math.PI/2:Math.PI/2,M=Math.atan2(L,D)}else{var j=t[2],R=t[6],z=t[10],F=j*u+R*f+z*l,B=j*g+R*b+z*y,P=j*w+R*A+z*E;S=Math.asin(i(F)),M=Math.atan2(P,B)}this.angle.jump(e,M,S),this.recalcMatrix(e);var N=t[2],I=t[6],H=t[10],U=this.computedMatrix;c(U,t);var V=U[15],G=U[12]/V,W=U[13]/V,q=U[14]/V,X=Math.exp(this.computedRadius[0]);this.center.jump(e,G-N*X,W-I*X,q-H*X)},p.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},p.idle=function(e){this.center.idle(e),this.up.idle(e),this.right.idle(e),this.radius.idle(e),this.angle.idle(e)},p.flush=function(e){this.center.flush(e),this.up.flush(e),this.right.flush(e),this.radius.flush(e),this.angle.flush(e)},p.setDistance=function(e,t){t>0&&this.radius.set(e,Math.log(t))},p.lookAt=function(e,t,n,o){this.recalcMatrix(e),t=t||this.computedEye,n=n||this.computedCenter,o=o||this.computedUp;var a=o[0],s=o[1],u=o[2],c=r(a,s,u);if(!(c<1e-6)){a/=c,s/=c,u/=c;var f=t[0]-n[0],l=t[1]-n[1],d=t[2]-n[2],h=r(f,l,d);if(!(h<1e-6)){f/=h,l/=h,d/=h;var p=this.computedRight,m=p[0],v=p[1],g=p[2],b=a*m+s*v+u*g;m-=b*a,v-=b*s,g-=b*u;var y=r(m,v,g);if(!(y<.01&&(m=s*d-u*l,v=u*f-a*d,g=a*l-s*f,y=r(m,v,g),y<1e-6))){m/=y,v/=y,g/=y,this.up.set(e,a,s,u),this.right.set(e,m,v,g),this.center.set(e,n[0],n[1],n[2]),this.radius.set(e,Math.log(h));var _=s*g-u*v,x=u*m-a*g,w=a*v-s*m,A=r(_,x,w);_/=A,x/=A,w/=A;var E=a*f+s*l+u*d,k=m*f+v*l+g*d,S=_*f+x*l+w*d,M=Math.asin(i(E)),C=Math.atan2(S,k),T=this.angle._state,O=T[T.length-1],D=T[T.length-2];O%=2*Math.PI;var L=Math.abs(O+2*Math.PI-C),j=Math.abs(O-C),R=Math.abs(O-2*Math.PI-C);L<j&&(O+=2*Math.PI),R<j&&(O-=2*Math.PI),this.angle.jump(this.angle.lastT(),O,D),this.angle.set(e,C,M)}}}}},{14:14,26:26,32:32,46:46,49:49,60:60}],98:[function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=document.createElement("div");n.innerHTML=e,t=i({position:"absolute",bottom:"-53px",right:0,color:"rgba(190, 190, 190, 0.5)",fontSize:"14px",WebkitFontSmoothing:"antialiased",letterSpacing:"1px"},t);for(var r in t)n.style[r]=t[r];return n}Object.defineProperty(n,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.default=r},{}],99:[function(e,t,n){"use strict";function r(e){var t=e.url,n=e.fontFamily;if(!t)throw new Error("includeFont expects an opts object that includes `url`");var r=document.createElement("link");r.href=t,r.rel="stylesheet",r.type="text/css",document.head.appendChild(r),n&&(document.body.style.fontFamily=n)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=r},{}],100:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){z=new c.default(R.seed),F=new l.default(z),j=s([1,-1,.5]);for(var e=(0,v.default)(R.points).map(function(){var e=2*z()-1,t=2*z()-1,n=(F.noise2D(e*R.noiseSize/100,t*R.noiseSize/100)*R.noiseMag/100+F.noise2D(e*R.noiseSize/1e3+1e3,t*R.noiseSize/1e3+1e3)*R.noiseMag/40)/2;return{position:[e,t,n],color:[z(),z(),z()]}}),t=new A(e.map(function(e){return e.position})),n=[],r=[],i=[],o=0;o<t.triangles.length;o+=3){var a=e[t.triangles[o]],u=e[t.triangles[o+1]],f=e[t.triangles[o+2]],d=(0,p.default)([],a.position,u.position,f.position);n.push(a.position,u.position,f.position),r.push(a.color,u.color,f.color),i.push(d,d,d)}window.delaunay=t,B=L({attributes:{position:n,color:r,normal:i},count:n.length})}function o(e,t){var n={},r=new d.GUI;for(var i in e){n[i]=e[i][0];var o=r.add(n,i,e[i][1],e[i][2]);e[i][3]&&o.step(e[i][3]),e[i][4]&&o.onChange(t)}if(t){var a=t;r.add({redraw:a},"redraw")}return n}function a(e,t){(0,b.default)({fontFamily:'"Space Mono", sans-serif',url:"https://fonts.googleapis.com/css?family=Space+Mono:700"});var n=(0,_.default)(e);(0,w.default)(n,{opacity:0,color:t,bottom:"5vh",right:"5vh",transition:"opacity 800ms linear",zIndex:10}),document.body.appendChild(n),setTimeout(function(){(0,w.default)(n,"opacity",1)},200)}function s(e){function t(e){r=e}function n(){var e=C.subtract([],o,i),t=C.subtract([],r,o),n=C.scale([],t,.001);e=C.add(e,n,e),C.length(e)>.005&&(e=C.normalize(e,e),e=C.scale(e,e,.005));var a=C.add([],e,o);return i=o,o=a}var r=e,i=e,o=e;return{updateDestination:t,tick:n}}var u=e(4),c=r(u),f=e(92),l=r(f),d=e(8),h=e(15),p=r(h),m=e(84),v=r(m),g=e(99),b=r(g),y=e(98),_=r(y),x=e(12),w=r(x),A=e(11),E=e(90),k=e(74),S=e(6),M=e(25),C=e(52),T=e(1);a("ruminative-steven","#ddd");var O=document.createElement("canvas"),D=T(O),L=E(O),j=void 0;D.zoomSpeed=4,D.lookAt([2.5,2.5,2.5],[0,0,0],[.52,-.11,50]),window.camera=D,window.addEventListener("resize",S(O),!1),document.body.appendChild(O);var R=o({seed:[442,0,1e3,1,!0],points:[1e5,3,5e5,1,!0],noiseSize:[300,1,800,1,!0],noiseMag:[15,1,100,1,!0],colorVariance:[4,0,20,1],reflectionMult:[4.5,0,20,.1],dotProdMult:[1.3,-20,20,.01],lightDistance:[3,0,10,.1]},i),z=void 0,F=void 0,B=void 0;i();var P=L({vert:k(["#define GLSLIFY 1\n// #pragma glslify: snoise2 = require(glsl-noise/simplex/2d)\n\nattribute vec3 position;\nattribute vec3 color;\nattribute vec3 normal;\n\nvarying vec4 fragColor;\n\nuniform mat4 projection;\nuniform mat4 view;\n// uniform float tick;\nuniform vec3 lightSource;\nuniform float colorVariance;\nuniform vec3 baseColor;\nuniform float reflectionMult;\nuniform float dotProdMult;\n// uniform float noiseMag;\n// uniform float noiseSize;\n\nvoid main() {\n  // float z1 = snoise2(position * noiseSize * 0.01 + vec2(tick / 500.0)) * noiseMag / 100.0;\n  // float z2 = snoise2(position * noiseSize * 0.01 + vec2(1000.0 + tick / 500.0)) * noiseMag / 40.0;\n  vec3 computedPosition = position; // vec3(position, (z1 + z2) / 2.0);\n  vec3 computedColor = color * colorVariance + baseColor;\n  vec3 currentLightSource = lightSource;\n  vec3 lightDirection = normalize(currentLightSource - computedPosition);\n  float dotProduct = abs(dot(lightDirection, normal));\n  float mult = pow(1.0 - dotProduct, dotProdMult);\n  float lightenPerc = pow(max(0.2, mult), 0.95) * reflectionMult;\n  fragColor = vec4(computedColor * lightenPerc + 0.1, 1.0);\n  gl_Position = projection * view * vec4(computedPosition, 1.0);\n}\n"]),
frag:k(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}\n"]),uniforms:{projection:function(e){var t=e.viewportWidth,n=e.viewportHeight;return M.perspective([],Math.PI/4,t/n,.01,1e3)},view:function(){return D.matrix},lightSource:L.prop("lightSource"),colorVariance:function(){return R.colorVariance/100},baseColor:[.03,.13,.5],reflectionMult:function(){return R.reflectionMult},dotProdMult:function(){return R.dotProdMult}},primitive:"triangles"}),N=-1e3;L.frame(function(e){var t=e.time;t-N>4&&(j.updateDestination([(z()-.5)*R.lightDistance,(z()-.5)*R.lightDistance,(z()-.5)*R.lightDistance]),N=t),L.clear({color:[.19,.19,.19,1],depth:1}),D.tick(),P({lightSource:j.tick()},function(){return B()})})},{1:1,11:11,12:12,15:15,25:25,4:4,52:52,6:6,74:74,8:8,84:84,90:90,92:92,98:98,99:99}]},{},[100]);